/*! For license information please see lab.min.js.LICENSE.txt */
!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=400)}({0:function(t,e,n){"use strict";var i={version:"0.0.1"};i.webgl="undefined"!=typeof window&&!!window.WebGLRenderingContext,i.typed=function(){try{return new Float64Array(0),!0}catch(t){return!1}}(),i.create=function(t,e,n){var r;if(n||(n=i.webgl||i.typed?"Float32Array":"regular"),void 0===e&&(e=0),"regular"===n)r=new Array(t);else switch(n){case"Float64Array":r=new Float64Array(t);break;case"Float32Array":r=new Float32Array(t);break;case"Int32Array":r=new Int32Array(t);break;case"Int16Array":r=new Int16Array(t);break;case"Int8Array":r=new Int8Array(t);break;case"Uint32Array":r=new Uint32Array(t);break;case"Uint16Array":r=new Uint16Array(t);break;case"Uint8Array":r=new Uint8Array(t);break;case"Uint8ClampedArray":r=new Uint8ClampedArray(t);break;default:throw new Error("arrays: couldn't understand array type \""+n+'".')}return i.fill(r,e),r},i.fill=function(t,e){for(var n=-1,i=t.length;++n<i;)t[n]=e},i.constructor_function=function(t){if(t.buffer&&t.buffer.__proto__&&t.buffer.__proto__.constructor&&"[object Array]"===Object.prototype.toString.call(t))return t.__proto__.constructor;switch(t.constructor){case Array:return Array;case Float32Array:return Float32Array;case Uint8Array:return Uint8Array;case Float64Array:return Float64Array;case Int32Array:return Int32Array;case Int16Array:return Int16Array;case Int8Array:return Int8Array;case Uint32Array:return Uint32Array;case Uint16Array:return Uint16Array;case Uint8ClampedArray:return Uint8ClampedArray;default:throw new Error("arrays.constructor_function: must be an Array or Typed Array:   source: "+t)}},i.copy=function(t,e,n){for(var r=void 0!==n?n:t.length,o=-1;++o<r;)e[o]=t[o];return i.constructor_function(e)===Array&&(e.length=r),e},i.clone=function(t){var e,n,r,o=t.length;if((r=i.constructor_function(t))===Array){for(n=new r(o),e=0;e<o;e++)n[e]=t[e];return n}if(t.buffer.slice)return n=new r(t.buffer.slice(0));for(n=new r(o),e=0;e<o;e++)n[e]=t[e];return n},i.between=function(t,e,n){return n<Math.max(t,e)&&n>Math.min(t,e)},i.max=function(t){return Math.max.apply(Math,t)},i.min=function(t){return Math.min.apply(Math,t)},i.maxTypedArray=function(t){var e,n,i=Number.MIN_VALUE,r=t.length;for(n=0;n<r;n++)i=(e=t[n])>i?e:i;return i},i.minTypedArray=function(t){var e,n,i=Number.MAX_VALUE,r=t.length;for(n=0;n<r;n++)i=(e=t[n])<i?e:i;return i},i.maxAnyArray=function(t){try{return Math.max.apply(Math,t)}catch(o){if(o instanceof TypeError){var e,n,i=Number.MIN_VALUE,r=t.length;for(n=0;n<r;n++)i=(e=t[n])>i?e:i;return i}}},i.minAnyArray=function(t){try{return Math.min.apply(Math,t)}catch(o){if(o instanceof TypeError){var e,n,i=Number.MAX_VALUE,r=t.length;for(n=0;n<r;n++)i=(e=t[n])<i?e:i;return i}}},i.average=function(t){var e,n=0,i=t.length;for(e=0;e<i;e++)n+=t[e];return n/i},i.extend=function(t,e){var n,r,o;if((r=i.constructor_function(t))===Array){for(o=t.length,t.length=e;o<e;o++)t[o]=0;return t}return(n=new r(e)).set(t.subarray(0,e)),n},i.remove=function(t,e){var n;if(i.constructor_function(t)!==Array)throw new Error("arrays.remove for typed arrays not implemented yet.");return n=t.slice(e+1),t.length=e,Array.prototype.push.apply(t,n),t},i.isArray=function(t){if(null==t)return!1;switch(Object.prototype.toString.call(t)){case"[object Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object Uint8ClampedArray]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":return!0;default:return!1}},e.a=i},1:function(t,e,n){"use strict";var i=n(0);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){this.prop=t,this.message=e}function a(t){return null!==t&&"object"===r(t)}function s(t,e,n){var i,r;for(i=0,r=n.length;i<r;i++)if(t.hasOwnProperty(n[i]))throw new o(e,"Properties set contains conflicting properties: "+n[i]+" and "+e)}function l(t,e,n,i){if(t.readOnly)throw new o(e,"Properties set tries to overwrite read-only property "+e);if(!i&&t.immutable)throw new o(e,"Properties set tries to overwrite immutable property "+e);return t.validate?t.validate(n):n}o.prototype=new Error,o.prototype.constructor=o,e.a={validate:function(t,e,n){var i,r,o={};if(arguments.length<2)throw new Error("Incorrect usage. Provide metadata and hash which should be validated.");for(i in e)e.hasOwnProperty(i)&&void 0!==(r=t[i])&&(e[i]=l(r,i,e[i],n),r.conflictsWith&&s(e,i,r.conflictsWith),o[i]=e[i]);return o},validateSingleProperty:l,propertyIsWritable:function(t){return!t.readOnly},propertyChangeInvalidates:function(t){return void 0===t.propertyChangeInvalidates||!!t.propertyChangeInvalidates},validateCompleteness:function(t,e,n){var r,s,l,u={},c=n&&n.includeOnlySerializedProperties;if(arguments.length<2)throw new Error("Incorrect usage. Provide metadata and hash which should be validated.");for(r in t)if(t.hasOwnProperty(r)){if(s=t[r],c&&!1===s.serialize)continue;if(l=s.defaultValue,void 0===e[r]){if(!0===s.required)throw new o(r,"Properties set is missing required property "+r);i.a.isArray(l)?u[r]=i.a.copy(l,[]):a(l)?u[r]=$.extend(!0,{},l):void 0!==l&&(u[r]=l)}else!i.a.isArray(e[r])&&a(e[r])&&a(l)?u[r]=$.extend(!0,{},l,e[r]):i.a.isArray(e[r])?u[r]=$.extend(!0,[],e[r]):u[r]=e[r]}return this.validate(t,u,!0)},ValidationError:o}},10:function(t,e,n){"use strict";var i=n(6),r=void 0!==window.alert?window.alert:i.a.error;e.a=function(t){r(t)}},118:function(t,e,n){var i=n(80);t.exports=function(t,e,n){var r,o=[],a=!1,s={};function l(t,n){var r;if(r=1===arguments.length&&"object"==typeof t&&"string"==typeof t.type?t:{type:t,content:n},a){var s=c();i.supported()?s.postMessage(r,e):s.postMessage(JSON.stringify(r),e)}else o.push(r)}function u(t,e){s[t]=e}function c(){if(r){var e=t.contentWindow;if(!e)throw"IFrame element needs to be added to DOM before communication can be started (.contentWindow is not available)";return e}return t}function h(t){var n;t.source!==c()||"*"!==e&&t.origin!==e||("string"==typeof(n=t.data)&&(n=JSON.parse(n)),s[n.type]?s[n.type](n.content):console.log("cant handle type: "+n.type))}try{r=t.constructor===HTMLIFrameElement}catch(t){r=!1}return r&&(e&&e.constructor!==Function||(n=e,e=t.src.match(/(.*?\/\/.*?)\//)[1])),"file://"===e&&(e="*"),u("hello",(function(){for(a=!0,l({type:"hello",origin:window.location.href.match(/(.*?\/\/.*?)\//)[1]}),n&&"function"==typeof n&&n();o.length>0;)l(o.shift())})),window.addEventListener("message",h,!1),{post:l,addListener:u,removeListener:function(t){s[t]=null},disconnect:function(){a=!1,window.removeEventListener("message",h)},getTargetWindow:c,targetOrigin:e}}},119:function(t,e,n){var i=n(80);function r(){var t,e={},n=!1,r=!1,o=[];function a(t){i.supported()?window.parent.postMessage(t,"*"):window.parent.postMessage(JSON.stringify(t),"*")}function s(t,e){var n;n=1===arguments.length&&"object"==typeof t&&"string"==typeof t.type?t:{type:t,content:e},r?a(n):o.push(n)}function l(){a({type:"hello"})}function u(t){if(t.source===window.parent){var n=t.data;if("string"==typeof n&&(n=JSON.parse(n)),!r&&"hello"===n.type)for(r=!0,c();o.length>0;)s(o.shift());r&&e[n.type]&&e[n.type](n.content)}}function c(){window.clearInterval(t),t=null}return{initialize:function(){n||(n=!0,window.parent!==window&&(!function(){t&&c();t=window.setInterval(l,200),window.setTimeout(c,6e4),l()}(),window.addEventListener("message",u,!1)))},getListenerNames:function(){return Object.keys(e)},addListener:function(t,n){e[t]=n},removeAllListeners:function(){e={}},disconnect:function(){r=!1,c(),window.removeEventListener("message",messsageListener)},post:s}}var o=null;t.exports=function(){return o||(o=new r),o}},12:function(t,e){var n,i="time",r="length",o="mass",a="energy",s="entropy",l="charge",u="inverse quantity",c="farads per meter",h="meters per farad",d="force",p="velocity";e.unit={FEMTOSECOND:{name:"femtosecond",value:1,type:i},SECOND:{name:"second",value:1e-15,type:i},NANOMETER:{name:"nanometer",value:1,type:r},ANGSTROM:{name:"Angstrom",value:10,type:r},METER:{name:"meter",value:1e-9,type:r},DALTON:{name:"Dalton",value:1,type:o},GRAM:{name:"gram",value:166054e-29,type:o},KILOGRAM:{name:"kilogram",value:166054e-32,type:o},MW_ENERGY_UNIT:{name:"MW Energy Unit (Dalton * nm^2 / fs^2)",value:1,type:a},JOULE:{name:"Joule",value:1/1e-15*1.66054e-30,type:a},EV:{name:"electron volt",value:10364.27311089848,type:a},EV_PER_KELVIN:{name:"electron volts per Kelvin",value:1,type:s},JOULES_PER_KELVIN:{name:"Joules per Kelvin",value:1602177e-25,type:s},ELEMENTARY_CHARGE:{name:"elementary charge",value:1,type:l},COULOMB:{name:"Coulomb",value:1602177e-25,type:l},INVERSE_MOLE:{name:"inverse moles",value:1,type:u},FARADS_PER_METER:{name:"Farads per meter",value:1,type:c},METERS_PER_FARAD:{name:"meters per Farad",value:1,type:h},MW_FORCE_UNIT:{name:"MW force units (Dalton * nm / fs^2)",value:1,type:d},NEWTON:{name:"Newton",value:16605399999999996e-22,type:d},EV_PER_NM:{name:"electron volts per nanometer",value:10364.27311089848,type:d},MW_VELOCITY_UNIT:{name:"MW velocity units (nm / fs)",value:1,type:p},METERS_PER_SECOND:{name:"meters per second",value:1/1e-15*1e-9,type:p}},e.ratio=n=function(t,e){var n=function(t,e){if(t.type!==e.type)throw new Error("Attempt to convert incompatible type '"+t.name+"'' to '"+e.name+"'")};if(e.per)return n(t,e.per),t.value/e.per.value;if(e.as)return n(t,e.as),e.as.value/t.value;throw new Error("units.ratio() received arguments it couldn't understand.")},e.convert=function(t,e){var i=e&&e.from,r=e&&e.to;if(!i)throw new Error('units.convert() did not receive a "from" argument');if(!r)throw new Error('units.convert() did not receive a "to" argument');return t*n(r,{per:i})}},14:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},15:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},16:function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},17:function(t,e,n){(function(t){var i=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},i=0;i<e.length;i++)n[e[i]]=Object.getOwnPropertyDescriptor(t,e[i]);return n},r=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var i=arguments,o=i.length,a=String(t).replace(r,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}})),l=i[n];n<o;l=i[++n])m(l)||!_(l)?a+=" "+l:a+=" "+s(l);return a},e.deprecate=function(n,i){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,i).apply(this,arguments)};var r=!1;return function(){if(!r){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),r=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var i={seen:[],stylize:u};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),f(n)?i.showHidden=n:n&&e._extend(i,n),y(i.showHidden)&&(i.showHidden=!1),y(i.depth)&&(i.depth=2),y(i.colors)&&(i.colors=!1),y(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=l),c(i,t,i.depth)}function l(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function u(t,e){return t}function c(t,n,i){if(t.customInspect&&n&&C(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var r=n.inspect(i,t);return v(r)||(r=c(t,r,i)),r}var o=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(v(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(g(e))return t.stylize(""+e,"number");if(f(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),w(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(n);if(0===a.length){if(C(n)){var l=n.name?": "+n.name:"";return t.stylize("[Function"+l+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(x(n))return t.stylize(Date.prototype.toString.call(n),"date");if(w(n))return h(n)}var u,_="",T=!1,S=["{","}"];(p(n)&&(T=!0,S=["[","]"]),C(n))&&(_=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(_=" "+RegExp.prototype.toString.call(n)),x(n)&&(_=" "+Date.prototype.toUTCString.call(n)),w(n)&&(_=" "+h(n)),0!==a.length||T&&0!=n.length?i<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=T?function(t,e,n,i,r){for(var o=[],a=0,s=e.length;a<s;++a)E(e,String(a))?o.push(d(t,e,n,i,String(a),!0)):o.push("");return r.forEach((function(r){r.match(/^\d+$/)||o.push(d(t,e,n,i,r,!0))})),o}(t,n,i,s,a):a.map((function(e){return d(t,n,i,s,e,T)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,_,S)):S[0]+_+S[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,n,i,r,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),E(i,r)||(a="["+r+"]"),s||(t.seen.indexOf(l.value)<0?(s=m(n)?c(t,l.value,null):c(t,l.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),y(a)){if(o&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t){return Array.isArray(t)}function f(t){return"boolean"==typeof t}function m(t){return null===t}function g(t){return"number"==typeof t}function v(t){return"string"==typeof t}function y(t){return void 0===t}function b(t){return _(t)&&"[object RegExp]"===T(t)}function _(t){return"object"==typeof t&&null!==t}function x(t){return _(t)&&"[object Date]"===T(t)}function w(t){return _(t)&&("[object Error]"===T(t)||t instanceof Error)}function C(t){return"function"==typeof t}function T(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(y(o)&&(o=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var i=t.pid;a[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,i,t)}}else a[n]=function(){};return a[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=f,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=v,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=b,e.isObject=_,e.isDate=x,e.isError=w,e.isFunction=C,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(81);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var t=new Date,e=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":");return[t.getDate(),k[t.getMonth()],e].join(" ")}function E(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",A(),e.format.apply(e,arguments))},e.inherits=n(82),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t};var M="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function P(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(M&&t[M]){var e;if("function"!=typeof(e=t[M]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,M,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,i=new Promise((function(t,i){e=t,n=i})),r=[],o=0;o<arguments.length;o++)r.push(arguments[o]);r.push((function(t,i){t?n(t):e(i)}));try{t.apply(this,r)}catch(t){n(t)}return i}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),M&&Object.defineProperty(e,M,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,i(t))},e.promisify.custom=M,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],i=0;i<arguments.length;i++)n.push(arguments[i]);var r=n.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return r.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(P,e,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,i(e)),n}}).call(this,n(28))},183:function(t,e,n){var i;!function(){"use strict";function r(t,e){var n;if(e=e||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=e.touchBoundary||10,this.layer=t,this.tapDelay=e.tapDelay||200,this.tapTimeout=e.tapTimeout||700,!r.notNeeded(t)){for(var i=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],o=0,s=i.length;o<s;o++)this[i[o]]=l(this[i[o]],this);a&&(t.addEventListener("mouseover",this.onMouse,!0),t.addEventListener("mousedown",this.onMouse,!0),t.addEventListener("mouseup",this.onMouse,!0)),t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(t.removeEventListener=function(e,n,i){var r=Node.prototype.removeEventListener;"click"===e?r.call(t,e,n.hijacked||n,i):r.call(t,e,n,i)},t.addEventListener=function(e,n,i){var r=Node.prototype.addEventListener;"click"===e?r.call(t,e,n.hijacked||(n.hijacked=function(t){t.propagationStopped||n(t)}),i):r.call(t,e,n,i)}),"function"==typeof t.onclick&&(n=t.onclick,t.addEventListener("click",(function(t){n(t)}),!1),t.onclick=null)}function l(t,e){return function(){return t.apply(e,arguments)}}}var o=navigator.userAgent.indexOf("Windows Phone")>=0,a=navigator.userAgent.indexOf("Android")>0&&!o,s=/iP(ad|hone|od)/.test(navigator.userAgent)&&!o,l=s&&/OS 4_\d(_\d)?/.test(navigator.userAgent),u=s&&/OS [6-7]_\d/.test(navigator.userAgent),c=navigator.userAgent.indexOf("BB10")>0;r.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(s&&"file"===t.type||t.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(t.className)},r.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!a;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},r.prototype.sendClick=function(t,e){var n,i;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),i=e.changedTouches[0],(n=document.createEvent("MouseEvents")).initMouseEvent(this.determineEventType(t),!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,t.dispatchEvent(n)},r.prototype.determineEventType=function(t){return a&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},r.prototype.focus=function(t){var e;s&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},r.prototype.updateScrollParent=function(t){var e,n;if(!(e=t.fastClickScrollParent)||!e.contains(t)){n=t;do{if(n.scrollHeight>n.offsetHeight){e=n,t.fastClickScrollParent=n;break}n=n.parentElement}while(n)}e&&(e.fastClickLastScrollTop=e.scrollTop)},r.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},r.prototype.onTouchStart=function(t){var e,n,i;if(t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),n=t.targetTouches[0],s){if((i=window.getSelection()).rangeCount&&!i.isCollapsed)return!0;if(!l){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=n.pageX,this.touchStartY=n.pageY,t.timeStamp-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0},r.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],n=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>n||Math.abs(e.pageY-this.touchStartY)>n},r.prototype.onTouchMove=function(t){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0)},r.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},r.prototype.onTouchEnd=function(t){var e,n,i,r,o,c=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(t.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,u&&(o=t.changedTouches[0],(c=document.elementFromPoint(o.pageX-window.pageXOffset,o.pageY-window.pageYOffset)||c).fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(i=c.tagName.toLowerCase())){if(e=this.findControl(c)){if(this.focus(c),a)return!1;c=e}}else if(this.needsFocus(c))return t.timeStamp-n>100||s&&window.top!==window&&"input"===i?(this.targetElement=null,!1):(this.focus(c),this.sendClick(c,t),s&&"select"===i||(this.targetElement=null,t.preventDefault()),!1);return!(!s||l||!(r=c.fastClickScrollParent)||r.fastClickLastScrollTop===r.scrollTop)||(this.needsClick(c)||(t.preventDefault(),this.sendClick(c,t)),!1)},r.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},r.prototype.onMouse=function(t){return!this.targetElement||(!!t.forwardedTouchEvent||(!t.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1))))},r.prototype.onClick=function(t){var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail||((e=this.onMouse(t))||(this.targetElement=null),e)},r.prototype.destroy=function(){var t=this.layer;a&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},r.notNeeded=function(t){var e,n,i;if(void 0===window.ontouchstart)return!0;if(n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!a)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(n>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(c&&(i=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/))[1]>=10&&i[2]>=3&&(e=document.querySelector("meta[name=viewport]"))){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===t.style.msTouchAction||"manipulation"===t.style.touchAction||(!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(e=document.querySelector("meta[name=viewport]"))&&(-1!==e.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===t.style.touchAction||"manipulation"===t.style.touchAction))},r.attach=function(t,e){return new r(t,e)},void 0===(i=function(){return r}.call(e,n,e,t))||(t.exports=i)}()},184:function(t){t.exports=JSON.parse('{"en-US":{"translation":{"banner":{"about":"About","about_tooltip":"Instructions","share":"Share","share_tooltip":"Share using e-mail, IM or embed in website","lang_tooltip":"Select language","reload_tooltip":"Reload interactive","help_tooltip":"Show help tips","credits_tooltip":"Learn more about The Concord Consortium","fullscreen_tooltip":"Toggle full-screen","video_play_pause_tooltip":"Start / pause the simulation","video_reset_tooltip":"Reset the simulation","video_step_back_tooltip":"Step back","video_step_forward_tooltip":"Step forward","text_start":"Start","text_start_tooltip":"Start the simulation or data collection","text_stop":"Stop","text_stop_tooltip":"Stop the simulation or data collection","text_reset":"Reset","text_reset_tooltip":"Reset the simulation or data collection","text_new_run":"New Run","text_new_run_tooltip":"Set up a new experiment run","text_analyze_data":"Analyze Data","text_analyze_data_tooltip":"Send data from the experiment to CODAP"},"dialog":{"close_tooltip":"Close"},"about_dialog":{"title":"About: __interactive_title__"},"share_dialog":{"title":"Share: __interactive_title__","link":"link","paste_email_im":"Paste this __link__ in email or IM.","paste_html":"Paste HTML to embed in website or blog.","select_size":"Select Size:","size_larger":"__val__% larger","size_actual":"actual","size_smaller":"__val__% smaller"},"credits_dialog":{"title":"Credits: __interactive_title__","credits_text":"This interactive was created by the __CC_link__ using our __Next_Gen_MW_link__ software, with funding by a grant from __Google_link__.","shareable_ver":"shareable version","find_shareable":"Find a __shareable_ver_link__ of this interactive along with dozens of other open-source interactives for science, math and engineering at __concord_org_link__."},"copyright":{"copyright":"Copyright","all_rights_reserved":"All rights reserved.","license":"The software is licensed under the __MIT_link__ license. Please see __license_link__ for other software and associated licensing included in this product.","attribution":"Please provide attribution to the Concord Consortium and the URL __concord_org_link__."},"md2d":{"heatbath_icon_tooltip":"Heatbath active","ke_icon_tooltip":"Kinetic energy gradient","invalid_object_position_alert":"You can\'t drop the object there.","aminoacid_menu":{"hydrophobic":"Hydrophobic","hydrophilic":"Hydrophilic","glycine":"Glycine","alanine":"Alanine","valine":"Valine","leucine":"Leucine","isoleucine":"Isoleucine","phenylalanine":"Phenylalanine","proline":"Proline","tryptophan":"Tryptophan","methionine":"Methionine","cysteine":"Cysteine","tyrosine":"Tyrosine","asparagine":"Asparagine","glutamine":"Glutamine","serine":"Serine","threonine":"Threonine","asparticacid":"Aspartic acid","glutamicacid":"Glutamic acid","lysine":"Lysine","arginine":"Arginine","histidine":"Histidine"},"mutations_menu":{"substitution_mutation":"Substitution mutation","insertion_mutation":"Insertion mutation","deletion_mutation":"Deletion mutation","insert":"Insert"}},"sensor":{"select_sensor":"Select Sensor","select_sensor_type":"Select type of sensor...","reading":"Reading:","zero":"Zero","zeroing":"Zeroing...","loading_sensor":"Loading sensor...","choose_sensor_title":"Select a sensor:","connect":"Connect","address_labquest2":"address of LabQuest2","messages":{"ready":"Ready to collect.","ready_nocontrol":"Please stop the __controlling_client__ data collector to collect data here.","ready_nocontrol_noname":"Please stop the other active data collector to collect data here.","no_sensors":"No sensors found.","no_devices":"No devices plugged in.","not_connected":"Not connected.","connecting":"Connecting...","connection_in_progress":"Connecting to your sensors. If a message comes up about sensorconnector.concord.org, please accept it.","connection_failed":"Connection failed. __retry_link__","connection_failed_retry_link_text":"Try again","connection_failed_alert":"The Concord Consortium Sensor Connector is not installed or is not running. Please __click_here_link__ for instructions on using the Sensor Connector.","connection_failed_labquest2_alert":"Could not connect to the LabQuest2. Please make sure the address is correct and that the LabQuest2 can be reached from this computer","tare_labquest2_alert":"The LabQuest2 needs to be collecting live data in order to zero. Either set up a new run on the LabQuest2, or click the meter icon in the upper left.","click_here":"click here","connected":"Connected.","connected_start_labquest2":"Connected. Press start on your LabQuest2 to begin.","connected_start_sensorconnector":"Please stop the __controlling_client__ data collector to collect data here.","connected_start_sensorconnector_noname":"Please stop the other active data collector to collect data here.","starting_data_collection":"Starting data collection...","error_starting_data_collection":"Error starting data collection.","error_starting_data_collection_alert":"Could not start data collection. Make sure that (remote starting) is enabled","collecting_data":"Collecting data.","collecting_data_stop_labquest2":"Collecting data. Press stop on your LabQuest2 to end.","collecting_data_stop_sensorconnector":"Collecting data.","no_data":"No data is available.","no_data_alert":"The Sensor Connector does not appear to be reporting data for the plugged-in device","no_data_labquest2_alert":"The LabQuest does not appear to be reporting data for the plugged-in device","canceling_data_collection":"Canceling data collection...","error_canceling_data_collection":"Error canceling data collection.","error_canceling_data_collection_alert":"Could not cancel data collection. Make sure that (remote starting) is enabled","stopping_data_collection":"Stopping data collection...","error_stopping_data_collection":"Error stopping data collection.","error_stopping_data_collection_alert":"Could not stop data collection. Make sure that (remote starting) is enabled","data_collection_stopped":"Data collection stopped.","data_collection_complete":"Data collection complete.","disconnected":"Disconnected.","java_applet_error":"It appears that Java applets cannot run in your browser. If you are able to fix this, reload the page to use the sensor","java_applet_not_loading":"The sensor applet appears not to be loading. If you are able to fix this, reload the page to use the sensor","unexpected_error":"There was an unexpected error when connecting to the sensor.","sensor_not_attached":"The __sensor_name__ does not appear to be attached. Try re-attaching it, and then click \\"$t(sensor.messages.try_again)\\".","sensor_or_device_unplugged":"The __sensor_or_device_name__ was unplugged. Try plugging it back in, and then click \\"$t(sensor.messages.try_again)\\".","try_again":"Try Again","cancel":"Cancel"},"measurements":{"sensor_reading":"Sensor Reading","time":"Time","distance":"Distance","acceleration":"Acceleration","altitude":"Altitude","angle":"Angle","CO2":"CO₂","CO2_concentration":"CO₂ Concentration","charge":"Charge","conductivity":"Conductivity","current":"Current","dissolved_oxygen":"DO","flow_rate":"Flow Rate","fluorescence_405_nm":"Fluorescence 405 nm","fluorescence_500_nm":"Fluorescence 500 nm","force":"Force","intensity":"Intensity","light_level":"Light Level","light_intensity":"Light Intensity","magnetic_field":"Magnetic Field","position":"Position","potential":"Potential","pressure":"Pressure","signal":"Signal","sound_level":"Sound Level","speed":"Speed","temperature":"Temperature","transmittance":"Transmittance","turbidity":"Turbidity","UV_intensity":"UV Intensity","velocity":"Velocity","volume":"Volume","pH":"pH","acidity":"Acidity","O2_concentration":"O₂ Concentration"},"names":{"sensor":"sensor","no_sensor":"(no sensor)","light":"Light","motion":"Motion","accelerometer":"Accelerometer","dissolved_oxygen":"Dissolved Oxygen","pressure":"Pressure","charge_sensor":"Charge Sensor","voltage":"Voltage","pH":"pH","CO2_gas":"CO₂ Gas","colorimeter":"Colorimeter","conductivity":"Conductivity","current":"Current","temperature":"Temperature","force":"Force","anemometer":"Anemometer","hand_dynamometer":"Hand Dynamometer","heart_rate":"Heart Rate","magnetic_field":"Magnetic Field","rotary_motion":"Rotary Motion","linear_position_sensor":"Linear Position Sensor","sound_level":"Sound Level","spectrophotometer":"Spectrophotometer","spirometer":"Spirometer","turbidity":"Turbidity","UV_sensor":"UV Sensor","drop_counter":"Drop Counter","altitude":"Altitude","goMotion":"GoMotion","goTemp":"GoIO Temperature Sensor","goLinkTemperature":"GoIO Temperature Sensor","goLinkLight":"GoIO Light Sensor","goLinkForce":"GoIO Force Sensor","goLinkPH":"GoIO pH Sensor","goLinkCO2":"GoIO CO₂ sensor","goLinkO2":"GoIO O₂ sensor","labQuestMotion":"LabQuest Motion Sensor","labQuestTemperature":"LabQuest Temperature Sensor","labQuestLight":"LabQuest Light Sensor","labQuestForce":"LabQuest Force Sensor","labQuestPH":"LabQuest pH Sensor","labQuestCO2":"LabQuest CO₂ sensor","labQuestO2":"LabQuest O₂ sensor"}},"codap":{"dataContextName":"Runs","parentTable":{"singleCase":"run","pluralCase":"runs","singleCaseWithArticle":"a run","setOfCases":"set","setOfCasesWithArticle":"a set"},"childTable":{"singleCase":"measurement","pluralCase":"measurements","singleCaseWithArticle":"a measurement","setOfCases":"time series","setOfCasesWithArticle":"a time series"},"singleTable":{"singleCase":"measurement","pluralCase":"measurements","singleCaseWithArticle":"a measurement","setOfCases":"set","setOfCasesWithArticle":"a set"}}}},"el":{"translation":{"banner":{"about":"Πληροφορίες","about_tooltip":"Οδηγίες","share":"Κοινοποίηση","share_tooltip":"Κοινοποίηση με e-mail, μήνυμα ή ενσωμάτωση σε ιστότοπο","lang_tooltip":"Επιλογή γλώσσας","reload_tooltip":"Επαναφόρτωση διαδραστικού","help_tooltip":"Εμφάνιση συμβουλών","credits_tooltip":"Μάθε περισσότερα για το Concord Consortium","fullscreen_tooltip":"Εναλλαγή πλήρους οθόνης","video_play_pause_tooltip":"Έναρξη / παύση της προσομοίωσης","video_reset_tooltip":"Επαναφορά της προσομοίωσης","video_step_back_tooltip":"Βήμα πίσω","video_step_forward_tooltip":"Βήμα εμπρός","text_start":"Εκτέλεση","text_start_tooltip":"Έναρξη της προσομοίωσης ή συλλογή δεδομένων","text_stop":"Σταμάτημα","text_stop_tooltip":"Σταμάτημα της προσομοίωσης ή συλλογή δεδομένων","text_reset":"Επαναφορά","text_reset_tooltip":"Επαναφορά της προσομοίωσης ή συλλογή δεδομένων","text_new_run":"Νέα εκτέλεση","text_new_run_tooltip":"Ρύθμιση μιας νέας εκτέλεσης πειράματος","text_analyze_data":"Ανάλυση δεδομένων","text_analyze_data_tooltip":"Αποστολή δεδομένων από το πείραμα στο CODAP"},"dialog":{"close_tooltip":"Κλείσιμο"},"about_dialog":{"title":"Πληροφορίες: __interactive_title__"},"share_dialog":{"title":"Κοινοποίηση: __interactive_title__","link":"συνδέσμου","paste_email_im":"Επικόλληση αυτού του __link__ σε email ή μήνυμα.","paste_html":"Επικόλληση HTML για ενσωμάτωση σε ιστότοπο ή ιστολόγιο.","select_size":"Επιλογή μεγέθους:","size_larger":"__val__% μεγαλύτερο","size_actual":"πραγματικό","size_smaller":"__val__% μικρότερο"},"credits_dialog":{"title":"Παράγοντες: __interactive_title__","credits_text":"Αυτό το διαδραστικό δημιουργήθηκε από __CC_link__ χρησιμοποιώντας το λογισμικό __Next_Gen_MW_link__, με χρηματοδότηση μέσω μιας δωρεάς από __Google_link__.","shareable_ver":"κοινοποιήσιμη έκδοση","find_shareable":"Εύρεση μιας __shareable_ver_link__ αυτού του διαδραστικού μαζί με δεκάδες άλλων διαδραστικών ανοικτού κώδικα για επιστήμη, μαθηματικά και μηχανική στο __concord_σrg_link__."},"copyright":{"copyright":"Πνευματικά δικαιώματα","all_rights_reserved":"Όλα τα δικαιώματα κατοχυρωμένα.","license":"Το λογισμικό είναι αδειοδοτημένο κάτω από άδεια __MIT_link__.","attribution":"Παρακαλώ αναφέρετε το Concord Consortium και το URL __concord_org_link__."},"md2d":{"heatbath_icon_tooltip":"Λουτρό θερμότητας ενεργό","ke_icon_tooltip":"Κλίση κινητικής ενέργειας","invalid_object_position_alert":"Δεν μπορείτε να ρίξετε το αντικείμενο εκεί.","aminoacid_menu":{"hydrophobic":"Υδρόφοβο","hydrophilic":"Υδρόφιλο","glycine":"Γλυκίνη","alanine":"Αλανίνη","valine":"Βαλίνη","leucine":"Λευκίνη","isoleucine":"Ισολευκίνη","phenylalanine":"Φαινυλαλανίνη","proline":"Προλίνη","tryptophan":"Τρυπτοφάνη","methionine":"Μεθειονίνη","cysteine":"Κυστεΐνη","tyrosine":"Τυροσίνη","asparagine":"Ασπαραγίνη","glutamine":"Γλουταμίνη","serine":"Σερίνη","threonine":"Θρεονίνη","asparticacid":"Ασπαρτικό οξύ","glutamicacid":"Γλουταμινικό οξύ","lysine":"Λυσίνη","arginine":"Αργινίνη","histidine":"Ιστιδίνη"},"mutations_menu":{"substitution_mutation":"Μετάλλαξη αντικατάστασης","insertion_mutation":"Μετάλλαξη προσθήκης","deletion_mutation":"Μετάλλαξη αφαίρεσης","insert":"Εισαγωγή"}},"sensor":{"select_sensor":"Επιλογή αισθητήρα","select_sensor_type":"Επιλογή τύπου αισθητήρα...","reading":"Ανάγνωση:","zero":"Μηδέν","zeroing":"Μηδενισμός...","loading_sensor":"Φόρτωμα αισθητήρα...","choose_sensor_title":"Επιλογή αισθητήρα:","connect":"Σύνδεση","address_labquest2":"διεύθυνση του LabQuest2","messages":{"ready":"Έτοιμο για συλλογή.","ready_nocontrol":"Παρακαλώ σταματήστε το συλλέκτη δεδομένων __controlling_client__ για να συλλέξετε δεδομένα εδώ.","ready_nocontrol_noname":"Παρακαλώ σταματήστε τον άλλο ενεργό συλλέκτη δεδομένων για να συλλέξετε δεδομένα εδώ.","no_sensors":"Δε βρέθηκαν αισθητήρες.","no_devices":"Δεν υπάρχουν συνδεδεμένες συσκευές.","not_connected":"Μη συνδεδεμένο.","connecting":"Σύνδεση...","connection_in_progress":"Γίνετε σύνδεση στους αισθητήρες σας. Αν εμφανιστεί ένα μήνυμα για το sensorconnector.concord.org, παρακαλώ αποδεχτείτε το.","connection_failed":"Η σύνδεση απέτυχε. __retry_link__","connection_failed_retry_link_text":"Προσπαθήστε ξανά","connection_failed_alert":"Το Concord Consortium Sensor Connector δεν είναι εγκατεστημένο ή δεν εκτελείται. Παρακαλώ __click_here_link__ για οδηγίες χρήσης του Sensor Connector.","connection_failed_labquest2_alert":"Δεν ήταν δυνατό να γίνει σύνδεση στο LabQuest2. Παρακαλώ σιγουρευτείτε πως η διεύθυνση είναι σωστή και πως το LabQuest2 μπορεί να προσπελαστεί από αυτόν τον υπολογιστή","tare_labquest2_alert":"Το LabQuest2 χρειάζεται να συλλέγει ζωντανά δεδομένα για να μηδενιστεί. Είτε ρυθμίστε μια νέα εκτέλεση στο LabQuest2, ή κάντε κλικ στο εικονίδιο μετρητή πάνω αριστερά.","click_here":"πατήστε εδώ","connected":"Συνδεδεμένο.","connected_start_labquest2":"Συνδεδεμένο. Πατήστε έναρξη στο LabQuest2 για έναρξη.","connected_start_sensorconnector":"Παρακαλώ σταματήστε το συλλέκτη δεδομένων __controlling_client__ για να συλλέξετε δεδομένα εδώ.","connected_start_sensorconnector_noname":"Παρακαλώ σταματήστε τον άλλο ενεργό συλλέκτη δεδομένων για να συλλέξετε δεδομένα εδώ.","starting_data_collection":"Έναρξη συλλογής δεδομένων...","error_starting_data_collection":"Σφάλμα έναρξης συλλογής δεδομένων.","error_starting_data_collection_alert":"Δεν ήταν δυνατή η έναρξη συλλογής δεδομένων. Σιγουρευτείτε πως η (απομακρυσμένη έναρξη) είναι ενεργοποιημένη","collecting_data":"Συλλογή δεδομένων.","collecting_data_stop_labquest2":"Συλλογή δεδομένων. Πατήστε σταμάτημα στο LabQuest2 για τερματισμό.","collecting_data_stop_sensorconnector":"Συλλογή δεδομένων.","no_data":"Δεν υπάρχουν διαθέσιμα δεδομένα.","no_data_alert":"Το Sensor Connector δε φαίνεται να αναφέρει δεδομένα για τη συνδεδεμένη συσκευή","no_data_labquest2_alert":"Το LabQuest δε φαίνεται να αναφέρει δεδομένα για τη συνδεδεμένη συσκευή","canceling_data_collection":"Ακύρωση συλλογής δεδομένων...","error_canceling_data_collection":"Σφάλμα ακύρωσης συλλογής δεδομένων.","error_canceling_data_collection_alert":"Δεν ήταν δυνατή η ακύρωση συλλογής δεδομένων. Σιγουρευτείτε πως η (απομακρυσμένη εκκίνηση) είναι ενεργοποιημένη","stopping_data_collection":"Τερματισμός συλλογής δεδομένων...","error_stopping_data_collection":"Σφάλμα τερματισμού συλλογής δεδομένων.","error_stopping_data_collection_alert":"Δεν ήταν δυνατός ο τερματισμός συλλογής δεδομένων. Σιγουτευτείτε πως η (απομακρυσμένη συλλογή δεδομένων) είναι ενεργοποιημένη","data_collection_stopped":"Η συλλογή δεδομένων τερματίστηκε.","data_collection_complete":"Η συλλογή δεδομένων ολοκληρώθηκε.","disconnected":"Αποσυνδεδεμένο.","java_applet_error":"Φαίνεται πως δεν επιτρέπεται εκτέλεση Java applet στο φυλλομετρητή σας. Αν μπορείτε να το διορθώσετε, επαναφορτώστε τη σελίδα για να χρησιμοποιήσετε τον αισθητήρα","java_applet_not_loading":"Το applet του αισθητήρα φαίνεται να μη φορτώνεται. Αν μπορείτε να το διορθώσετε, επαναφορτώστε τη σελίδα για να χρησιμοποιήσετε τον αισθητήρα","unexpected_error":"Υπήρξε ένα μη αναμενόμενο σφάλμα κατά τη σύνδεση στον αισθητήρα.","sensor_not_attached":"Το __sensor_name__ does δεν φαίνεται να είναι συνδεδεμένο. Δοκιμάστε να το επανασυνδέσετε, και έπειτα πατήστε \\"$t(sensor.messages.try_again)\\".","sensor_or_device_unplugged":"Το __sensor_or_device_name__ αποσυνδέθηκε. Δοκιμάστε να το επανασυνδέσετε, και έπειτα πατήστε \\"$t(sensor.messages.try_again)\\".","try_again":"Προσπαθήστε ξανά","cancel":"Άκυρο"},"measurements":{"sensor_reading":"Μέτρηση αισθητήρα","time":"Χρόνος","distance":"Απόσταση","acceleration":"Επιτάχυνση","altitude":"Υψόμετρο","angle":"Γωνία","CO2":"CO₂","CO2_concentration":"Συγκέντρωση CO₂","charge":"Φορτίο","conductivity":"Αγωγιμότητα","current":"Ρεύμα","dissolved_oxygen":"DO (διαλυμένο Οξυγόνο)","flow_rate":"Ρυθμός ροής","fluorescence_405_nm":"Φθορισμός 405 nm","fluorescence_500_nm":"Φθορισμός 500 nm","force":"Δύναμη","intensity":"Ένταση","light_level":"Επίπεδο φωτός","light_intensity":"Ένταση φωτός","magnetic_field":"Μαγνητικό πεδίο","position":"Θέση","potential":"Δυναμικό","pressure":"Πίεση","signal":"Σήμα","sound_level":"Επίπεδο ήχου","speed":"Ταχύτητα","temperature":"Θερμοκρασία","transmittance":"Μεταδοτικότητα","turbidity":"Θολότητα","UV_intensity":"Ένταση UV","velocity":"Διανυσματική ταχύτητα","volume":"Volume","pH":"pH","acidity":"Οξύτητα","O2_concentration":"Συγκέντρωση O₂"},"names":{"sensor":"αισθητήρας","no_sensor":"(χωρίς αισθητήρα)","light":"Φώς","motion":"Κίνηση","accelerometer":"Επιταχυνσιόμετρο","dissolved_oxygen":"Διαλυμένο Οξυγόνο","pressure":"Πίεση","charge_sensor":"Αισθητήρας φορτίου","voltage":"Τάση","pH":"pH","CO2_gas":"Αέριο CO₂","colorimeter":"Χρωματόμετρο","conductivity":"Αγωγιμότητα","current":"Ρεύμα","temperature":"Θερμοκρασία","force":"Δύναμη","anemometer":"Ανεμόμετρο","hand_dynamometer":"Δυναμόμετρο χειρός","heart_rate":"Καρδιακός ρυθμός","magnetic_field":"Μαγνητικό πεδίο","rotary_motion":"Περιστροφική κίνηση","linear_position_sensor":"Αισθητήρας γραμικής θέσης","sound_level":"Επίπεδο ήχου","spectrophotometer":"Φασματοφωτόμετρο","spirometer":"Σπιρόμετρο","turbidity":"Θολότητα","UV_sensor":"Αισθητήρας UV","drop_counter":"Μετρητής πτώσης","altitude":"Υψόμετρο","goMotion":"GoMotion","goTemp":"GoIO αισθητήρας θερμοκρασίας","goLinkTemperature":"GoIO αισθητήρας θερμοκρασίας","goLinkLight":"GoIO αισθητήρας φωτός","goLinkForce":"GoIO αισθητήρας δύναμης","goLinkPH":"GoIO αισθητήρας pH","goLinkCO2":"GoIO αισθητήρας CO₂","goLinkO2":"GoIO αισθητήρας O₂","labQuestMotion":"LabQuest αισθητήρας κίνησης","labQuestTemperature":"LabQuest αισθητήρας θερμοκρασίας","labQuestLight":"LabQuest αισθητήρας φωτός","labQuestForce":"LabQuest αισθητήρας δύναμης","labQuestPH":"LabQuest αισθητήρας pH","labQuestCO2":"LabQuest αισθητήρας CO₂","labQuestO2":"LabQuest αισθητήρας O₂"}}}},"it":{"translation":{"banner":{"about":"Chi siamo","about_tooltip":"Istruzioni","share":"Condividere","share_tooltip":"Condividi tramite e-mail, IM o incorporato nel sito web","lang_tooltip":"Seleziona la lingua","reload_tooltip":"Ricarica interattiva","help_tooltip":"Mostra suggerimenti di aiuto","credits_tooltip":"Scopri di più su The Concord Consortium","fullscreen_tooltip":"Passare a schermo intero","video_play_pause_tooltip":"Avviare / mettere in pausa la simulazione","video_reset_tooltip":"Ripristina la simulazione","video_step_back_tooltip":"Fai un passo indietro","video_step_forward_tooltip":"Passo in avanti","text_start":"Inizio","text_start_tooltip":"Avviare la simulazione o la raccolta di dati","text_stop":"Stop","text_stop_tooltip":"Interrompere la simulazione o la raccolta dei dati","text_reset":"Reset","text_reset_tooltip":"Ripristina la simulazione o la raccolta di dati","text_new_run":"Nuova corsa","text_new_run_tooltip":"Imposta un nuovo run di esperimenti","text_analyze_data":"Analizzare i dati","text_analyze_data_tooltip":"Invia dati dall\'esperimento a CODAP"},"dialog":{"close_tooltip":"Chiudere"},"about_dialog":{"title":"Di: __interactive_title__"},"share_dialog":{"title":"Condividere: __interactive_title__","link":"link","paste_email_im":"Incolla questo __link__ in posta elettronica o IM.","paste_html":"Incolla HTML per incorporare in sito o blog.","select_size":"Seleziona la dimensione:","size_larger":"__val__% più grandi","size_actual":"effettivo","size_smaller":"__val__% più piccola"},"credits_dialog":{"title":"Crediti: __interactive_title__","credits_text":"Questo interattivo è stato creato da __CC_link__ usando il nostru __Next_Gen_MW_link__ software, con finanziamento da una sovvenzione di __Google_link__.","shareable_ver":"versione condivisibile","find_shareable":"Trova un __shareable_ver_link__ di questo interattivo insieme a decine di altri interattivi open-source per la scienza, la matematica e l\'ingegneria a __concord_org_link__."},"copyright":{"copyright":"Diritto d\'autore","all_rights_reserved":"Tutti i diritti riservati.","license":"Il software è concesso in licenza sotto il __MIT_link__ license.","attribution":"Fornire l\'attribuzione al Consorzio Concord e all\'URL __concord_org_link__."},"md2d":{"heatbath_icon_tooltip":"Bagno termico attivo","ke_icon_tooltip":"Gradiente di energia cinetica","invalid_object_position_alert":"Non puoi posizionare l\'oggetto in quel luogo.","aminoacid_menu":{"hydrophobic":"Idrofobo","hydrophilic":"Idrofilo","glycine":"Glycine","alanine":"Alanina","valine":"Valina","leucine":"Leucina","isoleucine":"Isoleucine","phenylalanine":"Fenilalanina","proline":"Proline","tryptophan":"Triptofano","methionine":"Metionina","cysteine":"Cisteina","tyrosine":"Tirosina","asparagine":"Asparagina","glutamine":"Glutammina","serine":"Serina","threonine":"Treonina","asparticacid":"Acido aspartico","glutamicacid":"Acido glutammico","lysine":"Lisina","arginine":"Arginina","histidine":"Istidina"},"mutations_menu":{"substitution_mutation":"Mutazione di sostituzione","insertion_mutation":"Mutazione di inserzione","deletion_mutation":"Mutazione deletione","insert":"Inserire"}},"sensor":{"select_sensor":"Selezionare Sensore","select_sensor_type":"Seleziona il tipo di sensore ...","reading":"Lettura:","zero":"Zero","zeroing":"Azzeramento...","loading_sensor":"Sensore di carico...","choose_sensor_title":"Selezionare un sensore:","connect":"Collegare","address_labquest2":"Indirizzo di LabQuest2","messages":{"ready":"Pronta da raccogliere.","ready_nocontrol":"Si prega di fermare __controlling_client__ raccoglitore di dati per raccogliere i dati qui.","ready_nocontrol_noname":"Fermati l\'altro collezionista attivo per raccogliere i dati qui.","no_sensors":"Nessun sensore è stato trovato.","no_devices":"Nessun dispositivo collegato.","not_connected":"Non collegata.","connecting":"Connessione in corso ...","connection_in_progress":"Collegamento ai sensori. Se viene visualizzato un messaggio sensorconnector.concord.org, si prega di accettarlo.","connection_failed":"Connessione fallita. __retry_link__","connection_failed_retry_link_text":"Riprova","connection_failed_alert":"Il Concord Consortium Sensor Connector non è installato o non è in esecuzione. Per favore __click_here_link__ per istruzioni sull\'utilizzo del connettore del sensore.","connection_failed_labquest2_alert":"Impossibile connettersi a LabQuest2. Assicurarsi che l\'indirizzo sia corretto e che il LabQuest2 possa essere raggiunto da questo computer","tare_labquest2_alert":"Il LabQuest2 deve raccogliere i dati dal vivo per zero. Impostare una nuova esecuzione su LabQuest2 oppure fare clic sull\'icona del contatore in alto a sinistra.","click_here":"clicca qui","connected":"Collegato.","connected_start_labquest2":"Collegato. Avviare l\'inizio del tuo LabQuest2 per iniziare.","connected_start_sensorconnector":"Si prega di fermare __controlling_client__ raccoglitore di dati per raccogliere i dati qui.","connected_start_sensorconnector_noname":"Ferma l\'altro collezionista attivo per raccogliere i dati qui.","starting_data_collection":"Inizia la raccolta dati ...","error_starting_data_collection":"Errore durante la raccolta dati.","error_starting_data_collection_alert":"Impossibile avviare la raccolta dati. Assicurarsi che sia abilitato (avvio remoto)","collecting_data":"Raccolta dati.","collecting_data_stop_labquest2":"Raccolta dati. Arrestare la sosta sul tuo LabQuest2 per terminare.","collecting_data_stop_sensorconnector":"Raccolta dati.","no_data":"Nessun dato disponibile.","no_data_alert":"Il connettore del sensore non sembra riportare i dati per il dispositivo collegato","no_data_labquest2_alert":"Il LabQuest non sembra riportare i dati per il dispositivo collegato","canceling_data_collection":"Annullamento della raccolta dati ...","error_canceling_data_collection":"Errore durante l\'annullamento della raccolta dati.","error_canceling_data_collection_alert":"Impossibile annullare la raccolta dei dati. Assicurarsi che sia abilitato (avvio remoto)","stopping_data_collection":"Arresto della raccolta dati ...","error_stopping_data_collection":"Errore durante l\'arresto della raccolta dati.","error_stopping_data_collection_alert":"Impossibile arrestare la raccolta dati. Assicurarsi che sia abilitato (avvio remoto)","data_collection_stopped":"La raccolta dati è stata interrotta.","data_collection_complete":"La raccolta dei dati è completa.","disconnected":"Scollegato.","java_applet_error":"Sembra che gli applet Java non possano essere eseguiti nel tuo browser. Se è in grado di risolvere questo problema, ricaricare la pagina per utilizzare il sensore","java_applet_not_loading":"L\'applet del sensore sembra non essere caricato. Se è in grado di risolvere questo problema, ricaricare la pagina per utilizzare il sensore","unexpected_error":"Si è verificato un errore imprevisto quando si connette al sensore.","sensor_not_attached":"Il __sensor_name__ non sembra essere allegato. Provare a ricollegarlo, quindi fare clic su \\"$t(sensor.messages.try_again)\\".","sensor_or_device_unplugged":"Il __sensor_or_device_name__ È stato scollegato. Provare a collegarlo nuovamente e quindi fare clic su \\"$t(sensor.messages.try_again)\\".","try_again":"Riprova","cancel":"Annulla"},"measurements":{"sensor_reading":"Lettura del sensore","time":"Tempo","distance":"Distanza","acceleration":"Accelerazione","altitude":"Altitudine","angle":"Angolo","CO2":"CO₂","CO2_concentration":"CO₂ Concentrazione","charge":"Carica","conductivity":"Conducibilità","current":"Current","dissolved_oxygen":"FARE","flow_rate":"Portata","fluorescence_405_nm":"Fluorescenza 405 nm","fluorescence_500_nm":"Fluorescenza 500 nm","force":"Vigore","intensity":"Intensità","light_level":"Livello luminoso","light_intensity":"Intensità luminosa","magnetic_field":"Campo magnetico","position":"Posizione","potential":"Potenziale","pressure":"Pressure","signal":"Segnale","sound_level":"Livello audio","speed":"Velocità","temperature":"Temperatura","transmittance":"Trasmissione","turbidity":"Torbidità","UV_intensity":"Intensità UV","velocity":"Velocità","volume":"Volume","pH":"pH","acidity":"Acidità","O2_concentration":"O₂ Concentrazione"},"names":{"sensor":"sensore","no_sensor":"(Nessun sensore)","light":"Leggero","motion":"Movimento","accelerometer":"Accelerometro","dissolved_oxygen":"Ossigeno dissolto","pressure":"Pressione","charge_sensor":"Sensore di carica","voltage":"Voltaggio","pH":"pH","CO2_gas":"CO₂ Gas","colorimeter":"Colorimetro","conductivity":"Conducibilità","current":"Attuale","temperature":"Temperature","force":"Vigore","anemometer":"Anemometro","hand_dynamometer":"Dynamometer della mano","heart_rate":"Frequenza cardiaca","magnetic_field":"Campo magnetico","rotary_motion":"Moto rotativo","linear_position_sensor":"Sensore di posizione lineare","sound_level":"Livello audio","spectrophotometer":"spettrofotometro","spirometer":"Spirometro","turbidity":"torbidità","UV_sensor":"Sensore UV","drop_counter":"Contatore di caduta","altitude":"Altitudine","goMotion":"GoMotion","goTemp":"Sensore di temperatura GoIO","goLinkTemperature":"Sensore di temperatura GoIO","goLinkLight":"Sensore di luce GoIO","goLinkForce":"Sensore di forza GoIO","goLinkPH":"Sensore pH GoIO","goLinkCO2":"Sensore GoIO CO₂","goLinkO2":"Sensore GoIO O2","labQuestMotion":"LabQuest Motion Sensore","labQuestTemperature":"Sensore di temperatura LabQuest","labQuestLight":"Sensore di luce LabQuest","labQuestForce":"Sensore di forza LabQuest","labQuestPH":"Sensore pH LabQuest","labQuestCO2":"Sensore COQQuest CO₂","labQuestO2":"Sensore LabQuest O2"}}}},"pl":{"translation":{"banner":{"about":"O symulacji","about_tooltip":"Instrukcje","share":"Udostępnij","share_tooltip":"Udostępnij tę symulację za pomocą e-mail, komunikatora lub umieść na swojej stronie internetowej","lang_tooltip":"Zmień język","reload_tooltip":"Załaduj symulację ponownie","help_tooltip":"Pokaż pomoc","credits_tooltip":"Dowiedz się więcej o Concord Consortium","fullscreen_tooltip":"Tryb pełnoekranowy","video_play_pause_tooltip":"Uruchom lub zatrzymaj symulację","video_reset_tooltip":"Zresetuj symulację","video_step_back_tooltip":"Krok wstecz","video_step_forward_tooltip":"Krok do przodu","text_start":"Uruchom","text_start_tooltip":"Uruchom symulację lub pobieranie danych","text_stop":"Zatrzymaj","text_stop_tooltip":"Zatrzymaj symulację lub pobieranie danych","text_reset":"Zresetuj","text_reset_tooltip":"Zresetuj symulację lub pobieranie danych","text_new_run":"Nowy pomiar","text_new_run_tooltip":"Rozpocznij nowy eksperyment","text_analyze_data":"Analizuj dane","text_analyze_data_tooltip":"Wyślij wyniki eksperymentu do CODAP"},"dialog":{"close_tooltip":"Zamknij"},"about_dialog":{"title":"O symulacji: __interactive_title__"},"share_dialog":{"title":"Udostępnij: __interactive_title__","link":"odnośnik","paste_email_im":"Wklej ten __link__ do wiadomości e-mail lub wyślij za pomocą komunikatora.","paste_html":"Aby zamieścić symulację na swojej stronie lub blogu, wklej kod HTML znajdujący się poniżej.","select_size":"Wybierz rozmiar:","size_larger":"__val__% większy","size_actual":"aktualny","size_smaller":"__val__% mniejszy"},"credits_dialog":{"title":"__interactive_title__","credits_text":"Ta symulacja została stworzona przez __CC_link__ przy użyciu __Next_Gen_MW_link__. Prace zostały sfinansowana przez grant otrzymany od __Google_link__.","shareable_ver":"Wersję tej symulacji, którą możesz udostępnić","find_shareable":"__shareable_ver_link__, wraz z setkami innych, darmowych symulacji i ćwiczeń znajdziesz na __concord_org_link__."},"copyright":{"copyright":"Copyright","all_rights_reserved":"Wszystkie prawa zastrzeżone.","license":"To oprogramowanie jest rozpowszechniane na zasadach wolnej licencji __MIT_link__. Szczegóły licencji znajdują się w pliku __license_link__.","attribution":"Proszę umieścić odniesienia do Concord Consortium oraz witryny __concord_org_link__."},"md2d":{"heatbath_icon_tooltip":"Stała temperatura","ke_icon_tooltip":"Skala energii kinetycznej","invalid_object_position_alert":"Niepoprawna pozycja obiektu.","aminoacid_menu":{"hydrophobic":"Hydrofobowe","hydrophilic":"Hydrofilowe","glycine":"Glicyna","alanine":"Alanina","valine":"Walina","leucine":"Leucyna","isoleucine":"Izoleucyna","phenylalanine":"Fenyloalanina","proline":"Prolina","tryptophan":"Tryptofan","methionine":"Metionina","cysteine":"Cysteina","tyrosine":"Tyrozyna","asparagine":"Asparagina","glutamine":"Glutamina","serine":"Seryna","threonine":"Treonina","asparticacid":"Kwas asparaginowy","glutamicacid":"Kwas glutaminowy","lysine":"Lizyna","arginine":"Arginina","histidine":"Histydyna"},"mutations_menu":{"substitution_mutation":"Substytucja","insertion_mutation":"Insercja","deletion_mutation":"Delecja","insert":"Wstaw"}},"sensor":{"select_sensor":"Wybierz sensor","select_sensor_type":"Wybierz rodzaj sensora...","reading":"Odczyt:","zero":"Wyzeruj","zeroing":"Zerowanie...","loading_sensor":"Ładowanie sensora...","choose_sensor_title":"Wybierz sensor:","connect":"Połącz","address_labquest2":"adres serwera LabQuest2","messages":{"ready":"Gotowy do odczytu.","no_sensors":"Nie znaleziono sensorów.","no_devices":"Żadne urządzenie nie jest podłączone.","not_connected":"Brak połączenia.","connecting":"Łączenie...","connection_failed":"Połączenie nieudane.","connection_failed_alert":"Concord Consortium Sensor Connector nie jest zainstalowany lub nie działa. Proszę __click_here_link__ żeby otworzyć instrukcję dotyczącą korzystania z Sensor Connector.","connection_failed_labquest2_alert":"Nie udało się połączyć z LabQuest2. Upewnij się, że adres jest poprawny i LabQuest2 jest osiągalny z tego komputera.","tare_labquest2_alert":"LabQuest2 musi pobierać rzeczywiste dane aby się wyzerować. Ustaw nowy eksperyment na LabQuest2 lub kliknij ikonę licznika na górze po lewej stronie.","click_here":"kliknąć tutaj","connected":"Połączono.","connected_start_labquest2":"Połączono. Naciśnij start na LabQuest2 aby rozpocząć.","starting_data_collection":"Rozpoczynanie pobierania danych...","error_starting_data_collection":"Błąd podczas rozpoczynania pobierania danych.","error_starting_data_collection_alert":"Nie udało się rozpocząć pobierania danych. Upewnij się, że (remote starting) jest włączony","collecting_data":"Pobieranie danych.","collecting_data_stop_labquest2":"Pobieranie danych. Naciśnij stop na LabQuest2 aby zakończyć.","no_data":"Brak dostępnych danych.","no_data_alert":"Sensor Connector nie wydaje się raportować żadnych danych dla podłączonego urządzenia","no_data_labquest2_alert":"LabQuest nie wydaje się raportować żadnych danych dla podłączonego urządzenia","canceling_data_collection":"Anulowanie pobierania danych...","error_canceling_data_collection":"Błąd podczas anulowania pobierania danych.","error_canceling_data_collection_alert":"Nie udało się anulować pobierania danych. Upewnij się, że (remote starting) jest włączony","stopping_data_collection":"Zatrzymywanie pobierania danych...","error_stopping_data_collection":"Błąd podczas zatrzymywania pobierania danych.","error_stopping_data_collection_alert":"Nie udało się zatrzymać pobierania danych. Upewnij się, że (remote starting) jest włączony","data_collection_stopped":"Pobieranie danych zatrzymane.","data_collection_complete":"Pobieranie danych zakończone.","disconnected":"Rozłączono.","java_applet_error":"Aplety Java prawodpodobnie nie mogą być uruchomione w twojej przeglądarce. Jeżeli jesteś w stanie to naprawić to potem odśwież stronę, żeby użyć sensora.","java_applet_not_loading":"Sensor Aplet nie ładuje się. Jeżeli jesteś w stanie to naprawić to potem odśwież stronę, żeby użyć sensora.","unexpected_error":"Wystąpił nieoczekiwany błąd podczas próby połączenia z sensorem.","sensor_not_attached":"__sensor_name__ wydaje się być niedpołączony. Spróbuj podłączyć go ponownie i potem kliknij \\"$t(sensor.messages.try_again)\\".","sensor_or_device_unplugged":"__sensor_or_device_name__ został odłączony. Spróbuj podłączyć go ponownie i potem kliknij \\"$t(sensor.messages.try_again)\\".","try_again":"Spróbuj ponownie","cancel":"Anuluj"},"measurements":{"sensor_reading":"Odczyt sensora","time":"Czas","distance":"Odległość","acceleration":"Przyspieszenie","altitude":"Wysokość","angle":"Kąt","CO2":"CO₂","CO2_concentration":"Stężenie CO₂","charge":"Ładunek","conductivity":"Przewodność właściwa","current":"Natężenie prądu","dissolved_oxygen":"Stężenie tlenu","flow_rate":"Strumień objętości","fluorescence_405_nm":"Fluorescencja 405 nm","fluorescence_500_nm":"Fluorescencja 500 nm","force":"Siła","intensity":"Natężenie","light_level":"Natężenie światła","light_intensity":"Intensywność światła","magnetic_field":"Pole magnetyczne","position":"Pozycja","potential":"Potencjał","pressure":"Ciśnienie","signal":"Sygnał","sound_level":"Natężenie dźwięku","speed":"Szybkość","temperature":"Temperatura","transmittance":"Transmitacja","turbidity":"Mętność","UV_intensity":"Natężenie UV","velocity":"Prędkość","volume":"Objętość","pH":"pH","acidity":"Kwasowość","O2_concentration":"Stężenie O₂"},"names":{"sensor":"czujnik","no_sensor":"(brak czujnika)","light":"Światło","motion":"Ruch","accelerometer":"Akcelerometr","dissolved_oxygen":"Stężenie tlenu","pressure":"Ciśnienie","charge_sensor":"Czujnik ładunku","voltage":"Napięcie","pH":"pH","CO2_gas":"Czujnik CO₂","colorimeter":"Kolorymetr","conductivity":"Przewodność właściwa","current":"Natężenie prądu","temperature":"Temperatura","force":"Siła","anemometer":"Anemometr","hand_dynamometer":"Dynamometr","heart_rate":"Pulsometr","magnetic_field":"Pole magnetyczne","rotary_motion":"Ruch obrotowy","linear_position_sensor":"Czujnik położenia","sound_level":"Natężenie dźwięku","spectrophotometer":"Spektrofotometr","spirometer":"Spirometr","turbidity":"Mętność","UV_sensor":"Czujnik UV","drop_counter":"Licznik kropli","altitude":"Wysokość","goMotion":"GoMotion","goTemp":"GoIO czujnik temperatury","goLinkTemperature":"GoIO czujnik temperatury","goLinkLight":"GoIO czujnik światła","goLinkForce":"GoIO czujnik siły","goLinkPH":"GoIO czujnik pH","goLinkCO2":"GoIO czujnik CO₂","goLinkO2":"GoIO czujnik O₂","labQuestMotion":"LabQuest czujnik ruchu","labQuestTemperature":"LabQuest czujnik temperatury","labQuestLight":"LabQuest czujnik światła","labQuestForce":"LabQuest czujnik siły","labQuestPH":"LabQuest czujnik pH","labQuestCO2":"LabQuest czujnik CO₂","labQuestO2":"LabQuest czujnik O₂"}},"codap":{"dataContextName":"Wyniki","parentTable":{"singleCase":"eksperyment","pluralCase":"eksperymenty","singleCaseWithArticle":"eksperyment","setOfCases":"zbiór danych","setOfCasesWithArticle":"zbiór danych"},"childTable":{"singleCase":"pomiar","pluralCase":"pomiary","singleCaseWithArticle":"pomiar","setOfCases":"szereg czasowy","setOfCasesWithArticle":"szereg czasowy"},"singleTable":{"singleCase":"pomiar","pluralCase":"pomiary","singleCaseWithArticle":"pomiar","setOfCases":"zbiór danych","setOfCasesWithArticle":"zbiór danych"}}}},"nb-NO":{"translation":{"banner":{"about":"Om simuleringen","about_tooltip":"Bruksanvisning","share":"Del","share_tooltip":"Del med e-post, melding eller innbygging","lang_tooltip":"Velg språk","reload_tooltip":"Last simuleringen på nytt","help_tooltip":"Vis hjelpetekster","credits_tooltip":"Lær mer om Concord Consortium","fullscreen_tooltip":"Slå fullskjermvisning av/på","video_play_pause_tooltip":"Start og stopp simuleringen","video_reset_tooltip":"Tilbakestill simuleringen","video_step_back_tooltip":"Gå et steg bakover","video_step_forward_tooltip":"Gå et steg framover","text_start":"Start","text_start_tooltip":"Start simuleringen eller datainnsamlingen","text_stop":"Stopp","text_stop_tooltip":"Stopp simuleringen eller datainnsamlingen","text_reset":"Tilbakestill","text_reset_tooltip":"Tilbakestill simuleringen eller datainnsamlingen"},"dialog":{"close_tooltip":"Lukk"},"about_dialog":{"title":"Om: __interactive_title__"},"share_dialog":{"title":"-Del: __interactive_title__","link":"lenke","paste_email_im":"Lim inn denne __link__ i en e-post eller melding.","paste_html":"Lim inn HTML for innbygging på et nettsted eller en blogg.","select_size":"Velg størrelse:","size_larger":"__val__% større","size_actual":"faktisk","size_smaller":"__val__% mindre"},"credits_dialog":{"title":"Informasjon om: __interactive_title__","credits_text":"Denne simuleringen er laget av __CC_link__ med bruk av __Next_Gen_MW_link__ programvare, finanisert av en bevilgning fra __Google_link__.","shareable_ver":"simuleringen kan deles","find_shareable":"Du finner en __shareable_ver_link__ av denne simuleringen, sammen med dusinvis andre open-source simuleringer for vitenskap, matematikk og teknologi på __concord_org_link__."},"copyright":{"copyright":"Copyright","all_rights_reserved":"Alle rettigheter reservert.","license":"Denne programvaren er lisensiert under __MIT_link__ lisens.","attribution":"Vær vennlig å referere til Concord Consortium og URLen __concord_org_link__."},"md2d":{"heatbath_icon_tooltip":"Varmebad er på","ke_icon_tooltip":"Kinetisk energigradient","invalid_object_position_alert":"You can\'t drop the object there.","aminoacid_menu":{"hydrophobic":"Hydrofob","hydrophilic":"Hydrofil","glycine":"Glysin","alanine":"Alanin","valine":"Valin","leucine":"Leucin","isoleucine":"Isoleucin","phenylalanine":"Fenylalanin","proline":"Prolin","tryptophan":"Tryptofan","methionine":"Metionin","cysteine":"Cystin","tyrosine":"Tyrosin","asparagine":"Aspargin","glutamine":"Glutamin","serine":"Serin","threonine":"Threonin","asparticacid":"Asparginsyre","glutamicacid":"Glutaminsyre","lysine":"Lysin","arginine":"Arginin","histidine":"Histidin"},"mutations_menu":{"substitution_mutation":"Substitusjonsmutasjon","insertion_mutation":"Insersjonsmutasjon","deletion_mutation":"Delesjonsmutasjon","insert":"Sett inn"}},"sensor":{"select_sensor":"Velg sensor","select_sensor_type":"Velg sensortype...","reading":"Avlesning:","zero":"Null","zeroing":"Nullstilling...","loading_sensor":"Laster sensor...","choose_sensor_title":"Velg en sensor:","connect":"Koble til","address_labquest2":"adressen til LabQuest2","messages":{"ready":"Klar til innsamling.","no_sensors":"Finner ingen sensorer.","no_devices":"Ingen enheter er tilkoblet.","not_connected":"Ikke tilkoblet.","connecting":"Kobler til...","connection_failed":"Tilkobling feilet.","connection_failed_alert":"Concord Consortium Sensor Connector er ikke installert eller kjører ikke. Vennligst __click_here_link__ for instruksjoner om hvordan du bruker Sensor Connector.","connection_failed_labquest2_alert":"Kunne ikke koble til LabQuest2. Vennligst sjekk at adressen er riktig, og at LabQuest2 kan nås fra denne datamaskinen","tare_labquest2_alert":"LabQuest2 må samle inn data i sanntid for å kunne nullstilles. Sett enten opp en ny måling, eller klikk målerikonet oppe til venstre.","click_here":"klikk her","connected":"Tilkoblet.","connected_start_labquest2":"Tilkoblet. Trykk start på LabQuest2 for å begynne.","starting_data_collection":"Starter datainnsamling...","error_starting_data_collection":"Feil ved start av datainnsamling.","error_starting_data_collection_alert":"Kunne ikke starte datainnsamling. Forsikre deg om at (fjernstart) er aktivert.","collecting_data":"Samler inn data.","collecting_data_stop_labquest2":"Samler inn data. Trykk stopp på LabQuest2 for å avslutte.","no_data":"Ingen data er tilgengelig.","no_data_alert":"Sensorkonnektoren ser ikke ut til å levere data fra den tilkoblede enheten","no_data_labquest2_alert":"LabQuest ser ikke ut til å rapportere data fra den tilkoblede enheten","canceling_data_collection":"Avbryter datainnsamling...","error_canceling_data_collection":"Feil ved avbrytelse av datainnsamling.","error_canceling_data_collection_alert":"Kunne ikke avbryte datainnsamling. Sjekk at (fjernstart) er aktivert","stopping_data_collection":"Stopper datainnsamling...","error_stopping_data_collection":"Feil ved stopp av datainnsamling.","error_stopping_data_collection_alert":"Kunne ikke stoppe datainnsamling. Sjekk at (fjernstart) er aktivert","data_collection_stopped":"Datainnsamling stoppet.","data_collection_complete":"Datainnsamling er fullført.","disconnected":"Koblet fra.","java_applet_error":"Det ser ut som javaappleter ikke kan kjøre i nettleseren. Hvis du kan rette på dette, last siden på nytt for å bruke sensoren","java_applet_not_loading":"Sensorappleten ser ikke ut til å virke. Hvis du kan rette på dette, kan du laste siden på nytt for å bruke sensoren","unexpected_error":"Det oppsto en uventet feil da sensoren ble tilkoblet.","sensor_not_attached":" __sensor_name__ ser ikke ut til å være tilkoblet. Prøv å koble til på nytt, og klikk på \\"$t(sensor.messages.try_again)\\".","sensor_or_device_unplugged":" __sensor_or_device_name__ ble frakoblet. Prøv å koble til på nytt, og klikk på \\"$t(sensor.messages.try_again)\\".","try_again":"Prøv igjen","cancel":"Avbryt"},"measurements":{"sensor_reading":"Sensoravlesning","time":"Tid","distance":"Avstand","acceleration":"Akselerasjon","altitude":"Høyde","angle":"Vinkel","CO2":"CO₂","CO2_concentration":"CO₂-konsentrasjon","charge":"Ladning","conductivity":"Ledningsevne","current":"Strøm","dissolved_oxygen":"OO","flow_rate":"Gjennomstrømningsmengde","fluorescence_405_nm":"Fluorescens 405 nm","fluorescence_500_nm":"Fluorescens 500 nm","force":"Kraft","intensity":"Intensitet","light_level":"Lysnivå","light_intensity":"Lysintensitet","magnetic_field":"Magnetfelt","position":"Posisjon","potential":"Potensial","pressure":"Trykk","signal":"Signal","sound_level":"Lydnivå","speed":"Fart","temperature":"Temperatur","transmittance":"Transmittans","turbidity":"Turbiditet","UV_intensity":"UV-intensitet","velocity":"Hastighet","volume":"Volum","pH":"pH","acidity":"Surhet","O2_concentration":"O₂-konsentrasjon"},"names":{"sensor":"sensor","no_sensor":"(ingen sensor)","light":"Lys","motion":"Bevegelse","accelerometer":"Akselerometer","dissolved_oxygen":"Oppløst oksygen","pressure":"Trykk","charge_sensor":"Ladningssensor","voltage":"Spenning","pH":"pH","CO2_gas":"CO₂-gass","colorimeter":"Kolorimeter","conductivity":"Ledningsevne","current":"Strøm","temperature":"Temperatur","force":"Kraft","anemometer":"Anemometer","hand_dynamometer":"Hånddynamometer","heart_rate":"Hjertefrekvens","magnetic_field":"Magnetfelt","rotary_motion":"Rotasjon","linear_position_sensor":"Sensor for lineær posisjon","sound_level":"Lydnivå","spectrophotometer":"Spektrofotometer","spirometer":"Spirometer","turbidity":"Turbiditet","UV_sensor":"UV-sensor","drop_counter":"Dråpeteller","altitude":"Høyde","goMotion":"GoMotion","goTemp":"GoIO temperatursensor","goLinkTemperature":"GoIO temperatursensor","goLinkLight":"GoIO lyssensor","goLinkForce":"GoIO kraftsensor","goLinkPH":"GoIO pH-sensor","goLinkCO2":"GoIO CO₂-sensor","goLinkO2":"GoIO CO₂-sensor","labQuestMotion":"LabQuest bevegelsessensor","labQuestTemperature":"LabQuest temperatursensor","labQuestLight":"LabQuest lyssensor","labQuestForce":"LabQuest kraftsensor","labQuestPH":"LabQuest pH-sensor","labQuestCO2":"LabQuest CO₂-sensor","labQuestO2":"LabQuest O₂-sensor"}}}},"nn-NO":{"translation":{"banner":{"about":"Om simuleringa","about_tooltip":"Brukarrettleiing","share":"Del","share_tooltip":"Del med e-post, melding eller innbygging","lang_tooltip":"Vel språk","reload_tooltip":"Last simuleringa på nytt","help_tooltip":"Vis hjelpetekstar","credits_tooltip":"Lær meir om Concord Consortium","fullscreen_tooltip":"Slå fullskjermvising av/på","video_play_pause_tooltip":"Start og stopp simuleringa","video_reset_tooltip":"Tilbakestill simuleringa","video_step_back_tooltip":"Gå eit steg bakover","video_step_forward_tooltip":"Gå eit steg framover","text_start":"Start","text_start_tooltip":"Start simuleringa eller datainnsamlinga","text_stop":"Stopp","text_stop_tooltip":"Stopp simuleringa eller datainnsamlinga","text_reset":"Tilbakestill","text_reset_tooltip":"Tilbakestill simuleringa eller datainnsamlinga"},"dialog":{"close_tooltip":"Lukk"},"about_dialog":{"title":"Om: __interactive_title__"},"share_dialog":{"title":"-Del: __interactive_title__","link":"lenke","paste_email_im":"Lim inn denne __link__ i ein e-post eller melding.","paste_html":"Lim inn HTML for innbygging på ein nettstad eller ein blogg.","select_size":"Vel storleik:","size_larger":"__val__% større","size_actual":"faktisk","size_smaller":"__val__% mindre"},"credits_dialog":{"title":"Informasjon om: __interactive_title__","credits_text":"Denne simuleringa er laga av __CC_link__ med bruk av __Next_Gen_MW_link__ programvare, finanisert av ei løyving frå __Google_link__.","shareable_ver":"simuleringa kan delast","find_shareable":"Du finn ein __shareable_ver_link__ av denne simuleringa, saman med dusinvis andre open-source simuleringar for vitskap, matematikk og teknologi på __concord_org_link__."},"copyright":{"copyright":"Copyright","all_rights_reserved":"Alle rettar reservert.","license":"Denne programvara er lisensiert under __MIT_link__ eller lisens.","attribution":"Vær venleg å referere til Concord Consortium og URLen __concord_org_link__."},"md2d":{"heatbath_icon_tooltip":"Varmebad er på","ke_icon_tooltip":"Kinetisk energigradient","invalid_object_position_alert":"You can\'t drop the object there.","aminoacid_menu":{"hydrophobic":"Hydrofob","hydrophilic":"Hydrofil","glycine":"Glysin","alanine":"Alanin","valine":"Valin","leucine":"Leucin","isoleucine":"Isoleucin","phenylalanine":"Fenylalanin","proline":"Prolin","tryptophan":"Tryptofan","methionine":"Metionin","cysteine":"Cystin","tyrosine":"Tyrosin","asparagine":"Aspargin","glutamine":"Glutamin","serine":"Serin","threonine":"Threonin","asparticacid":"Asparginsyre","glutamicacid":"Glutaminsyre","lysine":"Lysin","arginine":"Arginin","histidine":"Histidin"},"mutations_menu":{"substitution_mutation":"Substitusjonsmutasjon","insertion_mutation":"Insersjonsmutasjon","deletion_mutation":"Delesjonsmutasjon","insert":"Sett inn"}},"sensor":{"select_sensor":"Vel sensor","select_sensor_type":"Vel sensortype...","reading":"Avlesing:","zero":"Null","zeroing":"Nullstilling...","loading_sensor":"Lastar sensor...","choose_sensor_title":"Vel en sensor:","connect":"Kople til","address_labquest2":"adressen til LabQuest2","messages":{"ready":"Klar til innsamling.","no_sensors":"Finn ingen sensorer.","no_devices":"Inga eining er kopla til.","not_connected":"Ikkje tilkopla.","connecting":"Kopla til...","connection_failed":"Tilkopling feila.","connection_failed_alert":"Concord Consortium Sensor Connector er ikke installert eller kjører ikke. Vær venleg __click_here_link__ for, om naudsynt, å laste ned eit installasjonsprogram for sensortilkoplinga.","connection_failed_labquest2_alert":"Kunne ikkje kople til LabQuest2. Vær venleg, sjekk at adressen er rett, og at LabQuest2 kan nåast frå denne datamaskina","tare_labquest2_alert":"LabQuest2 må samle inn data i sann tid for å kunne nullstillast. Sett anten opp en ny måling, eller klikk målårikonet oppe til venstre.","click_here":"klikk her","connected":"Tilkopla.","connected_start_labquest2":"Tilkopla. Trykk start på LabQuest2 for å byrje.","starting_data_collection":"Startar datainnsamling...","error_starting_data_collection":"Feil ved start av datainnsamling.","error_starting_data_collection_alert":"Kunne ikkje starte datainnsamling. Forsikre deg om at (fjernstart) er aktivert.","collecting_data":"Samlar inn data.","collecting_data_stop_labquest2":"Samlar inn data. Trykk stopp på LabQuest2 for å avslutte.","no_data":"Ingen data er tilgengelege.","no_data_alert":"Sensorkonnektoren ser ikkje ut til å levere data frå den tilkopla eininga","no_data_labquest2_alert":"LabQuest ser ikkje ut til å rapportere data frå den tilkopla eininga","canceling_data_collection":"Avbryt datainnsamlinga...","error_canceling_data_collection":"Feil på avbrytinga av datainnsamlinga.","error_canceling_data_collection_alert":"Kunne ikkje avbryte datainnsamlinga. Sjekk at (fjernstart) er aktivert","stopping_data_collection":"Stopper datainnsamlinga...","error_stopping_data_collection":"Feil ved stopp av datainnsamlinga.","error_stopping_data_collection_alert":"Kunne ikkje stoppe datainnsamlinga. Sjekk at (fjernstart) er aktivert","data_collection_stopped":"Datainnsamlinga stoppa.","data_collection_complete":"Datainnsamlinga er fullført.","disconnected":"Kopla frå.","java_applet_error":"Det ser ut som javaappleter ikkje kan køyre i nettlesaren. Hvis du kan rette på dette, last inn sida på nytt for å bruke sensoren","java_applet_not_loading":"Sensorappleten ser ikkje ut til å virke. Hvis du kan rette på dette, kan du laste inn sida på nytt for å bruke sensoren","unexpected_error":"Det oppsto ein uventa feil då sensoren vart tilkopla.","sensor_not_attached":" __sensor_name__ ser ikkje ut til å vere tilkopla. Prøv å kople til på nytt, og klikk på \\"$t(sensor.messages.try_again)\\".","sensor_or_device_unplugged":" __sensor_or_device_name__ ble frakopla. Prøv å kople til på nytt, og klikk på \\"$t(sensor.messages.try_again)\\".","try_again":"Prøv igjen","cancel":"Avbryt"},"measurements":{"sensor_reading":"Sensoravlesing","time":"Tid","distance":"Avstand","acceleration":"Akselerasjon","altitude":"Høgd","angle":"Vinkel","CO2":"CO₂","CO2_concentration":"CO₂-konsentrasjon","charge":"Ladning","conductivity":"Leiingsevne","current":"Strøm","dissolved_oxygen":"OO","flow_rate":"Gjennomstrømmingsmengd","fluorescence_405_nm":"Fluorescens 405 nm","fluorescence_500_nm":"Fluorescens 500 nm","force":"Kraft","intensity":"Intensitet","light_level":"Lysnivå","light_intensity":"Lysintensitet","magnetic_field":"Magnetfelt","position":"Posisjon","potential":"Potensial","pressure":"Trykk","signal":"Signal","sound_level":"Lydnivå","speed":"Fart","temperature":"Temperatur","transmittance":"Transmittans","turbidity":"Turbiditet","UV_intensity":"UV-intensitet","velocity":"Hastigheit","volume":"Volum","pH":"pH","acidity":"Surleik","O2_concentration":"O₂-konsentrasjon"},"names":{"sensor":"sensor","no_sensor":"(ingen sensor)","light":"Lys","motion":"Rørsle","accelerometer":"Akselerometer","dissolved_oxygen":"Løyst oksygen","pressure":"Trykk","charge_sensor":"Ladingssensor","voltage":"Spenning","pH":"pH","CO2_gas":"CO₂-gass","colorimeter":"Kolorimeter","conductivity":"Leiingsevne","current":"Strøm","temperature":"Temperatur","force":"Kraft","anemometer":"Anemometer","hand_dynamometer":"Handdynamometer","heart_rate":"Hjertefrekvens","magnetic_field":"Magnetfelt","rotary_motion":"Rotasjon","linear_position_sensor":"Sensor for lineær posisjon","sound_level":"Lydnivå","spectrophotometer":"Spektrofotometer","spirometer":"Spirometer","turbidity":"Turbiditet","UV_sensor":"UV-sensor","drop_counter":"Dropeteljar","altitude":"Høgd","goMotion":"GoMotion","goTemp":"GoIO temperatursensor","goLinkTemperature":"GoIO temperatursensor","goLinkLight":"GoIO lyssensor","goLinkForce":"GoIO kraftsensor","goLinkPH":"GoIO pH-sensor","goLinkCO2":"GoIO CO₂-sensor","goLinkO2":"GoIO CO₂-sensor","labQuestMotion":"LabQuest rørslesensor","labQuestTemperature":"LabQuest temperatursensor","labQuestLight":"LabQuest lyssensor","labQuestForce":"LabQuest kraftsensor","labQuestPH":"LabQuest pH-sensor","labQuestCO2":"LabQuest CO₂-sensor","labQuestO2":"LabQuest O₂-sensor"}}}},"pt-BR":{"translation":{"banner":{"about":"Sobre","about_tooltip":"Instruções","share":"Compartilhar","share_tooltip":"Compartilha por e-mail, mensagem ou inclui em site","lang_tooltip":"Seleciona a língua","reload_tooltip":"Recarrega o interativo","help_tooltip":"Mostra dicas","credits_tooltip":"Saber mais sobre The Concord Consortium","fullscreen_tooltip":"Alterna para tela cheia","video_play_pause_tooltip":"Inicia / pausa a simulação","video_reset_tooltip":"Reinicia a simulação","video_step_back_tooltip":"Passo atrás","video_step_forward_tooltip":"Passo adiante","text_start":"Iniciar","text_start_tooltip":"Inicia a simulação ou coleta de dados","text_stop":"Parar","text_stop_tooltip":"Para a simulação ou coleta de dados","text_reset":"Reiniciar","text_reset_tooltip":"Reinicia a simulação ou coleta de dados","text_new_run":"Nova corrida","text_new_run_tooltip":"Prepara nova corrida experimental","text_analyze_data":"Analisar dados","text_analyze_data_tooltip":"Envia dados experimentais para CODAP"},"dialog":{"close_tooltip":"Fecha"},"about_dialog":{"title":"Sobre: __interactive_title__"},"share_dialog":{"title":"Compartilhar: __interactive_title__","link":"link","paste_email_im":"Cole este __link__ no email ou mensagem.","paste_html":"Cole o HTML para incluir em site ou blog.","select_size":"Selecione o tamanho:","size_larger":"__val__% maior","size_actual":"real","size_smaller":"__val__% menor"},"credits_dialog":{"title":"Créditos: __interactive_title__","credits_text":"Este interativo foi criado pelo __CC_link__ usando nosso __Next_Gen_MW_link__ software, com o apoio financeiro do __Google_link__.","shareable_ver":"versão compartilhável","find_shareable":"Encontre uma __shareable_ver_link__ deste interativo e mais dezenas de outros interativos de código aberto para ciência, matemática e engenharia em __concord_org_link__."},"copyright":{"copyright":"Copyright","all_rights_reserved":"Todos direitos reservados.","license":"O software é licenciado sob a licença __MIT_link__.","attribution":"Por favor, forneça a atribuição ao Concord Consortium and a URL __concord_org_link__."},"md2d":{"heatbath_icon_tooltip":"Banho de calor ativo","ke_icon_tooltip":"Gradiente de energia cinética","invalid_object_position_alert":"You can\'t drop the object there.","aminoacid_menu":{"hydrophobic":"Hidrofóbico","hydrophilic":"Hidrofílico","glycine":"Glicina","alanine":"Alanina","valine":"Valina","leucine":"Leucina","isoleucine":"Isoleucina","phenylalanine":"Phenilalanina","proline":"Prolina","tryptophan":"Triptofano","methionine":"Metionina","cysteine":"Cisteína","tyrosine":"Tirosina","asparagine":"Asparagina","glutamine":"Glutamina","serine":"Serina","threonine":"Treonina","asparticacid":"Ácido aspártico","glutamicacid":"Ácido glutâmico","lysine":"Lisina","arginine":"Arginina","histidine":"Histidina"},"mutations_menu":{"substitution_mutation":"Mutação de substituição","insertion_mutation":"Mutação de inserção","deletion_mutation":"Mutação de deleção","insert":"Inserir"}},"sensor":{"select_sensor":"Selecione o sensor","select_sensor_type":"Selecione o tipo de sensor...","reading":"Leitura:","zero":"Zero","zeroing":"Zerando...","loading_sensor":"Carregando sensor...","choose_sensor_title":"Selecione o sensor:","connect":"Conectar","address_labquest2":"endereço do LabQuest2","messages":{"ready":"Pronto para coletar.","ready_nocontrol":"Por favor pare o coletor de dados __controlling_client__ para coletar dados aqui.","ready_nocontrol_noname":"Por favor pare o outro coletor de dados ativo para coletar dados aqui.","no_sensors":"Nenhum sensor encontrado.","no_devices":"Nenhum dispositivo plugado.","not_connected":"Não contectado.","connecting":"Conectando...","connection_failed":"Conexão falhou.","connection_in_progress":"Conectando-se a seus sensores. Se uma mensagem surge sobre sensorconnector.concord.org, por favor, aceite -o","connection_failed_alert":"O Conector de Sensores do Concord Consortium não está instalado ou não está funcionando. Por favor __click_here_link__ obter instruções sobre a utilização do Conector de Sensores.","connection_failed_labquest2_alert":"Não foi possível conectar ao LabQuest2. Por favor verifique se o endereço está certo e se o LabQuest2 pode ser alcançado deste computador","tare_labquest2_alert":"O LabQuest2 precisa conectar dados ao vivo para zerar. Inicie uma nova corrida no LabQuest2 ou clique no ícone do medidor no alto à esquerda.","click_here":"clique aqui","connected":"Conectado.","connected_start_labquest2":"Conectado. Aperte iniciar no seu LabQuest2 to começar.","connected_start_sensorconnector":"Por favor pare o coletor de dados __controlling_client__ para coletar dados aqui.","connected_start_sensorconnector_noname":"Por favor pare o outro coletor de dados ativo para coletar dados aqui.","starting_data_collection":"Iniciando coleta de dados...","error_starting_data_collection":"Erro ao iniciar a coleta de dados.","error_starting_data_collection_alert":"Não foi possível iniciar a coleta de dados. Verifique se (remote starting) está habilitado","collecting_data":"Coletando dados.","collecting_data_stop_labquest2":"Coletando dados. Pressione parar no seu LabQuest2 para encerrar.","collecting_data_stop_sensorconnector":"Coletando dados.","no_data":"Não há dados disponíveis.","no_data_alert":"O Conector de Sensores parece não estar reportando dados ao dispositivo plugado","no_data_labquest2_alert":"The LabQuest parece não estar reportando dados ao dispositivo plugado","canceling_data_collection":"Cancelando coleta de dados...","error_canceling_data_collection":"Erro ao cancelar a coleta de dados.","error_canceling_data_collection_alert":"Não foi possível cancelar a coleta de dados. Verifique se (remote starting) está habilitado","stopping_data_collection":"Interrompendo a coleta de dados...","error_stopping_data_collection":"Erro ao interromper a coleta de dados.","error_stopping_data_collection_alert":"Não foi possível interromper a coleta de dados. Verifique se (remote starting) está habilitado","data_collection_stopped":"Coleta de dados interrompida.","data_collection_complete":"Coleta de dados completa.","disconnected":"Desconectado.","java_applet_error":"Parece que applets Java não podem rodar no seu navegador. Se você puder consertar isso, recarregue a página para usar o sensor.","java_applet_not_loading":"O applet do sensor parece não estar carregando. Se você puder consertar isso, recarregue a página para usar o sensor.","unexpected_error":"Houve um erro inesperado ao conectar com o sensor.","sensor_not_attached":"O __sensor_name__ parece não estar conectado. Tente reconectá-lo, e então clique \\"$t(sensor.messages.try_again)\\".","sensor_or_device_unplugged":"O __sensor_or_device_name__ estava deplugado. Tente reconectá-lo, e então clique \\"$t(sensor.messages.try_again)\\".","try_again":"Tentar de novo","cancel":"Cancelar"},"measurements":{"sensor_reading":"Leitura do sensor","time":"Tempo","distance":"Distância","acceleration":"Aceleração","altitude":"Altitude","angle":"Ângulo","CO2":"CO₂","CO2_concentration":"Concentração de CO₂","charge":"Carga","conductivity":"Condutividade","current":"Corrente","dissolved_oxygen":"OD","flow_rate":"Taxa de fluxo","fluorescence_405_nm":"Fluorescência a 405 nm","fluorescence_500_nm":"Fluorescência a 500 nm","force":"Força","intensity":"Intensidade","light_level":"Nível de luz","light_intensity":"Intensidade de luz","magnetic_field":"Campo magnético","position":"Posição","potential":"Potencial","pressure":"Pressão","signal":"Sinal","sound_level":"Nível de som","speed":"Velocidade","temperature":"Temperatura","transmittance":"Transmitância","turbidity":"Turbidez","UV_intensity":"Intensidade UV","velocity":"Velocidade","volume":"Volume","pH":"pH","acidity":"Acidez","O2_concentration":"Concentração de O₂"},"names":{"sensor":"sensor","no_sensor":"(sem sensor)","light":"Luz","motion":"Movimento","accelerometer":"Acelerômetro","dissolved_oxygen":"Oxigênio Dissolvido","pressure":"Pressão","charge_sensor":"Sensor de Carga","voltage":"Voltagem","pH":"pH","CO2_gas":"Gas CO₂","colorimeter":"Colorímetro","conductivity":"Condutividade","current":"Corrente","temperature":"Temperatura","force":"Força","anemometer":"Anemômetro","hand_dynamometer":"Dinamômetro de Mão","heart_rate":"Frequência Cardíaca","magnetic_field":"Campo Magnético","rotary_motion":"Movimento de Rotação","linear_position_sensor":"Sensor de Posição Linear","sound_level":"Nível de Som","spectrophotometer":"Espectrofotômetro","spirometer":"Espirômetro","turbidity":"Turbidez","UV_sensor":"Sensor UV","drop_counter":"Contador de Gotas","altitude":"Altitude","goMotion":"GoMotion","goTemp":"Sensor de Temperatura GoIO","goLinkTemperature":"Sensor de Temperatura GoIO","goLinkLight":"Sensor de Luz GoIO","goLinkForce":"Sensor de Força GoIO","goLinkPH":"Sensor de pH GoIO","goLinkCO2":"Sensor de  CO₂ GoIO","goLinkO2":"Sensor de  O₂ GoIO","labQuestMotion":"Sensor de Movimento LabQuest","labQuestTemperature":"Sensor de Temperatura LabQuest","labQuestLight":"Sensor de Luz LabQuest","labQuestForce":"Sensor de Força LabQuest","labQuestPH":"Sensor de pH LabQuest","labQuestCO2":"Sensor de CO₂ LabQuest","labQuestO2":"Sensor de O₂ LabQuest"}}}},"cs-CZ":{"translation":{"banner":{"about":"O simulaci","about_tooltip":"Pokyny","share":"Sdílet","share_tooltip":"Sdílet pomocí e-mailu, IM nebo vložení do webové stránky","lang_tooltip":"Vybrat jazyk","reload_tooltip":"Opakovat simulaci","help_tooltip":"Zobrazit nápovědu","credits_tooltip":"Dozvědět se více o The Concord Consortium","fullscreen_tooltip":"Režim celé obrazovky","video_play_pause_tooltip":"Start / pauza simulace","video_reset_tooltip":"Obnova simulace","video_step_back_tooltip":"Krok zpět","video_step_forward_tooltip":"Krok vpřed","text_start":"Start","text_start_tooltip":"Start simulace nebo sběru dat","text_stop":"Stop","text_stop_tooltip":"Zastavit simulaci nebo sběr dat","text_reset":"Obnovit","text_reset_tooltip":"Obnovit simulaci nebo sběr dat","text_new_run":"Nový pokus","text_new_run_tooltip":"Nastavení nového pokusu","text_analyze_data":"Analyzovat data","text_analyze_data_tooltip":"Poslat data z experimentu do CODAP"},"dialog":{"close_tooltip":"Zavřít"},"about_dialog":{"title":"O simulaci: __interactive_title__"},"share_dialog":{"title":"Sdílet: __interactive_title__","link":"odkaz","paste_email_im":"Vložit __link__ do e-mailu nebo IM.","paste_html":"HTML kód pro vložení do webové stránky nebo blogu","select_size":"Vybrat velikost:","size_larger":"__val__% vetší","size_actual":"současná","size_smaller":"__val__% menší"},"credits_dialog":{"title":"Credits: __interactive_title__","credits_text":"Tato simulace byla vytvořena pomocí __CC_link__ využívající našeho __Next_Gen_MW_link__ softwaru. Práce byla financována z grantu __Google_link__.","shareable_ver":"Verze pro sdílení","find_shareable":"__shareable_ver_link__ s dalšími simulacemi z přírodních věd, matematiky a strojírenství je možné najít na __concord_org_link__."},"copyright":{"copyright":"Copyright","all_rights_reserved":"Všechna práva vyhrazena.","license":"Software je licencován pod __MIT_link__.","attribution":"Prosím, zajistěte práva Concord Consortium a URL __concord_org_link__."},"md2d":{"heatbath_icon_tooltip":"Vodní lázeň","ke_icon_tooltip":"Gradient kinetické energie","invalid_object_position_alert":"You can\'t drop the object there.","aminoacid_menu":{"hydrophobic":"Hydrofobní","hydrophilic":"Hydrofilní","glycine":"Glycin","alanine":"Alanin","valine":"Valin","leucine":"Leucin","isoleucine":"Isoleucin","phenylalanine":"Fenylalanin","proline":"Prolin","tryptophan":"Tryptofan","methionine":"Methionin","cysteine":"Cystein","tyrosine":"Tyrosin","asparagine":"Asparagin","glutamine":"Glutamin","serine":"Serin","threonine":"Threonin","asparticacid":"Kyselina asparagová","glutamicacid":"Kyselina glutamová","lysine":"Lysin","arginine":"Arginin","histidine":"Histidin"},"mutations_menu":{"substitution_mutation":"Substituční mutace","insertion_mutation":"Inzerce","deletion_mutation":"Delece","insert":"Vložení"}},"sensor":{"select_sensor":"Vybrat čidlo","select_sensor_type":"Vybrat druh čidla...","reading":"Hodnota:","zero":"Vynulovat","zeroing":"Nulování...","loading_sensor":"Nahrávání čidla...","choose_sensor_title":"Vybrat čidlo:","connect":"Připojeno","address_labquest2":"adresa LabQuest2","messages":{"ready":"Připraven ke sběr dat.","ready_nocontrol":"Prosím, zastavte __controlling_client__ sběr dat, aby bylo možné sbírat data zde.","ready_nocontrol_noname":"Prosím, zastavte ostatní sběry dat, aby bylo možné sbírat data zde.","no_sensors":"Čidlo nenalezeno.","no_devices":"Není připojeno žádné zařízení.","not_connected":"Nepřipojeno.","connecting":"Připojování...","connection_in_progress":"Připojování čidel. Pokud se objeví zpráva o sensorconnector.concord.org, potvrďte ji, prosím.","connection_failed":"Připojení selhalo. __retry_link__","connection_failed_retry_link_text":"Zkusit znovu","connection_failed_alert":"Concord Consortium Sensor Connector není naistalován nebo spuštěn. Prosím, pro další instrukce k používání Sensor Connector __click_here_link__ .","connection_failed_labquest2_alert":"Nepodařilo se spojit s LabQuest2. Prosím, ověřte zda je adresa správná a jestli je možné se s LabQuest2 spojit z toho počítače.","tare_labquest2_alert":"Pro vynulování potřebuje LabQuest2 sbírat aktuální data. Buď nastavte nový pokus v LabQuest2, nebo klepněte na ikonu měření v levém horním rohu.","click_here":"Klepněte zde","connected":"Připojeno.","connected_start_labquest2":"Připojeno. Pro zahájení pokusu klepněte na start v LabQuest2.","connected_start_sensorconnector":"Prosím, zastavte __controlling_client__ sběr dat, aby bylo možné sbírat data zde.","starting_data_collection":"Začíná sběr dat...","error_starting_data_collection":"Chyba při zahájení sběru dat.","error_starting_data_collection_alert":"Nebylo možné zahájit sběr dat. Ujistěte se, že (remote starting) je povolený.","collecting_data":"Sbírám data.","collecting_data_stop_labquest2":"Sbírám data. Klikněte na stop v LabQuest2, aby se sběr ukončil.","collecting_data_stop_sensorconnector":"Sběr dat.","no_data":"Data nejsou k dispozici.","no_data_alert":"Sensor Connector nezaznamenává data ze zapojeného zařízení.","no_data_labquest2_alert":"LabQuest nezaznamenává data ze zapojeného zařízení.","canceling_data_collection":"Rušení sběru dat...","error_canceling_data_collection":"Chyba při rušení sběru dat.","error_canceling_data_collection_alert":"Není možné zrušit sběr dat. Ujistěte se, že (remote starting) je povolený.","stopping_data_collection":"Zastavování sběru dat...","error_stopping_data_collection":"Chyba při zastavování sběru dat.","error_stopping_data_collection_alert":"Není možné zastavit sběr dat. Ujistěte se, že (remote starting) je povolený.","data_collection_stopped":"Sběr dat zastaven.","data_collection_complete":"Sběr dat dokončen.","disconnected":"Odpojeno.","java_applet_error":"Java aplety nemohou být spuštěny v prohlížeči. Po opravě znovu načtěte stránku, aby bylo možné použít sezor.","java_applet_not_loading":"čidlo se nenačítá. Po opravě znovu načtěte stránku, aby bylo možné použít sezor.","unexpected_error":"Nastala neočekáváná chyba při připojování čidla.","sensor_not_attached":"__sensor_name__ není připojený. Zkuste ho připojit znovu a poté klikněte na \\"$t(sensor.messages.try_again)\\".","sensor_or_device_unplugged":" __sensor_or_device_name__ byl odpojen. Zkuste ho připojit znovu a poté klepněte na \\"$t(sensor.messages.try_again)\\".","try_again":"Zkusit znovu","cancel":"Zrušit"},"measurements":{"sensor_reading":"Hodnota čidla","time":"Čas","distance":"Vzdálenost","acceleration":"Zrychlení","altitude":"Výška","angle":"Úhel","CO2":"CO2","CO2_concentration":"Koncentrace CO2","charge":"Náboj","conductivity":"Vodivost","current":"Proud","dissolved_oxygen":"DO - rozpuštěný kyslík","flow_rate":"Objemový průtok","fluorescence_405_nm":"Fluorescence 405 nm","fluorescence_500_nm":"Fluorescence 500 nm","force":"Síla","intensity":"Intenzita","light_level":"Množství světla","light_intensity":"Intenzita osvětlení","magnetic_field":"Magnetické pole","position":"Pozice","potential":"Potenciál","pressure":"Tlak","signal":"Signál","sound_level":"Hlasitost","speed":"Rychlost","temperature":"Teplota","transmittance":"Transmitance","turbidity":"Turbidita (zákal)","UV_intensity":"Intenzita UV záření","velocity":"Rychlost","volume":"Objem","pH":"pH","acidity":"Kyselost","O2_concentration":"Koncentrace O2"},"names":{"sensor":"čidlo","no_sensor":"(žádné čidlo)","light":"Světlo","motion":"Pohyb","accelerometer":"Akcelerometer (čidlo zrychlení)","dissolved_oxygen":"Rozpuštěný kyslík","pressure":"Tlak","charge_sensor":"Elektroskop (čidlo náboje)","voltage":"Elektrické napětí","pH":"pH","CO2_gas":"CO2","colorimeter":"Kolorimetr","conductivity":"Vodivost","current":"Elektrický proud","temperature":"Teplota","force":"Síla","anemometer":"Anemometr","hand_dynamometer":"Ruční siloměr","heart_rate":"Srdeční tep","magnetic_field":"Magnetické pole","rotary_motion":"Rotační pohyb","linear_position_sensor":"Lineární poloha","sound_level":"Hlasitost","spectrophotometer":"Spektrofotometr","spirometer":"Spirometr","turbidity":"Turbidita (zákal)","UV_sensor":"Čidlo UV záření","drop_counter":"Čítač kapek","altitude":"Výška","goMotion":"GoMotion","goTemp":"GoIO teplotní čidlo","goLinkTemperature":"GoIO teplotní čidlo","goLinkLight":"GoIO světelné čidlo","goLinkForce":"GoIO čidlo pro měření síly","goLinkPH":"GoIO čidlo pH","goLinkCO2":"GoIO čidlo pro měžení CO2","goLinkO2":"GoIO čidlo pro měření O2","labQuestMotion":"LabQuest pohybové čidlo","labQuestTemperature":"LabQuest teplotní čidlo","labQuestLight":"LabQuest světelné čidlo","labQuestForce":"LabQuest čidlo pro měření síly","labQuestPH":"LabQuest čidlo pH","labQuestCO2":"LabQuest čidlo pro měření CO2","labQuestO2":"LabQuest čidlo pro měření O2"}}}},"es":{"translation":{"banner":{"about":"Acerca de","about_tooltip":"Instrucciones","share":"Compartir","share_tooltip":"Compartir a través de e-mail, MI o embeber en sitio web","lang_tooltip":"Elegir idioma","reload_tooltip":"Recargar el interactivo","help_tooltip":"Mostrar ayuda","credits_tooltip":"Saber más sobre The Concord Consortium","fullscreen_tooltip":"Cambiar a pantalla completa","video_play_pause_tooltip":"Iniciar / pausar la simulación","video_reset_tooltip":"Resetear la simulación","video_step_back_tooltip":"Un paso atrás","video_step_forward_tooltip":"Un paso adelante","text_start":"Iniciar","text_start_tooltip":"Iniciar la simulación o recolección de datos","text_stop":"Detener","text_stop_tooltip":"Detener la simulación o recolección de datos","text_reset":"Resetear","text_reset_tooltip":"Resetear la simulación o recolección de datos"},"dialog":{"close_tooltip":"Cerrar"},"about_dialog":{"title":"Acerca de: __interactive_title__"},"share_dialog":{"title":"Compartir: __interactive_title__","link":"enlace","paste_email_im":"Pegar este __link__ en email o MI","paste_html":"Pegar HTML para embeber en sitio web o blog.","select_size":"Elegir tamaño:","size_larger":"__val__% más grande","size_actual":"actual","size_smaller":"__val__% más pequeño"},"credits_dialog":{"title":"Créditos: __interactive_title__","credits_text":"Este interactivo fue creado por the __CC_link__ usando nuestro software __Next_Gen_MW_link__, con fondos provenientes de un gran de __Google_link__.","shareable_ver":"versión para compartir","find_shareable":"Buscar un __shareable_ver_link__ de este interactivo junto a docenas de otros interactivos de código abierto para ciencias, matemática e ingeniería en __concord_org_link__."},"copyright":{"copyright":"Copyright","all_rights_reserved":"Todos los derechos reservados.","license":"Este software está licenciado bajo licencia de __MIT_link__.","attribution":"Por favor dar atribución a The Concord Consortium y la URL __concord_org_link__."}}},"ru":{"translation":{"banner":{"about":"Об интерактиве","about_tooltip":"Инструкция","share":"Опубликовать ссылку","share_tooltip":"Поделиться данными в e-mail, IM или вставить их на страницу в web-страницу","lang_tooltip":"Выбрать язык","reload_tooltip":"Перезагрузить интерактив","help_tooltip":"Показать подсказку","credits_tooltip":"Подробнее о Конкорд Консорциуме","fullscreen_tooltip":"Переключить на полноэкранную версию","video_play_pause_tooltip":"Старт/пауза симуляции","video_reset_tooltip":"Перезагрузить симуляцию","video_step_back_tooltip":"Шаг назад","video_step_forward_tooltip":"Шаг вперед","text_start":"Старт","text_start_tooltip":"Запустить симуляции или сбор данных","text_stop":"Стоп","text_stop_tooltip":"Остановить симуляцию или сбор данных ","text_reset":"Перегрузить","text_reset_tooltip":" Перегрузить симуляцию или сбор данных","text_new_run":"Повторный запуск","text_new_run_tooltip":"Повторить запуск нового эксперимента","text_analyze_data":"Анализ данных","text_analyze_data_tooltip":"Послать данные опыта на CODAP"},"dialog":{"close_tooltip":"Закрыть"},"about_dialog":{"title":"Об интерактиве: __interactive_title__"},"share_dialog":{"title":"Поделиться: __interactive_title__","link":" линк ","paste_email_im":"Вставить этот __link__ в e-mail или IM.","paste_html":" Скопировать HTML для вставки в web-site или блог.","select_size":"Выбрать размер:","size_larger":"__val__% больше","size_actual":"actual","size_smaller":"__val__% меньше"},"credits_dialog":{"title":"Авторство: __interactive_title__","credits_text":"Данные интерактивные  учебные продукты были созданы __CC_link__ с использованием нашего __Next_Gen_MW_link__ программного продукта, при финансовой поддержке  за счет гранта от __Google_link__.","shareable_ver":"версия для обмена","find_shareable":"Найти __shareable_ver_link__ коллекцию интерактивных учебных продуктов наряду с десятками  других открытых программных продуктов по естественным наукам, математике и инжинирингу в материалах __concord_org_link__."},"copyright":{"copyright":"Авторские права","all_rights_reserved":"Все права защищены.","license":"Лицензия на данный программный продукт предоставляется в соответствии с __MIT_link__ лицензией.","attribution":"Просьба при использовании данного продукта ссылаться на Конкорд Консорциум URL __concord_org_link__."},"md2d":{"heatbath_icon_tooltip":"Тепловая баня активна","ke_icon_tooltip":"Градиент кинетической энергии","invalid_object_position_alert":"Нельзя сбросить объект здесь.","aminoacid_menu":{"hydrophobic":"Гидрофобный","hydrophilic":"Гидрофильный","glycine":"Глицин","alanine":"Аланин","valine":"Валин","leucine":"Лейцин","isoleucine":"Изолейцин","phenylalanine":"Фенилаланин","proline":"Пролин","tryptophan":"Триптофан","methionine":"Метионин","cysteine":"Цистеин","tyrosine":"Тирозин","asparagine":"Аспарагин","glutamine":"Глутамин","serine":"Серин","threonine":"Треонин","asparticacid":"Аспартат","glutamicacid":"Глутамат","lysine":"Лизин","arginine":"Аргинин","histidine":"Гистидин"},"mutations_menu":{"substitution_mutation":"Мутация: Замена нуклеотида","insertion_mutation":"Мутация: Вставка нуклеотида","deletion_mutation":" Мутация: Удаление нуклеотида ","insert":"Вставить"}},"sensor":{"select_sensor":"Выбрать датчик","select_sensor_type":"Выбрать тип датчика…","reading":"Съем данных:","zero":"Ноль","zeroing":"Выбор ноля...","loading_sensor":"Загрузка датчика...","choose_sensor_title":"Выбор датчика:","connect":"Соединить","address_labquest2":"адрес LabQuest2","messages":{"ready":"Готов к сбору данных.","ready_nocontrol":"Пожалуйста остановите __controlling_client__ сборщик данных будет собирать данные здесь.","ready_nocontrol_noname":"Пожалуйста остановите все остальные активные сборщики данных, чтобы собрать данные здесь.","no_sensors":"Ни один датчик не найден.","no_devices":"Ни одно устройство не подключено.","not_connected":"Нет соединения.","connecting":"Идет подсоединение...","connection_in_progress":" Идет подсоединение к вашему датчику. Если придет сообщение от sensorconnector.concord.org, пожалуйста примите его.","connection_failed":"Подсоединения не произошло. __retry_link__"," Подсоединение_failed_retry_link_text":"Повторить попытку","подсоединения _failed_внимание":"Программа для подсоединения датчиков Concord Consortium Sensor Connector либо не инсталлирована, либо не подключена. Пожалуйста __click_here_link__ для получения инструкции по использованию программы Sensor Connector.","connection_failed_labquest2_alert":"Не произошло подсоединение к LabQuest2. Пожалуйста убедитесь, в правильности адреса и в том, что LabQuest2 доступен на данном компьютере","tare_labquest2_alert":"LabQuest2 должен начать сбор данных, чтобы выставить значение ноля. Запустите новое измерение на LabQuest2 или нажмите на иконку измерительного устройства в левом верхнем углу экрана.","click_here":"Нажать здесь","connected":"Подсоединение произошло.","connected_start_labquest2":" Подсоединение произошло. Чтобы начать работу, нажмите кнопку Старт на вашем LabQuest2.","connected_start_sensorconnector":"Пожалуйста остановите __controlling_client__ сборщик данных чтобы собрать данные здесь.","connected_start_sensorconnector_noname":"Пожалуйста остановите  другие сборщики данных чтобы собрать данные здесь.","starting_data_collection":"Начать сбор данных...","ошибка_starting_data_collection":"Ошибка при запуске сбора данных.","error_starting_data_collection_alert":" Не запускается сбор данных. Убедитесь в том, что (удаленный старт) разрешен ","collecting_data":"Идет сбор данных.","collecting_data_stop_labquest2":" Идет сбор данных. Чтобы его завершит, нажмите кнопку Стоп на LabQuest2.","collecting_data_stop_sensorconnector":" Идет сбор данных.","no_data":"Данные не доступны.","no_data_alert":"Похоже, что The Sensor Connector не передает данные для подключенных устройств","no_data_labquest2_alert":" Похоже, что LabQuest не передает данные для подключенных устройств","canceling_data_collection":"Отмена сбора данных...","error_canceling_data_collection":"Ошибка при отмене сбора данных.","error_canceling_data_collection_alert":"Не получается отменить сбор данных. Убедитесь в том, что (удаленный старт) разрешен","stopping_data_collection":"Происходит остановка сбора данных...","error_stopping_data_collection":" Ошибка при остановке сбора данных.","error_stopping_data_collection_alert":"Не удалось остановить сбор данных. Убедитесь в том, что (удаленный старт) разрешен ","data_collection_stopped":"Сбор данных остановлен.","data_collection_complete":" Сбор данных завершен.","disconnected":"Произошло отсоединение.","java_applet_error":"Похоже на то, что Java апплеты не поддерживаются вашим браузером. Попытайтесь решить эту проблему, а затем перезагрузите страницу для того, чтобы использовать датчики","java_applet_not_loading":" Похоже на то, что апплеты датчиков не загружаются. Попытайтесь решить эту проблему, а затем перезагрузите страницу для того, чтобы использовать датчики","unexpected_error":"Произошла непредвиденная ошибка при подсоединении к датчику.","sensor_not_attached":"Похоже, что __sensor_name__ не прикрепиля. Пожалуйста повторите попытку и затем кликните на \\"$t(sensor.messages.try_again)\\".","датчик_or_device_не подключен":"The __sensor_or_device_name__ был отключен. Пожалуйста подключите его и затем кликните \\"$t(sensor.messages.try_again)\\".","try_again":"Повторить попытку","cancel":"Отменить"},"measurements":{"sensor_reading":"Идет считывание датчика","time":"Время","distance":"Расстояние","acceleration":"Ускорение","altitude":"Высота над уровнем моря","angle":"Угол","CO2":"CO₂","CO2_concentration":"CO₂ Концентрация","charge":"Заряд","conductivity":"Проводимость","current":"Ток","dissolved_oxygen":"Растворенный кислород","flow_rate":"Скорость потока","fluorescence_405_nm":"Флюоресценция 405 nm","fluorescence_500_nm":"Флюоресценция 500 nm","force":"Сила","intensity":"Интенсивность","light_level":"Уровень освещенности","light_intensity":" Интенсивность освещенности ","magnetic_field":"Магнитное поле","position":"Расположение","potential":"Потенциал","pressure":"Давление","signal":"Сигнал","sound_level":"Уровень шума","speed":"Скорость","temperature":"Температура","transmittance":"Пропускание","turbidity":"Мутность","UV_intensity":"Интенсивность УФ","velocity":"Вектор скорости","volume":"Объем","pH":"рН","acidity":"Кислотность","O2_concentration":" Концентрация O₂"},"names":{"sensor":"датчик","no_sensor":"(нет датчика)","light":"Освещенность","motion":"Перемещение","accelerometer":"Измеритель ускорения","dissolved_oxygen":"Растворенный кислород","pressure":"Давление","charge_sensor":"Сменить датчик","voltage":"Напряжение","pH":"рН","CO2_gas":"CO₂ газ","colorimeter":"Колориметр","conductivity":"Проводимость","current":"Ток","temperature":"Температура","force":"Сила","anemometer":"Анемометр","hand_dynamometer":"Ручной динамометр","heart_rate":"Частота сердечных сокращений","magnetic_field":"Магнитное поле","rotary_motion":"Угловое перемещение","linear_position_sensor":"Датчик прямолинейного перемещения","sound_level":"Уровень шума","spectrophotometer":"Спектрофотометр","spirometer":"Спирометр ","turbidity":"Мутность","UV_sensor":"УФ датчик ","drop_counter":"Счетчик капель","altitude":"Высота над уривнем моря","goMotion":"GoMotion","goTemp":"GoIO температурный датчик","goLinkTemperature":"GoIO температурный датчик","goLinkLight":"GoIO оптический датчик ","goLinkForce":"GoIO датчик силы ","goLinkPH":"GoIO pH датчик ","goLinkCO2":"GoIO CO₂ датчик ","goLinkO2":"GoIO O₂ датчик","labQuestMotion":"LabQuest датчик перемещения","labQuestTemperature":"LabQuest температурный датчик ","labQuestLight":"LabQuest оптический датчик ","labQuestForce":"LabQuest датчик силы ","labQuestPH":"LabQuest pH датчик ","labQuestCO2":"LabQuest CO₂ датчик ","labQuestO2":"LabQuest O₂ датчик"}}}}}')},185:function(t,e,n){e.markdown=n(204),e.parse=e.markdown.toHTML},186:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return SemanticLayout}));var common_layout_semantic_layout_config__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(21),arrays__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),common_console__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6),common_alert__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10);function SemanticLayout(){var layout,$mainContainer,$containersParent,containerSpecList,containersContent,componentByID,modelController,aspectRatio,fontScale,padding,scaledPadding,containerSpecByID,$containerByID,$innerContainerByID,$modelContainer,availableWidth,availableHeight,fontSizeChanged=!1,modelWidth,modelTop,modelLeft,paddingTop,paddingLeft,paddingBottom;function reset(){modelWidth=common_layout_semantic_layout_config__WEBPACK_IMPORTED_MODULE_0__.a.minModelWidth,modelTop=0,modelLeft=0,paddingBottom=0}function getDimensionOfContainer(t,e){var n=t.position();switch(e){case"top":return n.top;case"bottom":return n.top+t.outerHeight();case"left":return n.left;case"right":return n.left+t.outerWidth();case"height":return t.outerHeight();case"width":return t.outerWidth()}}function setFontSize(){var t,e,n=common_layout_semantic_layout_config__WEBPACK_IMPORTED_MODULE_0__.a.canonicalWidth,i=n/aspectRatio;t=Math.min($mainContainer.width()/n,$mainContainer.height()/i),paddingTop=scaledPadding=t*padding,paddingLeft=scaledPadding,paddingBottom=scaledPadding,(e=common_layout_semantic_layout_config__WEBPACK_IMPORTED_MODULE_0__.a.canonicalFontSize*fontScale*t)<common_layout_semantic_layout_config__WEBPACK_IMPORTED_MODULE_0__.a.minFontSize&&(e=common_layout_semantic_layout_config__WEBPACK_IMPORTED_MODULE_0__.a.minFontSize),$mainContainer.css("font-size",e+"em"),fontSizeChanged=!0}function createContainers(){var t,e,n,i,r;for($containerByID={},$innerContainerByID={},containerSpecByID={},i=0,r=containerSpecList.length;i<r;i++)for(n in e=(t=containerSpecList[i]).id,containerSpecByID[e]=t,$containerByID[e]=$("<div id='"+e+"'>").appendTo($containersParent),$containerByID[e].css({display:"inline-block",position:"absolute"}),$innerContainerByID[e]=$('<div class="inner-container">'),$innerContainerByID[e].appendTo($containerByID[e]),void 0===t.width&&$containerByID[e].css("white-space","nowrap"),t)t.hasOwnProperty(n)&&(/^margin/.test(n)?$containerByID[e].css(n.replace("margin","padding"),t[n]):/^padding/.test(n)?$innerContainerByID[e].css(n,t[n]):"align"===n?$containerByID[e].css("text-align",t[n]):"min-width"===n?$containerByID[e].css("min-width",t[n]):"fontScale"===n?$containerByID[e].css("font-size",t[n]+"em"):"border"===n?$innerContainerByID[e].css("border",t[n]):"background"===n&&$innerContainerByID[e].css("background",t[n]))}function placeComponentsInContainers(){var t,e,n,i,r,o,a,s,l,u,c,h,d,p,f;for(e in s=$.extend({},componentByID),containersContent)if(containersContent.hasOwnProperty(e))if($containerByID[e])if(n=containersContent[e],arrays__WEBPACK_IMPORTED_MODULE_1__.a.isArray(n))for(arrays__WEBPACK_IMPORTED_MODULE_1__.a.isArray(n[0])||(n=[n]),h=0,d=n.length;h<d;h++)for(i=n[h],(r=$('<div class="interactive-row"/>')).css("width","100%"),1===d&&r.css("height","100%"),$innerContainerByID[e].append(r),p=0,f=i.length;p<f;p++)void 0!==s[t=i[p]]?(r.append(s[t].getViewContainer()),delete s[t]):Object(common_alert__WEBPACK_IMPORTED_MODULE_3__.a)("Incorrect layout definition. Component with ID '"+t+"'' is not defined.");else l="Incorrect layout definition for '"+e+"' container. It should specify an array of components or an array of arrays of components (multiple rows).",Object(common_alert__WEBPACK_IMPORTED_MODULE_3__.a)(l);else l="Incorrect layout definition - '"+e+"' container does not exist.",Object(common_alert__WEBPACK_IMPORTED_MODULE_3__.a)(l);if(a=containerSpecByID.bottom||containerSpecList[containerSpecList.length-1])for(t in(r=$innerContainerByID[a.id].children().last()).length||(r=$('<div class="interactive-row"/>'),$innerContainerByID[a.id].append(r)),s)s.hasOwnProperty(t)&&r.append(s[t].getViewContainer());for(u=0,c=containerSpecList.length;u<c;u++)(o=$innerContainerByID[containerSpecList[u].id].children().children()).length>1&&o.addClass("component-spacing")}function positionContainers(){var t,e,n,i,r,o,a,s,l,u;for($modelContainer.css({width:modelWidth,height:modelController.getHeightForWidth(modelWidth,fontSizeChanged),left:modelLeft,top:modelTop}),fontSizeChanged=!1,s=0,l=containerSpecList.length;s<l;s++)t=containerSpecList[s],e=$containerByID[t.id],t.left||t.right||(t.left="0"),t.top||t.bottom||(t.top="0"),t.left&&(n=parseDimension(t.left),e.css("left",n)),t.top&&(i=parseDimension(t.top),e.css("top",i)),t.height&&e.css("height",parseDimension(t.height)),t.width&&e.css("width",parseDimension(t.width)),t.right&&(r=parseDimension(t.right),t.left?e.css("width",r-n):(n=r-e.outerWidth(),e.css("left",n))),t.bottom&&(o=parseDimension(t.bottom),t.top?e.css("height",o-i):(i=o-e.outerHeight(),e.css("top",i))),t.aboveOthers&&(o=getDimensionOfContainer(e,"bottom")+scaledPadding)>paddingTop&&(paddingTop=o),t.belowOthers&&(a=getDimensionOfContainer(e,"height")+scaledPadding)>paddingBottom&&(paddingBottom=a);for(u in $containerByID)$containerByID.hasOwnProperty(u)&&(containerSpecByID[u]&&containerSpecByID[u].aboveOthers||containerSpecByID[u]&&containerSpecByID[u].belowOthers||(i=getDimensionOfContainer(e=$containerByID[u],"top"),e.css("top",i+paddingTop),n=getDimensionOfContainer(e,"left"),e.css("left",n+paddingLeft)))}function resizeModelContainer(){var t,e,n,i,r,o,a,s=-1/0,l=-1/0,u=1/0,c=1/0;for(t in $containerByID)$containerByID.hasOwnProperty(t)&&(containerSpecByID[t]&&containerSpecByID[t].aboveOthers||containerSpecByID[t]&&containerSpecByID[t].belowOthers||((n=getDimensionOfContainer(e=$containerByID[t],"right"))>s&&(s=n),(i=getDimensionOfContainer(e,"bottom"))>l&&(l=i),(o=getDimensionOfContainer(e,"left"))<u&&(u=o),(r=getDimensionOfContainer(e,"top"))<c&&(c=r)));return s<=availableWidth+2&&l<=availableHeight-paddingBottom+2&&(Math.abs(availableWidth-s)<2||Math.abs(availableHeight-paddingBottom-l)<2)&&Math.abs(u-paddingLeft)<2&&Math.abs(c-paddingTop)<2||(a=Math.min(availableWidth/s,(availableHeight-paddingBottom)/l),isNaN(a)||(modelWidth*=a),modelWidth<common_layout_semantic_layout_config__WEBPACK_IMPORTED_MODULE_0__.a.minModelWidth&&(modelWidth=common_layout_semantic_layout_config__WEBPACK_IMPORTED_MODULE_0__.a.minModelWidth),modelLeft-=u-paddingLeft,modelTop-=c-paddingTop,!1)}function parseDimension(dim){var vars,i,ii,value;if("number"==typeof dim||/^[0-9]+\.?[0-9]*(em)?$/.test(dim))return dim;for(vars=dim.match(/[a-zA-Z][a-zA-Z0-9\-]+\.[a-zA-Z]+/g),i=0,ii=vars.length;i<ii;i++)value=getDimension(vars[i]),dim=dim.replace(vars[i],value);return/^[^a-zA-Z]*$/.test(dim)?eval(dim):0}function getDimension(t){switch(t){case"container.left":case"container.top":return 0;case"container.width":case"container.right":return availableWidth;case"container.height":case"container.bottom":return availableHeight;case"interactive.left":return paddingLeft;case"interactive.top":return paddingTop;case"interactive.width":case"interactive.right":return availableWidth-paddingLeft;case"interactive.height":case"interactive.bottom":return availableHeight-paddingTop-paddingBottom;default:return t=t.split("."),getDimensionOfContainer($containerByID[t[0]],t[1])}}return layout={initialize:function(t){$mainContainer=t.$mainContainer,$containersParent=t.$containersParent,containerSpecList=t.containers,containersContent=t.layout,componentByID=t.components,aspectRatio=t.aspectRatio,fontScale=t.fontScale,padding=t.padding,createContainers(),placeComponentsInContainers(),modelController=null,$mainContainer.addClass("lab-responsive-content")},setupModel:function(t){if(modelController=t,$containerByID.model){if($containerByID.model===modelController.getViewContainer())return;$containerByID.model.remove()}($modelContainer=modelController.getViewContainer()).css({display:"inline-block",position:"absolute","z-index":"0"}),$modelContainer.appendTo($containersParent),$containerByID.model=$modelContainer},isReady:function(){return!!modelController},layoutInteractive:function(){var t,e=common_layout_semantic_layout_config__WEBPACK_IMPORTED_MODULE_0__.a.iterationsLimit;if(0!==e){for(common_console__WEBPACK_IMPORTED_MODULE_2__.a.time("[layout] update"),reset(),availableWidth=$mainContainer.width(),availableHeight=$mainContainer.height(),modelWidth=availableWidth,setFontSize(),positionContainers();--e>0&&!resizeModelContainer();)positionContainers();for(t in modelController.resize(),componentByID)componentByID.hasOwnProperty(t)&&void 0!==componentByID[t].resize&&componentByID[t].resize();return common_console__WEBPACK_IMPORTED_MODULE_2__.a.timeEnd("[layout] update"),common_layout_semantic_layout_config__WEBPACK_IMPORTED_MODULE_0__.a.iterationsLimit-e}}},layout}},187:function(t,e){var n;e.normal=(n=null,function(t,e){var i,r,o,a,s;return null==t&&(t=0),null==e&&(e=1),n?(r=n,n=null,r):(a=Math.random(),s=Math.random(),o=2*Math.PI*a,i=Math.sqrt(-2*Math.log(s)),n=t+e*(i*Math.sin(o)),t+e*(i*Math.cos(o)))})},188:function(t,e,n){t.exports=function(t,e){"use strict";var n;return t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e,function(n){var i;function r(){return document.createElement("canvas")}n.exports,(i=window).DOMParser=window.DOMParser;var o,a=function(n,s,l){if(null!=n||null!=s||null!=l){var u=function(n){var a={opts:n,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,rootEmSize:12,emSize:12,log:function(t){}};1==a.opts.log&&"undefined"!=typeof console&&(a.log=function(t){console.log(t)}),a.init=function(t){var e=0;a.UniqueId=function(){return"canvg"+ ++e},a.Definitions={},a.Styles={},a.StylesSpecificity={},a.Animations=[],a.Images=[],a.ctx=t,a.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},a.init(),a.ImagesLoaded=function(){for(var t=0;t<a.Images.length;t++)if(!a.Images[t].loaded)return!1;return!0},a.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},a.compressSpaces=function(t){return t.replace(/(?!\u3000)\s+/gm," ")},a.ajax=function(t){var e;return(e=i.XMLHttpRequest?new i.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"))?(e.open("GET",t,!1),e.send(null),e.responseText):null},a.parseXml=function(t){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,r=new Windows.Data.Xml.Dom.XmlLoadSettings;return r.prohibitDtd=!1,e.loadXml(t,r),e}if(!i.DOMParser)return t=t.replace(/<!DOCTYPE svg[^>]*>/,""),(e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t),e;try{var o=n.xmldom?new i.DOMParser(n.xmldom):new i.DOMParser;return o.parseFromString(t,"image/svg+xml")}catch(e){return(o=n.xmldom?new i.DOMParser(n.xmldom):new i.DOMParser).parseFromString(t,"text/xml")}},a.Property=function(t,e){this.name=t,this.value=e},a.Property.prototype.getValue=function(){return this.value},a.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},a.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},a.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},a.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():t},a.Property.prototype.addOpacity=function(e){var n=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var i=new t(this.value);i.ok&&(n="rgba("+i.r+", "+i.g+", "+i.b+", "+e.numValue()+")")}return new a.Property(this.name,n)},a.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),a.Definitions[t]},a.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},a.Property.prototype.getFillStyleDefinition=function(t,e){var n=this.getDefinition();if(null!=n&&n.createGradient)return n.createGradient(a.ctx,t,e);if(null!=n&&n.createPattern){if(n.getHrefAttribute().hasValue()){var i=n.attribute("patternTransform");n=n.getHrefAttribute().getDefinition(),i.hasValue()&&(n.attribute("patternTransform",!0).value=i.value)}return n.createPattern(a.ctx,t)}return null},a.Property.prototype.getDPI=function(t){return 96},a.Property.prototype.getREM=function(t){return a.rootEmSize},a.Property.prototype.getEM=function(t){return a.emSize},a.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},a.Property.prototype.isPixels=function(){if(!this.hasValue())return!1;var t=this.value+"";return!!t.match(/px$/)||!!t.match(/^[0-9]+$/)},a.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var n=this.value+"";if(n.match(/rem$/))return this.numValue()*this.getREM(t);if(n.match(/em$/))return this.numValue()*this.getEM(t);if(n.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(n.match(/px$/))return this.numValue();if(n.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(n.match(/pc$/))return 15*this.numValue();if(n.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(n.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(n.match(/in$/))return this.numValue()*this.getDPI(t);if(n.match(/%$/))return this.numValue()*a.ViewPort.ComputeSize(t);var i=this.numValue();return e&&i<1?i*a.ViewPort.ComputeSize(t):i},a.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/s$/)?1e3*this.numValue():(t.match(/ms$/),this.numValue())},a.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var s={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return a.Property.prototype.toTextBaseline=function(){return this.hasValue()?s[this.value]:null},a.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,e,n,i,r,o){var s=null!=o?this.Parse(o):this.CreateFont("","","","","",a.ctx.font);return{fontFamily:r=r||s.fontFamily,fontSize:i||s.fontSize,fontStyle:t||s.fontStyle,fontWeight:n||s.fontWeight,fontVariant:e||s.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(e){for(var n={},i=a.trim(a.compressSpaces(e||"")).split(" "),r={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},o="",s=0;s<i.length;s++)r.fontStyle||-1==t.Styles.indexOf(i[s])?r.fontVariant||-1==t.Variants.indexOf(i[s])?r.fontWeight||-1==t.Weights.indexOf(i[s])?r.fontSize?"inherit"!=i[s]&&(o+=i[s]):("inherit"!=i[s]&&(n.fontSize=i[s].split("/")[0]),r.fontStyle=r.fontVariant=r.fontWeight=r.fontSize=!0):("inherit"!=i[s]&&(n.fontWeight=i[s]),r.fontStyle=r.fontVariant=r.fontWeight=!0):("inherit"!=i[s]&&(n.fontVariant=i[s]),r.fontStyle=r.fontVariant=!0):("inherit"!=i[s]&&(n.fontStyle=i[s]),r.fontStyle=!0);return""!=o&&(n.fontFamily=o),n}},a.ToNumberArray=function(t){for(var e=a.trim(a.compressSpaces((t||"").replace(/,/g," "))).split(" "),n=0;n<e.length;n++)e[n]=parseFloat(e[n]);return e},a.Point=function(t,e){this.x=t,this.y=e},a.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},a.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4],n=this.x*t[1]+this.y*t[3]+t[5];this.x=e,this.y=n},a.CreatePoint=function(t){var e=a.ToNumberArray(t);return new a.Point(e[0],e[1])},a.CreatePath=function(t){for(var e=a.ToNumberArray(t),n=[],i=0;i<e.length;i+=2)n.push(new a.Point(e[i],e[i+1]));return n},a.BoundingBox=function(t,e,n,i){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,e){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,e,n,i,r,o){var a=t+2/3*(n-t),s=e+2/3*(i-e),l=a+1/3*(r-t),u=s+1/3*(o-e);this.addBezierCurve(t,e,a,l,s,u,r,o)},this.addBezierCurve=function(t,e,n,i,r,o,a,s){var l=[t,e],u=[n,i],c=[r,o],h=[a,s];this.addPoint(l[0],l[1]),this.addPoint(h[0],h[1]);for(var d=0;d<=1;d++){var p=function(t){return Math.pow(1-t,3)*l[d]+3*Math.pow(1-t,2)*t*u[d]+3*(1-t)*Math.pow(t,2)*c[d]+Math.pow(t,3)*h[d]},f=6*l[d]-12*u[d]+6*c[d],m=-3*l[d]+9*u[d]-9*c[d]+3*h[d],g=3*u[d]-3*l[d];if(0!=m){var v=Math.pow(f,2)-4*g*m;if(!(v<0)){var y=(-f+Math.sqrt(v))/(2*m);0<y&&y<1&&(0==d&&this.addX(p(y)),1==d&&this.addY(p(y)));var b=(-f-Math.sqrt(v))/(2*m);0<b&&b<1&&(0==d&&this.addX(p(b)),1==d&&this.addY(p(b)))}}else{if(0==f)continue;var _=-g/f;0<_&&_<1&&(0==d&&this.addX(p(_)),1==d&&this.addY(p(_)))}}},this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2},this.addPoint(t,e),this.addPoint(n,i)},a.Transform=function(t){var e=this;this.Type={},this.Type.translate=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var e=a.ToNumberArray(t);this.angle=new a.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=a.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var e=this.m[0],n=this.m[2],i=this.m[4],r=this.m[1],o=this.m[3],a=this.m[5],s=1/(e*(1*o-0*a)-n*(1*r-0*a)+i*(0*r-0*o));t.transform(s*(1*o-0*a),s*(0*a-1*r),s*(0*i-1*n),s*(1*e-0*i),s*(n*a-i*o),s*(i*r-e*a))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=e.Type.matrix,this.base(t),this.angle=new a.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(t)},this.unapply=function(t){for(var e=this.transforms.length-1;0<=e;e--)this.transforms[e].unapply(t)},this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].applyToPoint(t)};for(var n=a.trim(a.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),i=0;i<n.length;i++)if("none"!==n[i]){var r=a.trim(n[i].split("(")[0]),o=n[i].split("(")[1].replace(")",""),s=this.Type[r];if(void 0!==s){var l=new s(o);l.type=r,this.transforms.push(l)}}},a.AspectRatio=function(t,e,n,i,r,o,s,l,u,c){var h=(e=(e=a.compressSpaces(e)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",d=e.split(" ")[1]||"meet",p=n/i,f=r/o,m=Math.min(p,f),g=Math.max(p,f);"meet"==d&&(i*=m,o*=m),"slice"==d&&(i*=g,o*=g),u=new a.Property("refX",u),c=new a.Property("refY",c),u.hasValue()&&c.hasValue()?t.translate(-m*u.toPixels("x"),-m*c.toPixels("y")):(h.match(/^xMid/)&&("meet"==d&&m==f||"slice"==d&&g==f)&&t.translate(n/2-i/2,0),h.match(/YMid$/)&&("meet"==d&&m==p||"slice"==d&&g==p)&&t.translate(0,r/2-o/2),h.match(/^xMax/)&&("meet"==d&&m==f||"slice"==d&&g==f)&&t.translate(n-i,0),h.match(/YMax$/)&&("meet"==d&&m==p||"slice"==d&&g==p)&&t.translate(0,r-o)),"none"==h?t.scale(p,f):"meet"==d?t.scale(m,m):"slice"==d&&t.scale(g,g),t.translate(null==s?0:-s,null==l?0:-l)},a.Element={},a.EmptyProperty=new a.Property("EMPTY",""),a.Element.ElementBase=function(t){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,e){var n=this.attributes[t];return null!=n?n:(1==e&&(n=new a.Property(t,""),this.attributes[t]=n),n||a.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if("href"==t||t.match(/:href$/))return this.attributes[t];return a.EmptyProperty},this.style=function(t,e,n){var i=this.styles[t];if(null!=i)return i;var r=this.attribute(t);if(null!=r&&r.hasValue())return this.styles[t]=r;if(1!=n){var o=this.parent;if(null!=o){var s=o.style(t);if(null!=s&&s.hasValue())return s}}return 1==e&&(i=new a.Property(t,""),this.styles[t]=i),i||a.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.style("mask").hasValue()){var e=this.style("mask").getDefinition();null!=e&&e.apply(t,this)}else if(this.style("filter").hasValue()){var n=this.style("filter").getDefinition();null!=n&&n.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(t){},this.clearContext=function(t){},this.renderChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].render(t)},this.addChild=function(t,e){var n=t;e&&(n=a.CreateElement(t)),n.parent=this,"title"!=n.type&&this.children.push(n)},this.addStylesFromStyleDefinition=function(){for(var e in a.Styles)if("@"!=e[0]&&o(t,e)){var n=a.Styles[e],i=a.StylesSpecificity[e];if(null!=n)for(var r in n){var s=this.stylesSpecificity[r];void 0===s&&(s="000"),s<i&&(this.styles[r]=n[r],this.stylesSpecificity[r]=i)}}};var e,n=new RegExp("^[A-Z-]+$");if(null!=t&&1==t.nodeType){for(var i=0;i<t.attributes.length;i++){var r=t.attributes[i],s=(e=r.nodeName,n.test(e)?e.toLowerCase():e);this.attributes[s]=new a.Property(s,r.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue()){var l=this.attribute("style").value.split(";");for(i=0;i<l.length;i++)if(""!=a.trim(l[i])){var u=l[i].split(":"),c=a.trim(u[0]),h=a.trim(u[1]);this.styles[c]=new a.Property(c,h)}}for(this.attribute("id").hasValue()&&null==a.Definitions[this.attribute("id").value]&&(a.Definitions[this.attribute("id").value]=this),i=0;i<t.childNodes.length;i++){var d=t.childNodes[i];if(1==d.nodeType&&this.addChild(d,!0),this.captureTextNodes&&(3==d.nodeType||4==d.nodeType)){var p=d.value||d.text||d.textContent||"";""!=a.compressSpaces(p)&&this.addChild(new a.Element.tspan(d),!1)}}}},a.Element.RenderedElementBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.calculateOpacity=function(){for(var t=1,e=this;null!=e;){var n=e.style("opacity",!1,!0);n.hasValue()&&(t*=n.numValue()),e=e.parent}return t},this.setContext=function(t,e){if(!e){var n;if(this.style("fill").isUrlDefinition())null!=(n=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")))&&(t.fillStyle=n);else if(this.style("fill").hasValue()){var i;"currentColor"==(i=this.style("fill")).value&&(i.value=this.style("color").value),"inherit"!=i.value&&(t.fillStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}if(this.style("fill-opacity").hasValue()&&(i=(i=new a.Property("fill",t.fillStyle)).addOpacity(this.style("fill-opacity")),t.fillStyle=i.value),this.style("stroke").isUrlDefinition())null!=(n=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")))&&(t.strokeStyle=n);else if(this.style("stroke").hasValue()){var r;"currentColor"==(r=this.style("stroke")).value&&(r.value=this.style("color").value),"inherit"!=r.value&&(t.strokeStyle="none"==r.value?"rgba(0,0,0,0)":r.value)}if(this.style("stroke-opacity").hasValue()&&(r=(r=new a.Property("stroke",t.strokeStyle)).addOpacity(this.style("stroke-opacity")),t.strokeStyle=r.value),this.style("stroke-width").hasValue()){var o=this.style("stroke-width").toPixels();t.lineWidth=0==o?.001:o}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("paint-order").hasValue()&&(t.paintOrder=this.style("paint-order").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var s=a.ToNumberArray(this.style("stroke-dasharray").value);void 0!==t.setLineDash?t.setLineDash(s):void 0!==t.webkitLineDash?t.webkitLineDash=s:void 0===t.mozDash||1==s.length&&0==s[0]||(t.mozDash=s);var l=this.style("stroke-dashoffset").toPixels();void 0!==t.lineDashOffset?t.lineDashOffset=l:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=l:void 0!==t.mozDashOffset&&(t.mozDashOffset=l)}}if(void 0!==t.font){t.font=a.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString();var u=this.style("font-size",!1,!1);u.isPixels()&&(a.emSize=u.toPixels())}if(this.style("transform",!1,!0).hasValue()&&new a.Transform(this.style("transform",!1,!0).value).apply(t),this.style("clip-path",!1,!0).hasValue()){var c=this.style("clip-path",!1,!0).getDefinition();null!=c&&c.apply(t)}t.globalAlpha=this.calculateOpacity()}},a.Element.RenderedElementBase.prototype=new a.Element.ElementBase,a.Element.PathElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new a.BoundingBox},this.renderChildren=function(t){this.path(t),a.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var e=this.getMarkers();if(null!=e){if(this.style("marker-start").isUrlDefinition()&&(n=this.style("marker-start").getDefinition()).render(t,e[0][0],e[0][1]),this.style("marker-mid").isUrlDefinition())for(var n=this.style("marker-mid").getDefinition(),i=1;i<e.length-1;i++)n.render(t,e[i][0],e[i][1]);this.style("marker-end").isUrlDefinition()&&(n=this.style("marker-end").getDefinition()).render(t,e[e.length-1][0],e[e.length-1][1])}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase,a.Element.svg=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),a.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){if(t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,t.canvas.style&&void 0!==t.font&&void 0!==i.getComputedStyle){t.font=i.getComputedStyle(t.canvas).getPropertyValue("font");var e=new a.Property("fontSize",a.Font.Parse(t.font).fontSize);e.hasValue()&&(a.rootEmSize=a.emSize=e.toPixels("y"))}this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var n=a.ViewPort.width(),r=a.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){n=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");var o=0,s=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(o=-this.attribute("refX").toPixels("x"),s=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(o,s),t.lineTo(n,s),t.lineTo(n,r),t.lineTo(o,r),t.closePath(),t.clip())}if(a.ViewPort.SetCurrent(n,r),this.attribute("viewBox").hasValue()){var l=a.ToNumberArray(this.attribute("viewBox").value),u=l[0],c=l[1];n=l[2],r=l[3],a.AspectRatio(t,this.attribute("preserveAspectRatio").value,a.ViewPort.width(),n,a.ViewPort.height(),r,u,c,this.attribute("refX").value,this.attribute("refY").value),a.ViewPort.RemoveCurrent(),a.ViewPort.SetCurrent(l[2],l[3])}}},a.Element.svg.prototype=new a.Element.RenderedElementBase,a.Element.rect=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y"),o=this.attribute("rx").toPixels("x"),s=this.attribute("ry").toPixels("y");if(this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(s=o),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(o=s),o=Math.min(o,i/2),s=Math.min(s,r/2),null!=t){var l=(Math.sqrt(2)-1)/3*4;t.beginPath(),t.moveTo(e+o,n),t.lineTo(e+i-o,n),t.bezierCurveTo(e+i-o+l*o,n,e+i,n+s-l*s,e+i,n+s),t.lineTo(e+i,n+r-s),t.bezierCurveTo(e+i,n+r-s+l*s,e+i-o+l*o,n+r,e+i-o,n+r),t.lineTo(e+o,n+r),t.bezierCurveTo(e+o-l*o,n+r,e,n+r-s+l*s,e,n+r-s),t.lineTo(e,n+s),t.bezierCurveTo(e,n+s-l*s,e+o-l*o,n,e+o,n),t.closePath()}return new a.BoundingBox(e,n,e+i,n+r)}},a.Element.rect.prototype=new a.Element.PathElementBase,a.Element.circle=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("cx").toPixels("x"),n=this.attribute("cy").toPixels("y"),i=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(e,n,i,0,2*Math.PI,!1),t.closePath()),new a.BoundingBox(e-i,n-i,e+i,n+i)}},a.Element.circle.prototype=new a.Element.PathElementBase,a.Element.ellipse=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=(Math.sqrt(2)-1)/3*4,n=this.attribute("rx").toPixels("x"),i=this.attribute("ry").toPixels("y"),r=this.attribute("cx").toPixels("x"),o=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(r+n,o),t.bezierCurveTo(r+n,o+e*i,r+e*n,o+i,r,o+i),t.bezierCurveTo(r-e*n,o+i,r-n,o+e*i,r-n,o),t.bezierCurveTo(r-n,o-e*i,r-e*n,o-i,r,o-i),t.bezierCurveTo(r+e*n,o-i,r+n,o-e*i,r+n,o),t.closePath()),new a.BoundingBox(r-n,o-i,r+n,o+i)}},a.Element.ellipse.prototype=new a.Element.PathElementBase,a.Element.line=function(t){this.base=a.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new a.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new a.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var e=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y)),new a.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)},this.getMarkers=function(){var t=this.getPoints(),e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}},a.Element.line.prototype=new a.Element.PathElementBase,a.Element.polyline=function(t){this.base=a.Element.PathElementBase,this.base(t),this.points=a.CreatePath(this.attribute("points").value),this.path=function(t){var e=new a.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var n=1;n<this.points.length;n++)e.addPoint(this.points[n].x,this.points[n].y),null!=t&&t.lineTo(this.points[n].x,this.points[n].y);return e},this.getMarkers=function(){for(var t=[],e=0;e<this.points.length-1;e++)t.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);return 0<t.length&&t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},a.Element.polyline.prototype=new a.Element.PathElementBase,a.Element.polygon=function(t){this.base=a.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var e=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),e}},a.Element.polygon.prototype=new a.Element.polyline,a.Element.path=function(t){this.base=a.Element.PathElementBase,this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," ");for(var n=0;n<2;n++)e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");for(e=(e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2"),n=0;n<2;n++)e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=a.compressSpaces(e),e=a.trim(e),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new a.Point(0,0),this.control=new a.Point(0,0),this.current=new a.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,e,n){null!=n&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(t,null==e?null:e.angleTo(t))},this.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!=this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles}}(e),this.path=function(t){var e=this.PathParser;e.reset();var n=new a.BoundingBox;for(null!=t&&t.beginPath();!e.isEnd();)switch(e.nextCommand(),e.command){case"M":case"m":var i=e.getAsCurrentPoint();for(e.addMarker(i),n.addPoint(i.x,i.y),null!=t&&t.moveTo(i.x,i.y),e.start=e.current;!e.isCommandOrEnd();)i=e.getAsCurrentPoint(),e.addMarker(i,e.start),n.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y);break;case"L":case"l":for(;!e.isCommandOrEnd();){var r=e.current;i=e.getAsCurrentPoint(),e.addMarker(i,r),n.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y)}break;case"H":case"h":for(;!e.isCommandOrEnd();){var o=new a.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(o,e.current),e.current=o,n.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":for(;!e.isCommandOrEnd();)o=new a.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar()),e.addMarker(o,e.current),e.current=o,n.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y);break;case"C":case"c":for(;!e.isCommandOrEnd();){var s=e.current,l=e.getPoint(),u=e.getAsControlPoint(),c=e.getAsCurrentPoint();e.addMarker(c,u,l),n.addBezierCurve(s.x,s.y,l.x,l.y,u.x,u.y,c.x,c.y),null!=t&&t.bezierCurveTo(l.x,l.y,u.x,u.y,c.x,c.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();)s=e.current,l=e.getReflectedControlPoint(),u=e.getAsControlPoint(),c=e.getAsCurrentPoint(),e.addMarker(c,u,l),n.addBezierCurve(s.x,s.y,l.x,l.y,u.x,u.y,c.x,c.y),null!=t&&t.bezierCurveTo(l.x,l.y,u.x,u.y,c.x,c.y);break;case"Q":case"q":for(;!e.isCommandOrEnd();)s=e.current,u=e.getAsControlPoint(),c=e.getAsCurrentPoint(),e.addMarker(c,u,u),n.addQuadraticCurve(s.x,s.y,u.x,u.y,c.x,c.y),null!=t&&t.quadraticCurveTo(u.x,u.y,c.x,c.y);break;case"T":case"t":for(;!e.isCommandOrEnd();)s=e.current,u=e.getReflectedControlPoint(),e.control=u,c=e.getAsCurrentPoint(),e.addMarker(c,u,u),n.addQuadraticCurve(s.x,s.y,u.x,u.y,c.x,c.y),null!=t&&t.quadraticCurveTo(u.x,u.y,c.x,c.y);break;case"A":case"a":for(;!e.isCommandOrEnd();){s=e.current;var h=e.getScalar(),d=e.getScalar(),p=e.getScalar()*(Math.PI/180),f=e.getScalar(),m=e.getScalar(),g=(c=e.getAsCurrentPoint(),new a.Point(Math.cos(p)*(s.x-c.x)/2+Math.sin(p)*(s.y-c.y)/2,-Math.sin(p)*(s.x-c.x)/2+Math.cos(p)*(s.y-c.y)/2)),v=Math.pow(g.x,2)/Math.pow(h,2)+Math.pow(g.y,2)/Math.pow(d,2);1<v&&(h*=Math.sqrt(v),d*=Math.sqrt(v));var y=(f==m?-1:1)*Math.sqrt((Math.pow(h,2)*Math.pow(d,2)-Math.pow(h,2)*Math.pow(g.y,2)-Math.pow(d,2)*Math.pow(g.x,2))/(Math.pow(h,2)*Math.pow(g.y,2)+Math.pow(d,2)*Math.pow(g.x,2)));isNaN(y)&&(y=0);var b=new a.Point(y*h*g.y/d,y*-d*g.x/h),_=new a.Point((s.x+c.x)/2+Math.cos(p)*b.x-Math.sin(p)*b.y,(s.y+c.y)/2+Math.sin(p)*b.x+Math.cos(p)*b.y),x=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},w=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(x(t)*x(e))},C=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(w(t,e))},T=C([1,0],[(g.x-b.x)/h,(g.y-b.y)/d]),S=[(g.x-b.x)/h,(g.y-b.y)/d],k=[(-g.x-b.x)/h,(-g.y-b.y)/d],A=C(S,k);w(S,k)<=-1&&(A=Math.PI),1<=w(S,k)&&(A=0);var E=1-m?1:-1,M=T+E*(A/2),P=new a.Point(_.x+h*Math.cos(M),_.y+d*Math.sin(M));if(e.addMarkerAngle(P,M-E*Math.PI/2),e.addMarkerAngle(c,M-E*Math.PI),n.addPoint(c.x,c.y),null!=t){w=d<h?h:d;var D=d<h?1:h/d,O=d<h?d/h:1;t.translate(_.x,_.y),t.rotate(p),t.scale(D,O),t.arc(0,0,w,T,T+A,1-m),t.scale(1/D,1/O),t.rotate(-p),t.translate(-_.x,-_.y)}}break;case"Z":case"z":null!=t&&n.x1!==n.x2&&n.y1!==n.y2&&t.closePath(),e.current=e.start}return n},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),n=[],i=0;i<t.length;i++)n.push([t[i],e[i]]);return n}},a.Element.path.prototype=new a.Element.PathElementBase,a.Element.pattern=function(t){this.base=a.Element.ElementBase,this.base(t),this.createPattern=function(t,e){var n=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),o=new a.Element.svg;o.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),o.attributes.width=new a.Property("width",n+"px"),o.attributes.height=new a.Property("height",i+"px"),o.attributes.transform=new a.Property("transform",this.attribute("patternTransform").value),o.children=this.children;var s=r();s.width=n,s.height=i;var l=s.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&l.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var u=-1;u<=1;u++)for(var c=-1;c<=1;c++)l.save(),o.attributes.x=new a.Property("x",u*s.width),o.attributes.y=new a.Property("y",c*s.height),o.render(l),l.restore();return t.createPattern(s,"repeat")}},a.Element.pattern.prototype=new a.Element.ElementBase,a.Element.marker=function(t){this.base=a.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,e,n){if(e){t.translate(e.x,e.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(n),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var i=new a.Element.svg;i.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),i.attributes.refX=new a.Property("refX",this.attribute("refX").value),i.attributes.refY=new a.Property("refY",this.attribute("refY").value),i.attributes.width=new a.Property("width",this.attribute("markerWidth").value),i.attributes.height=new a.Property("height",this.attribute("markerHeight").value),i.attributes.fill=new a.Property("fill",this.attribute("fill").valueOrDefault("black")),i.attributes.stroke=new a.Property("stroke",this.attribute("stroke").valueOrDefault("none")),i.children=this.children,i.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-n),t.translate(-e.x,-e.y)}}},a.Element.marker.prototype=new a.Element.ElementBase,a.Element.defs=function(t){this.base=a.Element.ElementBase,this.base(t),this.render=function(t){}},a.Element.defs.prototype=new a.Element.ElementBase,a.Element.GradientBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.stops=[];for(var e=0;e<this.children.length;e++){var n=this.children[e];"stop"==n.type&&this.stops.push(n)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(t){for(var e=0;e<this.attributesToInherit.length;e++){var n=this.attributesToInherit[e];!this.attribute(n).hasValue()&&t.attribute(n).hasValue()&&(this.attribute(n,!0).value=t.attribute(n).value)}},this.createGradient=function(t,e,n){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));var o=function(t){return n.hasValue()?new a.Property("color",t).addOpacity(n).value:t},s=this.getGradient(t,e);if(null==s)return o(i.stops[i.stops.length-1].color);for(var l=0;l<i.stops.length;l++)s.addColorStop(i.stops[l].offset,o(i.stops[l].color));if(this.attribute("gradientTransform").hasValue()){var u=a.ViewPort.viewPorts[0],c=new a.Element.rect;c.attributes.x=new a.Property("x",-a.MAX_VIRTUAL_PIXELS/3),c.attributes.y=new a.Property("y",-a.MAX_VIRTUAL_PIXELS/3),c.attributes.width=new a.Property("width",a.MAX_VIRTUAL_PIXELS),c.attributes.height=new a.Property("height",a.MAX_VIRTUAL_PIXELS);var h=new a.Element.g;h.attributes.transform=new a.Property("transform",this.attribute("gradientTransform").value),h.children=[c];var d=new a.Element.svg;d.attributes.x=new a.Property("x",0),d.attributes.y=new a.Property("y",0),d.attributes.width=new a.Property("width",u.width),d.attributes.height=new a.Property("height",u.height),d.children=[h];var p=r();p.width=u.width,p.height=u.height;var f=p.getContext("2d");return f.fillStyle=s,d.render(f),f.createPattern(p,"no-repeat")}return s}},a.Element.GradientBase.prototype=new a.Element.ElementBase,a.Element.linearGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(t,e){var n="objectBoundingBox"==this.gradientUnits()?e.getBoundingBox(t):null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var i="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),r="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),o="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),a="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return i==o&&r==a?null:t.createLinearGradient(i,r,o,a)}},a.Element.linearGradient.prototype=new a.Element.GradientBase,a.Element.radialGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(t,e){var n=e.getBoundingBox(t);this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var i="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),r="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),o=i,a=r;this.attribute("fx").hasValue()&&(o="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(a="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var s="objectBoundingBox"==this.gradientUnits()?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(o,a,0,i,r,s)}},a.Element.radialGradient.prototype=new a.Element.GradientBase,a.Element.stop=function(t){this.base=a.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),1<this.offset&&(this.offset=1);var e=this.style("stop-color",!0);""===e.value&&(e.value="#000"),this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity"))),this.color=e.value},a.Element.stop.prototype=new a.Element.ElementBase,a.Element.AnimateBase=function(t){this.base=a.Element.ElementBase,this.base(t),a.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,e=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(e,!0):this.parent.attribute(e,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var e=!1;if(this.begin<this.duration){var n=this.calcValue();this.attribute("type").hasValue()&&(n=this.attribute("type").value+"("+n+")"),this.getProperty().value=n,e=!0}return e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1),n=Math.floor(e),i=Math.ceil(e);t.from=new a.Property("from",parseFloat(this.values.value[n])),t.to=new a.Property("to",parseFloat(this.values.value[i])),t.progress=(e-n)/(i-n)}else t.from=this.from,t.to=this.to;return t}},a.Element.AnimateBase.prototype=new a.Element.ElementBase,a.Element.animate=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress();return t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress+this.initialUnits}},a.Element.animate.prototype=new a.Element.AnimateBase,a.Element.animateColor=function(e){this.base=a.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),n=new t(e.from.value),i=new t(e.to.value);if(n.ok&&i.ok){var r=n.r+(i.r-n.r)*e.progress,o=n.g+(i.g-n.g)*e.progress,a=n.b+(i.b-n.b)*e.progress;return"rgb("+parseInt(r,10)+","+parseInt(o,10)+","+parseInt(a,10)+")"}return this.attribute("from").value}},a.Element.animateColor.prototype=new a.Element.AnimateBase,a.Element.animateTransform=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),e=a.ToNumberArray(t.from.value),n=a.ToNumberArray(t.to.value),i="",r=0;r<e.length;r++)i+=e[r]+(n[r]-e[r])*t.progress+" ";return i}},a.Element.animateTransform.prototype=new a.Element.animate,a.Element.font=function(t){this.base=a.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var e=0;e<this.children.length;e++){var n=this.children[e];"font-face"==n.type?(this.fontFace=n).style("font-family").hasValue()&&(a.Definitions[n.style("font-family").value]=this):"missing-glyph"==n.type?this.missingGlyph=n:"glyph"==n.type&&(""!=n.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[n.unicode]&&(this.glyphs[n.unicode]=[]),this.glyphs[n.unicode][n.arabicForm]=n):this.glyphs[n.unicode]=n)}},a.Element.font.prototype=new a.Element.ElementBase,a.Element.fontface=function(t){this.base=a.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},a.Element.fontface.prototype=new a.Element.ElementBase,a.Element.missingglyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=0},a.Element.missingglyph.prototype=new a.Element.path,a.Element.glyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},a.Element.glyph.prototype=new a.Element.path,a.Element.text=function(t){this.captureTextNodes=!0,this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();null==e&&(e=this.style("alignment-baseline").toTextBaseline()),null!=e&&(t.textBaseline=e)},this.initializeCoordinates=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(t,this,0)},this.getBoundingBox=function(t){this.initializeCoordinates(t);for(var e=null,n=0;n<this.children.length;n++){var i=this.getChildBoundingBox(t,this,this,n);null==e?e=i:e.addBoundingBox(i)}return e},this.renderChildren=function(t){this.initializeCoordinates(t);for(var e=0;e<this.children.length;e++)this.renderChild(t,this,this,e)},this.getAnchorDelta=function(t,e,n){var i=this.style("text-anchor").valueOrDefault("start");if("start"!=i){for(var r=0,o=n;o<e.children.length;o++){var a=e.children[o];if(n<o&&a.attribute("x").hasValue())break;r+=a.measureTextRecursive(t)}return-1*("end"==i?r:r/2)}return 0},this.adjustChildCoordinates=function(t,e,n,i){var r=n.children[i];return r.attribute("x").hasValue()?(r.x=r.attribute("x").toPixels("x")+e.getAnchorDelta(t,n,i),r.attribute("dx").hasValue()&&(r.x+=r.attribute("dx").toPixels("x"))):(r.attribute("dx").hasValue()&&(e.x+=r.attribute("dx").toPixels("x")),r.x=e.x),e.x=r.x+r.measureText(t),r.attribute("y").hasValue()?(r.y=r.attribute("y").toPixels("y"),r.attribute("dy").hasValue()&&(r.y+=r.attribute("dy").toPixels("y"))):(r.attribute("dy").hasValue()&&(e.y+=r.attribute("dy").toPixels("y")),r.y=e.y),e.y=r.y,r},this.getChildBoundingBox=function(t,e,n,i){var r=this.adjustChildCoordinates(t,e,n,i),o=r.getBoundingBox(t);for(i=0;i<r.children.length;i++){var a=e.getChildBoundingBox(t,e,r,i);o.addBoundingBox(a)}return o},this.renderChild=function(t,e,n,i){var r=this.adjustChildCoordinates(t,e,n,i);for(r.render(t),i=0;i<r.children.length;i++)e.renderChild(t,e,r,i)}},a.Element.text.prototype=new a.Element.RenderedElementBase,a.Element.TextElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,e,n){var i=e[n],r=null;if(t.isArabic){var o="isolated";(0==n||" "==e[n-1])&&n<e.length-2&&" "!=e[n+1]&&(o="terminal"),0<n&&" "!=e[n-1]&&n<e.length-2&&" "!=e[n+1]&&(o="medial"),0<n&&" "!=e[n-1]&&(n==e.length-1||" "==e[n+1])&&(o="initial"),void 0!==t.glyphs[i]&&null==(r=t.glyphs[i][o])&&"glyph"==t.glyphs[i].type&&(r=t.glyphs[i])}else r=t.glyphs[i];return null==r&&(r=t.missingGlyph),r},this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(null==e)"stroke"==t.paintOrder?(""!=t.strokeStyle&&t.strokeText(a.compressSpaces(this.getText()),this.x,this.y),""!=t.fillStyle&&t.fillText(a.compressSpaces(this.getText()),this.x,this.y)):(""!=t.fillStyle&&t.fillText(a.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(a.compressSpaces(this.getText()),this.x,this.y));else{var n=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),i=this.parent.style("font-style").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),r=this.getText();e.isRTL&&(r=r.split("").reverse().join(""));for(var o=a.ToNumberArray(this.parent.attribute("dx").value),s=0;s<r.length;s++){var l=this.getGlyph(e,r,s),u=n/e.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(u,-u);var c=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/n,"italic"==i&&t.transform(1,0,.4,1,0,0),l.render(t),"italic"==i&&t.transform(1,0,-.4,1,0,0),t.lineWidth=c,t.scale(1/u,-1/u),t.translate(-this.x,-this.y),this.x+=n*(l.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm,void 0===o[s]||isNaN(o[s])||(this.x+=o[s])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var e=this.measureText(t),n=0;n<this.children.length;n++)e+=this.children[n].measureTextRecursive(t);return e},this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(null!=e){var n=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),i=0,r=this.getText();e.isRTL&&(r=r.split("").reverse().join(""));for(var o=a.ToNumberArray(this.parent.attribute("dx").value),s=0;s<r.length;s++)i+=(this.getGlyph(e,r,s).horizAdvX||e.horizAdvX)*n/e.fontFace.unitsPerEm,void 0===o[s]||isNaN(o[s])||(i+=o[s]);return i}var l=a.compressSpaces(this.getText());if(!t.measureText)return 10*l.length;t.save(),this.setContext(t,!0);var u=t.measureText(l).width;return t.restore(),u},this.getBoundingBox=function(t){var e=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);return new a.BoundingBox(this.x,this.y-e,this.x+this.measureText(t),this.y)}},a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase,a.Element.tspan=function(t){this.captureTextNodes=!0,this.base=a.Element.TextElementBase,this.base(t),this.text=a.compressSpaces(t.value||t.text||t.textContent||""),this.getText=function(){return 0<this.children.length?"":this.text}},a.Element.tspan.prototype=new a.Element.TextElementBase,a.Element.tref=function(t){this.base=a.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();if(null!=t)return t.children[0].getText()}},a.Element.tref.prototype=new a.Element.TextElementBase,a.Element.a=function(t){this.base=a.Element.TextElementBase,this.base(t),this.hasText=0<t.childNodes.length;for(var e=0;e<t.childNodes.length;e++)3!=t.childNodes[e].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].value||t.childNodes[0].data:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(0<this.children.length){var n=new a.Element.g;n.children=this.children,n.parent=this,n.render(t)}},this.onclick=function(){i.open(this.getHrefAttribute().value)},this.onmousemove=function(){a.ctx.canvas.style.cursor="pointer"}},a.Element.a.prototype=new a.Element.TextElementBase,a.Element.image=function(t){this.base=a.Element.RenderedElementBase,this.base(t);var e=this.getHrefAttribute().value;if(""!=e){var n=e.match(/\.svg$/);if(a.Images.push(this),this.loaded=!1,n)this.img=a.ajax(e),this.loaded=!0;else{this.img=document.createElement("img"),1==a.opts.useCORS&&(this.img.crossOrigin="Anonymous");var i=this;this.img.onload=function(){i.loaded=!0},this.img.onerror=function(){a.log('ERROR: image "'+e+'" not found'),i.loaded=!0},this.img.src=e}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),o=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y");0!=o&&0!=s&&(t.save(),n?t.drawSvg(this.img,e,r,o,s):(t.translate(e,r),a.AspectRatio(t,this.attribute("preserveAspectRatio").value,o,this.img.width,s,this.img.height,0,0),i.loaded&&(void 0===this.img.complete||this.img.complete)&&t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");return new a.BoundingBox(t,e,t+n,e+i)}}},a.Element.image.prototype=new a.Element.RenderedElementBase,a.Element.g=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(t){for(var e=new a.BoundingBox,n=0;n<this.children.length;n++)e.addBoundingBox(this.children[n].getBoundingBox(t));return e}},a.Element.g.prototype=new a.Element.RenderedElementBase,a.Element.symbol=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.render=function(t){}},a.Element.symbol.prototype=new a.Element.RenderedElementBase,a.Element.style=function(t){this.base=a.Element.ElementBase,this.base(t);for(var e="",n=0;n<t.childNodes.length;n++)e+=t.childNodes[n].data;e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");var i=(e=a.compressSpaces(e)).split("}");for(n=0;n<i.length;n++)if(""!=a.trim(i[n]))for(var r=i[n].split("{"),o=r[0].split(","),s=r[1].split(";"),l=0;l<o.length;l++){var u=a.trim(o[l]);if(""!=u){for(var c=a.Styles[u]||{},h=0;h<s.length;h++){var d=s[h].indexOf(":"),p=s[h].substr(0,d),m=s[h].substr(d+1,s[h].length-d);null!=p&&null!=m&&(c[a.trim(p)]=new a.Property(a.trim(p),a.trim(m)))}if(a.Styles[u]=c,a.StylesSpecificity[u]=f(u),"@font-face"==u)for(var g=c["font-family"].value.replace(/"/g,""),v=c.src.value.split(","),y=0;y<v.length;y++)if(0<v[y].indexOf('format("svg")'))for(var b=v[y].indexOf("url"),_=v[y].indexOf(")",b),x=v[y].substr(b+5,_-b-6),w=a.parseXml(a.ajax(x)).getElementsByTagName("font"),C=0;C<w.length;C++){var T=a.CreateElement(w[C]);a.Definitions[g]=T}}}},a.Element.style.prototype=new a.Element.ElementBase,a.Element.use=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var e=this.getHrefAttribute().getDefinition();this.path=function(t){null!=e&&e.path(t)},this.elementTransform=function(){if(null!=e&&e.style("transform",!1,!0).hasValue())return new a.Transform(e.style("transform",!1,!0).value)},this.getBoundingBox=function(t){if(null!=e)return e.getBoundingBox(t)},this.renderChildren=function(t){if(null!=e){var n=e;"symbol"==e.type&&((n=new a.Element.svg).type="svg",n.attributes.viewBox=new a.Property("viewBox",e.attribute("viewBox").value),n.attributes.preserveAspectRatio=new a.Property("preserveAspectRatio",e.attribute("preserveAspectRatio").value),n.attributes.overflow=new a.Property("overflow",e.attribute("overflow").value),n.children=e.children),"svg"==n.type&&(this.attribute("width").hasValue()&&(n.attributes.width=new a.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(n.attributes.height=new a.Property("height",this.attribute("height").value)));var i=n.parent;n.parent=null,n.render(t),n.parent=i}}},a.Element.use.prototype=new a.Element.RenderedElementBase,a.Element.mask=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),o=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y");if(0==o&&0==s){for(var l=new a.BoundingBox,u=0;u<this.children.length;u++)l.addBoundingBox(this.children[u].getBoundingBox(t));n=Math.floor(l.x1),i=Math.floor(l.y1),o=Math.floor(l.width()),s=Math.floor(l.height())}var c=e.attribute("mask").value;e.attribute("mask").value="";var h=r();h.width=n+o,h.height=i+s;var d=h.getContext("2d");this.renderChildren(d);var p=r();p.width=n+o,p.height=i+s;var f=p.getContext("2d");e.render(f),f.globalCompositeOperation="destination-in",f.fillStyle=d.createPattern(h,"no-repeat"),f.fillRect(0,0,n+o,i+s),t.fillStyle=f.createPattern(p,"no-repeat"),t.fillRect(0,0,n+o,i+s),e.attribute("mask").value=c},this.render=function(t){}},a.Element.mask.prototype=new a.Element.ElementBase,a.Element.clipPath=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t){var e="undefined"!=typeof CanvasRenderingContext2D,n=t.beginPath,i=t.closePath;e&&(CanvasRenderingContext2D.prototype.beginPath=function(){},CanvasRenderingContext2D.prototype.closePath=function(){}),n.call(t);for(var r=0;r<this.children.length;r++){var o=this.children[r];if(void 0!==o.path){var s=void 0!==o.elementTransform&&o.elementTransform();!s&&o.style("transform",!1,!0).hasValue()&&(s=new a.Transform(o.style("transform",!1,!0).value)),s&&s.apply(t),o.path(t),e&&(CanvasRenderingContext2D.prototype.closePath=i),s&&s.unapply(t)}}i.call(t),t.clip(),e&&(CanvasRenderingContext2D.prototype.beginPath=n,CanvasRenderingContext2D.prototype.closePath=i)},this.render=function(t){}},a.Element.clipPath.prototype=new a.Element.ElementBase,a.Element.filter=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var n=e.getBoundingBox(t),i=Math.floor(n.x1),o=Math.floor(n.y1),a=Math.floor(n.width()),s=Math.floor(n.height()),l=e.style("filter").value;e.style("filter").value="";for(var u=0,c=0,h=0;h<this.children.length;h++){var d=this.children[h].extraFilterDistance||0;u=Math.max(u,d),c=Math.max(c,d)}var p=r();p.width=a+2*u,p.height=s+2*c;var f=p.getContext("2d");for(f.translate(-i+u,-o+c),e.render(f),h=0;h<this.children.length;h++)"function"==typeof this.children[h].apply&&this.children[h].apply(f,0,0,a+2*u,s+2*c);t.drawImage(p,0,0,a+2*u,s+2*c,i-u,o-c,a+2*u,s+2*c),e.style("filter",!0).value=l},this.render=function(t){}},a.Element.filter.prototype=new a.Element.ElementBase,a.Element.feMorphology=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e,n,i,r){}},a.Element.feMorphology.prototype=new a.Element.ElementBase,a.Element.feComposite=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e,n,i,r){}},a.Element.feComposite.prototype=new a.Element.ElementBase,a.Element.feColorMatrix=function(t){this.base=a.Element.ElementBase,this.base(t);var e=a.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var n=e[0];e=[.213+.787*n,.715-.715*n,.072-.072*n,0,0,.213-.213*n,.715+.285*n,.072-.072*n,0,0,.213-.213*n,.715-.715*n,.072+.928*n,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var i=e[0]*Math.PI/180,r=function(t,e,n){return t+Math.cos(i)*e+Math.sin(i)*n};e=[r(.213,.787,-.213),r(.715,-.715,-.715),r(.072,-.072,.928),0,0,r(.213,-.213,.143),r(.715,.285,.14),r(.072,-.072,-.283),0,0,r(.213,-.213,-.787),r(.715,-.715,.715),r(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}function o(t,e,n,i,r,o){return t[n*i*4+4*e+o]}function s(t,e,n,i,r,o,a){t[n*i*4+4*e+o]=a}function l(t,n){var i=e[t];return i*(i<0?n-255:n)}this.apply=function(t,e,n,i,r){var a=t.getImageData(0,0,i,r);for(n=0;n<r;n++)for(e=0;e<i;e++){var u=o(a.data,e,n,i,0,0),c=o(a.data,e,n,i,0,1),h=o(a.data,e,n,i,0,2),d=o(a.data,e,n,i,0,3);s(a.data,e,n,i,0,0,l(0,u)+l(1,c)+l(2,h)+l(3,d)+l(4,1)),s(a.data,e,n,i,0,1,l(5,u)+l(6,c)+l(7,h)+l(8,d)+l(9,1)),s(a.data,e,n,i,0,2,l(10,u)+l(11,c)+l(12,h)+l(13,d)+l(14,1)),s(a.data,e,n,i,0,3,l(15,u)+l(16,c)+l(17,h)+l(18,d)+l(19,1))}t.clearRect(0,0,i,r),t.putImageData(a,0,0)}},a.Element.feColorMatrix.prototype=new a.Element.ElementBase,a.Element.feGaussianBlur=function(t){this.base=a.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,n,i,r,o){e&&void 0!==e.canvasRGBA?(t.canvas.id=a.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),e.canvasRGBA(t.canvas,n,i,r,o,this.blurRadius),document.body.removeChild(t.canvas)):a.log("ERROR: StackBlur.js must be included for blur to work")}},a.Element.feGaussianBlur.prototype=new a.Element.ElementBase,a.Element.title=function(t){},a.Element.title.prototype=new a.Element.ElementBase,a.Element.desc=function(t){},a.Element.desc.prototype=new a.Element.ElementBase,a.Element.MISSING=function(t){a.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},a.Element.MISSING.prototype=new a.Element.ElementBase,a.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");e=e.replace(/\-/g,"");var n=null;return(n=void 0!==a.Element[e]?new a.Element[e](t):new a.Element.MISSING(t)).type=t.nodeName,n},a.load=function(t,e){a.loadXml(t,a.ajax(e))},a.loadXml=function(t,e){a.loadXmlDoc(t,a.parseXml(e))},a.loadXmlDoc=function(t,e){a.init(t);var n=function(e){for(var n=t.canvas;n;)e.x-=n.offsetLeft,e.y-=n.offsetTop,n=n.offsetParent;return i.scrollX&&(e.x+=i.scrollX),i.scrollY&&(e.y+=i.scrollY),e};1!=a.opts.ignoreMouse&&(t.canvas.onclick=function(t){var e=n(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onclick(e.x,e.y)},t.canvas.onmousemove=function(t){var e=n(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onmousemove(e.x,e.y)});var r=a.CreateElement(e.documentElement);r.root=!0,r.addStylesFromStyleDefinition();var o=!0,s=function(){a.ViewPort.Clear(),t.canvas.parentNode?a.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight):a.ViewPort.SetCurrent(800,600),1!=a.opts.ignoreDimensions&&(r.style("width").hasValue()&&(t.canvas.width=r.style("width").toPixels("x"),t.canvas.style&&(t.canvas.style.width=t.canvas.width+"px")),r.style("height").hasValue()&&(t.canvas.height=r.style("height").toPixels("y"),t.canvas.style&&(t.canvas.style.height=t.canvas.height+"px")));var n=t.canvas.clientWidth||t.canvas.width,i=t.canvas.clientHeight||t.canvas.height;if(1==a.opts.ignoreDimensions&&r.style("width").hasValue()&&r.style("height").hasValue()&&(n=r.style("width").toPixels("x"),i=r.style("height").toPixels("y")),a.ViewPort.SetCurrent(n,i),null!=a.opts.offsetX&&(r.attribute("x",!0).value=a.opts.offsetX),null!=a.opts.offsetY&&(r.attribute("y",!0).value=a.opts.offsetY),null!=a.opts.scaleWidth||null!=a.opts.scaleHeight){var s=null,l=null,u=a.ToNumberArray(r.attribute("viewBox").value);null!=a.opts.scaleWidth&&(r.attribute("width").hasValue()?s=r.attribute("width").toPixels("x")/a.opts.scaleWidth:isNaN(u[2])||(s=u[2]/a.opts.scaleWidth)),null!=a.opts.scaleHeight&&(r.attribute("height").hasValue()?l=r.attribute("height").toPixels("y")/a.opts.scaleHeight:isNaN(u[3])||(l=u[3]/a.opts.scaleHeight)),null==s&&(s=l),null==l&&(l=s),r.attribute("width",!0).value=a.opts.scaleWidth,r.attribute("height",!0).value=a.opts.scaleHeight,r.style("transform",!0,!0).value+=" scale("+1/s+","+1/l+")"}1!=a.opts.ignoreClear&&t.clearRect(0,0,n,i),r.render(t),o&&(o=!1,"function"==typeof a.opts.renderCallback&&a.opts.renderCallback(e))},l=!0;a.ImagesLoaded()&&(l=!1,s()),a.intervalID=setInterval((function(){var t=!1;if(l&&a.ImagesLoaded()&&(t=!(l=!1)),1!=a.opts.ignoreMouse&&(t|=a.Mouse.hasEvents()),1!=a.opts.ignoreAnimation)for(var e=0;e<a.Animations.length;e++)t|=a.Animations[e].update(1e3/a.FRAMERATE);"function"==typeof a.opts.forceRedraw&&1==a.opts.forceRedraw()&&(t=!0),t&&(s(),a.Mouse.runEvents())}),1e3/a.FRAMERATE)},a.stop=function(){a.intervalID&&clearInterval(a.intervalID)},a.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,e){for(var n=0;n<this.events.length;n++){var i=this.events[n];e.isPointInPath&&e.isPointInPath(i.x,i.y)&&(this.eventElements[n]=t)}},this.checkBoundingBox=function(t,e){for(var n=0;n<this.events.length;n++){var i=this.events[n];e.isPointInBox(i.x,i.y)&&(this.eventElements[n]=t)}},this.runEvents=function(){a.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var e=this.events[t],n=this.eventElements[t];n;)e.run(n),n=n.parent;this.events=[],this.eventElements=[]}},a}(l||{});"string"==typeof n&&(n=document.getElementById(n)),null!=n.svg&&n.svg.stop(),n.childNodes&&1==n.childNodes.length&&"OBJECT"==n.childNodes[0].nodeName||(n.svg=u);var c=n.getContext("2d");void 0!==s.documentElement?u.loadXmlDoc(c,s):"<"==s.substr(0,1)?u.loadXml(c,s):u.load(c,s)}else for(var h=document.querySelectorAll("svg"),d=0;d<h.length;d++){var p=h[d],m=document.createElement("canvas");m.width=p.clientWidth,m.height=p.clientHeight,p.parentNode.insertBefore(m,p),p.parentNode.removeChild(p);var g=document.createElement("div");g.appendChild(p),a(m,g.innerHTML)}};"undefined"==typeof Element||(void 0!==Element.prototype.matches?o=function(t,e){return t.matches(e)}:void 0!==Element.prototype.webkitMatchesSelector?o=function(t,e){return t.webkitMatchesSelector(e)}:void 0!==Element.prototype.mozMatchesSelector?o=function(t,e){return t.mozMatchesSelector(e)}:void 0!==Element.prototype.msMatchesSelector?o=function(t,e){return t.msMatchesSelector(e)}:void 0!==Element.prototype.oMatchesSelector?o=function(t,e){return t.oMatchesSelector(e)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(o=function(t,e){return $(t).is(e)}),void 0===o&&"undefined"!=typeof Sizzle&&(o=Sizzle.matchesSelector)));var s=/(\[[^\]]+\])/g,l=/(#[^\s\+>~\.\[:]+)/g,u=/(\.[^\s\+>~\.\[:]+)/g,c=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,h=/(:[\w-]+\([^\)]*\))/gi,d=/(:[^\s\+>~\.\[:]+)/g,p=/([^\s\+>~\.\[:]+)/g;function f(t){var e=[0,0,0],n=function(n,i){var r=t.match(n);null!=r&&(e[i]+=r.length,t=t.replace(n," "))};return t=(t=t.replace(/:not\(([^\)]*)\)/g,"     $1 ")).replace(/{[\s\S]*/gm," "),n(s,1),n(l,0),n(u,1),n(c,2),n(h,1),n(d,1),t=(t=t.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),n(p,2),e.join("")}"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,e,n,i,r,o){var s={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:e,offsetY:n,scaleWidth:i,scaleHeight:r};for(var l in o)o.hasOwnProperty(l)&&(s[l]=o[l]);a(this.canvas,t,s)}),n.exports=a}(n={exports:{}}),n.exports}(n(205),n(206))},189:function(t,e){var n=$.fn.hasClass,i=$.fn.addClass,r=$.fn.removeClass,o=function(t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(this.getAttribute("class"))},a=function(t){o.apply(this,arguments)||this.setAttribute("class",this.getAttribute("class")+" "+t)},s=function(t){var e=this.getAttribute("class").replace(new RegExp("(\\s|^)"+t+"(\\s|$)","g"),"$2");o.apply(this,arguments)&&this.setAttribute("class",e)};function l(t,e,n,i){for(var r,o=[],a=0,s=t.length;a<s;a++)(r=t[a])instanceof SVGElement?o.push(n.apply(r,e)):o.push(i.apply($(r),e));return o}$.fn.hasClass=function(t){for(var e=l(this,arguments,o,n),i=0,r=e.length;i<r;i++)if(e[i])return!0;return!1},$.fn.addClass=function(t){return $.isFunction(t)?i.apply(this,arguments):(l(this,arguments,a,i),this)},$.fn.removeClass=function(t){return $.isFunction(t)?r.apply(this,arguments):(l(this,arguments,s,r),this)}},190:function(t,e){d3=function(){var t={version:"3.3.8"};Date.now||(Date.now=function(){return+new Date});var e=[].slice,n=function(t){return e.call(t)},i=document,r=i.documentElement,o=window;try{n(r.childNodes)[0].nodeType}catch(t){n=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}try{i.createElement("div").style.setProperty("opacity",0,"")}catch(t){var a=o.Element.prototype,s=a.setAttribute,l=a.setAttributeNS,u=o.CSSStyleDeclaration.prototype,c=u.setProperty;a.setAttribute=function(t,e){s.call(this,t,e+"")},a.setAttributeNS=function(t,e,n){l.call(this,t,e,n+"")},u.setProperty=function(t,e,n){c.call(this,t,e+"",n)}}function h(t){return null!=t&&!isNaN(t)}t.ascending=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},t.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},t.min=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o&&!(null!=(n=t[r])&&n<=n);)n=void 0;for(;++r<o;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<o&&!(null!=(n=e.call(t,t[r],r))&&n<=n);)n=void 0;for(;++r<o;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},t.max=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o&&!(null!=(n=t[r])&&n<=n);)n=void 0;for(;++r<o;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<o&&!(null!=(n=e.call(t,t[r],r))&&n<=n);)n=void 0;for(;++r<o;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},t.extent=function(t,e){var n,i,r,o=-1,a=t.length;if(1===arguments.length){for(;++o<a&&!(null!=(n=r=t[o])&&n<=n);)n=r=void 0;for(;++o<a;)null!=(i=t[o])&&(n>i&&(n=i),r<i&&(r=i))}else{for(;++o<a&&!(null!=(n=r=e.call(t,t[o],o))&&n<=n);)n=void 0;for(;++o<a;)null!=(i=e.call(t,t[o],o))&&(n>i&&(n=i),r<i&&(r=i))}return[n,r]},t.sum=function(t,e){var n,i=0,r=t.length,o=-1;if(1===arguments.length)for(;++o<r;)isNaN(n=+t[o])||(i+=n);else for(;++o<r;)isNaN(n=+e.call(t,t[o],o))||(i+=n);return i},t.mean=function(t,e){var n,i=t.length,r=0,o=-1,a=0;if(1===arguments.length)for(;++o<i;)h(n=t[o])&&(r+=(n-r)/++a);else for(;++o<i;)h(n=e.call(t,t[o],o))&&(r+=(n-r)/++a);return a?r:void 0},t.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],o=n-i;return o?r+o*(t[i]-r):r},t.median=function(e,n){return arguments.length>1&&(e=e.map(n)),(e=e.filter(h)).length?t.quantile(e.sort(t.ascending),.5):void 0},t.bisector=function(t){return{left:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);i<r;){var o=i+r>>>1;t.call(e,e[o],o)<n?i=o+1:r=o}return i},right:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);i<r;){var o=i+r>>>1;n<t.call(e,e[o],o)?r=o:i=o+1}return i}}};var d=t.bisector((function(t){return t}));function p(t){return t.length}t.bisectLeft=d.left,t.bisect=t.bisectRight=d.right,t.shuffle=function(t){for(var e,n,i=t.length;i;)n=Math.random()*i--|0,e=t[i],t[i]=t[n],t[n]=e;return t},t.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},t.pairs=function(t){for(var e=0,n=t.length-1,i=t[0],r=new Array(n<0?0:n);e<n;)r[e]=[i,i=t[++e]];return r},t.zip=function(){if(!(r=arguments.length))return[];for(var e=-1,n=t.min(arguments,p),i=new Array(n);++e<n;)for(var r,o=-1,a=i[e]=new Array(r);++o<r;)a[o]=arguments[o][e];return i},t.transpose=function(e){return t.zip.apply(t,e)},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e},t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},t.merge=function(t){for(var e,n,i,r=t.length,o=-1,a=0;++o<r;)a+=t[o].length;for(n=new Array(a);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--a]=i[e];return n};var f=Math.abs;function m(t){for(var e=1;t*e%1;)e*=10;return e}function g(t,e){try{for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}catch(n){t.prototype=e}}function v(){}t.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n==1/0)throw new Error("infinite range");var i,r=[],o=m(f(n)),a=-1;if(t*=o,e*=o,(n*=o)<0)for(;(i=t+n*++a)>e;)r.push(i/o);else for(;(i=t+n*++a)<e;)r.push(i/o);return r},t.map=function(t){var e=new v;if(t instanceof v)t.forEach((function(t,n){e.set(t,n)}));else for(var n in t)e.set(n,t[n]);return e},g(v,{has:function(t){return y+t in this},get:function(t){return this[y+t]},set:function(t,e){return this[y+t]=e},remove:function(t){return(t=y+t)in this&&delete this[t]},keys:function(){var t=[];return this.forEach((function(e){t.push(e)})),t},values:function(){var t=[];return this.forEach((function(e,n){t.push(n)})),t},entries:function(){var t=[];return this.forEach((function(e,n){t.push({key:e,value:n})})),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===b&&t.call(this,e.substring(1),this[e])}});var y="\0",b=y.charCodeAt(0);function _(){}function x(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function w(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.substring(1);for(var n=0,i=C.length;n<i;++n){var r=C[n]+e;if(r in t)return r}}t.nest=function(){var e,n,i={},r=[],o=[];function a(t,o,s){if(s>=r.length)return n?n.call(i,o):e?o.sort(e):o;for(var l,u,c,h,d=-1,p=o.length,f=r[s++],m=new v;++d<p;)(h=m.get(l=f(u=o[d])))?h.push(u):m.set(l,[u]);return t?(u=t(),c=function(e,n){u.set(e,a(t,n,s))}):(u={},c=function(e,n){u[e]=a(t,n,s)}),m.forEach(c),u}return i.map=function(t,e){return a(e,t,0)},i.entries=function(e){return function t(e,n){if(n>=r.length)return e;var i=[],a=o[n++];return e.forEach((function(e,r){i.push({key:e,values:t(r,n)})})),a?i.sort((function(t,e){return a(t.key,e.key)})):i}(a(t.map,e,0),0)},i.key=function(t){return r.push(t),i},i.sortKeys=function(t){return o[r.length-1]=t,i},i.sortValues=function(t){return e=t,i},i.rollup=function(t){return n=t,i},i},t.set=function(t){var e=new _;if(t)for(var n=0,i=t.length;n<i;++n)e.add(t[n]);return e},g(_,{has:function(t){return y+t in this},add:function(t){return this[y+t]=!0,t},remove:function(t){return(t=y+t)in this&&delete this[t]},values:function(){var t=[];return this.forEach((function(e){t.push(e)})),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===b&&t.call(this,e.substring(1))}}),t.behavior={},t.rebind=function(t,e){for(var n,i=1,r=arguments.length;++i<r;)t[n=arguments[i]]=x(t,e,e[n]);return t};var C=["webkit","ms","moz","Moz","o","O"];function T(){}function S(){}function k(t){var e=[],n=new v;function i(){for(var n,i=e,r=-1,o=i.length;++r<o;)(n=i[r].on)&&n.apply(this,arguments);return t}return i.on=function(i,r){var o,a=n.get(i);return arguments.length<2?a&&a.on:(a&&(a.on=null,e=e.slice(0,o=e.indexOf(a)).concat(e.slice(o+1)),n.remove(i)),r&&e.push(n.set(i,{on:r})),t)},i}function A(){t.event.preventDefault()}function E(){for(var e,n=t.event;e=n.sourceEvent;)n=e;return n}function M(e){for(var n=new S,i=0,r=arguments.length;++i<r;)n[arguments[i]]=k(n);return n.of=function(i,r){return function(o){try{var a=o.sourceEvent=t.event;o.target=e,t.event=o,n[o.type].apply(i,r)}finally{t.event=a}}},n}t.dispatch=function(){for(var t=new S,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=k(t);return t},S.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.substring(n+1),t=t.substring(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},t.event=null,t.requote=function(t){return t.replace(P,"\\$&")};var P=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,D={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]};function O(t){return D(t,F),t}var I=function(t,e){return e.querySelector(t)},L=function(t,e){return e.querySelectorAll(t)},R=r[w(r,"matchesSelector")],N=function(t,e){return R.call(t,e)};"function"==typeof Sizzle&&(I=function(t,e){return Sizzle(t,e)[0]||null},L=function(t,e){return Sizzle.uniqueSort(Sizzle(t,e))},N=Sizzle.matchesSelector),t.selection=function(){return it};var F=t.selection.prototype=[];function B(t){return"function"==typeof t?t:function(){return I(t,this)}}function z(t){return"function"==typeof t?t:function(){return L(t,this)}}F.select=function(t){var e,n,i,r,o=[];t=B(t);for(var a=-1,s=this.length;++a<s;){o.push(e=[]),e.parentNode=(i=this[a]).parentNode;for(var l=-1,u=i.length;++l<u;)(r=i[l])?(e.push(n=t.call(r,r.__data__,l,a)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return O(o)},F.selectAll=function(t){var e,i,r=[];t=z(t);for(var o=-1,a=this.length;++o<a;)for(var s=this[o],l=-1,u=s.length;++l<u;)(i=s[l])&&(r.push(e=n(t.call(i,i.__data__,l,o))),e.parentNode=i);return O(r)};var j={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function V(e,n){return e=t.ns.qualify(e),null==n?e.local?function(){this.removeAttributeNS(e.space,e.local)}:function(){this.removeAttribute(e)}:"function"==typeof n?e.local?function(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}:function(){var t=n.apply(this,arguments);null==t?this.removeAttribute(e):this.setAttribute(e,t)}:e.local?function(){this.setAttributeNS(e.space,e.local,n)}:function(){this.setAttribute(e,n)}}function H(t){return t.trim().replace(/\s+/g," ")}function W(e){return new RegExp("(?:^|\\s+)"+t.requote(e)+"(?:\\s+|$)","g")}function U(t,e){var n=(t=t.trim().split(/\s+/).map($)).length;return"function"==typeof e?function(){for(var i=-1,r=e.apply(this,arguments);++i<n;)t[i](this,r)}:function(){for(var i=-1;++i<n;)t[i](this,e)}}function $(t){var e=W(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",H(r+" "+t))):n.setAttribute("class",H(r.replace(e," ")))}}function G(t,e,n){return null==e?function(){this.style.removeProperty(t)}:"function"==typeof e?function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}:function(){this.style.setProperty(t,e,n)}}function q(t,e){return null==e?function(){delete this[t]}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}:function(){this[t]=e}}function Y(e){return"function"==typeof e?e:(e=t.ns.qualify(e)).local?function(){return this.ownerDocument.createElementNS(e.space,e.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,e)}}function X(t){return{__data__:t}}function Q(t){return function(){return N(this,t)}}function K(e){return arguments.length||(e=t.ascending),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function J(t,e){for(var n=0,i=t.length;n<i;n++)for(var r,o=t[n],a=0,s=o.length;a<s;a++)(r=o[a])&&e(r,a,n);return t}function Z(t){return D(t,tt),t}t.ns={prefix:j,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.substring(0,e),t=t.substring(e+1)),j.hasOwnProperty(n)?{space:j[n],local:t}:t}},F.attr=function(e,n){if(arguments.length<2){if("string"==typeof e){var i=this.node();return(e=t.ns.qualify(e)).local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}for(n in e)this.each(V(n,e[n]));return this}return this.each(V(e,n))},F.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=t.trim().split(/^|\s+/g)).length,r=-1;if(e=n.classList){for(;++r<i;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");++r<i;)if(!W(t[r]).test(e))return!1;return!0}for(e in t)this.each(U(e,t[e]));return this}return this.each(U(t,e))},F.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.each(G(n,t[n],e));return this}if(i<2)return o.getComputedStyle(this.node(),null).getPropertyValue(t);n=""}return this.each(G(t,e,n))},F.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(q(e,t[e]));return this}return this.each(q(t,e))},F.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},F.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},F.append=function(t){return t=Y(t),this.select((function(){return this.appendChild(t.apply(this,arguments))}))},F.insert=function(t,e){return t=Y(t),e=B(e),this.select((function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)}))},F.remove=function(){return this.each((function(){var t=this.parentNode;t&&t.removeChild(this)}))},F.data=function(t,e){var n,i,r=-1,o=this.length;if(!arguments.length){for(t=new Array(o=(n=this[0]).length);++r<o;)(i=n[r])&&(t[r]=i.__data__);return t}function a(t,n){var i,r,o,a=t.length,c=n.length,h=Math.min(a,c),d=new Array(c),p=new Array(c),f=new Array(a);if(e){var m,g=new v,y=new v,b=[];for(i=-1;++i<a;)m=e.call(r=t[i],r.__data__,i),g.has(m)?f[i]=r:g.set(m,r),b.push(m);for(i=-1;++i<c;)m=e.call(n,o=n[i],i),(r=g.get(m))?(d[i]=r,r.__data__=o):y.has(m)||(p[i]=X(o)),y.set(m,o),g.remove(m);for(i=-1;++i<a;)g.has(b[i])&&(f[i]=t[i])}else{for(i=-1;++i<h;)r=t[i],o=n[i],r?(r.__data__=o,d[i]=r):p[i]=X(o);for(;i<c;++i)p[i]=X(n[i]);for(;i<a;++i)f[i]=t[i]}p.update=d,p.parentNode=d.parentNode=f.parentNode=t.parentNode,s.push(p),l.push(d),u.push(f)}var s=Z([]),l=O([]),u=O([]);if("function"==typeof t)for(;++r<o;)a(n=this[r],t.call(n,n.parentNode.__data__,r));else for(;++r<o;)a(n=this[r],t);return l.enter=function(){return s},l.exit=function(){return u},l},F.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},F.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=Q(t));for(var o=0,a=this.length;o<a;o++){r.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var s=0,l=n.length;s<l;s++)(i=n[s])&&t.call(i,i.__data__,s)&&e.push(i)}return O(r)},F.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,i=this[t],r=i.length-1,o=i[r];--r>=0;)(n=i[r])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},F.sort=function(t){t=K.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},F.each=function(t){return J(this,(function(e,n,i){t.call(e,e.__data__,n,i)}))},F.call=function(t){var e=n(arguments);return t.apply(e[0]=this,e),this},F.empty=function(){return!this.node()},F.node=function(){for(var t=0,e=this.length;t<e;t++)for(var n=this[t],i=0,r=n.length;i<r;i++){var o=n[i];if(o)return o}return null},F.size=function(){var t=0;return this.each((function(){++t})),t};var tt=[];function et(t){var e,n;return function(i,r,o){var a,s=t[o].update,l=s.length;for(o!=n&&(n=o,e=0),r>=e&&(e=r+1);!(a=s[e])&&++e<l;);return a}}function nt(){var t=this.__transition__;t&&++t.active}t.selection.enter=Z,t.selection.enter.prototype=tt,tt.append=F.append,tt.empty=F.empty,tt.node=F.node,tt.call=F.call,tt.size=F.size,tt.select=function(t){for(var e,n,i,r,o,a=[],s=-1,l=this.length;++s<l;){i=(r=this[s]).update,a.push(e=[]),e.parentNode=r.parentNode;for(var u=-1,c=r.length;++u<c;)(o=r[u])?(e.push(i[u]=n=t.call(r.parentNode,o.__data__,u,s)),n.__data__=o.__data__):e.push(null)}return O(a)},tt.insert=function(t,e){return arguments.length<2&&(e=et(this)),F.insert.call(this,t,e)},F.transition=function(){for(var t,e,n=ka||++Ma,i=[],r=Aa||{time:Date.now(),ease:Cr,delay:0,duration:250},o=-1,a=this.length;++o<a;){i.push(t=[]);for(var s=this[o],l=-1,u=s.length;++l<u;)(e=s[l])&&Oa(e,l,n,r),t.push(e)}return Sa(i,n)},F.interrupt=function(){return this.each(nt)},t.select=function(t){var e=["string"==typeof t?I(t,i):t];return e.parentNode=r,O([e])},t.selectAll=function(t){var e=n("string"==typeof t?L(t,i):t);return e.parentNode=r,O([e])};var it=t.select(r);function rt(e,i,r){var o="__on"+e,a=e.indexOf("."),s=at;a>0&&(e=e.substring(0,a));var l=ot.get(e);function u(){var t=this[o];t&&(this.removeEventListener(e,t,t.$),delete this[o])}return l&&(e=l,s=st),a?i?function(){var t=s(i,n(arguments));u.call(this),this.addEventListener(e,this[o]=t,t.$=r),t._=i}:u:i?T:function(){var n,i=new RegExp("^__on([^.]+)"+t.requote(e)+"$");for(var r in this)if(n=r.match(i)){var o=this[r];this.removeEventListener(n[1],o,o.$),delete this[r]}}}F.on=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=!1),t)this.each(rt(n,t[n],e));return this}if(i<2)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(rt(t,e,n))};var ot=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});function at(e,n){return function(i){var r=t.event;t.event=i,n[0]=this.__data__;try{e.apply(this,n)}finally{t.event=r}}}function st(t,e){var n=at(t,e);return function(t){var e=t.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||n.call(this,t)}}ot.forEach((function(t){"on"+t in i&&ot.remove(t)}));var lt=w(r.style,"userSelect"),ut=0;function ct(){var e=".dragsuppress-"+ ++ut,n="touchmove"+e,i="selectstart"+e,a="dragstart"+e,s="click"+e,l=t.select(o).on(n,A).on(i,A).on(a,A),u=r.style,c=u[lt];return u[lt]="none",function(t){if(l.on(e,null),u[lt]=c,t){function n(){l.on(s,null)}l.on(s,(function(){A(),n()}),!0),setTimeout(n,0)}}}t.mouse=function(t){return dt(t,E())};var ht=/WebKit/.test(o.navigator.userAgent)?-1:0;function dt(e,n){n.changedTouches&&(n=n.changedTouches[0]);var i=e.ownerSVGElement||e;if(i.createSVGPoint){var r=i.createSVGPoint();if(ht<0&&(o.scrollX||o.scrollY)){var a=(i=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();ht=!(a.f||a.e),i.remove()}return ht?(r.x=n.pageX,r.y=n.pageY):(r.x=n.clientX,r.y=n.clientY),[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var s=e.getBoundingClientRect();return[n.clientX-s.left-e.clientLeft,n.clientY-s.top-e.clientTop]}t.touches=function(t,e){return arguments.length<2&&(e=E().touches),e?n(e).map((function(e){var n=dt(t,e);return n.identifier=e.identifier,n})):[]},t.behavior.drag=function(){var e=M(a,"drag","dragstart","dragend"),n=null,i=s(T,t.mouse,"mousemove","mouseup"),r=s((function(){return t.event.changedTouches[0].identifier}),(function(e,n){return t.touches(e).filter((function(t){return t.identifier===n}))[0]}),"touchmove","touchend");function a(){this.on("mousedown.drag",i).on("touchstart.drag",r)}function s(i,r,a,s){return function(){var l,u=this,c=u.parentNode,h=e.of(u,arguments),d=t.event.target,p=i(),f=null==p?"drag":"drag-"+p,m=r(c,p),g=0,v=t.select(o).on(a+"."+f,b).on(s+"."+f,_),y=ct();function b(){var t=r(c,p),e=t[0]-m[0],n=t[1]-m[1];g|=e|n,m=t,h({type:"drag",x:t[0]+l[0],y:t[1]+l[1],dx:e,dy:n})}function _(){v.on(a+"."+f,null).on(s+"."+f,null),y(g&&t.event.target===d),h({type:"dragend"})}l=n?[(l=n.apply(u,arguments)).x-m[0],l.y-m[1]]:[0,0],h({type:"dragstart"})}}return a.origin=function(t){return arguments.length?(n=t,a):n},t.rebind(a,e,"on")};var pt=Math.PI,ft=2*pt,mt=pt/2,gt=1e-6,vt=pt/180,yt=180/pt;function bt(t){return t>0?1:t<0?-1:0}function _t(t){return t>1?0:t<-1?pt:Math.acos(t)}function xt(t){return t>1?mt:t<-1?-mt:Math.asin(t)}function wt(t){return((t=Math.exp(t))-1/t)/2}function Ct(t){return((t=Math.exp(t))+1/t)/2}function Tt(t){return(t=Math.sin(t/2))*t}var St=Math.SQRT2;t.interpolateZoom=function(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],a=e[1],s=e[2],l=o-n,u=a-i,c=l*l+u*u,h=Math.sqrt(c),d=(s*s-r*r+4*c)/(2*r*2*h),p=(s*s-r*r-4*c)/(2*s*2*h),f=Math.log(Math.sqrt(d*d+1)-d),m=Math.log(Math.sqrt(p*p+1)-p)-f,g=(m||Math.log(s/r))/St;function v(t){var e,o=t*g;if(m){var a=Ct(f),s=r/(2*h)*(a*(e=St*o+f,((e=Math.exp(2*e))-1)/(e+1))-wt(f));return[n+s*l,i+s*u,r*a/Ct(St*o+f)]}return[n+t*l,i+t*u,r*Math.exp(St*o)]}return v.duration=1e3*g,v},t.behavior.zoom=function(){var e,n,i,r,a,s,l,u,c={x:0,y:0,k:1},h=[960,500],d=At,p="mousedown.zoom",f="mousemove.zoom",m="mouseup.zoom",g="touchstart.zoom",v=M(y,"zoomstart","zoom","zoomend");function y(t){t.on(p,k).on(Et+".zoom",P).on(f,D).on("dblclick.zoom",O).on(g,E)}function b(t){return[(t[0]-c.x)/c.k,(t[1]-c.y)/c.k]}function _(t){c.k=Math.max(d[0],Math.min(d[1],t))}function x(t,e){e=function(t){return[t[0]*c.k+c.x,t[1]*c.k+c.y]}(e),c.x+=t[0]-e[0],c.y+=t[1]-e[1]}function w(){s&&s.domain(a.range().map((function(t){return(t-c.x)/c.k})).map(a.invert)),u&&u.domain(l.range().map((function(t){return(t-c.y)/c.k})).map(l.invert))}function C(t){t({type:"zoomstart"})}function T(t){w(),t({type:"zoom",scale:c.k,translate:[c.x,c.y]})}function S(t){t({type:"zoomend"})}function k(){var e=this,n=v.of(e,arguments),i=t.event.target,r=0,a=t.select(o).on(f,u).on(m,c),s=b(t.mouse(e)),l=ct();function u(){r=1,x(t.mouse(e),s),T(n)}function c(){a.on(f,o===e?D:null).on(m,null),l(r&&t.event.target===i),S(n)}nt.call(e),C(n)}function E(){var e,n=this,i=v.of(n,arguments),a={},s=0,l=t.event.changedTouches[0].identifier,u="touchmove.zoom-"+l,h="touchend.zoom-"+l,d=t.select(o).on(u,M).on(h,P),f=t.select(n).on(p,null).on(g,w),m=ct();function y(){var i=t.touches(n);return e=c.k,i.forEach((function(t){t.identifier in a&&(a[t.identifier]=b(t))})),i}function w(){for(var e=t.event.changedTouches,n=0,o=e.length;n<o;++n)a[e[n].identifier]=null;var l=y(),u=Date.now();if(1===l.length){if(u-r<500){var h=l[0],d=a[h.identifier];_(2*c.k),x(h,d),A(),T(i)}r=u}else if(l.length>1){h=l[0];var p=l[1],f=h[0]-p[0],m=h[1]-p[1];s=f*f+m*m}}function M(){for(var o,l,u,c,h=t.touches(n),d=0,p=h.length;d<p;++d,c=null)if(u=h[d],c=a[u.identifier]){if(l)break;o=u,l=c}if(c){var f=(f=u[0]-o[0])*f+(f=u[1]-o[1])*f,m=s&&Math.sqrt(f/s);o=[(o[0]+u[0])/2,(o[1]+u[1])/2],l=[(l[0]+c[0])/2,(l[1]+c[1])/2],_(m*e)}r=null,x(o,l),T(i)}function P(){if(t.event.touches.length){for(var e=t.event.changedTouches,n=0,r=e.length;n<r;++n)delete a[e[n].identifier];for(var o in a)return void y()}d.on(u,null).on(h,null),f.on(p,k).on(g,E),m(),S(i)}nt.call(n),w(),C(i)}function P(){var r=v.of(this,arguments);i?clearTimeout(i):(nt.call(this),C(r)),i=setTimeout((function(){i=null,S(r)}),50),A();var o=n||t.mouse(this);e||(e=b(o)),_(Math.pow(2,.002*kt())*c.k),x(o,e),T(r)}function D(){e=null}function O(){var e=v.of(this,arguments),n=t.mouse(this),i=b(n),r=Math.log(c.k)/Math.LN2;C(e),_(Math.pow(2,t.event.shiftKey?Math.ceil(r)-1:Math.floor(r)+1)),x(n,i),T(e),S(e)}return y.event=function(e){e.each((function(){var e=v.of(this,arguments),n=c;ka?t.select(this).transition().each("start.zoom",(function(){c=this.__chart__||{x:0,y:0,k:1},C(e)})).tween("zoom:zoom",(function(){var i=h[0],r=h[1],o=i/2,a=r/2,s=t.interpolateZoom([(o-c.x)/c.k,(a-c.y)/c.k,i/c.k],[(o-n.x)/n.k,(a-n.y)/n.k,i/n.k]);return function(t){var n=s(t),r=i/n[2];this.__chart__=c={x:o-n[0]*r,y:a-n[1]*r,k:r},T(e)}})).each("end.zoom",(function(){S(e)})):(this.__chart__=c,C(e),T(e),S(e))}))},y.translate=function(t){return arguments.length?(c={x:+t[0],y:+t[1],k:c.k},w(),y):[c.x,c.y]},y.scale=function(t){return arguments.length?(c={x:c.x,y:c.y,k:+t},w(),y):c.k},y.scaleExtent=function(t){return arguments.length?(d=null==t?At:[+t[0],+t[1]],y):d},y.center=function(t){return arguments.length?(n=t&&[+t[0],+t[1]],y):n},y.size=function(t){return arguments.length?(h=t&&[+t[0],+t[1]],y):h},y.x=function(t){return arguments.length?(s=t,a=t.copy(),c={x:0,y:0,k:1},y):s},y.y=function(t){return arguments.length?(u=t,l=t.copy(),c={x:0,y:0,k:1},y):u},t.rebind(y,v,"on")};var kt,At=[0,1/0],Et="onwheel"in i?(kt=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in i?(kt=function(){return t.event.wheelDelta},"mousewheel"):(kt=function(){return-t.event.detail},"MozMousePixelScroll");function Mt(){}function Pt(t,e,n){return new Dt(t,e,n)}function Dt(t,e,n){this.h=t,this.s=e,this.l=n}Mt.prototype.toString=function(){return this.rgb()+""},t.hsl=function(t,e,n){return 1===arguments.length?t instanceof Dt?Pt(t.h,t.s,t.l):Zt(""+t,te,Pt):Pt(+t,+e,+n)};var Ot=Dt.prototype=new Mt;function It(t,e,n){var i,r;function o(t){return Math.round(255*function(t){return t>360?t-=360:t<0&&(t+=360),t<60?i+(r-i)*t/60:t<180?r:t<240?i+(r-i)*(240-t)/60:i}(t))}return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:e<0?0:e>1?1:e,i=2*(n=n<0?0:n>1?1:n)-(r=n<=.5?n*(1+e):n+e-n*e),Xt(o(t+120),o(t),o(t-120))}function Lt(t,e,n){return new Rt(t,e,n)}function Rt(t,e,n){this.h=t,this.c=e,this.l=n}Ot.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),Pt(this.h,this.s,this.l/t)},Ot.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),Pt(this.h,this.s,t*this.l)},Ot.rgb=function(){return It(this.h,this.s,this.l)},t.hcl=function(e,n,i){return 1===arguments.length?e instanceof Rt?Lt(e.h,e.c,e.l):Wt(e instanceof zt?e.l:(e=ee((e=t.rgb(e)).r,e.g,e.b)).l,e.a,e.b):Lt(+e,+n,+i)};var Nt=Rt.prototype=new Mt;function Ft(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),Bt(n,Math.cos(t*=vt)*e,Math.sin(t)*e)}function Bt(t,e,n){return new zt(t,e,n)}function zt(t,e,n){this.l=t,this.a=e,this.b=n}Nt.brighter=function(t){return Lt(this.h,this.c,Math.min(100,this.l+jt*(arguments.length?t:1)))},Nt.darker=function(t){return Lt(this.h,this.c,Math.max(0,this.l-jt*(arguments.length?t:1)))},Nt.rgb=function(){return Ft(this.h,this.c,this.l).rgb()},t.lab=function(e,n,i){return 1===arguments.length?e instanceof zt?Bt(e.l,e.a,e.b):e instanceof Rt?Ft(e.l,e.c,e.h):ee((e=t.rgb(e)).r,e.g,e.b):Bt(+e,+n,+i)};var jt=18,Vt=zt.prototype=new Mt;function Ht(t,e,n){var i=(t+16)/116,r=i+e/500,o=i-n/200;return Xt(Gt(3.2404542*(r=.95047*Ut(r))-1.5371385*(i=1*Ut(i))-.4985314*(o=1.08883*Ut(o))),Gt(-.969266*r+1.8760108*i+.041556*o),Gt(.0556434*r-.2040259*i+1.0572252*o))}function Wt(t,e,n){return t>0?Lt(Math.atan2(n,e)*yt,Math.sqrt(e*e+n*n),t):Lt(NaN,NaN,t)}function Ut(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function $t(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function Gt(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function qt(t){return Xt(t>>16,t>>8&255,255&t)}function Yt(t){return qt(t)+""}function Xt(t,e,n){return new Qt(t,e,n)}function Qt(t,e,n){this.r=t,this.g=e,this.b=n}Vt.brighter=function(t){return Bt(Math.min(100,this.l+jt*(arguments.length?t:1)),this.a,this.b)},Vt.darker=function(t){return Bt(Math.max(0,this.l-jt*(arguments.length?t:1)),this.a,this.b)},Vt.rgb=function(){return Ht(this.l,this.a,this.b)},t.rgb=function(t,e,n){return 1===arguments.length?t instanceof Qt?Xt(t.r,t.g,t.b):Zt(""+t,Xt,It):Xt(~~t,~~e,~~n)};var Kt=Qt.prototype=new Mt;function Jt(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function Zt(t,e,n){var i,r,o,a=0,s=0,l=0;if(i=/([a-z]+)\((.*)\)/i.exec(t))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(ie(r[0]),ie(r[1]),ie(r[2]))}return(o=re.get(t))?e(o.r,o.g,o.b):(null!=t&&"#"===t.charAt(0)&&(4===t.length?(a=t.charAt(1),a+=a,s=t.charAt(2),s+=s,l=t.charAt(3),l+=l):7===t.length&&(a=t.substring(1,3),s=t.substring(3,5),l=t.substring(5,7)),a=parseInt(a,16),s=parseInt(s,16),l=parseInt(l,16)),e(a,s,l))}function te(t,e,n){var i,r,o=Math.min(t/=255,e/=255,n/=255),a=Math.max(t,e,n),s=a-o,l=(a+o)/2;return s?(r=l<.5?s/(a+o):s/(2-a-o),i=t==a?(e-n)/s+(e<n?6:0):e==a?(n-t)/s+2:(t-e)/s+4,i*=60):(i=NaN,r=l>0&&l<1?0:i),Pt(i,r,l)}function ee(t,e,n){var i=$t((.4124564*(t=ne(t))+.3575761*(e=ne(e))+.1804375*(n=ne(n)))/.95047),r=$t((.2126729*t+.7151522*e+.072175*n)/1);return Bt(116*r-16,500*(i-r),200*(r-$t((.0193339*t+.119192*e+.9503041*n)/1.08883)))}function ne(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ie(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}Kt.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&e<r&&(e=r),n&&n<r&&(n=r),i&&i<r&&(i=r),Xt(Math.min(255,~~(e/t)),Math.min(255,~~(n/t)),Math.min(255,~~(i/t)))):Xt(r,r,r)},Kt.darker=function(t){return Xt(~~((t=Math.pow(.7,arguments.length?t:1))*this.r),~~(t*this.g),~~(t*this.b))},Kt.hsl=function(){return te(this.r,this.g,this.b)},Kt.toString=function(){return"#"+Jt(this.r)+Jt(this.g)+Jt(this.b)};var re=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function oe(t){return"function"==typeof t?t:function(){return t}}function ae(t){return t}function se(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),le(e,n,t,i)}}function le(e,i,r,a){var s={},l=t.dispatch("beforesend","progress","load","error"),u={},c=new XMLHttpRequest,h=null;function d(){var t,e=c.status;if(!e&&c.responseText||e>=200&&e<300||304===e){try{t=r.call(s,c)}catch(t){return void l.error.call(s,t)}l.load.call(s,t)}else l.error.call(s,c)}return!o.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(e)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=d:c.onreadystatechange=function(){c.readyState>3&&d()},c.onprogress=function(e){var n=t.event;t.event=e;try{l.progress.call(s,c)}finally{t.event=n}},s.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?u[t]:(null==e?delete u[t]:u[t]=e+"",s)},s.mimeType=function(t){return arguments.length?(i=null==t?null:t+"",s):i},s.responseType=function(t){return arguments.length?(h=t,s):h},s.response=function(t){return r=t,s},["get","post"].forEach((function(t){s[t]=function(){return s.send.apply(s,[t].concat(n(arguments)))}})),s.send=function(t,n,r){if(2===arguments.length&&"function"==typeof n&&(r=n,n=null),c.open(t,e,!0),null==i||"accept"in u||(u.accept=i+",*/*"),c.setRequestHeader)for(var o in u)c.setRequestHeader(o,u[o]);return null!=i&&c.overrideMimeType&&c.overrideMimeType(i),null!=h&&(c.responseType=h),null!=r&&s.on("error",r).on("load",(function(t){r(null,t)})),l.beforesend.call(s,c),c.send(null==n?null:n),s},s.abort=function(){return c.abort(),s},t.rebind(s,l,"on"),null==a?s:s.get(function(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}(a))}re.forEach((function(t,e){re.set(t,qt(e))})),t.functor=oe,t.xhr=se(ae),t.dsv=function(e,n){var i=new RegExp('["'+e+"\n]"),r=e.charCodeAt(0);function o(e,i,r){arguments.length<3&&(r=i,i=null);var o=t.xhr(e,n,r);return o.row=function(t){return arguments.length?o.response(null==(i=t)?a:s(t)):i},o.row(i)}function a(t){return o.parse(t.responseText)}function s(t){return function(e){return o.parse(e.responseText,t)}}function l(t){return t.map(u).join(e)}function u(t){return i.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return o.parse=function(t,e){var n;return o.parseRows(t,(function(t,i){if(n)return n(t,i-1);var r=new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+"]"})).join(",")+"}");n=e?function(t,n){return e(r(t),n)}:r}))},o.parseRows=function(t,e){var n,i,o={},a={},s=[],l=t.length,u=0,c=0;function h(){if(u>=l)return a;if(i)return i=!1,o;var e=u;if(34===t.charCodeAt(e)){for(var n=e;n++<l;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}return u=n+2,13===(s=t.charCodeAt(n+1))?(i=!0,10===t.charCodeAt(n+2)&&++u):10===s&&(i=!0),t.substring(e+1,n).replace(/""/g,'"')}for(;u<l;){var s,c=1;if(10===(s=t.charCodeAt(u++)))i=!0;else if(13===s)i=!0,10===t.charCodeAt(u)&&(++u,++c);else if(s!==r)continue;return t.substring(e,u-c)}return t.substring(e)}for(;(n=h())!==a;){for(var d=[];n!==o&&n!==a;)d.push(n),n=h();e&&!(d=e(d,c++))||s.push(d)}return s},o.format=function(t){if(Array.isArray(t[0]))return o.formatRows(t);var n=new _,i=[];return t.forEach((function(t){for(var e in t)n.has(e)||i.push(n.add(e))})),[i.map(u).join(e)].concat(t.map((function(t){return i.map((function(e){return u(t[e])})).join(e)}))).join("\n")},o.formatRows=function(t){return t.map(l).join("\n")},o},t.csv=t.dsv(",","text/csv"),t.tsv=t.dsv("\t","text/tab-separated-values");var ue,ce,he,de,pe,fe=o[w(o,"requestAnimationFrame")]||function(t){setTimeout(t,17)};function me(){var t=ge(),e=ve()-t;e>24?(isFinite(e)&&(clearTimeout(de),de=setTimeout(me,e)),he=0):(he=1,fe(me))}function ge(){var t=Date.now();for(pe=ue;pe;)t>=pe.t&&(pe.f=pe.c(t-pe.t)),pe=pe.n;return t}function ve(){for(var t,e=ue,n=1/0;e;)e.f?e=t?t.n=e.n:ue=e.n:(e.t<n&&(n=e.t),e=(t=e).n);return ce=t,n}t.timer=function(t,e,n){var i=arguments.length;i<2&&(e=0),i<3&&(n=Date.now());var r=n+e,o={c:t,t:r,f:!1,n:null};ce?ce.n=o:ue=o,ce=o,he||(de=clearTimeout(de),he=1,fe(me))},t.timer.flush=function(){ge(),ve()};var ye=[3,3],be=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map((function(t,e){var n=Math.pow(10,3*f(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}));t.formatPrefix=function(e,n){var i=0;return e&&(e<0&&(e*=-1),n&&(e=t.round(e,we(e,n))),i=1+Math.floor(1e-12+Math.log(e)/Math.LN10),i=Math.max(-24,Math.min(24,3*Math.floor((i<=0?i+1:i-1)/3)))),be[8+i/3]},t.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},t.format=function(e){var n=_e.exec(e),i=n[1]||" ",r=n[2]||">",o=n[3]||"",a=n[4]||"",s=n[5],l=+n[6],u=n[7],c=n[8],h=n[9],d=1,p="",f=!1;switch(c&&(c=+c.substring(1)),(s||"0"===i&&"="===r)&&(s=i="0",r="=",u&&(l-=Math.floor((l-1)/4))),h){case"n":u=!0,h="g";break;case"%":d=100,p="%",h="f";break;case"p":d=100,p="%",h="r";break;case"b":case"o":case"x":case"X":"#"===a&&(a="0"+h.toLowerCase());case"c":case"d":f=!0,c=0;break;case"s":d=-1,h="r"}"#"===a?a="":"$"===a&&(a="$"),"r"!=h||c||(h="g"),null!=c&&("g"==h?c=Math.max(1,Math.min(21,c)):"e"!=h&&"f"!=h||(c=Math.max(0,Math.min(20,c)))),h=xe.get(h)||Ce;var m=s&&u;return function(e){if(f&&e%1)return"";var n=e<0||0===e&&1/e<0?(e=-e,"-"):o;if(d<0){var g=t.formatPrefix(e,c);e=g.scale(e),p=g.symbol}else e*=d;var v=(e=h(e,c)).lastIndexOf("."),y=v<0?e:e.substring(0,v),b=v<0?"":"."+e.substring(v+1);!s&&u&&(y=Te(y));var _=a.length+y.length+b.length+(m?0:n.length),x=_<l?new Array(_=l-_+1).join(i):"";return m&&(y=Te(x+y)),n+=a,e=y+b,("<"===r?n+e+x:">"===r?x+n+e:"^"===r?x.substring(0,_>>=1)+n+e+x.substring(_):n+(m?e:x+e))+p}};var _e=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,xe=t.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(e,n){return(e=t.round(e,we(e,n))).toFixed(Math.max(0,Math.min(20,we(e*(1+1e-15),n))))}});function we(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Ce(t){return t+""}var Te=ae;if(ye){var Se=ye.length;Te=function(t){for(var e=t.length,n=[],i=0,r=ye[0];e>0&&r>0;)n.push(t.substring(e-=r,e+r)),r=ye[i=(i+1)%Se];return n.reverse().join(",")}}function ke(){}t.geo={},ke.prototype={s:0,t:0,add:function(t){Ee(t,this.t,Ae),Ee(Ae.s,this.s,this),this.s?this.t+=Ae.t:this.s=Ae.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var Ae=new ke;function Ee(t,e,n){var i=n.s=t+e,r=i-t,o=i-r;n.t=t-o+(e-r)}function Me(t,e){t&&De.hasOwnProperty(t.type)&&De[t.type](t,e)}t.geo.stream=function(t,e){t&&Pe.hasOwnProperty(t.type)?Pe[t.type](t,e):Me(t,e)};var Pe={Feature:function(t,e){Me(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Me(n[i].geometry,e)}},De={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Oe(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Oe(n[i],e,0)},Polygon:function(t,e){Ie(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Ie(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Me(n[i],e)}};function Oe(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function Ie(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Oe(t[n],e,1);e.polygonEnd()}t.geo.area=function(e){return Le=0,t.geo.stream(e,qe),Le};var Le,Re,Ne,Fe,Be,ze,je,Ve,He,We,Ue,$e,Ge=new ke,qe={sphere:function(){Le+=4*pt},point:T,lineStart:T,lineEnd:T,polygonStart:function(){Ge.reset(),qe.lineStart=Ye},polygonEnd:function(){var t=2*Ge;Le+=t<0?4*pt+t:t,qe.lineStart=qe.lineEnd=qe.point=T}};function Ye(){var t,e,n,i,r;function o(t,e){e=e*vt/2+pt/4;var o=(t*=vt)-n,a=Math.cos(e),s=Math.sin(e),l=r*s,u=i*a+l*Math.cos(o),c=l*Math.sin(o);Ge.add(Math.atan2(c,u)),n=t,i=a,r=s}qe.point=function(a,s){qe.point=o,n=(t=a)*vt,i=Math.cos(s=(e=s)*vt/2+pt/4),r=Math.sin(s)},qe.lineEnd=function(){o(t,e)}}function Xe(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function Qe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ke(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Je(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ze(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function tn(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function en(t){return[Math.atan2(t[1],t[0]),xt(t[2])]}function nn(t,e){return f(t[0]-e[0])<gt&&f(t[1]-e[1])<gt}t.geo.bounds=function(){var e,n,i,r,o,a,s,l,u,c,h,d={point:p,lineStart:g,lineEnd:v,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=_,u=0,qe.polygonStart()},polygonEnd:function(){qe.polygonEnd(),d.point=p,d.lineStart=g,d.lineEnd=v,Ge<0?(e=-(i=180),n=-(r=90)):u>gt?r=90:u<-gt&&(n=-90),h[0]=e,h[1]=i}};function p(t,o){c.push(h=[e=t,i=t]),o<n&&(n=o),o>r&&(r=o)}function m(t,a){var s=Xe([t*vt,a*vt]);if(l){var u=Ke(l,s),c=Ke([u[1],-u[0],0],u);tn(c),c=en(c);var h=t-o,d=h>0?1:-1,m=c[0]*yt*d,g=f(h)>180;if(g^(d*o<m&&m<d*t))(v=c[1]*yt)>r&&(r=v);else if(g^(d*o<(m=(m+360)%360-180)&&m<d*t)){var v;(v=-c[1]*yt)<n&&(n=v)}else a<n&&(n=a),a>r&&(r=a);g?t<o?x(e,t)>x(e,i)&&(i=t):x(t,i)>x(e,i)&&(e=t):i>=e?(t<e&&(e=t),t>i&&(i=t)):t>o?x(e,t)>x(e,i)&&(i=t):x(t,i)>x(e,i)&&(e=t)}else p(t,a);l=s,o=t}function g(){d.point=m}function v(){h[0]=e,h[1]=i,d.point=p,l=null}function y(t,e){if(l){var n=t-o;u+=f(n)>180?n+(n>0?360:-360):n}else a=t,s=e;qe.point(t,e),m(t,e)}function b(){qe.lineStart()}function _(){y(a,s),qe.lineEnd(),f(u)>gt&&(e=-(i=180)),h[0]=e,h[1]=i,l=null}function x(t,e){return(e-=t)<0?e+360:e}function w(t,e){return t[0]-e[0]}function C(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}return function(o){if(r=i=-(e=n=1/0),c=[],t.geo.stream(o,d),u=c.length){c.sort(w);for(var a=1,s=[m=c[0]];a<u;++a)C((p=c[a])[0],m)||C(p[1],m)?(x(m[0],p[1])>x(m[0],m[1])&&(m[1]=p[1]),x(p[0],m[1])>x(m[0],m[1])&&(m[0]=p[0])):s.push(m=p);for(var l,u,p,f=-1/0,m=(a=0,s[u=s.length-1]);a<=u;m=p,++a)p=s[a],(l=x(m[1],p[0]))>f&&(f=l,e=p[0],i=m[1])}return c=h=null,e===1/0||n===1/0?[[NaN,NaN],[NaN,NaN]]:[[e,n],[i,r]]}}(),t.geo.centroid=function(e){Re=Ne=Fe=Be=ze=je=Ve=He=We=Ue=$e=0,t.geo.stream(e,rn);var n=We,i=Ue,r=$e,o=n*n+i*i+r*r;return o<1e-12&&(n=je,i=Ve,r=He,Ne<gt&&(n=Fe,i=Be,r=ze),(o=n*n+i*i+r*r)<1e-12)?[NaN,NaN]:[Math.atan2(i,n)*yt,xt(r/Math.sqrt(o))*yt]};var rn={sphere:T,point:on,lineStart:sn,lineEnd:ln,polygonStart:function(){rn.lineStart=un},polygonEnd:function(){rn.lineStart=sn}};function on(t,e){t*=vt;var n=Math.cos(e*=vt);an(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function an(t,e,n){++Re,Fe+=(t-Fe)/Re,Be+=(e-Be)/Re,ze+=(n-ze)/Re}function sn(){var t,e,n;function i(i,r){i*=vt;var o=Math.cos(r*=vt),a=o*Math.cos(i),s=o*Math.sin(i),l=Math.sin(r),u=Math.atan2(Math.sqrt((u=e*l-n*s)*u+(u=n*a-t*l)*u+(u=t*s-e*a)*u),t*a+e*s+n*l);Ne+=u,je+=u*(t+(t=a)),Ve+=u*(e+(e=s)),He+=u*(n+(n=l)),an(t,e,n)}rn.point=function(r,o){r*=vt;var a=Math.cos(o*=vt);t=a*Math.cos(r),e=a*Math.sin(r),n=Math.sin(o),rn.point=i,an(t,e,n)}}function ln(){rn.point=on}function un(){var t,e,n,i,r;function o(t,e){t*=vt;var o=Math.cos(e*=vt),a=o*Math.cos(t),s=o*Math.sin(t),l=Math.sin(e),u=i*l-r*s,c=r*a-n*l,h=n*s-i*a,d=Math.sqrt(u*u+c*c+h*h),p=n*a+i*s+r*l,f=d&&-_t(p)/d,m=Math.atan2(d,p);We+=f*u,Ue+=f*c,$e+=f*h,Ne+=m,je+=m*(n+(n=a)),Ve+=m*(i+(i=s)),He+=m*(r+(r=l)),an(n,i,r)}rn.point=function(a,s){t=a,e=s,rn.point=o,a*=vt;var l=Math.cos(s*=vt);n=l*Math.cos(a),i=l*Math.sin(a),r=Math.sin(s),an(n,i,r)},rn.lineEnd=function(){o(t,e),rn.lineEnd=ln,rn.point=on}}function cn(){return!0}function hn(t,e,n,i,r){var o=[],a=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if(nn(n,i)){r.lineStart();for(var s=0;s<e;++s)r.point((n=t[s])[0],n[1]);r.lineEnd()}else{var l=new pn(n,t,null,!0),u=new pn(n,null,l,!1);l.o=u,o.push(l),a.push(u),l=new pn(i,t,null,!1),u=new pn(i,null,l,!0),l.o=u,o.push(l),a.push(u)}}})),a.sort(e),dn(o),dn(a),o.length){for(var s=0,l=n,u=a.length;s<u;++s)a[s].e=l=!l;for(var c,h,d=o[0];;){for(var p=d,f=!0;p.v;)if((p=p.n)===d)return;c=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(s=0,u=c.length;s<u;++s)r.point((h=c[s])[0],h[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(f)for(s=(c=p.p.z).length-1;s>=0;--s)r.point((h=c[s])[0],h[1]);else i(p.x,p.p.x,-1,r);p=p.p}c=(p=p.o).z,f=!f}while(!p.v);r.lineEnd()}}}function dn(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function pn(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function fn(e,n,i,r){return function(o,a){var s,l=n(a),u=o.invert(r[0],r[1]),c={point:h,lineStart:p,lineEnd:m,polygonStart:function(){c.point=_,c.lineStart=x,c.lineEnd=w,s=[],g=[],a.polygonStart()},polygonEnd:function(){c.point=h,c.lineStart=p,c.lineEnd=m,s=t.merge(s);var e=function(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],o=0,a=0;Ge.reset();for(var s=0,l=e.length;s<l;++s){var u=e[s],c=u.length;if(c)for(var h=u[0],d=h[0],p=h[1]/2+pt/4,m=Math.sin(p),g=Math.cos(p),v=1;;){v===c&&(v=0);var y=(t=u[v])[0],b=t[1]/2+pt/4,_=Math.sin(b),x=Math.cos(b),w=y-d,C=f(w)>pt,T=m*_;if(Ge.add(Math.atan2(T*Math.sin(w),g*x+T*Math.cos(w))),o+=C?w+(w>=0?ft:-ft):w,C^d>=n^y>=n){var S=Ke(Xe(h),Xe(t));tn(S);var k=Ke(r,S);tn(k);var A=(C^w>=0?-1:1)*xt(k[2]);(i>A||i===A&&(S[0]||S[1]))&&(a+=C^w>=0?1:-1)}if(!v++)break;d=y,m=_,g=x,h=t}}return(o<-gt||o<gt&&Ge<0)^1&a}(u,g);s.length?hn(s,vn,e,i,a):e&&(a.lineStart(),i(null,null,1,a),a.lineEnd()),a.polygonEnd(),s=g=null},sphere:function(){a.polygonStart(),a.lineStart(),i(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function h(t,n){var i=o(t,n);e(t=i[0],n=i[1])&&a.point(t,n)}function d(t,e){var n=o(t,e);l.point(n[0],n[1])}function p(){c.point=d,l.lineStart()}function m(){c.point=h,l.lineEnd()}var g,v,y=gn(),b=n(y);function _(t,e){v.push([t,e]);var n=o(t,e);b.point(n[0],n[1])}function x(){b.lineStart(),v=[]}function w(){_(v[0][0],v[0][1]),b.lineEnd();var t,e=b.clean(),n=y.buffer(),i=n.length;if(v.pop(),g.push(v),v=null,i)if(1&e){i=(t=n[0]).length-1;var r,o=-1;for(a.lineStart();++o<i;)a.point((r=t[o])[0],r[1]);a.lineEnd()}else i>1&&2&e&&n.push(n.pop().concat(n.shift())),s.push(n.filter(mn))}return c}}function mn(t){return t.length>1}function gn(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:T,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function vn(t,e){return((t=t.x)[0]<0?t[1]-mt-gt:mt-t[1])-((e=e.x)[0]<0?e[1]-mt-gt:mt-e[1])}var yn=fn(cn,(function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?pt:-pt,l=f(o-n);f(l-pt)<gt?(t.point(n,i=(i+a)/2>0?mt:-mt),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),t.point(o,i),e=0):r!==s&&l>=pt&&(f(n-r)<gt&&(n-=r*gt),f(o-s)<gt&&(o-=s*gt),i=function(t,e,n,i){var r,o,a=Math.sin(t-n);return f(a)>gt?Math.atan((Math.sin(e)*(o=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*o*a)):(e+i)/2}(n,i,o,a),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),e=0),t.point(n=o,i=a),r=s},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var r;if(null==t)r=n*mt,i.point(-pt,r),i.point(0,r),i.point(pt,r),i.point(pt,0),i.point(pt,-r),i.point(0,-r),i.point(-pt,-r),i.point(-pt,0),i.point(-pt,r);else if(f(t[0]-e[0])>gt){var o=t[0]<e[0]?pt:-pt;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}),[-pt,-pt/2]);function bn(t){var e=Math.cos(t),n=e>0,i=f(e)>gt;return fn(r,(function(t){var e,s,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var p,f=[h,d],m=r(h,d),g=n?m?0:a(h,d):m?a(h+(h<0?pt:-pt),d):0;if(!e&&(u=l=m)&&t.lineStart(),m!==l&&(p=o(e,f),(nn(e,p)||nn(f,p))&&(f[0]+=gt,f[1]+=gt,m=r(f[0],f[1]))),m!==l)c=0,m?(t.lineStart(),p=o(f,e),t.point(p[0],p[1])):(p=o(e,f),t.point(p[0],p[1]),t.lineEnd()),e=p;else if(i&&e&&n^m){var v;g&s||!(v=o(f,e,!0))||(c=0,n?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!m||e&&nn(e,f)||t.point(f[0],f[1]),e=f,l=m,s=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),ti(t,6*vt),n?[0,-t]:[-pt,t-pt]);function r(t,n){return Math.cos(t)*Math.cos(n)>e}function o(t,n,i){var r=[1,0,0],o=Ke(Xe(t),Xe(n)),a=Qe(o,o),s=o[0],l=a-s*s;if(!l)return!i&&t;var u=e*a/l,c=-e*s/l,h=Ke(r,o),d=Ze(r,u);Je(d,Ze(o,c));var p=h,m=Qe(d,p),g=Qe(p,p),v=m*m-g*(Qe(d,d)-1);if(!(v<0)){var y=Math.sqrt(v),b=Ze(p,(-m-y)/g);if(Je(b,d),b=en(b),!i)return b;var _,x=t[0],w=n[0],C=t[1],T=n[1];w<x&&(_=x,x=w,w=_);var S=w-x,k=f(S-pt)<gt;if(!k&&T<C&&(_=C,C=T,T=_),k||S<gt?k?C+T>0^b[1]<(f(b[0]-x)<gt?C:T):C<=b[1]&&b[1]<=T:S>pt^(x<=b[0]&&b[0]<=w)){var A=Ze(p,(-m+y)/g);return Je(A,d),[b,en(A)]}}}function a(e,i){var r=n?t:pt-t,o=0;return e<-r?o|=1:e>r&&(o|=2),i<-r?o|=4:i>r&&(o|=8),o}}function _n(t,e,n,i){return function(r){var o,a=r.a,s=r.b,l=a.x,u=a.y,c=0,h=1,d=s.x-l,p=s.y-u;if(o=t-l,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<h&&(h=o)}else if(d>0){if(o>h)return;o>c&&(c=o)}if(o=n-l,d||!(o<0)){if(o/=d,d<0){if(o>h)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<h&&(h=o)}if(o=e-u,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<h&&(h=o)}else if(p>0){if(o>h)return;o>c&&(c=o)}if(o=i-u,p||!(o<0)){if(o/=p,p<0){if(o>h)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<h&&(h=o)}return c>0&&(r.a={x:l+c*d,y:u+c*p}),h<1&&(r.b={x:l+h*d,y:u+h*p}),r}}}}}}function xn(e,n,i,r){return function(l){var u,c,h,d,p,f,m,g,v,y,b,_=l,x=gn(),w=_n(e,n,i,r),C={point:A,lineStart:function(){C.point=E,c&&c.push(h=[]);y=!0,v=!1,m=g=NaN},lineEnd:function(){u&&(E(d,p),f&&v&&x.rejoin(),u.push(x.buffer()));C.point=A,v&&l.lineEnd()},polygonStart:function(){l=x,u=[],c=[],b=!0},polygonEnd:function(){l=_,u=t.merge(u);var n=function(t){for(var e=0,n=c.length,i=t[1],r=0;r<n;++r)for(var o,a=1,s=c[r],l=s.length,u=s[0];a<l;++a)o=s[a],u[1]<=i?o[1]>i&&T(u,o,t)>0&&++e:o[1]<=i&&T(u,o,t)<0&&--e,u=o;return 0!==e}([e,r]),i=b&&n,o=u.length;(i||o)&&(l.polygonStart(),i&&(l.lineStart(),S(null,null,1,l),l.lineEnd()),o&&hn(u,a,n,S,l),l.polygonEnd()),u=c=h=null}};function T(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function S(t,a,l,u){var c=0,h=0;if(null==t||(c=o(t,l))!==(h=o(a,l))||s(t,a)<0^l>0)do{u.point(0===c||3===c?e:i,c>1?r:n)}while((c=(c+l+4)%4)!==h);else u.point(a[0],a[1])}function k(t,o){return e<=t&&t<=i&&n<=o&&o<=r}function A(t,e){k(t,e)&&l.point(t,e)}function E(t,e){var n=k(t=Math.max(-1e9,Math.min(1e9,t)),e=Math.max(-1e9,Math.min(1e9,e)));if(c&&h.push([t,e]),y)d=t,p=e,f=n,y=!1,n&&(l.lineStart(),l.point(t,e));else if(n&&v)l.point(t,e);else{var i={a:{x:m,y:g},b:{x:t,y:e}};w(i)?(v||(l.lineStart(),l.point(i.a.x,i.a.y)),l.point(i.b.x,i.b.y),n||l.lineEnd(),b=!1):n&&(l.lineStart(),l.point(t,e),b=!1)}m=t,g=e,v=n}return C};function o(t,r){return f(t[0]-e)<gt?r>0?0:3:f(t[0]-i)<gt?r>0?2:1:f(t[1]-n)<gt?r>0?1:0:r>0?3:2}function a(t,e){return s(t.x,e.x)}function s(t,e){var n=o(t,1),i=o(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}}function wn(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function Cn(t){var e=0,n=pt/3,i=qn(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*pt/180,n=t[1]*pt/180):[e/pt*180,n/pt*180]},r}function Tn(t,e){var n=Math.sin(t),i=(n+Math.sin(e))/2,r=1+n*(2*i-n),o=Math.sqrt(r)/i;function a(t,e){var n=Math.sqrt(r-2*i*Math.sin(e))/i;return[n*Math.sin(t*=i),o-n*Math.cos(t)]}return a.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/i,xt((r-(t*t+n*n)*i*i)/(2*i))]},a}t.geo.clipExtent=function(){var t,e,n,i,r,o,a={stream:function(t){return r&&(r.valid=!1),(r=o(t)).valid=!0,r},extent:function(s){return arguments.length?(o=xn(t=+s[0][0],e=+s[0][1],n=+s[1][0],i=+s[1][1]),r&&(r.valid=!1,r=null),a):[[t,e],[n,i]]}};return a.extent([[0,0],[960,500]])},(t.geo.conicEqualArea=function(){return Cn(Tn)}).raw=Tn,t.geo.albers=function(){return t.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},t.geo.albersUsa=function(){var e,n,i,r,o=t.geo.albers(),a=t.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=t.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,n){e=[t,n]}};function u(t){var o=t[0],a=t[1];return e=null,n(o,a),e||(i(o,a),e)||r(o,a),e}return u.invert=function(t){var e=o.scale(),n=o.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&r<.234&&i>=-.425&&i<-.214?a:r>=.166&&r<.234&&i>=-.214&&i<-.115?s:o).invert(t)},u.stream=function(t){var e=o.stream(t),n=a.stream(t),i=s.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},u.precision=function(t){return arguments.length?(o.precision(t),a.precision(t),s.precision(t),u):o.precision()},u.scale=function(t){return arguments.length?(o.scale(t),a.scale(.35*t),s.scale(t),u.translate(o.translate())):o.scale()},u.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),c=+t[0],h=+t[1];return n=o.translate(t).clipExtent([[c-.455*e,h-.238*e],[c+.455*e,h+.238*e]]).stream(l).point,i=a.translate([c-.307*e,h+.201*e]).clipExtent([[c-.425*e+gt,h+.12*e+gt],[c-.214*e-gt,h+.234*e-gt]]).stream(l).point,r=s.translate([c-.205*e,h+.212*e]).clipExtent([[c-.214*e+gt,h+.166*e+gt],[c-.115*e-gt,h+.234*e-gt]]).stream(l).point,u},u.scale(1070)};var Sn,kn,An,En,Mn,Pn,Dn={point:T,lineStart:T,lineEnd:T,polygonStart:function(){kn=0,Dn.lineStart=On},polygonEnd:function(){Dn.lineStart=Dn.lineEnd=Dn.point=T,Sn+=f(kn/2)}};function On(){var t,e,n,i;function r(t,e){kn+=i*t-n*e,n=t,i=e}Dn.point=function(o,a){Dn.point=r,t=n=o,e=i=a},Dn.lineEnd=function(){r(t,e)}}var In={point:function(t,e){t<An&&(An=t);t>Mn&&(Mn=t);e<En&&(En=e);e>Pn&&(Pn=e)},lineStart:T,lineEnd:T,polygonStart:T,polygonEnd:T};function Ln(){var t=Rn(4.5),e=[],n={point:i,lineStart:function(){n.point=r},lineEnd:a,polygonStart:function(){n.lineEnd=s},polygonEnd:function(){n.lineEnd=a,n.point=i},pointRadius:function(e){return t=Rn(e),n},result:function(){if(e.length){var t=e.join("");return e=[],t}}};function i(n,i){e.push("M",n,",",i,t)}function r(t,i){e.push("M",t,",",i),n.point=o}function o(t,n){e.push("L",t,",",n)}function a(){n.point=i}function s(){e.push("Z")}return n}function Rn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var Nn,Fn={point:Bn,lineStart:zn,lineEnd:jn,polygonStart:function(){Fn.lineStart=Vn},polygonEnd:function(){Fn.point=Bn,Fn.lineStart=zn,Fn.lineEnd=jn}};function Bn(t,e){Fe+=t,Be+=e,++ze}function zn(){var t,e;function n(n,i){var r=n-t,o=i-e,a=Math.sqrt(r*r+o*o);je+=a*(t+n)/2,Ve+=a*(e+i)/2,He+=a,Bn(t=n,e=i)}Fn.point=function(i,r){Fn.point=n,Bn(t=i,e=r)}}function jn(){Fn.point=Bn}function Vn(){var t,e,n,i;function r(t,e){var r=t-n,o=e-i,a=Math.sqrt(r*r+o*o);je+=a*(n+t)/2,Ve+=a*(i+e)/2,He+=a,We+=(a=i*t-n*e)*(n+t),Ue+=a*(i+e),$e+=3*a,Bn(n=t,i=e)}Fn.point=function(o,a){Fn.point=r,Bn(t=n=o,e=i=a)},Fn.lineEnd=function(){r(t,e)}}function Hn(t){var e=4.5,n={point:i,lineStart:function(){n.point=r},lineEnd:a,polygonStart:function(){n.lineEnd=s},polygonEnd:function(){n.lineEnd=a,n.point=i},pointRadius:function(t){return e=t,n},result:T};function i(n,i){t.moveTo(n,i),t.arc(n,i,e,0,ft)}function r(e,i){t.moveTo(e,i),n.point=o}function o(e,n){t.lineTo(e,n)}function a(){n.point=i}function s(){t.closePath()}return n}function Wn(t){var e=.5,n=Math.cos(30*vt),i=16;function r(e){var n,r,a,s,l,u,c,h,d,p,f,m,g={point:v,lineStart:y,lineEnd:_,polygonStart:function(){e.polygonStart(),g.lineStart=x},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function v(n,i){n=t(n,i),e.point(n[0],n[1])}function y(){h=NaN,g.point=b,e.lineStart()}function b(n,r){var a=Xe([n,r]),s=t(n,r);o(h,d,c,p,f,m,h=s[0],d=s[1],c=n,p=a[0],f=a[1],m=a[2],i,e),e.point(h,d)}function _(){g.point=v,e.lineEnd()}function x(){y(),g.point=w,g.lineEnd=C}function w(t,e){b(n=t,e),r=h,a=d,s=p,l=f,u=m,g.point=b}function C(){o(h,d,c,p,f,m,r,a,n,s,l,u,i,e),g.lineEnd=_,_()}return g}function o(i,r,a,s,l,u,c,h,d,p,m,g,v,y){var b=c-i,_=h-r,x=b*b+_*_;if(x>4*e&&v--){var w=s+p,C=l+m,T=u+g,S=Math.sqrt(w*w+C*C+T*T),k=Math.asin(T/=S),A=f(f(T)-1)<gt?(a+d)/2:Math.atan2(C,w),E=t(A,k),M=E[0],P=E[1],D=M-i,O=P-r,I=_*D-b*O;(I*I/x>e||f((b*D+_*O)/x-.5)>.3||s*p+l*m+u*g<n)&&(o(i,r,a,s,l,u,M,P,A,w/=S,C/=S,T,v,y),y.point(M,P),o(M,P,A,w,C,T,c,h,d,p,m,g,v,y))}}return r.precision=function(t){return arguments.length?(i=(e=t*t)>0&&16,r):Math.sqrt(e)},r}function Un(t){this.stream=t}function $n(t){var e=Wn((function(e,n){return t([e*yt,n*yt])}));return function(t){var n=new Un(t=e(t));return n.point=function(e,n){t.point(e*vt,n*vt)},n}}function Gn(t){return qn((function(){return t}))()}function qn(e){var n,i,r,o,a,s,l=Wn((function(t,e){return[(t=n(t,e))[0]*u+o,a-t[1]*u]})),u=150,c=480,h=250,d=0,p=0,f=0,m=0,g=0,v=yn,y=ae,b=null,_=null;function x(t){return[(t=r(t[0]*vt,t[1]*vt))[0]*u+o,a-t[1]*u]}function w(t){return(t=r.invert((t[0]-o)/u,(a-t[1])/u))&&[t[0]*yt,t[1]*yt]}function C(){r=wn(i=Qn(f,m,g),n);var t=n(d,p);return o=c-t[0]*u,a=h+t[1]*u,T()}function T(){return s&&(s.valid=!1,s=null),x}return x.stream=function(t){return s&&(s.valid=!1),(s=function(t){var e=new Un(t);return e.point=function(e,n){t.point(e*vt,n*vt)},e}(v(i,l(y(t))))).valid=!0,s},x.clipAngle=function(t){return arguments.length?(v=null==t?(b=t,yn):bn((b=+t)*vt),T()):b},x.clipExtent=function(t){return arguments.length?(_=t,y=t?xn(t[0][0],t[0][1],t[1][0],t[1][1]):ae,T()):_},x.scale=function(t){return arguments.length?(u=+t,C()):u},x.translate=function(t){return arguments.length?(c=+t[0],h=+t[1],C()):[c,h]},x.center=function(t){return arguments.length?(d=t[0]%360*vt,p=t[1]%360*vt,C()):[d*yt,p*yt]},x.rotate=function(t){return arguments.length?(f=t[0]%360*vt,m=t[1]%360*vt,g=t.length>2?t[2]%360*vt:0,C()):[f*yt,m*yt,g*yt]},t.rebind(x,l,"precision"),function(){return n=e.apply(this,arguments),x.invert=n.invert&&w,C()}}function Yn(t,e){return[t,e]}function Xn(t,e){return[t>pt?t-ft:t<-pt?t+ft:t,e]}function Qn(t,e,n){return t?e||n?wn(Jn(t),Zn(e,n)):Jn(t):e||n?Zn(e,n):Xn}function Kn(t){return function(e,n){return[(e+=t)>pt?e-ft:e<-pt?e+ft:e,n]}}function Jn(t){var e=Kn(t);return e.invert=Kn(-t),e}function Zn(t,e){var n=Math.cos(t),i=Math.sin(t),r=Math.cos(e),o=Math.sin(e);function a(t,e){var a=Math.cos(e),s=Math.cos(t)*a,l=Math.sin(t)*a,u=Math.sin(e),c=u*n+s*i;return[Math.atan2(l*r-c*o,s*n-u*i),xt(c*r+l*o)]}return a.invert=function(t,e){var a=Math.cos(e),s=Math.cos(t)*a,l=Math.sin(t)*a,u=Math.sin(e),c=u*r-l*o;return[Math.atan2(l*r+u*o,s*n+c*i),xt(c*n-s*i)]},a}function ti(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,o,a,s){var l=a*e;null!=r?(r=ei(n,r),o=ei(n,o),(a>0?r<o:r>o)&&(r+=a*ft)):(r=t+a*ft,o=t-.5*l);for(var u,c=r;a>0?c>o:c<o;c-=l)s.point((u=en([n,-i*Math.cos(c),-i*Math.sin(c)]))[0],u[1])}}function ei(t,e){var n=Xe(e);n[0]-=t,tn(n);var i=_t(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-gt)%(2*Math.PI)}function ni(e,n,i){var r=t.range(e,n-gt,i).concat(n);return function(t){return r.map((function(e){return[t,e]}))}}function ii(e,n,i){var r=t.range(e,n-gt,i).concat(n);return function(t){return r.map((function(e){return[e,t]}))}}function ri(t){return t.source}function oi(t){return t.target}t.geo.transform=function(t){return{stream:function(e){var n=new Un(e);for(var i in t)n[i]=t[i];return n}}},Un.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},t.geo.path=function(){var e,n,i,r,o,a=4.5;function s(e){return e&&("function"==typeof a&&r.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=i(r)),t.geo.stream(e,o)),r.result()}function l(){return o=null,s}return s.area=function(e){return Sn=0,t.geo.stream(e,i(Dn)),Sn},s.centroid=function(e){return Fe=Be=ze=je=Ve=He=We=Ue=$e=0,t.geo.stream(e,i(Fn)),$e?[We/$e,Ue/$e]:He?[je/He,Ve/He]:ze?[Fe/ze,Be/ze]:[NaN,NaN]},s.bounds=function(e){return Mn=Pn=-(An=En=1/0),t.geo.stream(e,i(In)),[[An,En],[Mn,Pn]]},s.projection=function(t){return arguments.length?(i=(e=t)?t.stream||$n(t):ae,l()):e},s.context=function(t){return arguments.length?(r=null==(n=t)?new Ln:new Hn(t),"function"!=typeof a&&r.pointRadius(a),l()):n},s.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(r.pointRadius(+t),+t),s):a},s.projection(t.geo.albersUsa()).context(null)},t.geo.projection=Gn,t.geo.projectionMutator=qn,(t.geo.equirectangular=function(){return Gn(Yn)}).raw=Yn.invert=Yn,t.geo.rotation=function(t){function e(e){return(e=t(e[0]*vt,e[1]*vt))[0]*=yt,e[1]*=yt,e}return t=Qn(t[0]%360*vt,t[1]*vt,t.length>2?t[2]*vt:0),e.invert=function(e){return(e=t.invert(e[0]*vt,e[1]*vt))[0]*=yt,e[1]*=yt,e},e},Xn.invert=Yn,t.geo.circle=function(){var t,e,n=[0,0],i=6;function r(){var t="function"==typeof n?n.apply(this,arguments):n,i=Qn(-t[0]*vt,-t[1]*vt,0).invert,r=[];return e(null,null,1,{point:function(t,e){r.push(t=i(t,e)),t[0]*=yt,t[1]*=yt}}),{type:"Polygon",coordinates:[r]}}return r.origin=function(t){return arguments.length?(n=t,r):n},r.angle=function(n){return arguments.length?(e=ti((t=+n)*vt,i*vt),r):t},r.precision=function(n){return arguments.length?(e=ti(t*vt,(i=+n)*vt),r):i},r.angle(90)},t.geo.distance=function(t,e){var n,i=(e[0]-t[0])*vt,r=t[1]*vt,o=e[1]*vt,a=Math.sin(i),s=Math.cos(i),l=Math.sin(r),u=Math.cos(r),c=Math.sin(o),h=Math.cos(o);return Math.atan2(Math.sqrt((n=h*a)*n+(n=u*c-l*h*s)*n),l*c+u*h*s)},t.geo.graticule=function(){var e,n,i,r,o,a,s,l,u,c,h,d,p=10,m=p,g=90,v=360,y=2.5;function b(){return{type:"MultiLineString",coordinates:_()}}function _(){return t.range(Math.ceil(r/g)*g,i,g).map(h).concat(t.range(Math.ceil(l/v)*v,s,v).map(d)).concat(t.range(Math.ceil(n/p)*p,e,p).filter((function(t){return f(t%g)>gt})).map(u)).concat(t.range(Math.ceil(a/m)*m,o,m).filter((function(t){return f(t%v)>gt})).map(c))}return b.lines=function(){return _().map((function(t){return{type:"LineString",coordinates:t}}))},b.outline=function(){return{type:"Polygon",coordinates:[h(r).concat(d(s).slice(1),h(i).reverse().slice(1),d(l).reverse().slice(1))]}},b.extent=function(t){return arguments.length?b.majorExtent(t).minorExtent(t):b.minorExtent()},b.majorExtent=function(t){return arguments.length?(r=+t[0][0],i=+t[1][0],l=+t[0][1],s=+t[1][1],r>i&&(t=r,r=i,i=t),l>s&&(t=l,l=s,s=t),b.precision(y)):[[r,l],[i,s]]},b.minorExtent=function(t){return arguments.length?(n=+t[0][0],e=+t[1][0],a=+t[0][1],o=+t[1][1],n>e&&(t=n,n=e,e=t),a>o&&(t=a,a=o,o=t),b.precision(y)):[[n,a],[e,o]]},b.step=function(t){return arguments.length?b.majorStep(t).minorStep(t):b.minorStep()},b.majorStep=function(t){return arguments.length?(g=+t[0],v=+t[1],b):[g,v]},b.minorStep=function(t){return arguments.length?(p=+t[0],m=+t[1],b):[p,m]},b.precision=function(t){return arguments.length?(y=+t,u=ni(a,o,90),c=ii(n,e,y),h=ni(l,s,90),d=ii(r,i,y),b):y},b.majorExtent([[-180,-90+gt],[180,90-gt]]).minorExtent([[-180,-80-gt],[180,80+gt]])},t.geo.greatArc=function(){var e,n,i=ri,r=oi;function o(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),n||r.apply(this,arguments)]}}return o.distance=function(){return t.geo.distance(e||i.apply(this,arguments),n||r.apply(this,arguments))},o.source=function(t){return arguments.length?(i=t,e="function"==typeof t?null:t,o):i},o.target=function(t){return arguments.length?(r=t,n="function"==typeof t?null:t,o):r},o.precision=function(){return arguments.length?o:0},o},t.geo.interpolate=function(t,e){return n=t[0]*vt,i=t[1]*vt,r=e[0]*vt,o=e[1]*vt,a=Math.cos(i),s=Math.sin(i),l=Math.cos(o),u=Math.sin(o),c=a*Math.cos(n),h=a*Math.sin(n),d=l*Math.cos(r),p=l*Math.sin(r),f=2*Math.asin(Math.sqrt(Tt(o-i)+a*l*Tt(r-n))),m=1/Math.sin(f),(g=f?function(t){var e=Math.sin(t*=f)*m,n=Math.sin(f-t)*m,i=n*c+e*d,r=n*h+e*p,o=n*s+e*u;return[Math.atan2(r,i)*yt,Math.atan2(o,Math.sqrt(i*i+r*r))*yt]}:function(){return[n*yt,i*yt]}).distance=f,g;var n,i,r,o,a,s,l,u,c,h,d,p,f,m,g},t.geo.length=function(e){return Nn=0,t.geo.stream(e,ai),Nn};var ai={sphere:T,point:T,lineStart:function(){var t,e,n;function i(i,r){var o=Math.sin(r*=vt),a=Math.cos(r),s=f((i*=vt)-t),l=Math.cos(s);Nn+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=n*o-e*a*l)*s),e*o+n*a*l),t=i,e=o,n=a}ai.point=function(r,o){t=r*vt,e=Math.sin(o*=vt),n=Math.cos(o),ai.point=i},ai.lineEnd=function(){ai.point=ai.lineEnd=T}},lineEnd:T,polygonStart:T,polygonEnd:T};function si(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),o=t(i*r);return[o*r*Math.sin(e),o*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),o=Math.sin(r),a=Math.cos(r);return[Math.atan2(t*o,i*a),Math.asin(i&&n*o/i)]},n}var li=si((function(t){return Math.sqrt(2/(1+t))}),(function(t){return 2*Math.asin(t/2)}));(t.geo.azimuthalEqualArea=function(){return Gn(li)}).raw=li;var ui=si((function(t){var e=Math.acos(t);return e&&e/Math.sin(e)}),ae);function ci(t,e){var n=Math.cos(t),i=function(t){return Math.tan(pt/4+t/2)},r=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(i(e)/i(t)),o=n*Math.pow(i(t),r)/r;if(!r)return pi;function a(t,e){var n=f(f(e)-mt)<gt?0:o/Math.pow(i(e),r);return[n*Math.sin(r*t),o-n*Math.cos(r*t)]}return a.invert=function(t,e){var n=o-e,i=bt(r)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/r,2*Math.atan(Math.pow(o/i,1/r))-mt]},a}function hi(t,e){var n=Math.cos(t),i=t===e?Math.sin(t):(n-Math.cos(e))/(e-t),r=n/i+t;if(f(i)<gt)return Yn;function o(t,e){var n=r-e;return[n*Math.sin(i*t),r-n*Math.cos(i*t)]}return o.invert=function(t,e){var n=r-e;return[Math.atan2(t,n)/i,r-bt(i)*Math.sqrt(t*t+n*n)]},o}(t.geo.azimuthalEquidistant=function(){return Gn(ui)}).raw=ui,(t.geo.conicConformal=function(){return Cn(ci)}).raw=ci,(t.geo.conicEquidistant=function(){return Cn(hi)}).raw=hi;var di=si((function(t){return 1/t}),Math.atan);function pi(t,e){return[t,Math.log(Math.tan(pt/4+e/2))]}function fi(t){var e,n=Gn(t),i=n.scale,r=n.translate,o=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var a=o.apply(n,arguments);if(a===n){if(e=null==t){var s=pt*i(),l=r();o([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else e&&(a=null);return a},n.clipExtent(null)}(t.geo.gnomonic=function(){return Gn(di)}).raw=di,pi.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-mt]},(t.geo.mercator=function(){return fi(pi)}).raw=pi;var mi=si((function(){return 1}),Math.asin);(t.geo.orthographic=function(){return Gn(mi)}).raw=mi;var gi=si((function(t){return 1/(1+t)}),(function(t){return 2*Math.atan(t)}));function vi(t,e){var n=Math.cos(e)*Math.sin(t);return[Math.log((1+n)/(1-n))/2,Math.atan2(Math.tan(e),Math.cos(t))]}function yi(t){return t[0]}function bi(t){return t[1]}function _i(t,e,n,i){var r,o,a,s,l,u;return o=(r=i[t])[0],a=r[1],s=(r=i[e])[0],l=r[1],u=(r=i[n])[0],(r[1]-a)*(s-o)-(l-a)*(u-o)>0}(t.geo.stereographic=function(){return Gn(gi)}).raw=gi,vi.invert=function(t,e){return[Math.atan2(wt(t),Math.cos(e)),xt(Math.sin(e)/Ct(t))]},(t.geo.transverseMercator=function(){return fi(vi)}).raw=vi,t.geom={},t.geom.hull=function(t){var e=yi,n=bi;if(arguments.length)return i(t);function i(t){if(t.length<3)return[];var i,r,o,a,s,l,u,c,h,d,p,f,m=oe(e),g=oe(n),v=t.length,y=v-1,b=[],_=[],x=0;if(m===yi&&n===bi)i=t;else for(o=0,i=[];o<v;++o)i.push([+m.call(this,r=t[o],o),+g.call(this,r,o)]);for(o=1;o<v;++o)(i[o][1]<i[x][1]||i[o][1]==i[x][1]&&i[o][0]<i[x][0])&&(x=o);for(o=0;o<v;++o)o!==x&&(l=i[o][1]-i[x][1],s=i[o][0]-i[x][0],b.push({angle:Math.atan2(l,s),index:o}));for(b.sort((function(t,e){return t.angle-e.angle})),p=b[0].angle,d=b[0].index,h=0,o=1;o<y;++o){if(a=b[o].index,p==b[o].angle){if((s=i[d][0]-i[x][0])*s+(l=i[d][1]-i[x][1])*l>=(u=i[a][0]-i[x][0])*u+(c=i[a][1]-i[x][1])*c){b[o].index=-1;continue}b[h].index=-1}p=b[o].angle,h=o,d=a}for(_.push(x),o=0,a=0;o<2;++a)b[a].index>-1&&(_.push(b[a].index),o++);for(f=_.length;a<y;++a)if(!(b[a].index<0)){for(;!_i(_[f-2],_[f-1],b[a].index,i);)--f;_[f++]=b[a].index}var w=[];for(o=f-1;o>=0;--o)w.push(t[_[o]]);return w}return i.x=function(t){return arguments.length?(e=t,i):e},i.y=function(t){return arguments.length?(n=t,i):n},i},t.geom.polygon=function(t){return D(t,xi),t};var xi=t.geom.polygon.prototype=[];function wi(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Ci(t,e,n,i){var r=t[0],o=n[0],a=e[0]-r,s=i[0]-o,l=t[1],u=n[1],c=e[1]-l,h=i[1]-u,d=(s*(l-u)-h*(r-o))/(h*a-s*c);return[r+d*a,l+d*c]}function Ti(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}xi.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],r=0;++e<n;)t=i,i=this[e],r+=t[1]*i[0]-t[0]*i[1];return.5*r},xi.centroid=function(t){var e,n,i=-1,r=this.length,o=0,a=0,s=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++i<r;)e=s,s=this[i],n=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return[o*t,a*t]},xi.clip=function(t){for(var e,n,i,r,o,a,s=Ti(t),l=-1,u=this.length-Ti(this),c=this[u-1];++l<u;){for(e=t.slice(),t.length=0,r=this[l],o=e[(i=e.length-s)-1],n=-1;++n<i;)wi(a=e[n],c,r)?(wi(o,c,r)||t.push(Ci(o,a,c,r)),t.push(a)):wi(o,c,r)&&t.push(Ci(o,a,c,r)),o=a;s&&t.push(t[0]),c=r}return t};var Si,ki,Ai,Ei,Mi,Pi=[],Di=[];function Oi(){Ki(this),this.edge=this.site=this.circle=null}function Ii(t){var e=Pi.pop()||new Oi;return e.site=t,e}function Li(t){Wi(t),Ai.remove(t),Pi.push(t),Ki(t)}function Ri(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},o=t.P,a=t.N,s=[t];Li(t);for(var l=o;l.circle&&f(n-l.circle.x)<gt&&f(i-l.circle.cy)<gt;)o=l.P,s.unshift(l),Li(l),l=o;s.unshift(l),Wi(l);for(var u=a;u.circle&&f(n-u.circle.x)<gt&&f(i-u.circle.cy)<gt;)a=u.N,s.push(u),Li(u),u=a;s.push(u),Wi(u);var c,h=s.length;for(c=1;c<h;++c)u=s[c],l=s[c-1],Yi(u.edge,l.site,u.site,r);l=s[0],(u=s[h-1]).edge=Gi(l.site,u.site,null,r),Hi(l),Hi(u)}function Ni(t){for(var e,n,i,r,o=t.x,a=t.y,s=Ai._;s;)if((i=Fi(s,a)-o)>gt)s=s.L;else{if(!((r=o-Bi(s,a))>gt)){i>-gt?(e=s.P,n=s):r>-gt?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}var l=Ii(t);if(Ai.insert(e,l),e||n){if(e===n)return Wi(e),n=Ii(e.site),Ai.insert(l,n),l.edge=n.edge=Gi(e.site,l.site),Hi(e),void Hi(n);if(n){Wi(e),Wi(n);var u=e.site,c=u.x,h=u.y,d=t.x-c,p=t.y-h,f=n.site,m=f.x-c,g=f.y-h,v=2*(d*g-p*m),y=d*d+p*p,b=m*m+g*g,_={x:(g*y-p*b)/v+c,y:(d*b-m*y)/v+h};Yi(n.edge,u,f,_),l.edge=Gi(u,t,null,_),n.edge=Gi(t,f,null,_),Hi(e),Hi(n)}else l.edge=Gi(e.site,l.site)}}function Fi(t,e){var n=t.site,i=n.x,r=n.y,o=r-e;if(!o)return i;var a=t.P;if(!a)return-1/0;var s=(n=a.site).x,l=n.y,u=l-e;if(!u)return s;var c=s-i,h=1/o-1/u,d=c/u;return h?(-d+Math.sqrt(d*d-2*h*(c*c/(-2*u)-l+u/2+r-o/2)))/h+i:(i+s)/2}function Bi(t,e){var n=t.N;if(n)return Fi(n,e);var i=t.site;return i.y===e?i.x:1/0}function zi(t){this.site=t,this.edges=[]}function ji(t,e){return e.angle-t.angle}function Vi(){Ki(this),this.x=this.y=this.arc=this.site=this.cy=null}function Hi(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var a=r.x,s=r.y,l=i.x-a,u=i.y-s,c=o.x-a,h=2*(l*(g=o.y-s)-u*c);if(!(h>=-1e-12)){var d=l*l+u*u,p=c*c+g*g,f=(g*d-u*p)/h,m=(l*p-c*d)/h,g=m+s,v=Di.pop()||new Vi;v.arc=t,v.site=r,v.x=f+a,v.y=g+Math.sqrt(f*f+m*m),v.cy=g,t.circle=v;for(var y=null,b=Mi._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}Mi.insert(y,v),y||(Ei=v)}}}}function Wi(t){var e=t.circle;e&&(e.P||(Ei=e.N),Mi.remove(e),Di.push(e),Ki(e),t.circle=null)}function Ui(t,e){var n=t.b;if(n)return!0;var i,r,o=t.a,a=e[0][0],s=e[1][0],l=e[0][1],u=e[1][1],c=t.l,h=t.r,d=c.x,p=c.y,f=h.x,m=h.y,g=(d+f)/2,v=(p+m)/2;if(m===p){if(g<a||g>=s)return;if(d>f){if(o){if(o.y>=u)return}else o={x:g,y:l};n={x:g,y:u}}else{if(o){if(o.y<l)return}else o={x:g,y:u};n={x:g,y:l}}}else if(r=v-(i=(d-f)/(m-p))*g,i<-1||i>1)if(d>f){if(o){if(o.y>=u)return}else o={x:(l-r)/i,y:l};n={x:(u-r)/i,y:u}}else{if(o){if(o.y<l)return}else o={x:(u-r)/i,y:u};n={x:(l-r)/i,y:l}}else if(p<m){if(o){if(o.x>=s)return}else o={x:a,y:i*a+r};n={x:s,y:i*s+r}}else{if(o){if(o.x<a)return}else o={x:s,y:i*s+r};n={x:a,y:i*a+r}}return t.a=o,t.b=n,!0}function $i(t,e){this.l=t,this.r=e,this.a=this.b=null}function Gi(t,e,n,i){var r=new $i(t,e);return Si.push(r),n&&Yi(r,t,e,n),i&&Yi(r,e,t,i),ki[t.i].edges.push(new Xi(r,t,e)),ki[e.i].edges.push(new Xi(r,e,t)),r}function qi(t,e,n){var i=new $i(t,null);return i.a=e,i.b=n,Si.push(i),i}function Yi(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function Xi(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function Qi(){this._=null}function Ki(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Ji(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Zi(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function tr(t){for(;t.L;)t=t.L;return t}function er(t,e){var n,i,r,o=t.sort(nr).pop();for(Si=[],ki=new Array(t.length),Ai=new Qi,Mi=new Qi;;)if(r=Ei,o&&(!r||o.y<r.y||o.y===r.y&&o.x<r.x))o.x===n&&o.y===i||(ki[o.i]=new zi(o),Ni(o),n=o.x,i=o.y),o=t.pop();else{if(!r)break;Ri(r.arc)}e&&(function(t){for(var e,n=Si,i=_n(t[0][0],t[0][1],t[1][0],t[1][1]),r=n.length;r--;)(!Ui(e=n[r],t)||!i(e)||f(e.a.x-e.b.x)<gt&&f(e.a.y-e.b.y)<gt)&&(e.a=e.b=null,n.splice(r,1))}(e),function(t){for(var e,n,i,r,o,a,s,l,u,c,h=t[0][0],d=t[1][0],p=t[0][1],m=t[1][1],g=ki,v=g.length;v--;)if((o=g[v])&&o.prepare())for(l=(s=o.edges).length,a=0;a<l;)i=(c=s[a].end()).x,r=c.y,e=(u=s[++a%l].start()).x,n=u.y,(f(i-e)>gt||f(r-n)>gt)&&(s.splice(a,0,new Xi(qi(o.site,c,f(i-h)<gt&&m-r>gt?{x:h,y:f(e-h)<gt?n:m}:f(r-m)<gt&&d-i>gt?{x:f(n-m)<gt?e:d,y:m}:f(i-d)<gt&&r-p>gt?{x:d,y:f(e-d)<gt?n:p}:f(r-p)<gt&&i-h>gt?{x:f(n-p)<gt?e:h,y:p}:null),o.site,null)),++l)}(e));var a={cells:ki,edges:Si};return Ai=Mi=Si=ki=null,a}function nr(t,e){return e.y-t.y||e.x-t.x}zi.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)(t=e[n].edge).b&&t.a||e.splice(n,1);return e.sort(ji),e.length},Xi.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Qi.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=tr(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(Ji(this,n),n=(t=n).U),n.C=!1,i.C=!0,Zi(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(Zi(this,n),n=(t=n).U),n.C=!1,i.C=!0,Ji(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,a=t.R;if(n=o?a?tr(a):o:a,r?r.L===t?r.L=n:r.R=n:this._=n,o&&a?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=a,a.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,Ji(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Zi(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,Ji(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,Zi(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Ji(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Zi(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},t.geom.voronoi=function(t){var e=yi,n=bi,i=e,r=n,o=ir;if(t)return a(t);function a(t){var e=new Array(t.length),n=o[0][0],i=o[0][1],r=o[1][0],a=o[1][1];return er(s(t),o).cells.forEach((function(o,s){var l=o.edges,u=o.site;(e[s]=l.length?l.map((function(t){var e=t.start();return[e.x,e.y]})):u.x>=n&&u.x<=r&&u.y>=i&&u.y<=a?[[n,a],[r,a],[r,i],[n,i]]:[]).point=t[s]})),e}function s(t){return t.map((function(t,e){return{x:Math.round(i(t,e)/gt)*gt,y:Math.round(r(t,e)/gt)*gt,i:e}}))}return a.links=function(t){return er(s(t)).edges.filter((function(t){return t.l&&t.r})).map((function(e){return{source:t[e.l.i],target:t[e.r.i]}}))},a.triangles=function(t){var e=[];return er(s(t)).cells.forEach((function(n,i){for(var r,o=n.site,a=n.edges.sort(ji),s=-1,l=a.length,u=a[l-1].edge,c=u.l===o?u.r:u.l;++s<l;)u,r=c,c=(u=a[s].edge).l===o?u.r:u.l,i<r.i&&i<c.i&&rr(o,r,c)<0&&e.push([t[i],t[r.i],t[c.i]])})),e},a.x=function(t){return arguments.length?(i=oe(e=t),a):e},a.y=function(t){return arguments.length?(r=oe(n=t),a):n},a.clipExtent=function(t){return arguments.length?(o=null==t?ir:t,a):o===ir?null:o},a.size=function(t){return arguments.length?a.clipExtent(t&&[[0,0],t]):o===ir?null:o&&o[1]},a};var ir=[[-1e6,-1e6],[1e6,1e6]];function rr(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function or(t){return t.x}function ar(t){return t.y}function sr(t,e,n,i,r,o){if(!t(e,n,i,r,o)){var a=.5*(n+r),s=.5*(i+o),l=e.nodes;l[0]&&sr(t,l[0],n,i,a,s),l[1]&&sr(t,l[1],a,i,r,s),l[2]&&sr(t,l[2],n,s,a,o),l[3]&&sr(t,l[3],a,s,r,o)}}function lr(e,n){e=t.rgb(e),n=t.rgb(n);var i=e.r,r=e.g,o=e.b,a=n.r-i,s=n.g-r,l=n.b-o;return function(t){return"#"+Jt(Math.round(i+a*t))+Jt(Math.round(r+s*t))+Jt(Math.round(o+l*t))}}function ur(t,e){var n,i={},r={};for(n in t)n in e?i[n]=pr(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function cr(t,e){return e-=t=+t,function(n){return t+e*n}}function hr(t,e){var n,i,r,o,a,s=0,l=[],u=[];for(t+="",e+="",dr.lastIndex=0,i=0;n=dr.exec(e);++i)n.index&&l.push(e.substring(s,n.index)),u.push({i:l.length,x:n[0]}),l.push(null),s=dr.lastIndex;for(s<e.length&&l.push(e.substring(s)),i=0,o=u.length;(n=dr.exec(t))&&i<o;++i)if((a=u[i]).x==n[0]){if(a.i)if(null==l[a.i+1])for(l[a.i-1]+=a.x,l.splice(a.i,1),r=i+1;r<o;++r)u[r].i--;else for(l[a.i-1]+=a.x+l[a.i+1],l.splice(a.i,2),r=i+1;r<o;++r)u[r].i-=2;else if(null==l[a.i+1])l[a.i]=a.x;else for(l[a.i]=a.x+l[a.i+1],l.splice(a.i+1,1),r=i+1;r<o;++r)u[r].i--;u.splice(i,1),o--,i--}else a.x=cr(parseFloat(n[0]),parseFloat(a.x));for(;i<o;)a=u.pop(),null==l[a.i+1]?l[a.i]=a.x:(l[a.i]=a.x+l[a.i+1],l.splice(a.i+1,1)),o--;return 1===l.length?null==l[0]?(a=u[0].x,function(t){return a(t)+""}):function(){return e}:function(t){for(i=0;i<o;++i)l[(a=u[i]).i]=a.x(t);return l.join("")}}t.geom.delaunay=function(e){return t.geom.voronoi().triangles(e)},t.geom.quadtree=function(t,e,n,i,r){var o,a=yi,s=bi;if(o=arguments.length)return a=or,s=ar,3===o&&(r=n,i=e,n=e=0),l(t);function l(t){var l,u,c,h,d,p,m,g,v,y=oe(a),b=oe(s);if(null!=e)p=e,m=n,g=i,v=r;else if(g=v=-(p=m=1/0),u=[],c=[],d=t.length,o)for(h=0;h<d;++h)(l=t[h]).x<p&&(p=l.x),l.y<m&&(m=l.y),l.x>g&&(g=l.x),l.y>v&&(v=l.y),u.push(l.x),c.push(l.y);else for(h=0;h<d;++h){var _=+y(l=t[h],h),x=+b(l,h);_<p&&(p=_),x<m&&(m=x),_>g&&(g=_),x>v&&(v=x),u.push(_),c.push(x)}var w=g-p,C=v-m;function T(t,e,n,i,r,o,a,s){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var l=t.x,u=t.y;if(null!=l)if(f(l-n)+f(u-i)<.01)S(t,e,n,i,r,o,a,s);else{var c=t.point;t.x=t.y=t.point=null,S(t,c,l,u,r,o,a,s),S(t,e,n,i,r,o,a,s)}else t.x=n,t.y=i,t.point=e}else S(t,e,n,i,r,o,a,s)}function S(t,e,n,i,r,o,a,s){var l=.5*(r+a),u=.5*(o+s),c=n>=l,h=i>=u,d=(h<<1)+c;t.leaf=!1,c?r=l:a=l,h?o=u:s=u,T(t=t.nodes[d]||(t.nodes[d]={leaf:!0,nodes:[],point:null,x:null,y:null}),e,n,i,r,o,a,s)}w>C?v=m+w:g=p+C;var k={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){T(k,t,+y(t,++h),+b(t,h),p,m,g,v)},visit:function(t){sr(t,k,p,m,g,v)}};if(h=-1,null==e){for(;++h<d;)T(k,t[h],u[h],c[h],p,m,g,v);--h}else t.forEach(k.add);return u=c=t=l=null,k}return l.x=function(t){return arguments.length?(a=t,l):a},l.y=function(t){return arguments.length?(s=t,l):s},l.extent=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),l):null==e?null:[[e,n],[i,r]]},l.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),l):null==e?null:[i-e,r-n]},l},t.interpolateRgb=lr,t.interpolateObject=ur,t.interpolateNumber=cr,t.interpolateString=hr;var dr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;function pr(e,n){for(var i,r=t.interpolators.length;--r>=0&&!(i=t.interpolators[r](e,n)););return i}function fr(t,e){var n,i=[],r=[],o=t.length,a=e.length,s=Math.min(t.length,e.length);for(n=0;n<s;++n)i.push(pr(t[n],e[n]));for(;n<o;++n)r[n]=t[n];for(;n<a;++n)r[n]=e[n];return function(t){for(n=0;n<s;++n)r[n]=i[n](t);return r}}t.interpolate=pr,t.interpolators=[function(t,e){var n=typeof e;return("string"===n?re.has(e)||/^(#|rgb\(|hsl\()/.test(e)?lr:hr:e instanceof Mt?lr:"object"===n?Array.isArray(e)?fr:ur:cr)(t,e)}],t.interpolateArray=fr;var mr=function(){return ae},gr=t.map({linear:mr,poly:function(t){return function(e){return Math.pow(e,t)}},quad:function(){return xr},cubic:function(){return wr},sin:function(){return Tr},exp:function(){return Sr},circle:function(){return kr},elastic:function(t,e){var n;arguments.length<2&&(e=.45);arguments.length?n=e/ft*Math.asin(1/t):(t=1,n=e/4);return function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*ft/e)}},back:function(t){t||(t=1.70158);return function(e){return e*e*((t+1)*e-t)}},bounce:function(){return Ar}}),vr=t.map({in:ae,out:br,"in-out":_r,"out-in":function(t){return _r(br(t))}});function yr(t){return function(e){return e<=0?0:e>=1?1:t(e)}}function br(t){return function(e){return 1-t(1-e)}}function _r(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function xr(t){return t*t}function wr(t){return t*t*t}function Cr(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function Tr(t){return 1-Math.cos(t*mt)}function Sr(t){return Math.pow(2,10*(t-1))}function kr(t){return 1-Math.sqrt(1-t*t)}function Ar(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Er(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function Mr(t){var e=[t.a,t.b],n=[t.c,t.d],i=Dr(e),r=Pr(e,n),o=Dr(function(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*yt,this.translate=[t.e,t.f],this.scale=[i,o],this.skew=o?Math.atan2(r,o)*yt:0}function Pr(t,e){return t[0]*e[0]+t[1]*e[1]}function Dr(t){var e=Math.sqrt(Pr(t,t));return e&&(t[0]/=e,t[1]/=e),e}t.ease=function(t){var n=t.indexOf("-"),i=n>=0?t.substring(0,n):t,r=n>=0?t.substring(n+1):"in";return i=gr.get(i)||mr,yr((r=vr.get(r)||ae)(i.apply(null,e.call(arguments,1))))},t.interpolateHcl=function(e,n){e=t.hcl(e),n=t.hcl(n);var i=e.h,r=e.c,o=e.l,a=n.h-i,s=n.c-r,l=n.l-o;isNaN(s)&&(s=0,r=isNaN(r)?n.c:r);isNaN(a)?(a=0,i=isNaN(i)?n.h:i):a>180?a-=360:a<-180&&(a+=360);return function(t){return Ft(i+a*t,r+s*t,o+l*t)+""}},t.interpolateHsl=function(e,n){e=t.hsl(e),n=t.hsl(n);var i=e.h,r=e.s,o=e.l,a=n.h-i,s=n.s-r,l=n.l-o;isNaN(s)&&(s=0,r=isNaN(r)?n.s:r);isNaN(a)?(a=0,i=isNaN(i)?n.h:i):a>180?a-=360:a<-180&&(a+=360);return function(t){return It(i+a*t,r+s*t,o+l*t)+""}},t.interpolateLab=function(e,n){e=t.lab(e),n=t.lab(n);var i=e.l,r=e.a,o=e.b,a=n.l-i,s=n.a-r,l=n.b-o;return function(t){return Ht(i+a*t,r+s*t,o+l*t)+""}},t.interpolateRound=Er,t.transform=function(e){var n=i.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(t){if(null!=t){n.setAttribute("transform",t);var e=n.transform.baseVal.consolidate()}return new Mr(e?e.matrix:Or)})(e)},Mr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Or={a:1,b:0,c:0,d:1,e:0,f:0};function Ir(e,n){var i,r=[],o=[],a=t.transform(e),s=t.transform(n),l=a.translate,u=s.translate,c=a.rotate,h=s.rotate,d=a.skew,p=s.skew,f=a.scale,m=s.scale;return l[0]!=u[0]||l[1]!=u[1]?(r.push("translate(",null,",",null,")"),o.push({i:1,x:cr(l[0],u[0])},{i:3,x:cr(l[1],u[1])})):u[0]||u[1]?r.push("translate("+u+")"):r.push(""),c!=h?(c-h>180?h+=360:h-c>180&&(c+=360),o.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:cr(c,h)})):h&&r.push(r.pop()+"rotate("+h+")"),d!=p?o.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:cr(d,p)}):p&&r.push(r.pop()+"skewX("+p+")"),f[0]!=m[0]||f[1]!=m[1]?(i=r.push(r.pop()+"scale(",null,",",null,")"),o.push({i:i-4,x:cr(f[0],m[0])},{i:i-2,x:cr(f[1],m[1])})):1==m[0]&&1==m[1]||r.push(r.pop()+"scale("+m+")"),i=o.length,function(t){for(var e,n=-1;++n<i;)r[(e=o[n]).i]=e.x(t);return r.join("")}}function Lr(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return(n-t)*e}}function Rr(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return Math.max(0,Math.min(1,(n-t)*e))}}function Nr(t){for(var e=t.source,n=t.target,i=function(t,e){if(t===e)return t;var n=Fr(t),i=Fr(e),r=n.pop(),o=i.pop(),a=null;for(;r===o;)a=r,r=n.pop(),o=i.pop();return a}(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var o=r.length;n!==i;)r.splice(o,0,n),n=n.parent;return r}function Fr(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Br(t){t.fixed|=2}function zr(t){t.fixed&=-7}function jr(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Vr(t){t.fixed&=-5}t.interpolateTransform=Ir,t.layout={},t.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(Nr(t[n]));return e}},t.layout.chord=function(){var e,n,i,r,o,a,s,l={},u=0;function c(){var l,c,d,p,f,m={},g=[],v=t.range(r),y=[];for(e=[],n=[],l=0,p=-1;++p<r;){for(c=0,f=-1;++f<r;)c+=i[p][f];g.push(c),y.push(t.range(r)),l+=c}for(o&&v.sort((function(t,e){return o(g[t],g[e])})),a&&y.forEach((function(t,e){t.sort((function(t,n){return a(i[e][t],i[e][n])}))})),l=(ft-u*r)/l,c=0,p=-1;++p<r;){for(d=c,f=-1;++f<r;){var b=v[p],_=y[b][f],x=i[b][_],w=c,C=c+=x*l;m[b+"-"+_]={index:b,subindex:_,startAngle:w,endAngle:C,value:x}}n[b]={index:b,startAngle:d,endAngle:c,value:(c-d)/l},c+=u}for(p=-1;++p<r;)for(f=p-1;++f<r;){var T=m[p+"-"+f],S=m[f+"-"+p];(T.value||S.value)&&e.push(T.value<S.value?{source:S,target:T}:{source:T,target:S})}s&&h()}function h(){e.sort((function(t,e){return s((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)}))}return l.matrix=function(t){return arguments.length?(r=(i=t)&&i.length,e=n=null,l):i},l.padding=function(t){return arguments.length?(u=t,e=n=null,l):u},l.sortGroups=function(t){return arguments.length?(o=t,e=n=null,l):o},l.sortSubgroups=function(t){return arguments.length?(a=t,e=null,l):a},l.sortChords=function(t){return arguments.length?(s=t,e&&h(),l):s},l.chords=function(){return e||c(),e},l.groups=function(){return n||c(),n},l},t.layout.force=function(){var e,n,i,r,o,a={},s=t.dispatch("start","tick","end"),l=[1,1],u=.9,c=Hr,h=Wr,d=-30,p=.1,f=.8,m=[],g=[];function v(t){return function(e,n,i,r){if(e.point!==t){var o=e.cx-t.x,a=e.cy-t.y,s=1/Math.sqrt(o*o+a*a);if((r-n)*s<f){var l=e.charge*s*s;return t.px-=o*l,t.py-=a*l,!0}if(e.point&&isFinite(s)){l=e.pointCharge*s*s;t.px-=o*l,t.py-=a*l}}return!e.charge}}function y(e){e.px=t.event.x,e.py=t.event.y,a.resume()}return a.tick=function(){if((n*=.99)<.005)return s.end({type:"end",alpha:n=0}),!0;var e,a,c,h,f,y,b,_,x,w=m.length,C=g.length;for(a=0;a<C;++a)h=(c=g[a]).source,(y=(_=(f=c.target).x-h.x)*_+(x=f.y-h.y)*x)&&(_*=y=n*r[a]*((y=Math.sqrt(y))-i[a])/y,x*=y,f.x-=_*(b=h.weight/(f.weight+h.weight)),f.y-=x*b,h.x+=_*(b=1-b),h.y+=x*b);if((b=n*p)&&(_=l[0]/2,x=l[1]/2,a=-1,b))for(;++a<w;)(c=m[a]).x+=(_-c.x)*b,c.y+=(x-c.y)*b;if(d)for(!function t(e,n,i){var r=0,o=0;if(e.charge=0,!e.leaf)for(var a,s=e.nodes,l=s.length,u=-1;++u<l;)null!=(a=s[u])&&(t(a,n,i),e.charge+=a.charge,r+=a.charge*a.cx,o+=a.charge*a.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var c=n*i[e.point.index];e.charge+=e.pointCharge=c,r+=c*e.point.x,o+=c*e.point.y}e.cx=r/e.charge,e.cy=o/e.charge}(e=t.geom.quadtree(m),n,o),a=-1;++a<w;)(c=m[a]).fixed||e.visit(v(c));for(a=-1;++a<w;)(c=m[a]).fixed?(c.x=c.px,c.y=c.py):(c.x-=(c.px-(c.px=c.x))*u,c.y-=(c.py-(c.py=c.y))*u);s.tick({type:"tick",alpha:n})},a.nodes=function(t){return arguments.length?(m=t,a):m},a.links=function(t){return arguments.length?(g=t,a):g},a.size=function(t){return arguments.length?(l=t,a):l},a.linkDistance=function(t){return arguments.length?(c="function"==typeof t?t:+t,a):c},a.distance=a.linkDistance,a.linkStrength=function(t){return arguments.length?(h="function"==typeof t?t:+t,a):h},a.friction=function(t){return arguments.length?(u=+t,a):u},a.charge=function(t){return arguments.length?(d="function"==typeof t?t:+t,a):d},a.gravity=function(t){return arguments.length?(p=+t,a):p},a.theta=function(t){return arguments.length?(f=+t,a):f},a.alpha=function(e){return arguments.length?(e=+e,n?n=e>0?e:0:e>0&&(s.start({type:"start",alpha:n=e}),t.timer(a.tick)),a):n},a.start=function(){var t,e,n,s=m.length,u=g.length,p=l[0],f=l[1];for(t=0;t<s;++t)(n=m[t]).index=t,n.weight=0;for(t=0;t<u;++t)"number"==typeof(n=g[t]).source&&(n.source=m[n.source]),"number"==typeof n.target&&(n.target=m[n.target]),++n.source.weight,++n.target.weight;for(t=0;t<s;++t)n=m[t],isNaN(n.x)&&(n.x=v("x",p)),isNaN(n.y)&&(n.y=v("y",f)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(i=[],"function"==typeof c)for(t=0;t<u;++t)i[t]=+c.call(this,g[t],t);else for(t=0;t<u;++t)i[t]=c;if(r=[],"function"==typeof h)for(t=0;t<u;++t)r[t]=+h.call(this,g[t],t);else for(t=0;t<u;++t)r[t]=h;if(o=[],"function"==typeof d)for(t=0;t<s;++t)o[t]=+d.call(this,m[t],t);else for(t=0;t<s;++t)o[t]=d;function v(n,i){if(!e){for(e=new Array(s),l=0;l<s;++l)e[l]=[];for(l=0;l<u;++l){var r=g[l];e[r.source.index].push(r.target),e[r.target.index].push(r.source)}}for(var o,a=e[t],l=-1,u=a.length;++l<u;)if(!isNaN(o=a[l][n]))return o;return Math.random()*i}return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){if(e||(e=t.behavior.drag().origin(ae).on("dragstart.force",Br).on("drag.force",y).on("dragend.force",zr)),!arguments.length)return e;this.on("mouseover.force",jr).on("mouseout.force",Vr).call(e)},t.rebind(a,s,"on")};var Hr=20,Wr=1;function Ur(e,n){return t.rebind(e,n,"sort","children","value"),e.nodes=e,e.links=Yr,e}function $r(t){return t.children}function Gr(t){return t.value}function qr(t,e){return e.value-t.value}function Yr(e){return t.merge(e.map((function(t){return(t.children||[]).map((function(e){return{source:t,target:e}}))})))}t.layout.hierarchy=function(){var t=qr,e=$r,n=Gr;function i(r){var o=[];return function r(o,a,s){var l=e.call(i,o,a);if(o.depth=a,s.push(o),l&&(u=l.length)){for(var u,c,h=-1,d=o.children=new Array(u),p=0,f=a+1;++h<u;)(c=d[h]=r(l[h],f,s)).parent=o,p+=c.value;t&&d.sort(t),n&&(o.value=p)}else delete o.children,n&&(o.value=+n.call(i,o,a)||0);return o}(r,0,o),o}return i.sort=function(e){return arguments.length?(t=e,i):t},i.children=function(t){return arguments.length?(e=t,i):e},i.value=function(t){return arguments.length?(n=t,i):n},i.revalue=function(t){return function t(e,r){var o=e.children,a=0;if(o&&(s=o.length))for(var s,l=-1,u=r+1;++l<s;)a+=t(o[l],u);else n&&(a=+n.call(i,e,r)||0);return n&&(e.value=a),a}(t,0),t},i},t.layout.partition=function(){var e=t.layout.hierarchy(),n=[1,1];function i(t,i){var r=e.call(this,t,i);return function t(e,n,i,r){var o=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,o&&(a=o.length)){var a,s,l,u=-1;for(i=e.value?i/e.value:0;++u<a;)t(s=o[u],n,l=s.value*i,r),n+=l}}(r[0],0,n[0],n[1]/function t(e){var n=e.children,i=0;if(n&&(r=n.length))for(var r,o=-1;++o<r;)i=Math.max(i,t(n[o]));return 1+i}(r[0])),r}return i.size=function(t){return arguments.length?(n=t,i):n},Ur(i,e)},t.layout.pie=function(){var e=Number,n=Xr,i=0,r=ft;function o(a){var s=a.map((function(t,n){return+e.call(o,t,n)})),l=+("function"==typeof i?i.apply(this,arguments):i),u=(("function"==typeof r?r.apply(this,arguments):r)-l)/t.sum(s),c=t.range(a.length);null!=n&&c.sort(n===Xr?function(t,e){return s[e]-s[t]}:function(t,e){return n(a[t],a[e])});var h=[];return c.forEach((function(t){var e;h[t]={data:a[t],value:e=s[t],startAngle:l,endAngle:l+=e*u}})),h}return o.value=function(t){return arguments.length?(e=t,o):e},o.sort=function(t){return arguments.length?(n=t,o):n},o.startAngle=function(t){return arguments.length?(i=t,o):i},o.endAngle=function(t){return arguments.length?(r=t,o):r},o};var Xr={};function Qr(t){return t.x}function Kr(t){return t.y}function Jr(t,e,n){t.y0=e,t.y=n}t.layout.stack=function(){var e=ae,n=eo,i=no,r=Jr,o=Qr,a=Kr;function s(l,u){var c=l.map((function(t,n){return e.call(s,t,n)})),h=c.map((function(t){return t.map((function(t,e){return[o.call(s,t,e),a.call(s,t,e)]}))})),d=n.call(s,h,u);c=t.permute(c,d),h=t.permute(h,d);var p,f,m,g=i.call(s,h,u),v=c.length,y=c[0].length;for(f=0;f<y;++f)for(r.call(s,c[0][f],m=g[f],h[0][f][1]),p=1;p<v;++p)r.call(s,c[p][f],m+=h[p-1][f][1],h[p][f][1]);return l}return s.values=function(t){return arguments.length?(e=t,s):e},s.order=function(t){return arguments.length?(n="function"==typeof t?t:Zr.get(t)||eo,s):n},s.offset=function(t){return arguments.length?(i="function"==typeof t?t:to.get(t)||no,s):i},s.x=function(t){return arguments.length?(o=t,s):o},s.y=function(t){return arguments.length?(a=t,s):a},s.out=function(t){return arguments.length?(r=t,s):r},s};var Zr=t.map({"inside-out":function(e){var n,i,r=e.length,o=e.map(io),a=e.map(ro),s=t.range(r).sort((function(t,e){return o[t]-o[e]})),l=0,u=0,c=[],h=[];for(n=0;n<r;++n)i=s[n],l<u?(l+=a[i],c.push(i)):(u+=a[i],h.push(i));return h.reverse().concat(c)},reverse:function(e){return t.range(e.length).reverse()},default:eo}),to=t.map({silhouette:function(t){var e,n,i,r=t.length,o=t[0].length,a=[],s=0,l=[];for(n=0;n<o;++n){for(e=0,i=0;e<r;e++)i+=t[e][n][1];i>s&&(s=i),a.push(i)}for(n=0;n<o;++n)l[n]=(s-a[n])/2;return l},wiggle:function(t){var e,n,i,r,o,a,s,l,u,c=t.length,h=t[0],d=h.length,p=[];for(p[0]=l=u=0,n=1;n<d;++n){for(e=0,r=0;e<c;++e)r+=t[e][n][1];for(e=0,o=0,s=h[n][0]-h[n-1][0];e<c;++e){for(i=0,a=(t[e][n][1]-t[e][n-1][1])/(2*s);i<e;++i)a+=(t[i][n][1]-t[i][n-1][1])/s;o+=a*t[e][n][1]}p[n]=l-=r?o/r*s:0,l<u&&(u=l)}for(n=0;n<d;++n)p[n]-=u;return p},expand:function(t){var e,n,i,r=t.length,o=t[0].length,a=1/r,s=[];for(n=0;n<o;++n){for(e=0,i=0;e<r;e++)i+=t[e][n][1];if(i)for(e=0;e<r;e++)t[e][n][1]/=i;else for(e=0;e<r;e++)t[e][n][1]=a}for(n=0;n<o;++n)s[n]=0;return s},zero:no});function eo(e){return t.range(e.length)}function no(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function io(t){for(var e,n=1,i=0,r=t[0][1],o=t.length;n<o;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function ro(t){return t.reduce(oo,0)}function oo(t,e){return t+e[1]}function ao(t,e){return so(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function so(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,o=[];++n<=e;)o[n]=r*n+i;return o}function lo(e){return[t.min(e),t.max(e)]}function uo(t,e){return t.parent==e.parent?1:2}function co(t){var e=t.children;return e&&e.length?e[0]:t._tree.thread}function ho(t){var e,n=t.children;return n&&(e=n.length)?n[e-1]:t._tree.thread}function po(t,e){var n=t.children;if(n&&(r=n.length))for(var i,r,o=-1;++o<r;)e(i=po(n[o],e),t)>0&&(t=i);return t}function fo(t,e){return t.x-e.x}function mo(t,e){return e.x-t.x}function go(t,e){return t.depth-e.depth}function vo(t,e){!function t(n,i){var r=n.children;if(r&&(a=r.length))for(var o,a,s=null,l=-1;++l<a;)t(o=r[l],s),s=o;e(n,i)}(t,null)}function yo(t,e,n){t=t._tree;var i=n/((e=e._tree).number-t.number);t.change+=i,e.change-=i,e.shift+=n,e.prelim+=n,e.mod+=n}function bo(t,e,n){return t._tree.ancestor.parent==e.parent?t._tree.ancestor:n}function _o(t,e){return t.value-e.value}function xo(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function wo(t,e){t._pack_next=e,e._pack_prev=t}function Co(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return.999*r*r>n*n+i*i}function To(t){if((e=t.children)&&(l=e.length)){var e,n,i,r,o,a,s,l,u=1/0,c=-1/0,h=1/0,d=-1/0;if(e.forEach(So),(n=e[0]).x=-n.r,n.y=0,b(n),l>1&&((i=e[1]).x=i.r,i.y=0,b(i),l>2))for(Ao(n,i,r=e[2]),b(r),xo(n,r),n._pack_prev=r,xo(r,i),i=n._pack_next,o=3;o<l;o++){Ao(n,i,r=e[o]);var p=0,f=1,m=1;for(a=i._pack_next;a!==i;a=a._pack_next,f++)if(Co(a,r)){p=1;break}if(1==p)for(s=n._pack_prev;s!==a._pack_prev&&!Co(s,r);s=s._pack_prev,m++);p?(f<m||f==m&&i.r<n.r?wo(n,i=a):wo(n=s,i),o--):(xo(n,r),i=r,b(r))}var g=(u+c)/2,v=(h+d)/2,y=0;for(o=0;o<l;o++)(r=e[o]).x-=g,r.y-=v,y=Math.max(y,r.r+Math.sqrt(r.x*r.x+r.y*r.y));t.r=y,e.forEach(ko)}function b(t){u=Math.min(t.x-t.r,u),c=Math.max(t.x+t.r,c),h=Math.min(t.y-t.r,h),d=Math.max(t.y+t.r,d)}}function So(t){t._pack_next=t._pack_prev=t}function ko(t){delete t._pack_next,delete t._pack_prev}function Ao(t,e,n){var i=t.r+n.r,r=e.x-t.x,o=e.y-t.y;if(i&&(r||o)){var a=e.r+n.r,s=r*r+o*o,l=.5+((i*=i)-(a*=a))/(2*s),u=Math.sqrt(Math.max(0,2*a*(i+s)-(i-=s)*i-a*a))/(2*s);n.x=t.x+l*r+u*o,n.y=t.y+l*o-u*r}else n.x=t.x+i,n.y=t.y}function Eo(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Mo(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return r<0&&(n+=r/2,r=0),o<0&&(i+=o/2,o=0),{x:n,y:i,dx:r,dy:o}}function Po(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]}function Do(t){return t.rangeExtent?t.rangeExtent():Po(t.range())}function Oo(t,e,n,i){var r=n(t[0],t[1]),o=i(e[0],e[1]);return function(t){return o(r(t))}}function Io(t,e){var n,i=0,r=t.length-1,o=t[i],a=t[r];return a<o&&(n=i,i=r,r=n,n=o,o=a,a=n),t[i]=e.floor(o),t[r]=e.ceil(a),t}t.layout.histogram=function(){var e=!0,n=Number,i=lo,r=ao;function o(o,a){for(var s,l,u=[],c=o.map(n,this),h=i.call(this,c,a),d=r.call(this,h,c,a),p=(a=-1,c.length),f=d.length-1,m=e?1:1/p;++a<f;)(s=u[a]=[]).dx=d[a+1]-(s.x=d[a]),s.y=0;if(f>0)for(a=-1;++a<p;)(l=c[a])>=h[0]&&l<=h[1]&&((s=u[t.bisect(d,l,1,f)-1]).y+=m,s.push(o[a]));return u}return o.value=function(t){return arguments.length?(n=t,o):n},o.range=function(t){return arguments.length?(i=oe(t),o):i},o.bins=function(t){return arguments.length?(r="number"==typeof t?function(e){return so(e,t)}:oe(t),o):r},o.frequency=function(t){return arguments.length?(e=!!t,o):e},o},t.layout.tree=function(){var e=t.layout.hierarchy().sort(null).value(null),n=uo,i=[1,1],r=!1;function o(t,o){var a=e.call(this,t,o),s=a[0];function l(t,e,i){if(e){for(var r,o=t,a=t,s=e,l=t.parent.children[0],u=o._tree.mod,c=a._tree.mod,h=s._tree.mod,d=l._tree.mod;s=ho(s),o=co(o),s&&o;)l=co(l),(a=ho(a))._tree.ancestor=t,(r=s._tree.prelim+h-o._tree.prelim-u+n(s,o))>0&&(yo(bo(s,t,i),t,r),u+=r,c+=r),h+=s._tree.mod,u+=o._tree.mod,d+=l._tree.mod,c+=a._tree.mod;s&&!ho(a)&&(a._tree.thread=s,a._tree.mod+=h-c),o&&!co(l)&&(l._tree.thread=o,l._tree.mod+=u-d,i=t)}return i}vo(s,(function(t,e){t._tree={ancestor:t,prelim:0,mod:0,change:0,shift:0,number:e?e._tree.number+1:0}})),function t(e,i){var r=e.children,o=e._tree;if(r&&(a=r.length)){for(var a,s,u,c=r[0],h=c,d=-1;++d<a;)t(u=r[d],s),h=l(u,s,h),s=u;!function(t){var e,n=0,i=0,r=t.children,o=r.length;for(;--o>=0;)(e=r[o]._tree).prelim+=n,e.mod+=n,n+=e.shift+(i+=e.change)}(e);var p=.5*(c._tree.prelim+u._tree.prelim);i?(o.prelim=i._tree.prelim+n(e,i),o.mod=o.prelim-p):o.prelim=p}else i&&(o.prelim=i._tree.prelim+n(e,i))}(s),function t(e,n){e.x=e._tree.prelim+n;var i=e.children;if(i&&(r=i.length)){var r,o=-1;for(n+=e._tree.mod;++o<r;)t(i[o],n)}}(s,-s._tree.prelim);var u=po(s,mo),c=po(s,fo),h=po(s,go),d=u.x-n(u,c)/2,p=c.x+n(c,u)/2,f=h.depth||1;return vo(s,r?function(t){t.x*=i[0],t.y=t.depth*i[1],delete t._tree}:function(t){t.x=(t.x-d)/(p-d)*i[0],t.y=t.depth/f*i[1],delete t._tree}),a}return o.separation=function(t){return arguments.length?(n=t,o):n},o.size=function(t){return arguments.length?(r=null==(i=t),o):r?null:i},o.nodeSize=function(t){return arguments.length?(r=null!=(i=t),o):r?i:null},Ur(o,e)},t.layout.pack=function(){var e,n=t.layout.hierarchy().sort(_o),i=0,r=[1,1];function o(t,o){var a=n.call(this,t,o),s=a[0],l=r[0],u=r[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(s.x=s.y=0,vo(s,(function(t){t.r=+c(t.value)})),vo(s,To),i){var h=i*(e?1:Math.max(2*s.r/l,2*s.r/u))/2;vo(s,(function(t){t.r+=h})),vo(s,To),vo(s,(function(t){t.r-=h}))}return function t(e,n,i,r){var o=e.children;if(e.x=n+=r*e.x,e.y=i+=r*e.y,e.r*=r,o)for(var a=-1,s=o.length;++a<s;)t(o[a],n,i,r)}(s,l/2,u/2,e?1:1/Math.max(2*s.r/l,2*s.r/u)),a}return o.size=function(t){return arguments.length?(r=t,o):r},o.radius=function(t){return arguments.length?(e=null==t||"function"==typeof t?t:+t,o):e},o.padding=function(t){return arguments.length?(i=+t,o):i},Ur(o,n)},t.layout.cluster=function(){var e=t.layout.hierarchy().sort(null).value(null),n=uo,i=[1,1],r=!1;function o(o,a){var s,l=e.call(this,o,a),u=l[0],c=0;vo(u,(function(e){var i=e.children;i&&i.length?(e.x=function(t){return t.reduce((function(t,e){return t+e.x}),0)/t.length}(i),e.y=function(e){return 1+t.max(e,(function(t){return t.y}))}(i)):(e.x=s?c+=n(e,s):0,e.y=0,s=e)}));var h=function t(e){var n=e.children;return n&&n.length?t(n[0]):e}(u),d=function t(e){var n,i=e.children;return i&&(n=i.length)?t(i[n-1]):e}(u),p=h.x-n(h,d)/2,f=d.x+n(d,h)/2;return vo(u,r?function(t){t.x=(t.x-u.x)*i[0],t.y=(u.y-t.y)*i[1]}:function(t){t.x=(t.x-p)/(f-p)*i[0],t.y=(1-(u.y?t.y/u.y:1))*i[1]}),l}return o.separation=function(t){return arguments.length?(n=t,o):n},o.size=function(t){return arguments.length?(r=null==(i=t),o):r?null:i},o.nodeSize=function(t){return arguments.length?(r=null!=(i=t),o):r?i:null},Ur(o,e)},t.layout.treemap=function(){var e,n=t.layout.hierarchy(),i=Math.round,r=[1,1],o=null,a=Eo,s=!1,l="squarify",u=.5*(1+Math.sqrt(5));function c(t,e){for(var n,i,r=-1,o=t.length;++r<o;)i=(n=t[r]).value*(e<0?0:e),n.area=isNaN(i)||i<=0?0:i}function h(t){var e=t.children;if(e&&e.length){var n,i,r,o=a(t),s=[],u=e.slice(),d=1/0,m="slice"===l?o.dx:"dice"===l?o.dy:"slice-dice"===l?1&t.depth?o.dy:o.dx:Math.min(o.dx,o.dy);for(c(u,o.dx*o.dy/t.value),s.area=0;(r=u.length)>0;)s.push(n=u[r-1]),s.area+=n.area,"squarify"!==l||(i=p(s,m))<=d?(u.pop(),d=i):(s.area-=s.pop().area,f(s,m,o,!1),m=Math.min(o.dx,o.dy),s.length=s.area=0,d=1/0);s.length&&(f(s,m,o,!0),s.length=s.area=0),e.forEach(h)}}function d(t){var e=t.children;if(e&&e.length){var n,i=a(t),r=e.slice(),o=[];for(c(r,i.dx*i.dy/t.value),o.area=0;n=r.pop();)o.push(n),o.area+=n.area,null!=n.z&&(f(o,n.z?i.dx:i.dy,i,!r.length),o.length=o.area=0);e.forEach(d)}}function p(t,e){for(var n,i=t.area,r=0,o=1/0,a=-1,s=t.length;++a<s;)(n=t[a].area)&&(n<o&&(o=n),n>r&&(r=n));return e*=e,(i*=i)?Math.max(e*r*u/i,i/(e*o*u)):1/0}function f(t,e,n,r){var o,a=-1,s=t.length,l=n.x,u=n.y,c=e?i(t.area/e):0;if(e==n.dx){for((r||c>n.dy)&&(c=n.dy);++a<s;)(o=t[a]).x=l,o.y=u,o.dy=c,l+=o.dx=Math.min(n.x+n.dx-l,c?i(o.area/c):0);o.z=!0,o.dx+=n.x+n.dx-l,n.y+=c,n.dy-=c}else{for((r||c>n.dx)&&(c=n.dx);++a<s;)(o=t[a]).x=l,o.y=u,o.dx=c,u+=o.dy=Math.min(n.y+n.dy-u,c?i(o.area/c):0);o.z=!1,o.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function m(t){var i=e||n(t),o=i[0];return o.x=0,o.y=0,o.dx=r[0],o.dy=r[1],e&&n.revalue(o),c([o],o.dx*o.dy/o.value),(e?d:h)(o),s&&(e=i),i}return m.size=function(t){return arguments.length?(r=t,m):r},m.padding=function(t){if(!arguments.length)return o;function e(e){var n=t.call(m,e,e.depth);return null==n?Eo(e):Mo(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Mo(e,t)}var i;return a=null==(o=t)?Eo:"function"==(i=typeof t)?e:"number"===i?(t=[t,t,t,t],n):n,m},m.round=function(t){return arguments.length?(i=t?Math.round:Number,m):i!=Number},m.sticky=function(t){return arguments.length?(s=t,e=null,m):s},m.ratio=function(t){return arguments.length?(u=t,m):u},m.mode=function(t){return arguments.length?(l=t+"",m):l},Ur(m,n)},t.random={normal:function(t,e){var n=arguments.length;return n<2&&(e=1),n<1&&(t=0),function(){var n,i,r;do{r=(n=2*Math.random()-1)*n+(i=2*Math.random()-1)*i}while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var e=t.random.normal.apply(t,arguments);return function(){return Math.exp(e())}},irwinHall:function(t){return function(){for(var e=0,n=0;n<t;n++)e+=Math.random();return e/t}}},t.scale={};var Lo={floor:ae,ceil:ae};function Ro(e,n,i,r){var o=[],a=[],s=0,l=Math.min(e.length,n.length)-1;for(e[l]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++s<=l;)o.push(i(e[s-1],e[s])),a.push(r(n[s-1],n[s]));return function(n){var i=t.bisect(e,n,1,l)-1;return a[i](o[i](n))}}function No(e,n){return t.rebind(e,n,"range","rangeRound","interpolate","clamp")}function Fo(t,e){return Io(t,(n=Bo(t,e)[2])?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:Lo);var n}function Bo(t,e){null==e&&(e=10);var n=Po(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),o=e/i*r;return o<=.15?r*=10:o<=.35?r*=5:o<=.75&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function zo(e,n){return t.range.apply(t,Bo(e,n))}function jo(e,n,i){var r=-Math.floor(Math.log(Bo(e,n)[2])/Math.LN10+.01);return t.format(i?i.replace(_e,(function(t,e,n,i,o,a,s,l,u,c){return[e,n,i,o,a,s,l,u||"."+(r-2*("%"===c)),c].join("")})):",."+r+"f")}t.scale.linear=function(){return function t(e,n,i,r){var o,a;function s(){var t=Math.min(e.length,n.length)>2?Ro:Oo,s=r?Rr:Lr;return o=t(e,n,s,i),a=t(n,e,s,pr),l}function l(t){return o(t)}return l.invert=function(t){return a(t)},l.domain=function(t){return arguments.length?(e=t.map(Number),s()):e},l.range=function(t){return arguments.length?(n=t,s()):n},l.rangeRound=function(t){return l.range(t).interpolate(Er)},l.clamp=function(t){return arguments.length?(r=t,s()):r},l.interpolate=function(t){return arguments.length?(i=t,s()):i},l.ticks=function(t){return zo(e,t)},l.tickFormat=function(t,n){return jo(e,t,n)},l.nice=function(t){return Fo(e,t),s()},l.copy=function(){return t(e,n,i,r)},s()}([0,1],[0,1],pr,!1)},t.scale.log=function(){return function e(n,i,r,o){function a(t){return(r?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(i)}function s(t){return r?Math.pow(i,t):-Math.pow(i,-t)}function l(t){return n(a(t))}return l.invert=function(t){return s(n.invert(t))},l.domain=function(t){return arguments.length?(r=t[0]>=0,n.domain((o=t.map(Number)).map(a)),l):o},l.base=function(t){return arguments.length?(i=+t,n.domain(o.map(a)),l):i},l.nice=function(){var t=Io(o.map(a),r?Math:Ho);return n.domain(t),o=t.map(s),l},l.ticks=function(){var t=Po(o),e=[],n=t[0],l=t[1],u=Math.floor(a(n)),c=Math.ceil(a(l)),h=i%1?2:i;if(isFinite(c-u)){if(r){for(;u<c;u++)for(var d=1;d<h;d++)e.push(s(u)*d);e.push(s(u))}else for(e.push(s(u));u++<c;)for(d=h-1;d>0;d--)e.push(s(u)*d);for(u=0;e[u]<n;u++);for(c=e.length;e[c-1]>l;c--);e=e.slice(u,c)}return e},l.tickFormat=function(e,n){if(!arguments.length)return Vo;arguments.length<2?n=Vo:"function"!=typeof n&&(n=t.format(n));var i,o=Math.max(.1,e/l.ticks().length),u=r?(i=1e-12,Math.ceil):(i=-1e-12,Math.floor);return function(t){return t/s(u(a(t)+i))<=o?n(t):""}},l.copy=function(){return e(n.copy(),i,r,o)},No(l,n)}(t.scale.linear().domain([0,1]),10,!0,[1,10])};var Vo=t.format(".0e"),Ho={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};function Wo(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}t.scale.pow=function(){return function t(e,n,i){var r=Wo(n),o=Wo(1/n);function a(t){return e(r(t))}return a.invert=function(t){return o(e.invert(t))},a.domain=function(t){return arguments.length?(e.domain((i=t.map(Number)).map(r)),a):i},a.ticks=function(t){return zo(i,t)},a.tickFormat=function(t,e){return jo(i,t,e)},a.nice=function(t){return a.domain(Fo(i,t))},a.exponent=function(t){return arguments.length?(r=Wo(n=t),o=Wo(1/n),e.domain(i.map(r)),a):n},a.copy=function(){return t(e.copy(),n,i)},No(a,e)}(t.scale.linear(),1,[0,1])},t.scale.sqrt=function(){return t.scale.pow().exponent(.5)},t.scale.ordinal=function(){return function e(n,i){var r,o,a;function s(t){return o[((r.get(t)||"range"===i.t&&r.set(t,n.push(t)))-1)%o.length]}function l(e,i){return t.range(n.length).map((function(t){return e+i*t}))}return s.domain=function(t){if(!arguments.length)return n;n=[],r=new v;for(var e,o=-1,a=t.length;++o<a;)r.has(e=t[o])||r.set(e,n.push(e));return s[i.t].apply(s,i.a)},s.range=function(t){return arguments.length?(o=t,a=0,i={t:"range",a:arguments},s):o},s.rangePoints=function(t,e){arguments.length<2&&(e=0);var r=t[0],u=t[1],c=(u-r)/(Math.max(1,n.length-1)+e);return o=l(n.length<2?(r+u)/2:r+c*e/2,c),a=0,i={t:"rangePoints",a:arguments},s},s.rangeBands=function(t,e,r){arguments.length<2&&(e=0),arguments.length<3&&(r=e);var u=t[1]<t[0],c=t[u-0],h=t[1-u],d=(h-c)/(n.length-e+2*r);return o=l(c+d*r,d),u&&o.reverse(),a=d*(1-e),i={t:"rangeBands",a:arguments},s},s.rangeRoundBands=function(t,e,r){arguments.length<2&&(e=0),arguments.length<3&&(r=e);var u=t[1]<t[0],c=t[u-0],h=t[1-u],d=Math.floor((h-c)/(n.length-e+2*r)),p=h-c-(n.length-e)*d;return o=l(c+Math.round(p/2),d),u&&o.reverse(),a=Math.round(d*(1-e)),i={t:"rangeRoundBands",a:arguments},s},s.rangeBand=function(){return a},s.rangeExtent=function(){return Po(i.a[0])},s.copy=function(){return e(n,i)},s.domain(n)}([],{t:"range",a:[[]]})},t.scale.category10=function(){return t.scale.ordinal().range(Uo)},t.scale.category20=function(){return t.scale.ordinal().range($o)},t.scale.category20b=function(){return t.scale.ordinal().range(Go)},t.scale.category20c=function(){return t.scale.ordinal().range(qo)};var Uo=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Yt),$o=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Yt),Go=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Yt),qo=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Yt);t.scale.quantile=function(){return function e(n,i){var r;function o(){var e=0,o=i.length;for(r=[];++e<o;)r[e-1]=t.quantile(n,e/o);return a}function a(e){if(!isNaN(e=+e))return i[t.bisect(r,e)]}return a.domain=function(e){return arguments.length?(n=e.filter((function(t){return!isNaN(t)})).sort(t.ascending),o()):n},a.range=function(t){return arguments.length?(i=t,o()):i},a.quantiles=function(){return r},a.invertExtent=function(t){return(t=i.indexOf(t))<0?[NaN,NaN]:[t>0?r[t-1]:n[0],t<r.length?r[t]:n[n.length-1]]},a.copy=function(){return e(n,i)},o()}([],[])},t.scale.quantize=function(){return function t(e,n,i){var r,o;function a(t){return i[Math.max(0,Math.min(o,Math.floor(r*(t-e))))]}function s(){return r=i.length/(n-e),o=i.length-1,a}return a.domain=function(t){return arguments.length?(e=+t[0],n=+t[t.length-1],s()):[e,n]},a.range=function(t){return arguments.length?(i=t,s()):i},a.invertExtent=function(t){return[t=(t=i.indexOf(t))<0?NaN:t/r+e,t+1/r]},a.copy=function(){return t(e,n,i)},s()}(0,1,[0,1])},t.scale.threshold=function(){return function e(n,i){function r(e){if(e<=e)return i[t.bisect(n,e)]}return r.domain=function(t){return arguments.length?(n=t,r):n},r.range=function(t){return arguments.length?(i=t,r):i},r.invertExtent=function(t){return t=i.indexOf(t),[n[t-1],n[t]]},r.copy=function(){return e(n,i)},r}([.5],[0,1])},t.scale.identity=function(){return function t(e){function n(t){return+t}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=t.map(n),n):e},n.ticks=function(t){return zo(e,t)},n.tickFormat=function(t,n){return jo(e,t,n)},n.copy=function(){return t(e)},n}([0,1])},t.svg={},t.svg.arc=function(){var t=Qo,e=Ko,n=Jo,i=Zo;function r(){var r=t.apply(this,arguments),o=e.apply(this,arguments),a=n.apply(this,arguments)+Yo,s=i.apply(this,arguments)+Yo,l=(s<a&&(l=a,a=s,s=l),s-a),u=l<pt?"0":"1",c=Math.cos(a),h=Math.sin(a),d=Math.cos(s),p=Math.sin(s);return l>=Xo?r?"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"M0,"+r+"A"+r+","+r+" 0 1,0 0,"+-r+"A"+r+","+r+" 0 1,0 0,"+r+"Z":"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"Z":r?"M"+o*c+","+o*h+"A"+o+","+o+" 0 "+u+",1 "+o*d+","+o*p+"L"+r*d+","+r*p+"A"+r+","+r+" 0 "+u+",0 "+r*c+","+r*h+"Z":"M"+o*c+","+o*h+"A"+o+","+o+" 0 "+u+",1 "+o*d+","+o*p+"L0,0Z"}return r.innerRadius=function(e){return arguments.length?(t=oe(e),r):t},r.outerRadius=function(t){return arguments.length?(e=oe(t),r):e},r.startAngle=function(t){return arguments.length?(n=oe(t),r):n},r.endAngle=function(t){return arguments.length?(i=oe(t),r):i},r.centroid=function(){var r=(t.apply(this,arguments)+e.apply(this,arguments))/2,o=(n.apply(this,arguments)+i.apply(this,arguments))/2+Yo;return[Math.cos(o)*r,Math.sin(o)*r]},r};var Yo=-mt,Xo=ft-gt;function Qo(t){return t.innerRadius}function Ko(t){return t.outerRadius}function Jo(t){return t.startAngle}function Zo(t){return t.endAngle}function ta(t){var e=yi,n=bi,i=cn,r=na,o=r.key,a=.7;function s(o){var s,l=[],u=[],c=-1,h=o.length,d=oe(e),p=oe(n);function f(){l.push("M",r(t(u),a))}for(;++c<h;)i.call(this,s=o[c],c)?u.push([+d.call(this,s,c),+p.call(this,s,c)]):u.length&&(f(),u=[]);return u.length&&f(),l.length?l.join(""):null}return s.x=function(t){return arguments.length?(e=t,s):e},s.y=function(t){return arguments.length?(n=t,s):n},s.defined=function(t){return arguments.length?(i=t,s):i},s.interpolate=function(t){return arguments.length?(o="function"==typeof t?r=t:(r=ea.get(t)||na).key,s):o},s.tension=function(t){return arguments.length?(a=t,s):a},s}t.svg.line=function(){return ta(ae)};var ea=t.map({linear:na,"linear-closed":function(t){return na(t)+"Z"},step:function(t){var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];for(;++e<n;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);n>1&&r.push("H",i[0]);return r.join("")},"step-before":ia,"step-after":ra,basis:sa,"basis-open":function(t){if(t.length<4)return na(t);var e,n=[],i=-1,r=t.length,o=[0],a=[0];for(;++i<3;)e=t[i],o.push(e[0]),a.push(e[1]);n.push(la(ha,o)+","+la(ha,a)),--i;for(;++i<r;)e=t[i],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),da(n,o,a);return n.join("")},"basis-closed":function(t){var e,n,i=-1,r=t.length,o=r+4,a=[],s=[];for(;++i<4;)n=t[i%r],a.push(n[0]),s.push(n[1]);e=[la(ha,a),",",la(ha,s)],--i;for(;++i<o;)n=t[i%r],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),da(e,a,s);return e.join("")},bundle:function(t,e){var n=t.length-1;if(n)for(var i,r,o=t[0][0],a=t[0][1],s=t[n][0]-o,l=t[n][1]-a,u=-1;++u<=n;)i=t[u],r=u/n,i[0]=e*i[0]+(1-e)*(o+r*s),i[1]=e*i[1]+(1-e)*(a+r*l);return sa(t)},cardinal:function(t,e){return t.length<3?na(t):t[0]+oa(t,aa(t,e))},"cardinal-open":function(t,e){return t.length<4?na(t):t[1]+oa(t.slice(1,t.length-1),aa(t,e))},"cardinal-closed":function(t,e){return t.length<3?na(t):t[0]+oa((t.push(t[0]),t),aa([t[t.length-2]].concat(t,[t[1]]),e))},monotone:function(t){return t.length<3?na(t):t[0]+oa(t,function(t){var e,n,i,r,o=[],a=function(t){var e=0,n=t.length-1,i=[],r=t[0],o=t[1],a=i[0]=pa(r,o);for(;++e<n;)i[e]=(a+(a=pa(r=o,o=t[e+1])))/2;return i[e]=a,i}(t),s=-1,l=t.length-1;for(;++s<l;)e=pa(t[s],t[s+1]),f(e)<gt?a[s]=a[s+1]=0:(n=a[s]/e,i=a[s+1]/e,(r=n*n+i*i)>9&&(r=3*e/Math.sqrt(r),a[s]=r*n,a[s+1]=r*i));s=-1;for(;++s<=l;)r=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([r||0,a[s]*r||0]);return o}(t))}});function na(t){return t.join("L")}function ia(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function ra(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function oa(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return na(t);var n=t.length!=e.length,i="",r=t[0],o=t[1],a=e[0],s=a,l=1;if(n&&(i+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],r=t[1],l=2),e.length>1){s=e[1],o=t[l],l++,i+="C"+(r[0]+a[0])+","+(r[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var u=2;u<e.length;u++,l++)o=t[l],s=e[u],i+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(n){var c=t[l];i+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+c[0]+","+c[1]}return i}function aa(t,e){for(var n,i=[],r=(1-e)/2,o=t[0],a=t[1],s=1,l=t.length;++s<l;)n=o,o=a,a=t[s],i.push([r*(a[0]-n[0]),r*(a[1]-n[1])]);return i}function sa(t){if(t.length<3)return na(t);var e=1,n=t.length,i=t[0],r=i[0],o=i[1],a=[r,r,r,(i=t[1])[0]],s=[o,o,o,i[1]],l=[r,",",o,"L",la(ha,a),",",la(ha,s)];for(t.push(t[n-1]);++e<=n;)i=t[e],a.shift(),a.push(i[0]),s.shift(),s.push(i[1]),da(l,a,s);return t.pop(),l.push("L",i),l.join("")}function la(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}ea.forEach((function(t,e){e.key=t,e.closed=/-closed$/.test(t)}));var ua=[0,2/3,1/3,0],ca=[0,1/3,2/3,0],ha=[0,1/6,2/3,1/6];function da(t,e,n){t.push("C",la(ua,e),",",la(ua,n),",",la(ca,e),",",la(ca,n),",",la(ha,e),",",la(ha,n))}function pa(t,e){return(e[1]-t[1])/(e[0]-t[0])}function fa(t){for(var e,n,i,r=-1,o=t.length;++r<o;)n=(e=t[r])[0],i=e[1]+Yo,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function ma(t){var e=yi,n=yi,i=0,r=bi,o=cn,a=na,s=a.key,l=a,u="L",c=.7;function h(s){var h,d,p,f=[],m=[],g=[],v=-1,y=s.length,b=oe(e),_=oe(i),x=e===n?function(){return d}:oe(n),w=i===r?function(){return p}:oe(r);function C(){f.push("M",a(t(g),c),u,l(t(m.reverse()),c),"Z")}for(;++v<y;)o.call(this,h=s[v],v)?(m.push([d=+b.call(this,h,v),p=+_.call(this,h,v)]),g.push([+x.call(this,h,v),+w.call(this,h,v)])):m.length&&(C(),m=[],g=[]);return m.length&&C(),f.length?f.join(""):null}return h.x=function(t){return arguments.length?(e=n=t,h):n},h.x0=function(t){return arguments.length?(e=t,h):e},h.x1=function(t){return arguments.length?(n=t,h):n},h.y=function(t){return arguments.length?(i=r=t,h):r},h.y0=function(t){return arguments.length?(i=t,h):i},h.y1=function(t){return arguments.length?(r=t,h):r},h.defined=function(t){return arguments.length?(o=t,h):o},h.interpolate=function(t){return arguments.length?(s="function"==typeof t?a=t:(a=ea.get(t)||na).key,l=a.reverse||a,u=a.closed?"M":"L",h):s},h.tension=function(t){return arguments.length?(c=t,h):c},h}function ga(t){return t.radius}function va(t){return[t.x,t.y]}function ya(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]+Yo;return[n*Math.cos(i),n*Math.sin(i)]}}function ba(){return 64}function _a(){return"circle"}function xa(t){var e=Math.sqrt(t/pt);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}t.svg.line.radial=function(){var t=ta(fa);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},ia.reverse=ra,ra.reverse=ia,t.svg.area=function(){return ma(ae)},t.svg.area.radial=function(){var t=ma(fa);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},t.svg.chord=function(){var t=ri,e=oi,n=ga,i=Jo,r=Zo;function o(n,i){var r=a(this,t,n,i),o=a(this,e,n,i);return"M"+r.p0+s(r.r,r.p1,r.a1-r.a0)+(function(t,e){return t.a0==e.a0&&t.a1==e.a1}(r,o)?l(r.r,r.p1,r.r,r.p0):l(r.r,r.p1,o.r,o.p0)+s(o.r,o.p1,o.a1-o.a0)+l(o.r,o.p1,r.r,r.p0))+"Z"}function a(t,e,o,a){var s=e.call(t,o,a),l=n.call(t,s,a),u=i.call(t,s,a)+Yo,c=r.call(t,s,a)+Yo;return{r:l,a0:u,a1:c,p0:[l*Math.cos(u),l*Math.sin(u)],p1:[l*Math.cos(c),l*Math.sin(c)]}}function s(t,e,n){return"A"+t+","+t+" 0 "+ +(n>pt)+",1 "+e}function l(t,e,n,i){return"Q 0,0 "+i}return o.radius=function(t){return arguments.length?(n=oe(t),o):n},o.source=function(e){return arguments.length?(t=oe(e),o):t},o.target=function(t){return arguments.length?(e=oe(t),o):e},o.startAngle=function(t){return arguments.length?(i=oe(t),o):i},o.endAngle=function(t){return arguments.length?(r=oe(t),o):r},o},t.svg.diagonal=function(){var t=ri,e=oi,n=va;function i(i,r){var o=t.call(this,i,r),a=e.call(this,i,r),s=(o.y+a.y)/2,l=[o,{x:o.x,y:s},{x:a.x,y:s},a];return"M"+(l=l.map(n))[0]+"C"+l[1]+" "+l[2]+" "+l[3]}return i.source=function(e){return arguments.length?(t=oe(e),i):t},i.target=function(t){return arguments.length?(e=oe(t),i):e},i.projection=function(t){return arguments.length?(n=t,i):n},i},t.svg.diagonal.radial=function(){var e=t.svg.diagonal(),n=va,i=e.projection;return e.projection=function(t){return arguments.length?i(ya(n=t)):n},e},t.svg.symbol=function(){var t=_a,e=ba;function n(n,i){return(wa.get(t.call(this,n,i))||xa)(e.call(this,n,i))}return n.type=function(e){return arguments.length?(t=oe(e),n):t},n.size=function(t){return arguments.length?(e=oe(t),n):e},n};var wa=t.map({circle:xa,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Ta)),n=e*Ta;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Ca),n=e*Ca/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Ca),n=e*Ca/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});t.svg.symbolTypes=wa.keys();var Ca=Math.sqrt(3),Ta=Math.tan(30*vt);function Sa(t,e){return D(t,Ea),t.id=e,t}var ka,Aa,Ea=[],Ma=0;function Pa(t,e,n,i){var r=t.id;return J(t,"function"==typeof n?function(t,o,a){t.__transition__[r].tween.set(e,i(n.call(t,t.__data__,o,a)))}:(n=i(n),function(t){t.__transition__[r].tween.set(e,n)}))}function Da(t){return null==t&&(t=""),function(){this.textContent=t}}function Oa(e,n,i,r){var o=e.__transition__||(e.__transition__={active:0,count:0}),a=o[i];if(!a){var s=r.time;a=o[i]={tween:new v,time:s,ease:r.ease,delay:r.delay,duration:r.duration},++o.count,t.timer((function(r){var l=e.__data__,u=a.ease,c=a.delay,h=a.duration,d=pe,p=[];if(d.t=c+s,c<=r)return f(r-c);function f(r){if(o.active>i)return g();o.active=i,a.event&&a.event.start.call(e,l,n),a.tween.forEach((function(t,i){(i=i.call(e,l,n))&&p.push(i)})),t.timer((function(){return d.c=m(r||1)?cn:m,1}),0,s)}function m(t){if(o.active!==i)return g();for(var r=t/h,s=u(r),c=p.length;c>0;)p[--c].call(e,s);return r>=1?(a.event&&a.event.end.call(e,l,n),g()):void 0}function g(){return--o.count?delete o[i]:delete e.__transition__,1}d.c=f}),0,s)}}Ea.call=F.call,Ea.empty=F.empty,Ea.node=F.node,Ea.size=F.size,t.transition=function(t){return arguments.length?ka?t.transition():t:it.transition()},t.transition.prototype=Ea,Ea.select=function(t){var e,n,i,r=this.id,o=[];t=B(t);for(var a=-1,s=this.length;++a<s;){o.push(e=[]);for(var l=this[a],u=-1,c=l.length;++u<c;)(i=l[u])&&(n=t.call(i,i.__data__,u,a))?("__data__"in i&&(n.__data__=i.__data__),Oa(n,u,r,i.__transition__[r]),e.push(n)):e.push(null)}return Sa(o,r)},Ea.selectAll=function(t){var e,n,i,r,o,a=this.id,s=[];t=z(t);for(var l=-1,u=this.length;++l<u;)for(var c=this[l],h=-1,d=c.length;++h<d;)if(i=c[h]){o=i.__transition__[a],n=t.call(i,i.__data__,h,l),s.push(e=[]);for(var p=-1,f=n.length;++p<f;)(r=n[p])&&Oa(r,p,a,o),e.push(r)}return Sa(s,a)},Ea.filter=function(t){var e,n,i=[];"function"!=typeof t&&(t=Q(t));for(var r=0,o=this.length;r<o;r++){i.push(e=[]);for(var a,s=0,l=(a=this[r]).length;s<l;s++)(n=a[s])&&t.call(n,n.__data__,s)&&e.push(n)}return Sa(i,this.id)},Ea.tween=function(t,e){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(t):J(this,null==e?function(e){e.__transition__[n].tween.remove(t)}:function(i){i.__transition__[n].tween.set(t,e)})},Ea.attr=function(e,n){if(arguments.length<2){for(n in e)this.attr(n,e[n]);return this}var i="transform"==e?Ir:pr,r=t.ns.qualify(e);function o(){this.removeAttribute(r)}function a(){this.removeAttributeNS(r.space,r.local)}function s(t){return null==t?o:(t+="",function(){var e,n=this.getAttribute(r);return n!==t&&(e=i(n,t),function(t){this.setAttribute(r,e(t))})})}function l(t){return null==t?a:(t+="",function(){var e,n=this.getAttributeNS(r.space,r.local);return n!==t&&(e=i(n,t),function(t){this.setAttributeNS(r.space,r.local,e(t))})})}return Pa(this,"attr."+e,n,r.local?l:s)},Ea.attrTween=function(e,n){var i=t.ns.qualify(e);return this.tween("attr."+e,i.local?function(t,e){var r=n.call(this,t,e,this.getAttributeNS(i.space,i.local));return r&&function(t){this.setAttributeNS(i.space,i.local,r(t))}}:function(t,e){var r=n.call(this,t,e,this.getAttribute(i));return r&&function(t){this.setAttribute(i,r(t))}})},Ea.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.style(n,t[n],e);return this}n=""}function r(){this.style.removeProperty(t)}function a(e){return null==e?r:(e+="",function(){var i,r=o.getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(i=pr(r,e),function(e){this.style.setProperty(t,i(e),n)})})}return Pa(this,"style."+t,e,a)},Ea.styleTween=function(t,e,n){function i(i,r){var a=e.call(this,i,r,o.getComputedStyle(this,null).getPropertyValue(t));return a&&function(e){this.style.setProperty(t,a(e),n)}}return arguments.length<3&&(n=""),this.tween("style."+t,i)},Ea.text=function(t){return Pa(this,"text",t,Da)},Ea.remove=function(){return this.each("end.transition",(function(){var t;this.__transition__.count<2&&(t=this.parentNode)&&t.removeChild(this)}))},Ea.ease=function(e){var n=this.id;return arguments.length<1?this.node().__transition__[n].ease:("function"!=typeof e&&(e=t.ease.apply(t,arguments)),J(this,(function(t){t.__transition__[n].ease=e})))},Ea.delay=function(t){var e=this.id;return J(this,"function"==typeof t?function(n,i,r){n.__transition__[e].delay=+t.call(n,n.__data__,i,r)}:(t=+t,function(n){n.__transition__[e].delay=t}))},Ea.duration=function(t){var e=this.id;return J(this,"function"==typeof t?function(n,i,r){n.__transition__[e].duration=Math.max(1,t.call(n,n.__data__,i,r))}:(t=Math.max(1,t),function(n){n.__transition__[e].duration=t}))},Ea.each=function(e,n){var i=this.id;if(arguments.length<2){var r=Aa,o=ka;ka=i,J(this,(function(t,n,r){Aa=t.__transition__[i],e.call(t,t.__data__,n,r)})),Aa=r,ka=o}else J(this,(function(r){var o=r.__transition__[i];(o.event||(o.event=t.dispatch("start","end"))).on(e,n)}));return this},Ea.transition=function(){for(var t,e,n,i=this.id,r=++Ma,o=[],a=0,s=this.length;a<s;a++){o.push(t=[]);for(var l,u=0,c=(l=this[a]).length;u<c;u++)(e=l[u])&&((n=Object.create(e.__transition__[i])).delay+=n.duration,Oa(e,u,r,n)),t.push(e)}return Sa(o,r)},t.svg.axis=function(){var e,n=t.scale.linear(),i=Ia,r=6,o=6,a=3,s=[10],l=null;function u(u){u.each((function(){var u,c=t.select(this),h=this.__chart__||n,d=this.__chart__=n.copy(),p=null==l?d.ticks?d.ticks.apply(d,s):d.domain():l,f=null==e?d.tickFormat?d.tickFormat.apply(d,s):ae:e,m=c.selectAll(".tick").data(p,d),g=m.enter().insert("g",".domain").attr("class","tick").style("opacity",gt),v=t.transition(m.exit()).style("opacity",gt).remove(),y=t.transition(m).style("opacity",1),b=Do(d),_=c.selectAll(".domain").data([0]),x=(_.enter().append("path").attr("class","domain"),t.transition(_));g.append("line"),g.append("text");var w=g.select("line"),C=y.select("line"),T=m.select("text").text(f),S=g.select("text"),k=y.select("text");switch(i){case"bottom":u=Ra,w.attr("y2",r),S.attr("y",Math.max(r,0)+a),C.attr("x2",0).attr("y2",r),k.attr("x",0).attr("y",Math.max(r,0)+a),T.attr("dy",".71em").style("text-anchor","middle"),x.attr("d","M"+b[0]+","+o+"V0H"+b[1]+"V"+o);break;case"top":u=Ra,w.attr("y2",-r),S.attr("y",-(Math.max(r,0)+a)),C.attr("x2",0).attr("y2",-r),k.attr("x",0).attr("y",-(Math.max(r,0)+a)),T.attr("dy","0em").style("text-anchor","middle"),x.attr("d","M"+b[0]+","+-o+"V0H"+b[1]+"V"+-o);break;case"left":u=Na,w.attr("x2",-r),S.attr("x",-(Math.max(r,0)+a)),C.attr("x2",-r).attr("y2",0),k.attr("x",-(Math.max(r,0)+a)).attr("y",0),T.attr("dy",".32em").style("text-anchor","end"),x.attr("d","M"+-o+","+b[0]+"H0V"+b[1]+"H"+-o);break;case"right":u=Na,w.attr("x2",r),S.attr("x",Math.max(r,0)+a),C.attr("x2",r).attr("y2",0),k.attr("x",Math.max(r,0)+a).attr("y",0),T.attr("dy",".32em").style("text-anchor","start"),x.attr("d","M"+o+","+b[0]+"H0V"+b[1]+"H"+o)}if(d.rangeBand){var A=d.rangeBand()/2,E=function(t){return d(t)+A};g.call(u,E),y.call(u,E)}else g.call(u,h),y.call(u,d),v.call(u,d)}))}return u.scale=function(t){return arguments.length?(n=t,u):n},u.orient=function(t){return arguments.length?(i=t in La?t+"":Ia,u):i},u.ticks=function(){return arguments.length?(s=arguments,u):s},u.tickValues=function(t){return arguments.length?(l=t,u):l},u.tickFormat=function(t){return arguments.length?(e=t,u):e},u.tickSize=function(t){var e=arguments.length;return e?(r=+t,o=+arguments[e-1],u):r},u.innerTickSize=function(t){return arguments.length?(r=+t,u):r},u.outerTickSize=function(t){return arguments.length?(o=+t,u):o},u.tickPadding=function(t){return arguments.length?(a=+t,u):a},u.tickSubdivide=function(){return arguments.length&&u},u};var Ia="bottom",La={top:1,right:1,bottom:1,left:1};function Ra(t,e){t.attr("transform",(function(t){return"translate("+e(t)+",0)"}))}function Na(t,e){t.attr("transform",(function(t){return"translate(0,"+e(t)+")"}))}t.svg.brush=function(){var e,n,i=M(d,"brushstart","brush","brushend"),r=null,a=null,s=[0,0],l=[0,0],u=!0,c=!0,h=Ba[0];function d(e){e.each((function(){var e=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",g).on("touchstart.brush",g),n=e.selectAll(".background").data([0]);n.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var i=e.selectAll(".resize").data(h,ae);i.exit().remove(),i.enter().append("g").attr("class",(function(t){return"resize "+t})).style("cursor",(function(t){return Fa[t]})).append("rect").attr("x",(function(t){return/[ew]$/.test(t)?-3:null})).attr("y",(function(t){return/^[ns]/.test(t)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden"),i.style("display",d.empty()?"none":null);var o,s=t.transition(e),l=t.transition(n);r&&(o=Do(r),l.attr("x",o[0]).attr("width",o[1]-o[0]),f(s)),a&&(o=Do(a),l.attr("y",o[0]).attr("height",o[1]-o[0]),m(s)),p(s)}))}function p(t){t.selectAll(".resize").attr("transform",(function(t){return"translate("+s[+/e$/.test(t)]+","+l[+/^s/.test(t)]+")"}))}function f(t){t.select(".extent").attr("x",s[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",s[1]-s[0])}function m(t){t.select(".extent").attr("y",l[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",l[1]-l[0])}function g(){var h,g,v=this,y=t.select(t.event.target),b=i.of(v,arguments),_=t.select(v),x=y.datum(),w=!/^(n|s)$/.test(x)&&r,C=!/^(e|w)$/.test(x)&&a,T=y.classed("extent"),S=ct(),k=t.mouse(v),E=t.select(o).on("keydown.brush",D).on("keyup.brush",O);if(t.event.changedTouches?E.on("touchmove.brush",I).on("touchend.brush",R):E.on("mousemove.brush",I).on("mouseup.brush",R),_.interrupt().selectAll("*").interrupt(),T)k[0]=s[0]-k[0],k[1]=l[0]-k[1];else if(x){var M=+/w$/.test(x),P=+/^n/.test(x);g=[s[1-M]-k[0],l[1-P]-k[1]],k[0]=s[M],k[1]=l[P]}else t.event.altKey&&(h=k.slice());function D(){32==t.event.keyCode&&(T||(h=null,k[0]-=s[1],k[1]-=l[1],T=2),A())}function O(){32==t.event.keyCode&&2==T&&(k[0]+=s[1],k[1]+=l[1],T=0,A())}function I(){var e=t.mouse(v),n=!1;g&&(e[0]+=g[0],e[1]+=g[1]),T||(t.event.altKey?(h||(h=[(s[0]+s[1])/2,(l[0]+l[1])/2]),k[0]=s[+(e[0]<h[0])],k[1]=l[+(e[1]<h[1])]):h=null),w&&L(e,r,0)&&(f(_),n=!0),C&&L(e,a,1)&&(m(_),n=!0),n&&(p(_),b({type:"brush",mode:T?"move":"resize"}))}function L(t,i,r){var o,a,d=Do(i),p=d[0],f=d[1],m=k[r],g=r?l:s,v=g[1]-g[0];if(T&&(p-=m,f-=v+m),o=(r?c:u)?Math.max(p,Math.min(f,t[r])):t[r],T?a=(o+=m)+v:(h&&(m=Math.max(p,Math.min(f,2*h[r]-o))),m<o?(a=o,o=m):a=m),g[0]!=o||g[1]!=a)return r?n=null:e=null,g[0]=o,g[1]=a,!0}function R(){I(),_.style("pointer-events","all").selectAll(".resize").style("display",d.empty()?"none":null),t.select("body").style("cursor",null),E.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),S(),b({type:"brushend"})}_.style("pointer-events","none").selectAll(".resize").style("display",null),t.select("body").style("cursor",y.style("cursor")),b({type:"brushstart"}),I()}return d.event=function(r){r.each((function(){var r=i.of(this,arguments),o={x:s,y:l,i:e,j:n},a=this.__chart__||o;this.__chart__=o,ka?t.select(this).transition().each("start.brush",(function(){e=a.i,n=a.j,s=a.x,l=a.y,r({type:"brushstart"})})).tween("brush:brush",(function(){var t=fr(s,o.x),i=fr(l,o.y);return e=n=null,function(e){s=o.x=t(e),l=o.y=i(e),r({type:"brush",mode:"resize"})}})).each("end.brush",(function(){e=o.i,n=o.j,r({type:"brush",mode:"resize"}),r({type:"brushend"})})):(r({type:"brushstart"}),r({type:"brush",mode:"resize"}),r({type:"brushend"}))}))},d.x=function(t){return arguments.length?(h=Ba[!(r=t)<<1|!a],d):r},d.y=function(t){return arguments.length?(h=Ba[!r<<1|!(a=t)],d):a},d.clamp=function(t){return arguments.length?(r&&a?(u=!!t[0],c=!!t[1]):r?u=!!t:a&&(c=!!t),d):r&&a?[u,c]:r?u:a?c:null},d.extent=function(t){var i,o,u,c,h;return arguments.length?(r&&(i=t[0],o=t[1],a&&(i=i[0],o=o[0]),e=[i,o],r.invert&&(i=r(i),o=r(o)),o<i&&(h=i,i=o,o=h),i==s[0]&&o==s[1]||(s=[i,o])),a&&(u=t[0],c=t[1],r&&(u=u[1],c=c[1]),n=[u,c],a.invert&&(u=a(u),c=a(c)),c<u&&(h=u,u=c,c=h),u==l[0]&&c==l[1]||(l=[u,c])),d):(r&&(e?(i=e[0],o=e[1]):(i=s[0],o=s[1],r.invert&&(i=r.invert(i),o=r.invert(o)),o<i&&(h=i,i=o,o=h))),a&&(n?(u=n[0],c=n[1]):(u=l[0],c=l[1],a.invert&&(u=a.invert(u),c=a.invert(c)),c<u&&(h=u,u=c,c=h))),r&&a?[[i,u],[o,c]]:r?[i,o]:a&&[u,c])},d.clear=function(){return d.empty()||(s=[0,0],l=[0,0],e=n=null),d},d.empty=function(){return!!r&&s[0]==s[1]||!!a&&l[0]==l[1]},t.rebind(d,i,"on")};var Fa={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ba=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],za=t.time={},ja=Date;function Va(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}Va.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Ha.setUTCDate.apply(this._,arguments)},setDay:function(){Ha.setUTCDay.apply(this._,arguments)},setFullYear:function(){Ha.setUTCFullYear.apply(this._,arguments)},setHours:function(){Ha.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Ha.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Ha.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Ha.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Ha.setUTCSeconds.apply(this._,arguments)},setTime:function(){Ha.setTime.apply(this._,arguments)}};var Ha=Date.prototype,Wa=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ua=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],$a=["January","February","March","April","May","June","July","August","September","October","November","December"],Ga=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function qa(t,e,n){function i(e){var n=t(e),i=o(n,1);return e-n<i-e?n:i}function r(n){return e(n=t(new ja(n-1)),1),n}function o(t,n){return e(t=new ja(+t),n),t}function a(t,i,o){var a=r(t),s=[];if(o>1)for(;a<i;)n(a)%o||s.push(new Date(+a)),e(a,1);else for(;a<i;)s.push(new Date(+a)),e(a,1);return s}t.floor=t,t.round=i,t.ceil=r,t.offset=o,t.range=a;var s=t.utc=Ya(t);return s.floor=s,s.round=Ya(i),s.ceil=Ya(r),s.offset=Ya(o),s.range=function(t,e,n){try{ja=Va;var i=new Va;return i._=t,a(i,e,n)}finally{ja=Date}},t}function Ya(t){return function(e,n){try{ja=Va;var i=new Va;return i._=e,t(i,n)._}finally{ja=Date}}}function Xa(t){var e=t.length;function n(n){for(var i,r,o,a=[],s=-1,l=0;++s<e;)37===t.charCodeAt(s)&&(a.push(t.substring(l,s)),null!=(r=us[i=t.charAt(++s)])&&(i=t.charAt(++s)),(o=cs[i])&&(i=o(n,null==r?"e"===i?" ":"0":r)),a.push(i),l=s+1);return a.push(t.substring(l,s)),a.join("")}return n.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(Qa(n,t,e,0)!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var i=null!=n.Z&&ja!==Va,r=new(i?Va:ja);return"j"in n?r.setFullYear(n.y,0,n.j):"w"in n&&("W"in n||"U"in n)?(r.setFullYear(n.y,0,1),r.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(r.getDay()+5)%7:n.w+7*n.U-(r.getDay()+6)%7)):r.setFullYear(n.y,n.m,n.d),r.setHours(n.H+Math.floor(n.Z/100),n.M+n.Z%100,n.S,n.L),i?r._:r},n.toString=function(){return t},n}function Qa(t,e,n,i){for(var r,o,a,s=0,l=e.length,u=n.length;s<l;){if(i>=u)return-1;if(37===(r=e.charCodeAt(s++))){if(a=e.charAt(s++),!(o=hs[a in us?e.charAt(s++):a])||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function Ka(e){return new RegExp("^(?:"+e.map(t.requote).join("|")+")","i")}function Ja(t){for(var e=new v,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function Za(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(e)+r:r)}za.year=qa((function(t){return(t=za.day(t)).setMonth(0,1),t}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t){return t.getFullYear()})),za.years=za.year.range,za.years.utc=za.year.utc.range,za.day=qa((function(t){var e=new ja(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t){return t.getDate()-1})),za.days=za.day.range,za.days.utc=za.day.utc.range,za.dayOfYear=function(t){var e=za.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].forEach((function(t,e){t=t.toLowerCase(),e=7-e;var n=za[t]=qa((function(t){return(t=za.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t}),(function(t,e){t.setDate(t.getDate()+7*Math.floor(e))}),(function(t){var n=za.year(t).getDay();return Math.floor((za.dayOfYear(t)+(n+e)%7)/7)-(n!==e)}));za[t+"s"]=n.range,za[t+"s"].utc=n.utc.range,za[t+"OfYear"]=function(t){var n=za.year(t).getDay();return Math.floor((za.dayOfYear(t)+(n+e)%7)/7)}})),za.week=za.sunday,za.weeks=za.sunday.range,za.weeks.utc=za.sunday.utc.range,za.weekOfYear=za.sundayOfYear,za.format=Xa;var ts=Ka(Wa),es=Ja(Wa),ns=Ka(Ua),is=Ja(Ua),rs=Ka($a),os=Ja($a),as=Ka(Ga),ss=Ja(Ga),ls=/^%/,us={"-":"",_:" ",0:"0"},cs={a:function(t){return Ua[t.getDay()]},A:function(t){return Wa[t.getDay()]},b:function(t){return Ga[t.getMonth()]},B:function(t){return $a[t.getMonth()]},c:Xa("%a %b %e %X %Y"),d:function(t,e){return Za(t.getDate(),e,2)},e:function(t,e){return Za(t.getDate(),e,2)},H:function(t,e){return Za(t.getHours(),e,2)},I:function(t,e){return Za(t.getHours()%12||12,e,2)},j:function(t,e){return Za(1+za.dayOfYear(t),e,3)},L:function(t,e){return Za(t.getMilliseconds(),e,3)},m:function(t,e){return Za(t.getMonth()+1,e,2)},M:function(t,e){return Za(t.getMinutes(),e,2)},p:function(t){return t.getHours()>=12?"PM":"AM"},S:function(t,e){return Za(t.getSeconds(),e,2)},U:function(t,e){return Za(za.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Za(za.mondayOfYear(t),e,2)},x:Xa("%m/%d/%Y"),X:Xa("%H:%M:%S"),y:function(t,e){return Za(t.getFullYear()%100,e,2)},Y:function(t,e){return Za(t.getFullYear()%1e4,e,4)},Z:function(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=~~(f(e)/60),r=f(e)%60;return n+Za(i,"0",2)+Za(r,"0",2)},"%":function(){return"%"}},hs={a:function(t,e,n){ns.lastIndex=0;var i=ns.exec(e.substring(n));return i?(t.w=is.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){ts.lastIndex=0;var i=ts.exec(e.substring(n));return i?(t.w=es.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){as.lastIndex=0;var i=as.exec(e.substring(n));return i?(t.m=ss.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){rs.lastIndex=0;var i=rs.exec(e.substring(n));return i?(t.m=os.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,e,n){return Qa(t,cs.c.toString(),e,n)},d:ds,e:ds,H:ps,I:ps,j:function(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1},L:function(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1},m:function(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1},M:function(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1},p:function(t,e,n){var i=ms.get(e.substring(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)},S:function(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1},U:function(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n));return i?(t.U=+i[0],n+i[0].length):-1},w:function(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1},W:function(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n));return i?(t.W=+i[0],n+i[0].length):-1},x:function(t,e,n){return Qa(t,cs.x.toString(),e,n)},X:function(t,e,n){return Qa(t,cs.X.toString(),e,n)},y:function(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n,n+2));return i?(t.y=(r=+i[0],r+(r>68?1900:2e3)),n+i[0].length):-1;var r},Y:function(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1},Z:function(t,e,n){return/^[+-]\d{4}$/.test(e=e.substring(n,n+5))?(t.Z=+e,n+5):-1},"%":function(t,e,n){ls.lastIndex=0;var i=ls.exec(e.substring(n,n+1));return i?n+i[0].length:-1}};function ds(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function ps(t,e,n){fs.lastIndex=0;var i=fs.exec(e.substring(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}var fs=/^\s*\d+/;var ms=t.map({am:0,pm:1});function gs(t){var e=Xa(t);function n(t){try{var n=new(ja=Va);return n._=t,e(n)}finally{ja=Date}}return n.parse=function(t){try{ja=Va;var n=e.parse(t);return n&&n._}finally{ja=Date}},n.toString=e.toString,n}Xa.utc=gs;var vs=gs("%Y-%m-%dT%H:%M:%S.%LZ");function ys(t){return t.toISOString()}function bs(e,n,i){function r(t){return e(t)}function o(e,i){var r=(e[1]-e[0])/i,o=t.bisect(ws,r);return o==ws.length?[n.year,Bo(e.map((function(t){return t/31536e6})),i)[2]]:o?n[r/ws[o-1]<ws[o]/r?o-1:o]:[Ss,Bo(e,i)[2]]}return r.invert=function(t){return _s(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain(t),r):e.domain().map(_s)},r.nice=function(t,e){var n=r.domain(),i=Po(n),a=null==t?o(i,10):"number"==typeof t&&o(i,t);function s(n){return!isNaN(n)&&!t.range(n,_s(+n+1),e).length}return a&&(t=a[0],e=a[1]),r.domain(Io(n,e>1?{floor:function(e){for(;s(e=t.floor(e));)e=_s(e-1);return e},ceil:function(e){for(;s(e=t.ceil(e));)e=_s(+e+1);return e}}:t))},r.ticks=function(t,e){var n=Po(r.domain()),i=null==t?o(n,10):"number"==typeof t?o(n,t):!t.range&&[{range:t},e];return i&&(t=i[0],e=i[1]),t.range(n[0],_s(+n[1]+1),e<1?1:e)},r.tickFormat=function(){return i},r.copy=function(){return bs(e.copy(),n,i)},No(r,e)}function _s(t){return new Date(t)}function xs(t){return function(e){for(var n=t.length-1,i=t[n];!i[1](e);)i=t[--n];return i[0](e)}}Xa.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?ys:vs,ys.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},ys.toString=vs.toString,za.second=qa((function(t){return new ja(1e3*Math.floor(t/1e3))}),(function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))}),(function(t){return t.getSeconds()})),za.seconds=za.second.range,za.seconds.utc=za.second.utc.range,za.minute=qa((function(t){return new ja(6e4*Math.floor(t/6e4))}),(function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))}),(function(t){return t.getMinutes()})),za.minutes=za.minute.range,za.minutes.utc=za.minute.utc.range,za.hour=qa((function(t){var e=t.getTimezoneOffset()/60;return new ja(36e5*(Math.floor(t/36e5-e)+e))}),(function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))}),(function(t){return t.getHours()})),za.hours=za.hour.range,za.hours.utc=za.hour.utc.range,za.month=qa((function(t){return(t=za.day(t)).setDate(1),t}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t){return t.getMonth()})),za.months=za.month.range,za.months.utc=za.month.utc.range;var ws=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Cs=[[za.second,1],[za.second,5],[za.second,15],[za.second,30],[za.minute,1],[za.minute,5],[za.minute,15],[za.minute,30],[za.hour,1],[za.hour,3],[za.hour,6],[za.hour,12],[za.day,1],[za.day,2],[za.week,1],[za.month,1],[za.month,3],[za.year,1]],Ts=xs([[Xa("%Y"),cn],[Xa("%B"),function(t){return t.getMonth()}],[Xa("%b %d"),function(t){return 1!=t.getDate()}],[Xa("%a %d"),function(t){return t.getDay()&&1!=t.getDate()}],[Xa("%I %p"),function(t){return t.getHours()}],[Xa("%I:%M"),function(t){return t.getMinutes()}],[Xa(":%S"),function(t){return t.getSeconds()}],[Xa(".%L"),function(t){return t.getMilliseconds()}]]);Cs.year=za.year,za.scale=function(){return bs(t.scale.linear(),Cs,Ts)};var Ss={range:function(e,n,i){return t.range(+e,+n,i).map(_s)}},ks=Cs.map((function(t){return[t[0].utc,t[1]]})),As=xs([[gs("%Y"),cn],[gs("%B"),function(t){return t.getUTCMonth()}],[gs("%b %d"),function(t){return 1!=t.getUTCDate()}],[gs("%a %d"),function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],[gs("%I %p"),function(t){return t.getUTCHours()}],[gs("%I:%M"),function(t){return t.getUTCMinutes()}],[gs(":%S"),function(t){return t.getUTCSeconds()}],[gs(".%L"),function(t){return t.getUTCMilliseconds()}]]);function Es(t){return JSON.parse(t.responseText)}function Ms(t){var e=i.createRange();return e.selectNode(i.body),e.createContextualFragment(t.responseText)}return ks.year=za.year.utc,za.scale.utc=function(){return bs(t.scale.linear(),ks,As)},t.text=se((function(t){return t.responseText})),t.json=function(t,e){return le(t,"application/json",Es,e)},t.html=function(t,e){return le(t,"text/html",Ms,e)},t.xml=se((function(t){return t.responseXML})),t}()},191:function(t,e,n){var i,r,o;r=[n(57)],void 0===(o="function"==typeof(i=function(t){t.ui=t.ui||{},t.ui.version="1.12.1";var e,n=0,i=Array.prototype.slice;t.cleanData=(e=t.cleanData,function(n){var i,r,o;for(o=0;null!=(r=n[o]);o++)try{(i=t._data(r,"events"))&&i.remove&&t(r).triggerHandler("remove")}catch(t){}e(n)}),t.widget=function(e,n,i){var r,o,a,s={},l=e.split(".")[0],u=l+"-"+(e=e.split(".")[1]);return i||(i=n,n=t.Widget),t.isArray(i)&&(i=t.extend.apply(null,[{}].concat(i))),t.expr[":"][u.toLowerCase()]=function(e){return!!t.data(e,u)},t[l]=t[l]||{},r=t[l][e],o=t[l][e]=function(t,e){if(!this._createWidget)return new o(t,e);arguments.length&&this._createWidget(t,e)},t.extend(o,r,{version:i.version,_proto:t.extend({},i),_childConstructors:[]}),(a=new n).options=t.widget.extend({},a.options),t.each(i,(function(e,i){t.isFunction(i)?s[e]=function(){function t(){return n.prototype[e].apply(this,arguments)}function r(t){return n.prototype[e].apply(this,t)}return function(){var e,n=this._super,o=this._superApply;return this._super=t,this._superApply=r,e=i.apply(this,arguments),this._super=n,this._superApply=o,e}}():s[e]=i})),o.prototype=t.widget.extend(a,{widgetEventPrefix:r&&a.widgetEventPrefix||e},s,{constructor:o,namespace:l,widgetName:e,widgetFullName:u}),r?(t.each(r._childConstructors,(function(e,n){var i=n.prototype;t.widget(i.namespace+"."+i.widgetName,o,n._proto)})),delete r._childConstructors):n._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var n,r,o=i.call(arguments,1),a=0,s=o.length;a<s;a++)for(n in o[a])r=o[a][n],o[a].hasOwnProperty(n)&&void 0!==r&&(t.isPlainObject(r)?e[n]=t.isPlainObject(e[n])?t.widget.extend({},e[n],r):t.widget.extend({},r):e[n]=r);return e},t.widget.bridge=function(e,n){var r=n.prototype.widgetFullName||e;t.fn[e]=function(o){var a="string"==typeof o,s=i.call(arguments,1),l=this;return a?this.length||"instance"!==o?this.each((function(){var n,i=t.data(this,r);return"instance"===o?(l=i,!1):i?t.isFunction(i[o])&&"_"!==o.charAt(0)?(n=i[o].apply(i,s))!==i&&void 0!==n?(l=n&&n.jquery?l.pushStack(n.get()):n,!1):void 0:t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")})):l=void 0:(s.length&&(o=t.widget.extend.apply(null,[o].concat(s))),this.each((function(){var e=t.data(this,r);e?(e.option(o||{}),e._init&&e._init()):t.data(this,r,new n(o,this))}))),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,(function(t,n){e._removeClass(n,t)})),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,n){var i,r,o,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},i=e.split("."),e=i.shift(),i.length){for(r=a[e]=t.widget.extend({},this.options[e]),o=0;o<i.length-1;o++)r[i[o]]=r[i[o]]||{},r=r[i[o]];if(e=i.pop(),1===arguments.length)return void 0===r[e]?null:r[e];r[e]=n}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=n}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var n,i,r;for(n in e)r=this.classesElementLookup[n],e[n]!==this.options.classes[n]&&r&&r.length&&(i=t(r.get()),this._removeClass(r,n),i.addClass(this._classes({element:i,keys:n,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){var n=[],i=this;function r(r,o){var a,s;for(s=0;s<r.length;s++)a=i.classesElementLookup[r[s]]||t(),a=e.add?t(t.unique(a.get().concat(e.element.get()))):t(a.not(e.element).get()),i.classesElementLookup[r[s]]=a,n.push(r[s]),o&&e.classes[r[s]]&&n.push(e.classes[r[s]])}return e=t.extend({element:this.element,classes:this.options.classes||{}},e),this._on(e.element,{remove:"_untrackClassesElement"}),e.keys&&r(e.keys.match(/\S+/g)||[],!0),e.extra&&r(e.extra.match(/\S+/g)||[]),n.join(" ")},_untrackClassesElement:function(e){var n=this;t.each(n.classesElementLookup,(function(i,r){-1!==t.inArray(e.target,r)&&(n.classesElementLookup[i]=t(r.not(e.target).get()))}))},_removeClass:function(t,e,n){return this._toggleClass(t,e,n,!1)},_addClass:function(t,e,n){return this._toggleClass(t,e,n,!0)},_toggleClass:function(t,e,n,i){i="boolean"==typeof i?i:n;var r="string"==typeof t||null===t,o={extra:r?e:n,keys:r?t:e,element:r?this.element:t,add:i};return o.element.toggleClass(this._classes(o),i),this},_on:function(e,n,i){var r,o=this;"boolean"!=typeof e&&(i=n,n=e,e=!1),i?(n=r=t(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),t.each(i,(function(i,a){function s(){if(e||!0!==o.options.disabled&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof a?o[a]:a).apply(o,arguments)}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||t.guid++);var l=i.match(/^([\w:-]*)\s*(.*)$/),u=l[1]+o.eventNamespace,c=l[2];c?r.on(u,c,s):n.on(u,s)}))},_off:function(e,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(n).off(n),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){var n=this;return setTimeout((function(){return("string"==typeof t?n[t]:t).apply(n,arguments)}),e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,n,i){var r,o,a=this.options[e];if(i=i||{},(n=t.Event(n)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!(t.isFunction(a)&&!1===a.apply(this.element[0],[n].concat(i))||n.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},(function(e,n){t.Widget.prototype["_"+e]=function(i,r,o){var a;"string"==typeof r&&(r={effect:r});var s=r?!0===r||"number"==typeof r?n:r.effect||n:e;"number"==typeof(r=r||{})&&(r={duration:r}),a=!t.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),a&&t.effects&&t.effects.effect[s]?i[e](r):s!==e&&i[s]?i[s](r.duration,r.easing,o):i.queue((function(n){t(this)[e](),o&&o.call(i[0]),n()}))}})),t.widget,function(){var e,n=Math.max,i=Math.abs,r=/left|center|right/,o=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,l=/%$/,u=t.fn.position;function c(t,e,n){return[parseFloat(t[0])*(l.test(t[0])?e/100:1),parseFloat(t[1])*(l.test(t[1])?n/100:1)]}function h(e,n){return parseInt(t.css(e,n),10)||0}function d(e){var n=e[0];return 9===n.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(n)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.position={scrollbarWidth:function(){if(void 0!==e)return e;var n,i,r=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=r.children()[0];return t("body").append(r),n=o.offsetWidth,r.css("overflow","scroll"),n===(i=o.offsetWidth)&&(i=r[0].clientWidth),r.remove(),e=n-i},getScrollInfo:function(e){var n=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),i=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),r="scroll"===n||"auto"===n&&e.width<e.element[0].scrollWidth;return{width:"scroll"===i||"auto"===i&&e.height<e.element[0].scrollHeight?t.position.scrollbarWidth():0,height:r?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var n=t(e||window),i=t.isWindow(n[0]),r=!!n[0]&&9===n[0].nodeType;return{element:n,isWindow:i,isDocument:r,offset:i||r?{left:0,top:0}:t(e).offset(),scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:n.outerWidth(),height:n.outerHeight()}}},t.fn.position=function(e){if(!e||!e.of)return u.apply(this,arguments);e=t.extend({},e);var l,p,f,m,g,v,y=t(e.of),b=t.position.getWithinInfo(e.within),_=t.position.getScrollInfo(b),x=(e.collision||"flip").split(" "),w={};return v=d(y),y[0].preventDefault&&(e.at="left top"),p=v.width,f=v.height,m=v.offset,g=t.extend({},m),t.each(["my","at"],(function(){var t,n,i=(e[this]||"").split(" ");1===i.length&&(i=r.test(i[0])?i.concat(["center"]):o.test(i[0])?["center"].concat(i):["center","center"]),i[0]=r.test(i[0])?i[0]:"center",i[1]=o.test(i[1])?i[1]:"center",t=a.exec(i[0]),n=a.exec(i[1]),w[this]=[t?t[0]:0,n?n[0]:0],e[this]=[s.exec(i[0])[0],s.exec(i[1])[0]]})),1===x.length&&(x[1]=x[0]),"right"===e.at[0]?g.left+=p:"center"===e.at[0]&&(g.left+=p/2),"bottom"===e.at[1]?g.top+=f:"center"===e.at[1]&&(g.top+=f/2),l=c(w.at,p,f),g.left+=l[0],g.top+=l[1],this.each((function(){var r,o,a=t(this),s=a.outerWidth(),u=a.outerHeight(),d=h(this,"marginLeft"),v=h(this,"marginTop"),C=s+d+h(this,"marginRight")+_.width,T=u+v+h(this,"marginBottom")+_.height,S=t.extend({},g),k=c(w.my,a.outerWidth(),a.outerHeight());"right"===e.my[0]?S.left-=s:"center"===e.my[0]&&(S.left-=s/2),"bottom"===e.my[1]?S.top-=u:"center"===e.my[1]&&(S.top-=u/2),S.left+=k[0],S.top+=k[1],r={marginLeft:d,marginTop:v},t.each(["left","top"],(function(n,i){t.ui.position[x[n]]&&t.ui.position[x[n]][i](S,{targetWidth:p,targetHeight:f,elemWidth:s,elemHeight:u,collisionPosition:r,collisionWidth:C,collisionHeight:T,offset:[l[0]+k[0],l[1]+k[1]],my:e.my,at:e.at,within:b,elem:a})})),e.using&&(o=function(t){var r=m.left-S.left,o=r+p-s,l=m.top-S.top,c=l+f-u,h={target:{element:y,left:m.left,top:m.top,width:p,height:f},element:{element:a,left:S.left,top:S.top,width:s,height:u},horizontal:o<0?"left":r>0?"right":"center",vertical:c<0?"top":l>0?"bottom":"middle"};p<s&&i(r+o)<p&&(h.horizontal="center"),f<u&&i(l+c)<f&&(h.vertical="middle"),n(i(r),i(o))>n(i(l),i(c))?h.important="horizontal":h.important="vertical",e.using.call(this,t,h)}),a.offset(t.extend(S,{using:o}))}))},t.ui.position={fit:{left:function(t,e){var i,r=e.within,o=r.isWindow?r.scrollLeft:r.offset.left,a=r.width,s=t.left-e.collisionPosition.marginLeft,l=o-s,u=s+e.collisionWidth-a-o;e.collisionWidth>a?l>0&&u<=0?(i=t.left+l+e.collisionWidth-a-o,t.left+=l-i):t.left=u>0&&l<=0?o:l>u?o+a-e.collisionWidth:o:l>0?t.left+=l:u>0?t.left-=u:t.left=n(t.left-s,t.left)},top:function(t,e){var i,r=e.within,o=r.isWindow?r.scrollTop:r.offset.top,a=e.within.height,s=t.top-e.collisionPosition.marginTop,l=o-s,u=s+e.collisionHeight-a-o;e.collisionHeight>a?l>0&&u<=0?(i=t.top+l+e.collisionHeight-a-o,t.top+=l-i):t.top=u>0&&l<=0?o:l>u?o+a-e.collisionHeight:o:l>0?t.top+=l:u>0?t.top-=u:t.top=n(t.top-s,t.top)}},flip:{left:function(t,e){var n,r,o=e.within,a=o.offset.left+o.scrollLeft,s=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,u=t.left-e.collisionPosition.marginLeft,c=u-l,h=u+e.collisionWidth-s-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];c<0?((n=t.left+d+p+f+e.collisionWidth-s-a)<0||n<i(c))&&(t.left+=d+p+f):h>0&&((r=t.left-e.collisionPosition.marginLeft+d+p+f-l)>0||i(r)<h)&&(t.left+=d+p+f)},top:function(t,e){var n,r,o=e.within,a=o.offset.top+o.scrollTop,s=o.height,l=o.isWindow?o.scrollTop:o.offset.top,u=t.top-e.collisionPosition.marginTop,c=u-l,h=u+e.collisionHeight-s-l,d="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,p="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,f=-2*e.offset[1];c<0?((r=t.top+d+p+f+e.collisionHeight-s-a)<0||r<i(c))&&(t.top+=d+p+f):h>0&&((n=t.top-e.collisionPosition.marginTop+d+p+f-l)>0||i(n)<h)&&(t.top+=d+p+f)}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}}}(),t.ui.position,t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo((function(e){return function(n){return!!t.data(n,e)}})):function(e,n,i){return!!t.data(e,i[3])}}),t.fn.extend({disableSelection:(r="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(r+".ui-disableSelection",(function(t){t.preventDefault()}))}),enableSelection:function(){return this.off(".ui-disableSelection")}});var r,o,a,s,l=t;t.effects={effect:{}},function(t,e){var n,i=/^([\-+])=\s*(\d+\.?\d*)/,r=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],o=t.Color=function(e,n,i,r){return new t.Color.fn.parse(e,n,i,r)},a={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},s={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},l=o.support={},u=t("<p>")[0],c=t.each;function h(t,e,n){var i=s[e.type]||{};return null==t?n||!e.def?null:e.def:(t=i.floor?~~t:parseFloat(t),isNaN(t)?e.def:i.mod?(t+i.mod)%i.mod:0>t?0:i.max<t?i.max:t)}function d(e){var i=o(),s=i._rgba=[];return e=e.toLowerCase(),c(r,(function(t,n){var r,o=n.re.exec(e),l=o&&n.parse(o),u=n.space||"rgba";if(l)return r=i[u](l),i[a[u].cache]=r[a[u].cache],s=i._rgba=r._rgba,!1})),s.length?("0,0,0,0"===s.join()&&t.extend(s,n.transparent),i):n[e]}function p(t,e,n){return 6*(n=(n+1)%1)<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}u.style.cssText="background-color:rgba(1,1,1,.5)",l.rgba=u.style.backgroundColor.indexOf("rgba")>-1,c(a,(function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}})),o.fn=t.extend(o.prototype,{parse:function(e,i,r,s){if(void 0===e)return this._rgba=[null,null,null,null],this;(e.jquery||e.nodeType)&&(e=t(e).css(i),i=void 0);var l=this,u=t.type(e),p=this._rgba=[];return void 0!==i&&(e=[e,i,r,s],u="array"),"string"===u?this.parse(d(e)||n._default):"array"===u?(c(a.rgba.props,(function(t,n){p[n.idx]=h(e[n.idx],n)})),this):"object"===u?(c(a,e instanceof o?function(t,n){e[n.cache]&&(l[n.cache]=e[n.cache].slice())}:function(n,i){var r=i.cache;c(i.props,(function(t,n){if(!l[r]&&i.to){if("alpha"===t||null==e[t])return;l[r]=i.to(l._rgba)}l[r][n.idx]=h(e[t],n,!0)})),l[r]&&t.inArray(null,l[r].slice(0,3))<0&&(l[r][3]=1,i.from&&(l._rgba=i.from(l[r])))}),this):void 0},is:function(t){var e=o(t),n=!0,i=this;return c(a,(function(t,r){var o,a=e[r.cache];return a&&(o=i[r.cache]||r.to&&r.to(i._rgba)||[],c(r.props,(function(t,e){if(null!=a[e.idx])return n=a[e.idx]===o[e.idx]}))),n})),n},_space:function(){var t=[],e=this;return c(a,(function(n,i){e[i.cache]&&t.push(n)})),t.pop()},transition:function(t,e){var n=o(t),i=n._space(),r=a[i],l=0===this.alpha()?o("transparent"):this,u=l[r.cache]||r.to(l._rgba),d=u.slice();return n=n[r.cache],c(r.props,(function(t,i){var r=i.idx,o=u[r],a=n[r],l=s[i.type]||{};null!==a&&(null===o?d[r]=a:(l.mod&&(a-o>l.mod/2?o+=l.mod:o-a>l.mod/2&&(o-=l.mod)),d[r]=h((a-o)*e+o,i)))})),this[i](d)},blend:function(e){if(1===this._rgba[3])return this;var n=this._rgba.slice(),i=n.pop(),r=o(e)._rgba;return o(t.map(n,(function(t,e){return(1-i)*r[e]+i*t})))},toRgbaString:function(){var e="rgba(",n=t.map(this._rgba,(function(t,e){return null==t?e>2?1:0:t}));return 1===n[3]&&(n.pop(),e="rgb("),e+n.join()+")"},toHslaString:function(){var e="hsla(",n=t.map(this.hsla(),(function(t,e){return null==t&&(t=e>2?1:0),e&&e<3&&(t=Math.round(100*t)+"%"),t}));return 1===n[3]&&(n.pop(),e="hsl("),e+n.join()+")"},toHexString:function(e){var n=this._rgba.slice(),i=n.pop();return e&&n.push(~~(255*i)),"#"+t.map(n,(function(t){return 1===(t=(t||0).toString(16)).length?"0"+t:t})).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),o.fn.parse.prototype=o.fn,a.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,n,i=t[0]/255,r=t[1]/255,o=t[2]/255,a=t[3],s=Math.max(i,r,o),l=Math.min(i,r,o),u=s-l,c=s+l,h=.5*c;return e=l===s?0:i===s?60*(r-o)/u+360:r===s?60*(o-i)/u+120:60*(i-r)/u+240,n=0===u?0:h<=.5?u/c:u/(2-c),[Math.round(e)%360,n,h,null==a?1:a]},a.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,n=t[1],i=t[2],r=t[3],o=i<=.5?i*(1+n):i+n-i*n,a=2*i-o;return[Math.round(255*p(a,o,e+1/3)),Math.round(255*p(a,o,e)),Math.round(255*p(a,o,e-1/3)),r]},c(a,(function(e,n){var r=n.props,a=n.cache,s=n.to,l=n.from;o.fn[e]=function(e){if(s&&!this[a]&&(this[a]=s(this._rgba)),void 0===e)return this[a].slice();var n,i=t.type(e),u="array"===i||"object"===i?e:arguments,d=this[a].slice();return c(r,(function(t,e){var n=u["object"===i?t:e.idx];null==n&&(n=d[e.idx]),d[e.idx]=h(n,e)})),l?((n=o(l(d)))[a]=d,n):o(d)},c(r,(function(n,r){o.fn[n]||(o.fn[n]=function(o){var a,s=t.type(o),l="alpha"===n?this._hsla?"hsla":"rgba":e,u=this[l](),c=u[r.idx];return"undefined"===s?c:("function"===s&&(o=o.call(this,c),s=t.type(o)),null==o&&r.empty?this:("string"===s&&(a=i.exec(o))&&(o=c+parseFloat(a[2])*("+"===a[1]?1:-1)),u[r.idx]=o,this[l](u)))})}))})),o.hook=function(e){var n=e.split(" ");c(n,(function(e,n){t.cssHooks[n]={set:function(e,i){var r,a,s="";if("transparent"!==i&&("string"!==t.type(i)||(r=d(i)))){if(i=o(r||i),!l.rgba&&1!==i._rgba[3]){for(a="backgroundColor"===n?e.parentNode:e;(""===s||"transparent"===s)&&a&&a.style;)try{s=t.css(a,"backgroundColor"),a=a.parentNode}catch(t){}i=i.blend(s&&"transparent"!==s?s:"_default")}i=i.toRgbaString()}try{e.style[n]=i}catch(t){}}},t.fx.step[n]=function(e){e.colorInit||(e.start=o(e.elem,n),e.end=o(e.end),e.colorInit=!0),t.cssHooks[n].set(e.elem,e.start.transition(e.end,e.pos))}}))},o.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),t.cssHooks.borderColor={expand:function(t){var e={};return c(["Top","Right","Bottom","Left"],(function(n,i){e["border"+i+"Color"]=t})),e}},n=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(l),function(){var e=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function i(e){var n,i,r=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,o={};if(r&&r.length&&r[0]&&r[r[0]])for(i=r.length;i--;)"string"==typeof r[n=r[i]]&&(o[t.camelCase(n)]=r[n]);else for(n in r)"string"==typeof r[n]&&(o[n]=r[n]);return o}t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],(function(e,n){t.fx.step[n]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(l.style(t.elem,n,t.end),t.setAttr=!0)}})),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(r,o,a,s){var l=t.speed(o,a,s);return this.queue((function(){var o,a=t(this),s=a.attr("class")||"",u=l.children?a.find("*").addBack():a;u=u.map((function(){return{el:t(this),start:i(this)}})),(o=function(){t.each(e,(function(t,e){r[e]&&a[e+"Class"](r[e])}))})(),u=u.map((function(){return this.end=i(this.el[0]),this.diff=function(e,i){var r,o,a={};for(r in i)o=i[r],e[r]!==o&&(n[r]||!t.fx.step[r]&&isNaN(parseFloat(o))||(a[r]=o));return a}(this.start,this.end),this})),a.attr("class",s),u=u.map((function(){var e=this,n=t.Deferred(),i=t.extend({},l,{queue:!1,complete:function(){n.resolve(e)}});return this.el.animate(this.diff,i),n.promise()})),t.when.apply(t,u.get()).done((function(){o(),t.each(arguments,(function(){var e=this.el;t.each(this.diff,(function(t){e.css(t,"")}))})),l.complete.call(a[0])}))}))},t.fn.extend({addClass:function(e){return function(n,i,r,o){return i?t.effects.animateClass.call(this,{add:n},i,r,o):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(n,i,r,o){return arguments.length>1?t.effects.animateClass.call(this,{remove:n},i,r,o):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(e){return function(n,i,r,o,a){return"boolean"==typeof i||void 0===i?r?t.effects.animateClass.call(this,i?{add:n}:{remove:n},r,o,a):e.apply(this,arguments):t.effects.animateClass.call(this,{toggle:n},i,r,o)}}(t.fn.toggleClass),switchClass:function(e,n,i,r,o){return t.effects.animateClass.call(this,{add:n,remove:e},i,r,o)}})}(),function(){function e(e,n,i,r){return t.isPlainObject(e)&&(n=e,e=e.effect),e={effect:e},null==n&&(n={}),t.isFunction(n)&&(r=n,i=null,n={}),("number"==typeof n||t.fx.speeds[n])&&(r=i,i=n,n={}),t.isFunction(i)&&(r=i,i=null),n&&t.extend(e,n),i=i||n.duration,e.duration=t.fx.off?0:"number"==typeof i?i:i in t.fx.speeds?t.fx.speeds[i]:t.fx.speeds._default,e.complete=r||n.complete,e}function n(e){return!(e&&"number"!=typeof e&&!t.fx.speeds[e])||"string"==typeof e&&!t.effects.effect[e]||!!t.isFunction(e)||"object"==typeof e&&!e.effect}function i(t,e){var n=e.outerWidth(),i=e.outerHeight(),r=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/.exec(t)||["",0,n,i,0];return{top:parseFloat(r[1])||0,right:"auto"===r[2]?n:parseFloat(r[2]),bottom:"auto"===r[3]?i:parseFloat(r[3]),left:parseFloat(r[4])||0}}t.expr&&t.expr.filters&&t.expr.filters.animated&&(t.expr.filters.animated=function(e){return function(n){return!!t(n).data("ui-effects-animated")||e(n)}}(t.expr.filters.animated)),!1!==t.uiBackCompat&&t.extend(t.effects,{save:function(t,e){for(var n=0,i=e.length;n<i;n++)null!==e[n]&&t.data("ui-effects-"+e[n],t[0].style[e[n]])},restore:function(t,e){for(var n,i=0,r=e.length;i<r;i++)null!==e[i]&&(n=t.data("ui-effects-"+e[i]),t.css(e[i],n))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var n={width:e.outerWidth(!0),height:e.outerHeight(!0),float:e.css("float")},i=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),r={width:e.width(),height:e.height()},o=document.activeElement;try{o.id}catch(t){o=document.body}return e.wrap(i),(e[0]===o||t.contains(e[0],o))&&t(o).trigger("focus"),i=e.parent(),"static"===e.css("position")?(i.css({position:"relative"}),e.css({position:"relative"})):(t.extend(n,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],(function(t,i){n[i]=e.css(i),isNaN(parseInt(n[i],10))&&(n[i]="auto")})),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(r),i.css(n).show()},removeWrapper:function(e){var n=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===n||t.contains(e[0],n))&&t(n).trigger("focus")),e}}),t.extend(t.effects,{version:"1.12.1",define:function(e,n,i){return i||(i=n,n="effect"),t.effects.effect[e]=i,t.effects.effect[e].mode=n,i},scaledDimensions:function(t,e,n){if(0===e)return{height:0,width:0,outerHeight:0,outerWidth:0};var i="horizontal"!==n?(e||100)/100:1,r="vertical"!==n?(e||100)/100:1;return{height:t.height()*r,width:t.width()*i,outerHeight:t.outerHeight()*r,outerWidth:t.outerWidth()*i}},clipToBox:function(t){return{width:t.clip.right-t.clip.left,height:t.clip.bottom-t.clip.top,left:t.clip.left,top:t.clip.top}},unshift:function(t,e,n){var i=t.queue();e>1&&i.splice.apply(i,[1,0].concat(i.splice(e,n))),t.dequeue()},saveStyle:function(t){t.data("ui-effects-style",t[0].style.cssText)},restoreStyle:function(t){t[0].style.cssText=t.data("ui-effects-style")||"",t.removeData("ui-effects-style")},mode:function(t,e){var n=t.is(":hidden");return"toggle"===e&&(e=n?"show":"hide"),(n?"hide"===e:"show"===e)&&(e="none"),e},getBaseline:function(t,e){var n,i;switch(t[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=t[0]/e.height}switch(t[1]){case"left":i=0;break;case"center":i=.5;break;case"right":i=1;break;default:i=t[1]/e.width}return{x:i,y:n}},createPlaceholder:function(e){var n,i=e.css("position"),r=e.position();return e.css({marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()),/^(static|relative)/.test(i)&&(i="absolute",n=t("<"+e[0].nodeName+">").insertAfter(e).css({display:/^(inline|ruby)/.test(e.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight"),float:e.css("float")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).addClass("ui-effects-placeholder"),e.data("ui-effects-placeholder",n)),e.css({position:i,left:r.left,top:r.top}),n},removePlaceholder:function(t){var e="ui-effects-placeholder",n=t.data(e);n&&(n.remove(),t.removeData(e))},cleanUp:function(e){t.effects.restoreStyle(e),t.effects.removePlaceholder(e)},setTransition:function(e,n,i,r){return r=r||{},t.each(n,(function(t,n){var o=e.cssUnit(n);o[0]>0&&(r[n]=o[0]*i+o[1])})),r}}),t.fn.extend({effect:function(){var n=e.apply(this,arguments),i=t.effects.effect[n.effect],r=i.mode,o=n.queue,a=o||"fx",s=n.complete,l=n.mode,u=[],c=function(e){var n=t(this),i=t.effects.mode(n,l)||r;n.data("ui-effects-animated",!0),u.push(i),r&&("show"===i||i===r&&"hide"===i)&&n.show(),r&&"none"===i||t.effects.saveStyle(n),t.isFunction(e)&&e()};if(t.fx.off||!i)return l?this[l](n.duration,s):this.each((function(){s&&s.call(this)}));function h(e){var o=t(this);function a(){t.isFunction(s)&&s.call(o[0]),t.isFunction(e)&&e()}n.mode=u.shift(),!1===t.uiBackCompat||r?"none"===n.mode?(o[l](),a()):i.call(o[0],n,(function(){o.removeData("ui-effects-animated"),t.effects.cleanUp(o),"hide"===n.mode&&o.hide(),a()})):(o.is(":hidden")?"hide"===l:"show"===l)?(o[l](),a()):i.call(o[0],n,a)}return!1===o?this.each(c).each(h):this.queue(a,c).queue(a,h)},show:function(t){return function(i){if(n(i))return t.apply(this,arguments);var r=e.apply(this,arguments);return r.mode="show",this.effect.call(this,r)}}(t.fn.show),hide:function(t){return function(i){if(n(i))return t.apply(this,arguments);var r=e.apply(this,arguments);return r.mode="hide",this.effect.call(this,r)}}(t.fn.hide),toggle:function(t){return function(i){if(n(i)||"boolean"==typeof i)return t.apply(this,arguments);var r=e.apply(this,arguments);return r.mode="toggle",this.effect.call(this,r)}}(t.fn.toggle),cssUnit:function(e){var n=this.css(e),i=[];return t.each(["em","px","%","pt"],(function(t,e){n.indexOf(e)>0&&(i=[parseFloat(n),e])})),i},cssClip:function(t){return t?this.css("clip","rect("+t.top+"px "+t.right+"px "+t.bottom+"px "+t.left+"px)"):i(this.css("clip"),this)},transfer:function(e,n){var i=t(this),r=t(e.to),o="fixed"===r.css("position"),a=t("body"),s=o?a.scrollTop():0,l=o?a.scrollLeft():0,u=r.offset(),c={top:u.top-s,left:u.left-l,height:r.innerHeight(),width:r.innerWidth()},h=i.offset(),d=t("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(e.className).css({top:h.top-s,left:h.left-l,height:i.innerHeight(),width:i.innerWidth(),position:o?"fixed":"absolute"}).animate(c,e.duration,e.easing,(function(){d.remove(),t.isFunction(n)&&n()}))}}),t.fx.step.clip=function(e){e.clipInit||(e.start=t(e.elem).cssClip(),"string"==typeof e.end&&(e.end=i(e.end,e.elem)),e.clipInit=!0),t(e.elem).cssClip({top:e.pos*(e.end.top-e.start.top)+e.start.top,right:e.pos*(e.end.right-e.start.right)+e.start.right,bottom:e.pos*(e.end.bottom-e.start.bottom)+e.start.bottom,left:e.pos*(e.end.left-e.start.left)+e.start.left})}}(),o={},t.each(["Quad","Cubic","Quart","Quint","Expo"],(function(t,e){o[e]=function(e){return Math.pow(e,t+2)}})),t.extend(o,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(o,(function(e,n){t.easing["easeIn"+e]=n,t.easing["easeOut"+e]=function(t){return 1-n(1-t)},t.easing["easeInOut"+e]=function(t){return t<.5?n(2*t)/2:1-n(-2*t+2)/2}})),t.effects,t.effects.define("blind","hide",(function(e,n){var i={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},r=t(this),o=e.direction||"up",a=r.cssClip(),s={clip:t.extend({},a)},l=t.effects.createPlaceholder(r);s.clip[i[o][0]]=s.clip[i[o][1]],"show"===e.mode&&(r.cssClip(s.clip),l&&l.css(t.effects.clipToBox(s)),s.clip=a),l&&l.animate(t.effects.clipToBox(s),e.duration,e.easing),r.animate(s,{queue:!1,duration:e.duration,easing:e.easing,complete:n})})),t.effects.define("bounce",(function(e,n){var i,r,o,a=t(this),s=e.mode,l="hide"===s,u="show"===s,c=e.direction||"up",h=e.distance,d=e.times||5,p=2*d+(u||l?1:0),f=e.duration/p,m=e.easing,g="up"===c||"down"===c?"top":"left",v="up"===c||"left"===c,y=0,b=a.queue().length;for(t.effects.createPlaceholder(a),o=a.css(g),h||(h=a["top"===g?"outerHeight":"outerWidth"]()/3),u&&((r={opacity:1})[g]=o,a.css("opacity",0).css(g,v?2*-h:2*h).animate(r,f,m)),l&&(h/=Math.pow(2,d-1)),(r={})[g]=o;y<d;y++)(i={})[g]=(v?"-=":"+=")+h,a.animate(i,f,m).animate(r,f,m),h=l?2*h:h/2;l&&((i={opacity:0})[g]=(v?"-=":"+=")+h,a.animate(i,f,m)),a.queue(n),t.effects.unshift(a,b,p+1)})),t.effects.define("clip","hide",(function(e,n){var i,r={},o=t(this),a=e.direction||"vertical",s="both"===a,l=s||"horizontal"===a,u=s||"vertical"===a;i=o.cssClip(),r.clip={top:u?(i.bottom-i.top)/2:i.top,right:l?(i.right-i.left)/2:i.right,bottom:u?(i.bottom-i.top)/2:i.bottom,left:l?(i.right-i.left)/2:i.left},t.effects.createPlaceholder(o),"show"===e.mode&&(o.cssClip(r.clip),r.clip=i),o.animate(r,{queue:!1,duration:e.duration,easing:e.easing,complete:n})})),t.effects.define("drop","hide",(function(e,n){var i,r=t(this),o="show"===e.mode,a=e.direction||"left",s="up"===a||"down"===a?"top":"left",l="up"===a||"left"===a?"-=":"+=",u="+="===l?"-=":"+=",c={opacity:0};t.effects.createPlaceholder(r),i=e.distance||r["top"===s?"outerHeight":"outerWidth"](!0)/2,c[s]=l+i,o&&(r.css(c),c[s]=u+i,c.opacity=1),r.animate(c,{queue:!1,duration:e.duration,easing:e.easing,complete:n})})),t.effects.define("explode","hide",(function(e,n){var i,r,o,a,s,l,u=e.pieces?Math.round(Math.sqrt(e.pieces)):3,c=u,h=t(this),d="show"===e.mode,p=h.show().css("visibility","hidden").offset(),f=Math.ceil(h.outerWidth()/c),m=Math.ceil(h.outerHeight()/u),g=[];function v(){g.push(this),g.length===u*c&&(h.css({visibility:"visible"}),t(g).remove(),n())}for(i=0;i<u;i++)for(a=p.top+i*m,l=i-(u-1)/2,r=0;r<c;r++)o=p.left+r*f,s=r-(c-1)/2,h.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-r*f,top:-i*m}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:m,left:o+(d?s*f:0),top:a+(d?l*m:0),opacity:d?0:1}).animate({left:o+(d?0:s*f),top:a+(d?0:l*m),opacity:d?1:0},e.duration||500,e.easing,v)})),t.effects.define("fade","toggle",(function(e,n){var i="show"===e.mode;t(this).css("opacity",i?0:1).animate({opacity:i?1:0},{queue:!1,duration:e.duration,easing:e.easing,complete:n})})),t.effects.define("fold","hide",(function(e,n){var i=t(this),r=e.mode,o="show"===r,a="hide"===r,s=e.size||15,l=/([0-9]+)%/.exec(s),u=e.horizFirst?["right","bottom"]:["bottom","right"],c=e.duration/2,h=t.effects.createPlaceholder(i),d=i.cssClip(),p={clip:t.extend({},d)},f={clip:t.extend({},d)},m=[d[u[0]],d[u[1]]],g=i.queue().length;l&&(s=parseInt(l[1],10)/100*m[a?0:1]),p.clip[u[0]]=s,f.clip[u[0]]=s,f.clip[u[1]]=0,o&&(i.cssClip(f.clip),h&&h.css(t.effects.clipToBox(f)),f.clip=d),i.queue((function(n){h&&h.animate(t.effects.clipToBox(p),c,e.easing).animate(t.effects.clipToBox(f),c,e.easing),n()})).animate(p,c,e.easing).animate(f,c,e.easing).queue(n),t.effects.unshift(i,g,4)})),t.effects.define("highlight","show",(function(e,n){var i=t(this),r={backgroundColor:i.css("backgroundColor")};"hide"===e.mode&&(r.opacity=0),t.effects.saveStyle(i),i.css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(r,{queue:!1,duration:e.duration,easing:e.easing,complete:n})})),t.effects.define("size",(function(e,n){var i,r,o,a=t(this),s=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],u=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],c=e.mode,h="effect"!==c,d=e.scale||"both",p=e.origin||["middle","center"],f=a.css("position"),m=a.position(),g=t.effects.scaledDimensions(a),v=e.from||g,y=e.to||t.effects.scaledDimensions(a,0);t.effects.createPlaceholder(a),"show"===c&&(o=v,v=y,y=o),r={from:{y:v.height/g.height,x:v.width/g.width},to:{y:y.height/g.height,x:y.width/g.width}},"box"!==d&&"both"!==d||(r.from.y!==r.to.y&&(v=t.effects.setTransition(a,l,r.from.y,v),y=t.effects.setTransition(a,l,r.to.y,y)),r.from.x!==r.to.x&&(v=t.effects.setTransition(a,u,r.from.x,v),y=t.effects.setTransition(a,u,r.to.x,y))),"content"!==d&&"both"!==d||r.from.y!==r.to.y&&(v=t.effects.setTransition(a,s,r.from.y,v),y=t.effects.setTransition(a,s,r.to.y,y)),p&&(i=t.effects.getBaseline(p,g),v.top=(g.outerHeight-v.outerHeight)*i.y+m.top,v.left=(g.outerWidth-v.outerWidth)*i.x+m.left,y.top=(g.outerHeight-y.outerHeight)*i.y+m.top,y.left=(g.outerWidth-y.outerWidth)*i.x+m.left),a.css(v),"content"!==d&&"both"!==d||(l=l.concat(["marginTop","marginBottom"]).concat(s),u=u.concat(["marginLeft","marginRight"]),a.find("*[width]").each((function(){var n=t(this),i=t.effects.scaledDimensions(n),o={height:i.height*r.from.y,width:i.width*r.from.x,outerHeight:i.outerHeight*r.from.y,outerWidth:i.outerWidth*r.from.x},a={height:i.height*r.to.y,width:i.width*r.to.x,outerHeight:i.height*r.to.y,outerWidth:i.width*r.to.x};r.from.y!==r.to.y&&(o=t.effects.setTransition(n,l,r.from.y,o),a=t.effects.setTransition(n,l,r.to.y,a)),r.from.x!==r.to.x&&(o=t.effects.setTransition(n,u,r.from.x,o),a=t.effects.setTransition(n,u,r.to.x,a)),h&&t.effects.saveStyle(n),n.css(o),n.animate(a,e.duration,e.easing,(function(){h&&t.effects.restoreStyle(n)}))}))),a.animate(y,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){var e=a.offset();0===y.opacity&&a.css("opacity",v.opacity),h||(a.css("position","static"===f?"relative":f).offset(e),t.effects.saveStyle(a)),n()}})})),t.effects.define("scale",(function(e,n){var i=t(this),r=e.mode,o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"effect"!==r?0:100),a=t.extend(!0,{from:t.effects.scaledDimensions(i),to:t.effects.scaledDimensions(i,o,e.direction||"both"),origin:e.origin||["middle","center"]},e);e.fade&&(a.from.opacity=1,a.to.opacity=0),t.effects.effect.size.call(this,a,n)})),t.effects.define("puff","hide",(function(e,n){var i=t.extend(!0,{},e,{fade:!0,percent:parseInt(e.percent,10)||150});t.effects.effect.scale.call(this,i,n)})),t.effects.define("pulsate","show",(function(e,n){var i=t(this),r=e.mode,o="show"===r,a=o||"hide"===r,s=2*(e.times||5)+(a?1:0),l=e.duration/s,u=0,c=1,h=i.queue().length;for(!o&&i.is(":visible")||(i.css("opacity",0).show(),u=1);c<s;c++)i.animate({opacity:u},l,e.easing),u=1-u;i.animate({opacity:u},l,e.easing),i.queue(n),t.effects.unshift(i,h,s+1)})),t.effects.define("shake",(function(e,n){var i=1,r=t(this),o=e.direction||"left",a=e.distance||20,s=e.times||3,l=2*s+1,u=Math.round(e.duration/l),c="up"===o||"down"===o?"top":"left",h="up"===o||"left"===o,d={},p={},f={},m=r.queue().length;for(t.effects.createPlaceholder(r),d[c]=(h?"-=":"+=")+a,p[c]=(h?"+=":"-=")+2*a,f[c]=(h?"-=":"+=")+2*a,r.animate(d,u,e.easing);i<s;i++)r.animate(p,u,e.easing).animate(f,u,e.easing);r.animate(p,u,e.easing).animate(d,u/2,e.easing).queue(n),t.effects.unshift(r,m,l+1)})),t.effects.define("slide","show",(function(e,n){var i,r,o=t(this),a={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},s=e.mode,l=e.direction||"left",u="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l,h=e.distance||o["top"===u?"outerHeight":"outerWidth"](!0),d={};t.effects.createPlaceholder(o),i=o.cssClip(),r=o.position()[u],d[u]=(c?-1:1)*h+r,d.clip=o.cssClip(),d.clip[a[l][1]]=d.clip[a[l][0]],"show"===s&&(o.cssClip(d.clip),o.css(u,d[u]),d.clip=i,d[u]=r),o.animate(d,{queue:!1,duration:e.duration,easing:e.easing,complete:n})})),!1!==t.uiBackCompat&&t.effects.define("transfer",(function(e,n){t(this).transfer(e,n)})),t.ui.focusable=function(e,n){var i,r,o,a,s,l=e.nodeName.toLowerCase();return"area"===l?(r=(i=e.parentNode).name,!(!e.href||!r||"map"!==i.nodeName.toLowerCase())&&(o=t("img[usemap='#"+r+"']")).length>0&&o.is(":visible")):(/^(input|select|textarea|button|object)$/.test(l)?(a=!e.disabled)&&(s=t(e).closest("fieldset")[0])&&(a=!s.disabled):a="a"===l&&e.href||n,a&&t(e).is(":visible")&&function(t){for(var e=t.css("visibility");"inherit"===e;)e=(t=t.parent()).css("visibility");return"hidden"!==e}(t(e)))},t.extend(t.expr[":"],{focusable:function(e){return t.ui.focusable(e,null!=t.attr(e,"tabindex"))}}),t.ui.focusable,t.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):t(this[0].form)},t.ui.formResetMixin={_formResetHandler:function(){var e=t(this);setTimeout((function(){var n=e.data("ui-form-reset-instances");t.each(n,(function(){this.refresh()}))}))},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var t=this.form.data("ui-form-reset-instances")||[];t.length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t)}},_unbindFormResetHandler:function(){if(this.form.length){var e=this.form.data("ui-form-reset-instances");e.splice(t.inArray(this,e),1),e.length?this.form.data("ui-form-reset-instances",e):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}},"1.7"===t.fn.jquery.substring(0,3)&&(t.each(["Width","Height"],(function(e,n){var i="Width"===n?["Left","Right"]:["Top","Bottom"],r=n.toLowerCase(),o={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};function a(e,n,r,o){return t.each(i,(function(){n-=parseFloat(t.css(e,"padding"+this))||0,r&&(n-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(n-=parseFloat(t.css(e,"margin"+this))||0)})),n}t.fn["inner"+n]=function(e){return void 0===e?o["inner"+n].call(this):this.each((function(){t(this).css(r,a(this,e)+"px")}))},t.fn["outer"+n]=function(e,i){return"number"!=typeof e?o["outer"+n].call(this,e):this.each((function(){t(this).css(r,a(this,e,!0,i)+"px")}))}})),t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},t.ui.escapeSelector=(s=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,function(t){return t.replace(s,"\\$1")}),t.fn.labels=function(){var e,n,i,r,o;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(r=this.eq(0).parents("label"),(i=this.attr("id"))&&(o=(e=this.eq(0).parents().last()).add(e.length?e.siblings():this.siblings()),n="label[for='"+t.ui.escapeSelector(i)+"']",r=r.add(o.find(n).addBack(n))),this.pushStack(r))},t.fn.scrollParent=function(e){var n=this.css("position"),i="absolute"===n,r=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter((function(){var e=t(this);return(!i||"static"!==e.css("position"))&&r.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))})).eq(0);return"fixed"!==n&&o.length?o:t(this[0].ownerDocument||document)},t.extend(t.expr[":"],{tabbable:function(e){var n=t.attr(e,"tabindex"),i=null!=n;return(!i||n>=0)&&t.ui.focusable(e,i)}}),t.fn.extend({uniqueId:(a=0,function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++a)}))}),removeUniqueId:function(){return this.each((function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")}))}}),t.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),e.collapsible||!1!==e.active&&null!=e.active||(e.active=0),this._processPanels(),e.active<0&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t()}},_createIcons:function(){var e,n,i=this.options.icons;i&&(e=t("<span>"),this._addClass(e,"ui-accordion-header-icon","ui-icon "+i.header),e.prependTo(this.headers),n=this.active.children(".ui-accordion-header-icon"),this._removeClass(n,i.header)._addClass(n,null,i.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){"active"!==t?("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||!1!==this.options.active||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons())):this._activate(e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!t)},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var n=t.ui.keyCode,i=this.headers.length,r=this.headers.index(e.target),o=!1;switch(e.keyCode){case n.RIGHT:case n.DOWN:o=this.headers[(r+1)%i];break;case n.LEFT:case n.UP:o=this.headers[(r-1+i)%i];break;case n.SPACE:case n.ENTER:this._eventHandler(e);break;case n.HOME:o=this.headers[0];break;case n.END:o=this.headers[i-1]}o&&(t(e.target).attr("tabIndex",-1),t(o).attr("tabIndex",0),t(o).trigger("focus"),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().trigger("focus")},refresh:function(){var e=this.options;this._processPanels(),!1===e.active&&!0===e.collapsible||!this.headers.length?(e.active=!1,this.active=t()):!1===e.active?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))},_refresh:function(){var e,n=this.options,i=n.heightStyle,r=this.element.parent();this.active=this._findActive(n.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each((function(){var e=t(this),n=e.uniqueId().attr("id"),i=e.next(),r=i.uniqueId().attr("id");e.attr("aria-controls",r),i.attr("aria-labelledby",n)})).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(n.event),"fill"===i?(e=r.height(),this.element.siblings(":visible").each((function(){var n=t(this),i=n.css("position");"absolute"!==i&&"fixed"!==i&&(e-=n.outerHeight(!0))})),this.headers.each((function(){e-=t(this).outerHeight(!0)})),this.headers.next().each((function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))})).css("overflow","auto")):"auto"===i&&(e=0,this.headers.next().each((function(){var n=t(this).is(":visible");n||t(this).show(),e=Math.max(e,t(this).css("height","").height()),n||t(this).hide()})).height(e))},_activate:function(e){var n=this._findActive(e)[0];n!==this.active[0]&&(n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var n={keydown:"_keydown"};e&&t.each(e.split(" "),(function(t,e){n[e]="_eventHandler"})),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var n,i,r=this.options,o=this.active,a=t(e.currentTarget),s=a[0]===o[0],l=s&&r.collapsible,u=l?t():a.next(),c=o.next(),h={oldHeader:o,oldPanel:c,newHeader:l?t():a,newPanel:u};e.preventDefault(),s&&!r.collapsible||!1===this._trigger("beforeActivate",e,h)||(r.active=!l&&this.headers.index(a),this.active=s?t():a,this._toggle(h),this._removeClass(o,"ui-accordion-header-active","ui-state-active"),r.icons&&(n=o.children(".ui-accordion-header-icon"),this._removeClass(n,null,r.icons.activeHeader)._addClass(n,null,r.icons.header)),s||(this._removeClass(a,"ui-accordion-header-collapsed")._addClass(a,"ui-accordion-header-active","ui-state-active"),r.icons&&(i=a.children(".ui-accordion-header-icon"),this._removeClass(i,null,r.icons.header)._addClass(i,null,r.icons.activeHeader)),this._addClass(a.next(),"ui-accordion-content-active")))},_toggle:function(e){var n=e.newPanel,i=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=i,this.options.animate?this._animate(n,i,e):(i.hide(),n.show(),this._toggleComplete(e)),i.attr({"aria-hidden":"true"}),i.prev().attr({"aria-selected":"false","aria-expanded":"false"}),n.length&&i.length?i.prev().attr({tabIndex:-1,"aria-expanded":"false"}):n.length&&this.headers.filter((function(){return 0===parseInt(t(this).attr("tabIndex"),10)})).attr("tabIndex",-1),n.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(t,e,n){var i,r,o,a=this,s=0,l=t.css("box-sizing"),u=t.length&&(!e.length||t.index()<e.index()),c=this.options.animate||{},h=u&&c.down||c,d=function(){a._toggleComplete(n)};return"number"==typeof h&&(o=h),"string"==typeof h&&(r=h),r=r||h.easing||c.easing,o=o||h.duration||c.duration,e.length?t.length?(i=t.show().outerHeight(),e.animate(this.hideProps,{duration:o,easing:r,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(this.showProps,{duration:o,easing:r,complete:d,step:function(t,n){n.now=Math.round(t),"height"!==n.prop?"content-box"===l&&(s+=n.now):"content"!==a.options.heightStyle&&(n.now=Math.round(i-e.outerHeight()-s),s=0)}})):e.animate(this.hideProps,o,r,d):t.animate(this.showProps,o,r,d)},_toggleComplete:function(t){var e=t.oldPanel,n=e.prev();this._removeClass(e,"ui-accordion-content-active"),this._removeClass(n,"ui-accordion-header-active")._addClass(n,"ui-accordion-header-collapsed"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),t.ui.safeActiveElement=function(t){var e;try{e=t.activeElement}catch(n){e=t.body}return e||(e=t.body),e.nodeName||(e=t.body),e},t.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var n=t(e.target),i=t(t.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&n.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),n.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&i.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var n=t(e.target).closest(".ui-menu-item"),i=t(e.currentTarget);n[0]===i[0]&&(this._removeClass(i.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(e,i))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var n=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,n)},blur:function(e){this._delay((function(){!t.contains(this.element[0],t.ui.safeActiveElement(this.document[0]))&&this.collapseAll(e)}))},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),e.children().each((function(){var e=t(this);e.data("ui-menu-submenu-caret")&&e.remove()}))},_keydown:function(e){var n,i,r,o,a=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:a=!1,i=this.previousFilter||"",o=!1,r=e.keyCode>=96&&e.keyCode<=105?(e.keyCode-96).toString():String.fromCharCode(e.keyCode),clearTimeout(this.filterTimer),r===i?o=!0:r=i+r,n=this._filterMenuItems(r),(n=o&&-1!==n.index(this.active.next())?this.active.nextAll(".ui-menu-item"):n).length||(r=String.fromCharCode(e.keyCode),n=this._filterMenuItems(r)),n.length?(this.focus(e,n),this.previousFilter=r,this.filterTimer=this._delay((function(){delete this.previousFilter}),1e3)):delete this.previousFilter}a&&e.preventDefault()},_activate:function(t){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,n,i,r,o=this,a=this.options.icons.submenu,s=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),n=s.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each((function(){var e=t(this),n=e.prev(),i=t("<span>").data("ui-menu-submenu-caret",!0);o._addClass(i,"ui-menu-icon","ui-icon "+a),n.attr("aria-haspopup","true").prepend(i),e.attr("aria-labelledby",n.attr("id"))})),this._addClass(n,"ui-menu","ui-widget ui-widget-content ui-front"),(e=s.add(this.element).find(this.options.items)).not(".ui-menu-item").each((function(){var e=t(this);o._isDivider(e)&&o._addClass(e,"ui-menu-divider","ui-widget-content")})),r=(i=e.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(i,"ui-menu-item")._addClass(r,"ui-menu-item-wrapper"),e.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){if("icons"===t){var n=this.element.find(".ui-menu-icon");this._removeClass(n,null,this.options.icons.submenu)._addClass(n,null,e.submenu)}this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",String(t)),this._toggleClass(null,"ui-state-disabled",!!t)},focus:function(t,e){var n,i,r;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),i=this.active.children(".ui-menu-item-wrapper"),this._addClass(i,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),r=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(r,null,"ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay((function(){this._close()}),this.delay),(n=e.children(".ui-menu")).length&&t&&/^mouse/.test(t.type)&&this._startOpening(n),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var n,i,r,o,a,s;this._hasScroll()&&(n=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,r=e.offset().top-this.activeMenu.offset().top-n-i,o=this.activeMenu.scrollTop(),a=this.activeMenu.height(),s=e.outerHeight(),r<0?this.activeMenu.scrollTop(o+r):r+s>a&&this.activeMenu.scrollTop(o+r-a+s))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",t,{item:this.active}),this.active=null)},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay((function(){this._close(),this._open(t)}),this.delay))},_open:function(e){var n=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(e,n){clearTimeout(this.timer),this.timer=this._delay((function(){var i=n?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(e),this._removeClass(i.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=i}),this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay((function(){this.focus(t,e)})))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,n){var i;this.active&&(i="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),i&&i.length&&this.active||(i=this.activeMenu.find(this.options.items)[e]()),this.focus(n,i)},nextPage:function(e){var n,i,r;this.active?this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,r=this.element.height(),this.active.nextAll(".ui-menu-item").each((function(){return(n=t(this)).offset().top-i-r<0})),this.focus(e,n)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())):this.next(e)},previousPage:function(e){var n,i,r;this.active?this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,r=this.element.height(),this.active.prevAll(".ui-menu-item").each((function(){return(n=t(this)).offset().top-i+r>0})),this.focus(e,n)):this.focus(e,this.activeMenu.find(this.options.items).first())):this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,n)},_filterMenuItems:function(e){var n=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=new RegExp("^"+n,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter((function(){return i.test(t.trim(t(this).children(".ui-menu-item-wrapper").text()))}))}}),t.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,n,i,r=this.element[0].nodeName.toLowerCase(),o="textarea"===r,a="input"===r;this.isMultiLine=o||!a&&this._isContentEditable(this.element),this.valueMethod=this.element[o||a?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(r){if(this.element.prop("readOnly"))return e=!0,i=!0,void(n=!0);e=!1,i=!1,n=!1;var o=t.ui.keyCode;switch(r.keyCode){case o.PAGE_UP:e=!0,this._move("previousPage",r);break;case o.PAGE_DOWN:e=!0,this._move("nextPage",r);break;case o.UP:e=!0,this._keyEvent("previous",r);break;case o.DOWN:e=!0,this._keyEvent("next",r);break;case o.ENTER:this.menu.active&&(e=!0,r.preventDefault(),this.menu.select(r));break;case o.TAB:this.menu.active&&this.menu.select(r);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(r),r.preventDefault());break;default:n=!0,this._searchTimeout(r)}},keypress:function(i){if(e)return e=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||i.preventDefault());if(!n){var r=t.ui.keyCode;switch(i.keyCode){case r.PAGE_UP:this._move("previousPage",i);break;case r.PAGE_DOWN:this._move("nextPage",i);break;case r.UP:this._keyEvent("previous",i);break;case r.DOWN:this._keyEvent("next",i)}}},input:function(t){if(i)return i=!1,void t.preventDefault();this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),this._change(t))}}),this._initSource(),this.menu=t("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay((function(){delete this.cancelBlur,this.element[0]!==t.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")}))},menufocus:function(e,n){var i,r;if(this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",(function(){t(e.target).trigger(e.originalEvent)}));r=n.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:r})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(r.value),(i=n.item.attr("aria-label")||r.value)&&t.trim(i).length&&(this.liveRegion.children().hide(),t("<div>").text(i).appendTo(this.liveRegion))},menuselect:function(e,n){var i=n.item.data("ui-autocomplete-item"),r=this.previous;this.element[0]!==t.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=r,this._delay((function(){this.previous=r,this.selectedItem=i}))),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=t("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(e){var n=this.menu.element[0];return e.target===this.element[0]||e.target===n||t.contains(n,e.target)},_closeOnClickOutside:function(t){this._isEventTargetInWidget(t)||this.close()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,n,i=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(n,i){i(t.ui.autocomplete.filter(e,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(e,r){i.xhr&&i.xhr.abort(),i.xhr=t.ajax({url:n,data:e,dataType:"json",success:function(t){r(t)},error:function(){r([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay((function(){var e=this.term===this._value(),n=this.menu.element.is(":visible"),i=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;e&&(!e||n||i)||(this.selectedItem=null,this.search(null,t))}),this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(t):void 0},_search:function(t){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy((function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")}),this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,(function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})}))},_suggest:function(e){var n=this.menu.element.empty();this._renderMenu(n,e),this.isNewMenu=!0,this.menu.refresh(),n.show(),this._resizeMenu(),n.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,n){var i=this;t.each(n,(function(t,n){i._renderItemData(e,n)}))},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,n){return t("<li>").append(t("<div>").text(n.label)).appendTo(e)},_move:function(t,e){if(this.menu.element.is(":visible"))return this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[t](e);this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(t,e),e.preventDefault())},_isContentEditable:function(t){if(!t.length)return!1;var e=t.prop("contentEditable");return"inherit"===e?this._isContentEditable(t.parent()):"true"===e}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,n){var i=new RegExp(t.ui.autocomplete.escapeRegex(n),"i");return t.grep(e,(function(t){return i.test(t.label||t.value||t)}))}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var n;this._superApply(arguments),this.options.disabled||this.cancelSearch||(n=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(n).appendTo(this.liveRegion))}}),t.ui.autocomplete;var u,c=/ui-corner-([a-z]){2,6}/g;function h(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.regional.en=t.extend(!0,{},this.regional[""]),this.regional["en-US"]=t.extend(!0,{},this.regional.en),this.dpDiv=d(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function d(e){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.on("mouseout",n,(function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")})).on("mouseover",n,p)}function p(){t.datepicker._isDisabledDatepicker(u.inline?u.dpDiv.parent()[0]:u.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))}function f(e,n){for(var i in t.extend(e,n),n)null==n[i]&&(e[i]=n[i]);return e}t.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var e=this,n=[];t.each(this.options.items,(function(i,r){var o,a={};if(r)return"controlgroupLabel"===i?((o=e.element.find(r)).each((function(){var e=t(this);e.children(".ui-controlgroup-label-contents").length||e.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")})),e._addClass(o,null,"ui-widget ui-widget-content ui-state-default"),void(n=n.concat(o.get()))):void(t.fn[i]&&(a=e["_"+i+"Options"]?e["_"+i+"Options"]("middle"):{classes:{}},e.element.find(r).each((function(){var r=t(this),o=r[i]("instance"),s=t.widget.extend({},a);if("button"!==i||!r.parent(".ui-spinner").length){o||(o=r[i]()[i]("instance")),o&&(s.classes=e._resolveClassesValues(s.classes,o)),r[i](s);var l=r[i]("widget");t.data(l[0],"ui-controlgroup-data",o||r[i]("instance")),n.push(l[0])}}))))})),this.childWidgets=t(t.unique(n)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(e){this.childWidgets.each((function(){var n=t(this).data("ui-controlgroup-data");n&&n[e]&&n[e]()}))},_updateCornerClass:function(t,e){var n=this._buildSimpleOptions(e,"label").classes.label;this._removeClass(t,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(t,null,n)},_buildSimpleOptions:function(t,e){var n="vertical"===this.options.direction,i={classes:{}};return i.classes[e]={middle:"",first:"ui-corner-"+(n?"top":"left"),last:"ui-corner-"+(n?"bottom":"right"),only:"ui-corner-all"}[t],i},_spinnerOptions:function(t){var e=this._buildSimpleOptions(t,"ui-spinner");return e.classes["ui-spinner-up"]="",e.classes["ui-spinner-down"]="",e},_buttonOptions:function(t){return this._buildSimpleOptions(t,"ui-button")},_checkboxradioOptions:function(t){return this._buildSimpleOptions(t,"ui-checkboxradio-label")},_selectmenuOptions:function(t){var e="vertical"===this.options.direction;return{width:!!e&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(e?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(e?"top":"left")},last:{"ui-selectmenu-button-open":e?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(e?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[t]}},_resolveClassesValues:function(e,n){var i={};return t.each(e,(function(r){var o=n.options.classes[r]||"";o=t.trim(o.replace(c,"")),i[r]=(o+" "+e[r]).replace(/\s+/g," ")})),i},_setOption:function(t,e){"direction"===t&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(t,e),"disabled"!==t?this.refresh():this._callChildMethod(e?"disable":"enable")},refresh:function(){var e,n=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),e=this.childWidgets,this.options.onlyVisible&&(e=e.filter(":visible")),e.length&&(t.each(["first","last"],(function(t,i){var r=e[i]().data("ui-controlgroup-data");if(r&&n["_"+r.widgetName+"Options"]){var o=n["_"+r.widgetName+"Options"](1===e.length?"only":i);o.classes=n._resolveClassesValues(o.classes,r),r.element[r.widgetName](o)}else n._updateCornerClass(e[i](),i)})),this._callChildMethod("refresh"))}}),t.widget("ui.checkboxradio",[t.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var e,n,i=this,r=this._super()||{};return this._readType(),n=this.element.labels(),this.label=t(n[n.length-1]),this.label.length||t.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each((function(){i.originalLabel+=3===this.nodeType?t(this).text():this.outerHTML})),this.originalLabel&&(r.label=this.originalLabel),null!=(e=this.element[0].disabled)&&(r.disabled=e),r},_create:function(){var t=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),t&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var e=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===e&&/radio|checkbox/.test(this.type)||t.error("Can't create checkboxradio on element.nodeName="+e+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var e=this.element[0].name,n="input[name='"+t.ui.escapeSelector(e)+"']";return e?(this.form.length?t(this.form[0].elements).filter(n):t(n).filter((function(){return 0===t(this).form().length}))).not(this.element):t([])},_toggleClasses:function(){var e=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",e)._toggleClass(this.icon,null,"ui-icon-blank",!e),"radio"===this.type&&this._getRadioGroup().each((function(){var e=t(this).checkboxradio("instance");e&&e._removeClass(e.label,"ui-checkboxradio-checked","ui-state-active")}))},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(t,e){if("label"!==t||e){if(this._super(t,e),"disabled"===t)return this._toggleClass(this.label,null,"ui-state-disabled",e),void(this.element[0].disabled=e);this.refresh()}},_updateIcon:function(e){var n="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=t("<span>"),this.iconSpace=t("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(n+=e?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,e?"ui-icon-blank":"ui-icon-check")):n+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",n),e||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var t=this.label.contents().not(this.element[0]);this.icon&&(t=t.not(this.icon[0])),this.iconSpace&&(t=t.not(this.iconSpace[0])),t.remove(),this.label.append(this.options.label)},refresh:function(){var t=this.element[0].checked,e=this.element[0].disabled;this._updateIcon(t),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),null!==this.options.label&&this._updateLabel(),e!==this.options.disabled&&this._setOptions({disabled:e})}}]),t.ui.checkboxradio,t.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var t,e=this._super()||{};return this.isInput=this.element.is("input"),null!=(t=this.element[0].disabled)&&(e.disabled=t),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(e.label=this.originalLabel),e},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(e){e.keyCode===t.ui.keyCode.SPACE&&(e.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(e,n){var i="iconPosition"!==e,r=i?this.options.iconPosition:n,o="top"===r||"bottom"===r;this.icon?i&&this._removeClass(this.icon,null,this.options.icon):(this.icon=t("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),i&&this._addClass(this.icon,null,n),this._attachIcon(r),o?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=t("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(r))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(t){this.icon[/^(?:end|bottom)/.test(t)?"before":"after"](this.iconSpace)},_attachIcon:function(t){this.element[/^(?:end|bottom)/.test(t)?"append":"prepend"](this.icon)},_setOptions:function(t){var e=void 0===t.showLabel?this.options.showLabel:t.showLabel,n=void 0===t.icon?this.options.icon:t.icon;e||n||(t.showLabel=!0),this._super(t)},_setOption:function(t,e){"icon"===t&&(e?this._updateIcon(t,e):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===t&&this._updateIcon(t,e),"showLabel"===t&&(this._toggleClass("ui-button-icon-only",null,!e),this._updateTooltip()),"label"===t&&(this.isInput?this.element.val(e):(this.element.html(e),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(t,e),"disabled"===t&&(this._toggleClass(null,"ui-state-disabled",e),this.element[0].disabled=e,e&&this.element.blur())},refresh:function(){var t=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOptions({disabled:t}),this._updateTooltip()}}),!1!==t.uiBackCompat&&(t.widget("ui.button",t.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(t,e){"text"!==t?("showLabel"===t&&(this.options.text=e),"icon"===t&&(this.options.icons.primary=e),"icons"===t&&(e.primary?(this._super("icon",e.primary),this._super("iconPosition","beginning")):e.secondary&&(this._super("icon",e.secondary),this._super("iconPosition","end"))),this._superApply(arguments)):this._super("showLabel",e)}}),t.fn.button=function(e){return function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?e.apply(this,arguments):(t.ui.checkboxradio||t.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}}(t.fn.button),t.fn.buttonset=function(){return t.ui.controlgroup||t.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),t.ui.button,t.extend(t.ui,{datepicker:{version:"1.12.1"}}),t.extend(h.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return f(this._defaults,t||{}),this},_attachDatepicker:function(e,n){var i,r,o;r="div"===(i=e.nodeName.toLowerCase())||"span"===i,e.id||(this.uuid+=1,e.id="dp"+this.uuid),(o=this._newInst(t(e),r)).settings=t.extend({},n||{}),"input"===i?this._connectDatepicker(e,o):r&&this._inlineDatepicker(e,o)},_newInst:function(e,n){return{id:e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?d(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,n){var i=t(e);n.append=t([]),n.trigger=t([]),i.hasClass(this.markerClassName)||(this._attachments(i,n),i.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(n),t.data(e,"datepicker",n),n.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,n){var i,r,o,a=this._get(n,"appendText"),s=this._get(n,"isRTL");n.append&&n.append.remove(),a&&(n.append=t("<span class='"+this._appendClass+"'>"+a+"</span>"),e[s?"before":"after"](n.append)),e.off("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),"focus"!==(i=this._get(n,"showOn"))&&"both"!==i||e.on("focus",this._showDatepicker),"button"!==i&&"both"!==i||(r=this._get(n,"buttonText"),o=this._get(n,"buttonImage"),n.trigger=t(this._get(n,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:o,alt:r,title:r}):t("<button type='button'></button>").addClass(this._triggerClass).html(o?t("<img/>").attr({src:o,alt:r,title:r}):r)),e[s?"before":"after"](n.trigger),n.trigger.on("click",(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1})))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,n,i,r,o=new Date(2009,11,20),a=this._get(t,"dateFormat");a.match(/[DM]/)&&(e=function(t){for(n=0,i=0,r=0;r<t.length;r++)t[r].length>n&&(n=t[r].length,i=r);return i},o.setMonth(e(this._get(t,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length)}},_inlineDatepicker:function(e,n){var i=t(e);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(n.dpDiv),t.data(e,"datepicker",n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(e),n.dpDiv.css("display","block"))},_dialogDatepicker:function(e,n,i,r,o){var a,s,l,u,c,h=this._dialogInst;return h||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),t("body").append(this._dialogInput),(h=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},t.data(this._dialogInput[0],"datepicker",h)),f(h.settings,r||{}),n=n&&n.constructor===Date?this._formatDate(h,n):n,this._dialogInput.val(n),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(s=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[s/2-100+u,l/2-150+c]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),h.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],"datepicker",h),this},_destroyDatepicker:function(e){var n,i=t(e),r=t.data(e,"datepicker");i.hasClass(this.markerClassName)&&(n=e.nodeName.toLowerCase(),t.removeData(e,"datepicker"),"input"===n?(r.append.remove(),r.trigger.remove(),i.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):"div"!==n&&"span"!==n||i.removeClass(this.markerClassName).empty(),u===r&&(u=null))},_enableDatepicker:function(e){var n,i,r=t(e),o=t.data(e,"datepicker");r.hasClass(this.markerClassName)&&("input"===(n=e.nodeName.toLowerCase())?(e.disabled=!1,o.trigger.filter("button").each((function(){this.disabled=!1})).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==n&&"span"!==n||((i=r.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,(function(t){return t===e?null:t})))},_disableDatepicker:function(e){var n,i,r=t(e),o=t.data(e,"datepicker");r.hasClass(this.markerClassName)&&("input"===(n=e.nodeName.toLowerCase())?(e.disabled=!0,o.trigger.filter("button").each((function(){this.disabled=!0})).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==n&&"span"!==n||((i=r.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,(function(t){return t===e?null:t})),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,"datepicker")}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,n,i){var r,o,a,s,l=this._getInst(e);if(2===arguments.length&&"string"==typeof n)return"defaults"===n?t.extend({},t.datepicker._defaults):l?"all"===n?t.extend({},l.settings):this._get(l,n):null;r=n||{},"string"==typeof n&&((r={})[n]=i),l&&(this._curInst===l&&this._hideDatepicker(),o=this._getDateDatepicker(e,!0),a=this._getMinMaxDate(l,"min"),s=this._getMinMaxDate(l,"max"),f(l.settings,r),null!==a&&void 0!==r.dateFormat&&void 0===r.minDate&&(l.settings.minDate=this._formatDate(l,a)),null!==s&&void 0!==r.dateFormat&&void 0===r.maxDate&&(l.settings.maxDate=this._formatDate(l,s)),"disabled"in r&&(r.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),l),this._autoSize(l),this._setDate(l,o),this._updateAlternate(l),this._updateDatepicker(l))},_changeDatepicker:function(t,e,n){this._optionDatepicker(t,e,n)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var n=this._getInst(t);n&&(this._setDate(n,e),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(t,e){var n=this._getInst(t);return n&&!n.inline&&this._setDateFromField(n,e),n?this._getDate(n):null},_doKeyDown:function(e){var n,i,r,o=t.datepicker._getInst(e.target),a=!0,s=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),a=!1;break;case 13:return(r=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",o.dpDiv))[0]&&t.datepicker._selectDay(e.target,o.selectedMonth,o.selectedYear,r[0]),(n=t.datepicker._get(o,"onSelect"))?(i=t.datepicker._formatDate(o),n.apply(o.input?o.input[0]:null,[i,o])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),a=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),a=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,s?1:-1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),a=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,s?-1:1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),a=e.ctrlKey||e.metaKey;break;default:a=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):a=!1;a&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var n,i,r=t.datepicker._getInst(e.target);if(t.datepicker._get(r,"constrainInput"))return n=t.datepicker._possibleChars(t.datepicker._get(r,"dateFormat")),i=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||i<" "||!n||n.indexOf(i)>-1},_doKeyUp:function(e){var n=t.datepicker._getInst(e.target);if(n.input.val()!==n.lastVal)try{t.datepicker.parseDate(t.datepicker._get(n,"dateFormat"),n.input?n.input.val():null,t.datepicker._getFormatConfig(n))&&(t.datepicker._setDateFromField(n),t.datepicker._updateAlternate(n),t.datepicker._updateDatepicker(n))}catch(t){}return!0},_showDatepicker:function(e){var n,i,r,o,a,s,l;"input"!==(e=e.target||e).nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),t.datepicker._isDisabledDatepicker(e)||t.datepicker._lastInput===e||(n=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==n&&(t.datepicker._curInst.dpDiv.stop(!0,!0),n&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),!1!==(r=(i=t.datepicker._get(n,"beforeShow"))?i.apply(e,[e,n]):{})&&(f(n.settings,r),n.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(n),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),o=!1,t(e).parents().each((function(){return!(o|="fixed"===t(this).css("position"))})),a={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(n),a=t.datepicker._checkOffset(n,a,o),n.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":o?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),n.inline||(s=t.datepicker._get(n,"showAnim"),l=t.datepicker._get(n,"duration"),n.dpDiv.css("z-index",function(t){for(var e,n;t.length&&t[0]!==document;){if(("absolute"===(e=t.css("position"))||"relative"===e||"fixed"===e)&&(n=parseInt(t.css("zIndex"),10),!isNaN(n)&&0!==n))return n;t=t.parent()}return 0}(t(e))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[s]?n.dpDiv.show(s,t.datepicker._get(n,"showOptions"),l):n.dpDiv[s||"show"](s?l:null),t.datepicker._shouldFocusInput(n)&&n.input.trigger("focus"),t.datepicker._curInst=n)))},_updateDatepicker:function(e){this.maxRows=4,u=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var n,i=this._getNumberOfMonths(e),r=i[1],o=e.dpDiv.find("."+this._dayOverClass+" a");o.length>0&&p.apply(o.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),r>1&&e.dpDiv.addClass("ui-datepicker-multi-"+r).css("width",17*r+"em"),e.dpDiv[(1!==i[0]||1!==i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.trigger("focus"),e.yearshtml&&(n=e.yearshtml,setTimeout((function(){n===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),n=e.yearshtml=null}),0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,n,i){var r=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),a=e.input?e.input.outerWidth():0,s=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+(i?0:t(document).scrollLeft()),u=document.documentElement.clientHeight+(i?0:t(document).scrollTop());return n.left-=this._get(e,"isRTL")?r-a:0,n.left-=i&&n.left===e.input.offset().left?t(document).scrollLeft():0,n.top-=i&&n.top===e.input.offset().top+s?t(document).scrollTop():0,n.left-=Math.min(n.left,n.left+r>l&&l>r?Math.abs(n.left+r-l):0),n.top-=Math.min(n.top,n.top+o>u&&u>o?Math.abs(o+s):0),n},_findPos:function(e){for(var n,i=this._getInst(e),r=this._get(i,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[r?"previousSibling":"nextSibling"];return[(n=t(e).offset()).left,n.top]},_hideDatepicker:function(e){var n,i,r,o,a=this._curInst;!a||e&&a!==t.data(e,"datepicker")||this._datepickerShowing&&(n=this._get(a,"showAnim"),i=this._get(a,"duration"),r=function(){t.datepicker._tidyDialog(a)},t.effects&&(t.effects.effect[n]||t.effects[n])?a.dpDiv.hide(n,t.datepicker._get(a,"showOptions"),i,r):a.dpDiv["slideDown"===n?"slideUp":"fadeIn"===n?"fadeOut":"hide"](n?i:null,r),n||r(),this._datepickerShowing=!1,(o=this._get(a,"onClose"))&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var n=t(e.target),i=t.datepicker._getInst(n[0]);(n[0].id===t.datepicker._mainDivId||0!==n.parents("#"+t.datepicker._mainDivId).length||n.hasClass(t.datepicker.markerClassName)||n.closest("."+t.datepicker._triggerClass).length||!t.datepicker._datepickerShowing||t.datepicker._inDialog&&t.blockUI)&&(!n.hasClass(t.datepicker.markerClassName)||t.datepicker._curInst===i)||t.datepicker._hideDatepicker()}},_adjustDate:function(e,n,i){var r=t(e),o=this._getInst(r[0]);this._isDisabledDatepicker(r[0])||(this._adjustInstDate(o,n+("M"===i?this._get(o,"showCurrentAtPos"):0),i),this._updateDatepicker(o))},_gotoToday:function(e){var n,i=t(e),r=this._getInst(i[0]);this._get(r,"gotoCurrent")&&r.currentDay?(r.selectedDay=r.currentDay,r.drawMonth=r.selectedMonth=r.currentMonth,r.drawYear=r.selectedYear=r.currentYear):(n=new Date,r.selectedDay=n.getDate(),r.drawMonth=r.selectedMonth=n.getMonth(),r.drawYear=r.selectedYear=n.getFullYear()),this._notifyChange(r),this._adjustDate(i)},_selectMonthYear:function(e,n,i){var r=t(e),o=this._getInst(r[0]);o["selected"+("M"===i?"Month":"Year")]=o["draw"+("M"===i?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(r)},_selectDay:function(e,n,i,r){var o,a=t(e);t(r).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||((o=this._getInst(a[0])).selectedDay=o.currentDay=t("a",r).html(),o.selectedMonth=o.currentMonth=n,o.selectedYear=o.currentYear=i,this._selectDate(e,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(e){var n=t(e);this._selectDate(n,"")},_selectDate:function(e,n){var i,r=t(e),o=this._getInst(r[0]);n=null!=n?n:this._formatDate(o),o.input&&o.input.val(n),this._updateAlternate(o),(i=this._get(o,"onSelect"))?i.apply(o.input?o.input[0]:null,[n,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(e){var n,i,r,o=this._get(e,"altField");o&&(n=this._get(e,"altFormat")||this._get(e,"dateFormat"),i=this._getDate(e),r=this.formatDate(n,i,this._getFormatConfig(e)),t(o).val(r))},noWeekends:function(t){var e=t.getDay();return[e>0&&e<6,""]},iso8601Week:function(t){var e,n=new Date(t.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),e=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((e-n)/864e5)/7)+1},parseDate:function(e,n,i){if(null==e||null==n)throw"Invalid arguments";if(""===(n="object"==typeof n?n.toString():n+""))return null;var r,o,a,s,l=0,u=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof u?u:(new Date).getFullYear()%100+parseInt(u,10),h=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,d=(i?i.dayNames:null)||this._defaults.dayNames,p=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,f=(i?i.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,_=function(t){var n=r+1<e.length&&e.charAt(r+1)===t;return n&&r++,n},x=function(t){var e=_(t),i="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,r=new RegExp("^\\d{"+("y"===t?i:1)+","+i+"}"),o=n.substring(l).match(r);if(!o)throw"Missing number at position "+l;return l+=o[0].length,parseInt(o[0],10)},w=function(e,i,r){var o=-1,a=t.map(_(e)?r:i,(function(t,e){return[[e,t]]})).sort((function(t,e){return-(t[1].length-e[1].length)}));if(t.each(a,(function(t,e){var i=e[1];if(n.substr(l,i.length).toLowerCase()===i.toLowerCase())return o=e[0],l+=i.length,!1})),-1!==o)return o+1;throw"Unknown name at position "+l},C=function(){if(n.charAt(l)!==e.charAt(r))throw"Unexpected literal at position "+l;l++};for(r=0;r<e.length;r++)if(b)"'"!==e.charAt(r)||_("'")?C():b=!1;else switch(e.charAt(r)){case"d":v=x("d");break;case"D":w("D",h,d);break;case"o":y=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":m=(s=new Date(x("@"))).getFullYear(),g=s.getMonth()+1,v=s.getDate();break;case"!":m=(s=new Date((x("!")-this._ticksTo1970)/1e4)).getFullYear(),g=s.getMonth()+1,v=s.getDate();break;case"'":_("'")?C():b=!0;break;default:C()}if(l<n.length&&(a=n.substr(l),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===m?m=(new Date).getFullYear():m<100&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(m<=c?0:-100)),y>-1)for(g=1,v=y;!(v<=(o=this._getDaysInMonth(m,g-1)));)g++,v-=o;if((s=this._daylightSavingAdjust(new Date(m,g-1,v))).getFullYear()!==m||s.getMonth()+1!==g||s.getDate()!==v)throw"Invalid date";return s},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(t,e,n){if(!e)return"";var i,r=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,o=(n?n.dayNames:null)||this._defaults.dayNames,a=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,s=(n?n.monthNames:null)||this._defaults.monthNames,l=function(e){var n=i+1<t.length&&t.charAt(i+1)===e;return n&&i++,n},u=function(t,e,n){var i=""+e;if(l(t))for(;i.length<n;)i="0"+i;return i},c=function(t,e,n,i){return l(t)?i[e]:n[e]},h="",d=!1;if(e)for(i=0;i<t.length;i++)if(d)"'"!==t.charAt(i)||l("'")?h+=t.charAt(i):d=!1;else switch(t.charAt(i)){case"d":h+=u("d",e.getDate(),2);break;case"D":h+=c("D",e.getDay(),r,o);break;case"o":h+=u("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":h+=u("m",e.getMonth()+1,2);break;case"M":h+=c("M",e.getMonth(),a,s);break;case"y":h+=l("y")?e.getFullYear():(e.getFullYear()%100<10?"0":"")+e.getFullYear()%100;break;case"@":h+=e.getTime();break;case"!":h+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?h+="'":d=!0;break;default:h+=t.charAt(i)}return h},_possibleChars:function(t){var e,n="",i=!1,r=function(n){var i=e+1<t.length&&t.charAt(e+1)===n;return i&&e++,i};for(e=0;e<t.length;e++)if(i)"'"!==t.charAt(e)||r("'")?n+=t.charAt(e):i=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":r("'")?n+="'":i=!0;break;default:n+=t.charAt(e)}return n},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var n=this._get(t,"dateFormat"),i=t.lastVal=t.input?t.input.val():null,r=this._getDefaultDate(t),o=r,a=this._getFormatConfig(t);try{o=this.parseDate(n,i,a)||r}catch(t){i=e?"":i}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=i?o.getDate():0,t.currentMonth=i?o.getMonth():0,t.currentYear=i?o.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,n,i){var r=null==n||""===n?i:"string"==typeof n?function(n){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),n,t.datepicker._getFormatConfig(e))}catch(t){}for(var i=(n.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,r=i.getFullYear(),o=i.getMonth(),a=i.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=s.exec(n);l;){switch(l[2]||"d"){case"d":case"D":a+=parseInt(l[1],10);break;case"w":case"W":a+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),a=Math.min(a,t.datepicker._getDaysInMonth(r,o));break;case"y":case"Y":r+=parseInt(l[1],10),a=Math.min(a,t.datepicker._getDaysInMonth(r,o))}l=s.exec(n)}return new Date(r,o,a)}(n):"number"==typeof n?isNaN(n)?i:function(t){var e=new Date;return e.setDate(e.getDate()+t),e}(n):new Date(n.getTime());return(r=r&&"Invalid Date"===r.toString()?i:r)&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,n){var i=!e,r=t.selectedMonth,o=t.selectedYear,a=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=a.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=a.getMonth(),t.drawYear=t.selectedYear=t.currentYear=a.getFullYear(),r===t.selectedMonth&&o===t.selectedYear||n||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(i?"":this._formatDate(t))},_getDate:function(t){return!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay))},_attachHandlers:function(e){var n=this._get(e,"stepMonths"),i="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map((function(){var e={prev:function(){t.datepicker._adjustDate(i,-n,"M")},next:function(){t.datepicker._adjustDate(i,+n,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(i)},selectDay:function(){return t.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(i,this,"Y"),!1}};t(this).on(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])}))},_generateHTML:function(t){var e,n,i,r,o,a,s,l,u,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E,M,P,D,O,I,L,R,N,F,B,z,j=new Date,V=this._daylightSavingAdjust(new Date(j.getFullYear(),j.getMonth(),j.getDate())),H=this._get(t,"isRTL"),W=this._get(t,"showButtonPanel"),U=this._get(t,"hideIfNoPrevNext"),$=this._get(t,"navigationAsDateFormat"),G=this._getNumberOfMonths(t),q=this._get(t,"showCurrentAtPos"),Y=this._get(t,"stepMonths"),X=1!==G[0]||1!==G[1],Q=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),K=this._getMinMaxDate(t,"min"),J=this._getMinMaxDate(t,"max"),Z=t.drawMonth-q,tt=t.drawYear;if(Z<0&&(Z+=12,tt--),J)for(e=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-G[0]*G[1]+1,J.getDate())),e=K&&e<K?K:e;this._daylightSavingAdjust(new Date(tt,Z,1))>e;)--Z<0&&(Z=11,tt--);for(t.drawMonth=Z,t.drawYear=tt,n=this._get(t,"prevText"),n=$?this.formatDate(n,this._daylightSavingAdjust(new Date(tt,Z-Y,1)),this._getFormatConfig(t)):n,i=this._canAdjustMonth(t,-1,tt,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"e":"w")+"'>"+n+"</span></a>":U?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"e":"w")+"'>"+n+"</span></a>",r=this._get(t,"nextText"),r=$?this.formatDate(r,this._daylightSavingAdjust(new Date(tt,Z+Y,1)),this._getFormatConfig(t)):r,o=this._canAdjustMonth(t,1,tt,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"w":"e")+"'>"+r+"</span></a>":U?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"w":"e")+"'>"+r+"</span></a>",a=this._get(t,"currentText"),s=this._get(t,"gotoCurrent")&&t.currentDay?Q:V,a=$?this.formatDate(a,s,this._getFormatConfig(t)):a,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",u=W?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(H?l:"")+(this._isInRange(t,s)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(H?"":l)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,h=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),g=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),y=this._get(t,"selectOtherMonths"),b=this._getDefaultDate(t),_="",w=0;w<G[0];w++){for(C="",this.maxRows=4,T=0;T<G[1];T++){if(S=this._daylightSavingAdjust(new Date(tt,Z,t.selectedDay)),k=" ui-corner-all",A="",X){if(A+="<div class='ui-datepicker-group",G[1]>1)switch(T){case 0:A+=" ui-datepicker-group-first",k=" ui-corner-"+(H?"right":"left");break;case G[1]-1:A+=" ui-datepicker-group-last",k=" ui-corner-"+(H?"left":"right");break;default:A+=" ui-datepicker-group-middle",k=""}A+="'>"}for(A+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+k+"'>"+(/all|left/.test(k)&&0===w?H?o:i:"")+(/all|right/.test(k)&&0===w?H?i:o:"")+this._generateMonthYearHeader(t,Z,tt,K,J,w>0||T>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",E=h?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",x=0;x<7;x++)E+="<th scope='col'"+((x+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+d[M=(x+c)%7]+"'>"+p[M]+"</span></th>";for(A+=E+"</tr></thead><tbody>",P=this._getDaysInMonth(tt,Z),tt===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,P)),D=(this._getFirstDayOfMonth(tt,Z)-c+7)%7,O=Math.ceil((D+P)/7),I=X&&this.maxRows>O?this.maxRows:O,this.maxRows=I,L=this._daylightSavingAdjust(new Date(tt,Z,1-D)),R=0;R<I;R++){for(A+="<tr>",N=h?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(L)+"</td>":"",x=0;x<7;x++)F=g?g.apply(t.input?t.input[0]:null,[L]):[!0,""],z=(B=L.getMonth()!==Z)&&!y||!F[0]||K&&L<K||J&&L>J,N+="<td class='"+((x+c+6)%7>=5?" ui-datepicker-week-end":"")+(B?" ui-datepicker-other-month":"")+(L.getTime()===S.getTime()&&Z===t.selectedMonth&&t._keyEvent||b.getTime()===L.getTime()&&b.getTime()===S.getTime()?" "+this._dayOverClass:"")+(z?" "+this._unselectableClass+" ui-state-disabled":"")+(B&&!v?"":" "+F[1]+(L.getTime()===Q.getTime()?" "+this._currentClass:"")+(L.getTime()===V.getTime()?" ui-datepicker-today":""))+"'"+(B&&!v||!F[2]?"":" title='"+F[2].replace(/'/g,"&#39;")+"'")+(z?"":" data-handler='selectDay' data-event='click' data-month='"+L.getMonth()+"' data-year='"+L.getFullYear()+"'")+">"+(B&&!v?"&#xa0;":z?"<span class='ui-state-default'>"+L.getDate()+"</span>":"<a class='ui-state-default"+(L.getTime()===V.getTime()?" ui-state-highlight":"")+(L.getTime()===Q.getTime()?" ui-state-active":"")+(B?" ui-priority-secondary":"")+"' href='#'>"+L.getDate()+"</a>")+"</td>",L.setDate(L.getDate()+1),L=this._daylightSavingAdjust(L);A+=N+"</tr>"}++Z>11&&(Z=0,tt++),C+=A+="</tbody></table>"+(X?"</div>"+(G[0]>0&&T===G[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}_+=C}return _+=u,t._keyEvent=!1,_},_generateMonthYearHeader:function(t,e,n,i,r,o,a,s){var l,u,c,h,d,p,f,m,g=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),y=this._get(t,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",_="";if(o||!g)_+="<span class='ui-datepicker-month'>"+a[e]+"</span>";else{for(l=i&&i.getFullYear()===n,u=r&&r.getFullYear()===n,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;c<12;c++)(!l||c>=i.getMonth())&&(!u||c<=r.getMonth())&&(_+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+s[c]+"</option>");_+="</select>"}if(y||(b+=_+(!o&&g&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!v)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{for(h=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),f=(p=function(t){var e=t.match(/c[+\-].*/)?n+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e})(h[0]),m=Math.max(f,p(h[1]||"")),f=i?Math.max(f,i.getFullYear()):f,m=r?Math.min(m,r.getFullYear()):m,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";f<=m;f++)t.yearshtml+="<option value='"+f+"'"+(f===n?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),y&&(b+=(!o&&g&&v?"":"&#xa0;")+_),b+="</div>"},_adjustInstDate:function(t,e,n){var i=t.selectedYear+("Y"===n?e:0),r=t.selectedMonth+("M"===n?e:0),o=Math.min(t.selectedDay,this._getDaysInMonth(i,r))+("D"===n?e:0),a=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(i,r,o)));t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),"M"!==n&&"Y"!==n||this._notifyChange(t)},_restrictMinMax:function(t,e){var n=this._getMinMaxDate(t,"min"),i=this._getMinMaxDate(t,"max"),r=n&&e<n?n:e;return i&&r>i?i:r},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,n,i){var r=this._getNumberOfMonths(t),o=this._daylightSavingAdjust(new Date(n,i+(e<0?e:r[0]*r[1]),1));return e<0&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(t,o)},_isInRange:function(t,e){var n,i,r=this._getMinMaxDate(t,"min"),o=this._getMinMaxDate(t,"max"),a=null,s=null,l=this._get(t,"yearRange");return l&&(n=l.split(":"),i=(new Date).getFullYear(),a=parseInt(n[0],10),s=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(a+=i),n[1].match(/[+\-].*/)&&(s+=i)),(!r||e.getTime()>=r.getTime())&&(!o||e.getTime()<=o.getTime())&&(!a||e.getFullYear()>=a)&&(!s||e.getFullYear()<=s)},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return{shortYearCutoff:e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,n,i){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var r=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(i,n,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),r,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).on("mousedown",t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(n)):this.each((function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(n)):t.datepicker._attachDatepicker(this,e)})):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(n))},t.datepicker=new h,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.12.1",t.datepicker,t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var m=!1;t(document).on("mouseup",(function(){m=!1})),t.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,(function(t){return e._mouseDown(t)})).on("click."+this.widgetName,(function(n){if(!0===t.data(n.target,e.widgetName+".preventClickEvent"))return t.removeData(n.target,e.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!m){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var n=this,i=1===e.which,r=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&t(e.target).closest(this.options.cancel).length;return!(i&&!r&&this._mouseCapture(e)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){n.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return n._mouseMove(t)},this._mouseUpDelegate=function(t){return n._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),m=!0,0)))}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,m=!1,e.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),t.ui.plugin={add:function(e,n,i){var r,o=t.ui[e].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(t,e,n,i){var r,o=t.plugins[e];if(o&&(i||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(r=0;r<o.length;r++)t.options[o[r][0]]&&o[r][1].apply(t.element,n)}},t.ui.safeBlur=function(e){e&&"body"!==e.nodeName.toLowerCase()&&t(e).trigger("blur")},t.widget("ui.draggable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(e){var n=this.options;return!(this.helper||n.disabled||t(e.target).closest(".ui-resizable-handle").length>0||(this.handle=this._getHandle(e),!this.handle||(this._blurActiveElement(e),this._blockFrames(!0===n.iframeFix?"iframe":n.iframeFix),0)))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map((function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var n=t.ui.safeActiveElement(this.document[0]);t(e.target).closest(n).length||t.ui.safeBlur(n)},_mouseStart:function(e){var n=this.options;return this.helper=this._createHelper(e),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter((function(){return"fixed"===t(this).css("position")})).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,n){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(!1===this._trigger("drag",e,i))return this._mouseUp(new t.Event("mouseup",e)),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var n=this,i=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(i=t.ui.ddmanager.drop(this,e)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),(function(){!1!==n._trigger("stop",e)&&n._clear()})):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.trigger("focus"),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new t.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!t(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(e){var n=this.options,i=t.isFunction(n.helper),r=i?t(n.helper.apply(this.element[0],[e])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,n,i,r=this.options,o=this.document[0];this.relativeContainer=null,r.containment?"window"!==r.containment?"document"!==r.containment?r.containment.constructor!==Array?("parent"===r.containment&&(r.containment=this.helper[0].parentNode),(i=(n=t(r.containment))[0])&&(e=/(scroll|auto)/.test(n.css("overflow")),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(e?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=n)):this.containment=r.containment:this.containment=[0,0,t(o).width()-this.helperProportions.width-this.margins.left,(t(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(t,e){e||(e=this.position);var n="absolute"===t?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*n,left:e.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*n}},_generatePosition:function(t,e){var n,i,r,o,a=this.options,s=this._isRootNode(this.scrollParent[0]),l=t.pageX,u=t.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(i=this.relativeContainer.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(u=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(u=n[3]+this.offset.click.top)),a.grid&&(r=a.grid[1]?this.originalPageY+Math.round((u-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,u=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-a.grid[1]:r+a.grid[1]:r,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(u=this.originalPageY)),{top:u-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(e,n,i){return i=i||this._uiHash(),t.ui.plugin.call(this,e,[n,i,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,n,i){var r=t.extend({},n,{item:i.element});i.sortables=[],t(i.options.connectToSortable).each((function(){var n=t(this).sortable("instance");n&&!n.options.disabled&&(i.sortables.push(n),n.refreshPositions(),n._trigger("activate",e,r))}))},stop:function(e,n,i){var r=t.extend({},n,{item:i.element});i.cancelHelperRemoval=!1,t.each(i.sortables,(function(){this.isOver?(this.isOver=0,i.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(e),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",e,r))}))},drag:function(e,n,i){t.each(i.sortables,(function(){var r=!1,o=this;o.positionAbs=i.positionAbs,o.helperProportions=i.helperProportions,o.offset.click=i.offset.click,o._intersectsWith(o.containerCache)&&(r=!0,t.each(i.sortables,(function(){return this.positionAbs=i.positionAbs,this.helperProportions=i.helperProportions,this.offset.click=i.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&t.contains(o.element[0],this.element[0])&&(r=!1),r}))),r?(o.isOver||(o.isOver=1,i._parent=n.helper.parent(),o.currentItem=n.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return n.helper[0]},e.target=o.currentItem[0],o._mouseCapture(e,!0),o._mouseStart(e,!0,!0),o.offset.click.top=i.offset.click.top,o.offset.click.left=i.offset.click.left,o.offset.parent.left-=i.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=i.offset.parent.top-o.offset.parent.top,i._trigger("toSortable",e),i.dropped=o.element,t.each(i.sortables,(function(){this.refreshPositions()})),i.currentItem=i.element,o.fromOutside=i),o.currentItem&&(o._mouseDrag(e),n.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",e,o._uiHash(o)),o._mouseStop(e,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),n.helper.appendTo(i._parent),i._refreshOffsets(e),n.position=i._generatePosition(e,!0),i._trigger("fromSortable",e),i.dropped=!1,t.each(i.sortables,(function(){this.refreshPositions()})))}))}}),t.ui.plugin.add("draggable","cursor",{start:function(e,n,i){var r=t("body"),o=i.options;r.css("cursor")&&(o._cursor=r.css("cursor")),r.css("cursor",o.cursor)},stop:function(e,n,i){var r=i.options;r._cursor&&t("body").css("cursor",r._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,n,i){var r=t(n.helper),o=i.options;r.css("opacity")&&(o._opacity=r.css("opacity")),r.css("opacity",o.opacity)},stop:function(e,n,i){var r=i.options;r._opacity&&t(n.helper).css("opacity",r._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(e,n,i){var r=i.options,o=!1,a=i.scrollParentNotHidden[0],s=i.document[0];a!==s&&"HTML"!==a.tagName?(r.axis&&"x"===r.axis||(i.overflowOffset.top+a.offsetHeight-e.pageY<r.scrollSensitivity?a.scrollTop=o=a.scrollTop+r.scrollSpeed:e.pageY-i.overflowOffset.top<r.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(i.overflowOffset.left+a.offsetWidth-e.pageX<r.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+r.scrollSpeed:e.pageX-i.overflowOffset.left<r.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(e.pageY-t(s).scrollTop()<r.scrollSensitivity?o=t(s).scrollTop(t(s).scrollTop()-r.scrollSpeed):t(window).height()-(e.pageY-t(s).scrollTop())<r.scrollSensitivity&&(o=t(s).scrollTop(t(s).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(e.pageX-t(s).scrollLeft()<r.scrollSensitivity?o=t(s).scrollLeft(t(s).scrollLeft()-r.scrollSpeed):t(window).width()-(e.pageX-t(s).scrollLeft())<r.scrollSensitivity&&(o=t(s).scrollLeft(t(s).scrollLeft()+r.scrollSpeed)))),!1!==o&&t.ui.ddmanager&&!r.dropBehaviour&&t.ui.ddmanager.prepareOffsets(i,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,n,i){var r=i.options;i.snapElements=[],t(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each((function(){var e=t(this),n=e.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:n.top,left:n.left})}))},drag:function(e,n,i){var r,o,a,s,l,u,c,h,d,p,f=i.options,m=f.snapTolerance,g=n.offset.left,v=g+i.helperProportions.width,y=n.offset.top,b=y+i.helperProportions.height;for(d=i.snapElements.length-1;d>=0;d--)u=(l=i.snapElements[d].left-i.margins.left)+i.snapElements[d].width,h=(c=i.snapElements[d].top-i.margins.top)+i.snapElements[d].height,v<l-m||g>u+m||b<c-m||y>h+m||!t.contains(i.snapElements[d].item.ownerDocument,i.snapElements[d].item)?(i.snapElements[d].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,e,t.extend(i._uiHash(),{snapItem:i.snapElements[d].item})),i.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(r=Math.abs(c-b)<=m,o=Math.abs(h-y)<=m,a=Math.abs(l-v)<=m,s=Math.abs(u-g)<=m,r&&(n.position.top=i._convertPositionTo("relative",{top:c-i.helperProportions.height,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:h,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:u}).left)),p=r||o||a||s,"outer"!==f.snapMode&&(r=Math.abs(c-y)<=m,o=Math.abs(h-b)<=m,a=Math.abs(l-g)<=m,s=Math.abs(u-v)<=m,r&&(n.position.top=i._convertPositionTo("relative",{top:c,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:h-i.helperProportions.height,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l}).left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:u-i.helperProportions.width}).left)),!i.snapElements[d].snapping&&(r||o||a||s||p)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,e,t.extend(i._uiHash(),{snapItem:i.snapElements[d].item})),i.snapElements[d].snapping=r||o||a||s||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,n,i){var r,o=i.options,a=t.makeArray(t(o.stack)).sort((function(e,n){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(n).css("zIndex"),10)||0)}));a.length&&(r=parseInt(t(a[0]).css("zIndex"),10)||0,t(a).each((function(e){t(this).css("zIndex",r+e)})),this.css("zIndex",r+a.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,n,i){var r=t(n.helper),o=i.options;r.css("zIndex")&&(o._zIndex=r.css("zIndex")),r.css("zIndex",o.zIndex)},stop:function(e,n,i){var r=i.options;r._zIndex&&t(n.helper).css("zIndex",r._zIndex)}}),t.ui.draggable,t.widget("ui.resizable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(e,n){if("hidden"===t(e).css("overflow"))return!1;var i,r=n&&"left"===n?"scrollLeft":"scrollTop";return e[r]>0||(e[r]=1,i=e[r]>0,e[r]=0,i)},_create:function(){var e,n=this.options,i=this;this._addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,e={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(e),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(e),this._proportionallyResize()),this._setupHandles(),n.autoHide&&t(this.element).on("mouseenter",(function(){n.disabled||(i._removeClass("ui-resizable-autohide"),i._handles.show())})).on("mouseleave",(function(){n.disabled||i.resizing||(i._addClass("ui-resizable-autohide"),i._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,n=function(e){t(e).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_setOption:function(t,e){switch(this._super(t,e),t){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var e,n,i,r,o,a=this.options,s=this;if(this.handles=a.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),i=this.handles.split(","),this.handles={},n=0;n<i.length;n++)r="ui-resizable-"+(e=t.trim(i[n])),o=t("<div>"),this._addClass(o,"ui-resizable-handle "+r),o.css({zIndex:a.zIndex}),this.handles[e]=".ui-resizable-"+e,this.element.append(o);this._renderAxis=function(e){var n,i,r,o;for(n in e=e||this.element,this.handles)this.handles[n].constructor===String?this.handles[n]=this.element.children(this.handles[n]).first().show():(this.handles[n].jquery||this.handles[n].nodeType)&&(this.handles[n]=t(this.handles[n]),this._on(this.handles[n],{mousedown:s._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(i=t(this.handles[n],this.element),o=/sw|ne|nw|se|n|s/.test(n)?i.outerHeight():i.outerWidth(),r=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),e.css(r,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[n])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",(function(){s.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=o&&o[1]?o[1]:"se")})),a.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(e){var n,i,r=!1;for(n in this.handles)((i=t(this.handles[n])[0])===e.target||t.contains(i,e.target))&&(r=!0);return!this.options.disabled&&r},_mouseStart:function(e){var n,i,r,o=this.options,a=this.element;return this.resizing=!0,this._renderProxy(),n=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),o.containment&&(n+=t(o.containment).scrollLeft()||0,i+=t(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalPosition={left:n,top:i},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===r?this.axis+"-resize":r),this._addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var n,i,r=this.originalMousePosition,o=this.axis,a=e.pageX-r.left||0,s=e.pageY-r.top||0,l=this._change[o];return this._updatePrevProperties(),!!l&&(n=l.apply(this,[e,a,s]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(n=this._updateRatio(n,e)),n=this._respectSize(n,e),this._updateCache(n),this._propagate("resize",e),i=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1)},_mouseStop:function(e){this.resizing=!1;var n,i,r,o,a,s,l,u=this.options;return this._helper&&(r=(i=(n=this._proportionallyResizeElements).length&&/textarea/i.test(n[0].nodeName))&&this._hasScroll(n[0],"left")?0:this.sizeDiff.height,o=i?0:this.sizeDiff.width,a={width:this.helper.width()-o,height:this.helper.height()-r},s=parseFloat(this.element.css("left"))+(this.position.left-this.originalPosition.left)||null,l=parseFloat(this.element.css("top"))+(this.position.top-this.originalPosition.top)||null,u.animate||this.element.css(t.extend(a,{top:l,left:s})),this.helper.height(this.size.height),this.helper.width(this.size.width),this._helper&&!u.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,n,i,r,o,a=this.options;o={minWidth:this._isNumber(a.minWidth)?a.minWidth:0,maxWidth:this._isNumber(a.maxWidth)?a.maxWidth:1/0,minHeight:this._isNumber(a.minHeight)?a.minHeight:0,maxHeight:this._isNumber(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||t)&&(e=o.minHeight*this.aspectRatio,i=o.minWidth/this.aspectRatio,n=o.maxHeight*this.aspectRatio,r=o.maxWidth/this.aspectRatio,e>o.minWidth&&(o.minWidth=e),i>o.minHeight&&(o.minHeight=i),n<o.maxWidth&&(o.maxWidth=n),r<o.maxHeight&&(o.maxHeight=r)),this._vBoundaries=o},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,n=this.size,i=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===i&&(t.left=e.left+(n.width-t.width),t.top=null),"nw"===i&&(t.top=e.top+(n.height-t.height),t.left=e.left+(n.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,n=this.axis,i=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,r=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,a=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,s=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,u=/sw|nw|w/.test(n),c=/nw|ne|n/.test(n);return o&&(t.width=e.minWidth),a&&(t.height=e.minHeight),i&&(t.width=e.maxWidth),r&&(t.height=e.maxHeight),o&&u&&(t.left=s-e.minWidth),i&&u&&(t.left=s-e.maxWidth),a&&c&&(t.top=l-e.minHeight),r&&c&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,n=[],i=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],r=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];e<4;e++)n[e]=parseFloat(i[e])||0,n[e]+=parseFloat(r[e])||0;return{height:n[0]+n[2],width:n[1]+n[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,n=this.helper||this.element;e<this._proportionallyResizeElements.length;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:n.height()-this.outerDimensions.height||0,width:n.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,n=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var n=this.originalSize;return{left:this.originalPosition.left+e,width:n.width-e}},n:function(t,e,n){var i=this.originalSize;return{top:this.originalPosition.top+n,height:i.height-n}},s:function(t,e,n){return{height:this.originalSize.height+n}},se:function(e,n,i){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,n,i]))},sw:function(e,n,i){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,n,i]))},ne:function(e,n,i){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,n,i]))},nw:function(e,n,i){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,n,i]))}},_propagate:function(e,n){t.ui.plugin.call(this,e,[n,this.ui()]),"resize"!==e&&this._trigger(e,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var n=t(this).resizable("instance"),i=n.options,r=n._proportionallyResizeElements,o=r.length&&/textarea/i.test(r[0].nodeName),a=o&&n._hasScroll(r[0],"left")?0:n.sizeDiff.height,s=o?0:n.sizeDiff.width,l={width:n.size.width-s,height:n.size.height-a},u=parseFloat(n.element.css("left"))+(n.position.left-n.originalPosition.left)||null,c=parseFloat(n.element.css("top"))+(n.position.top-n.originalPosition.top)||null;n.element.animate(t.extend(l,c&&u?{top:c,left:u}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseFloat(n.element.css("width")),height:parseFloat(n.element.css("height")),top:parseFloat(n.element.css("top")),left:parseFloat(n.element.css("left"))};r&&r.length&&t(r[0]).css({width:i.width,height:i.height}),n._updateCache(i),n._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,n,i,r,o,a,s,l=t(this).resizable("instance"),u=l.options,c=l.element,h=u.containment,d=h instanceof t?h.get(0):/parent/.test(h)?c.parent().get(0):h;d&&(l.containerElement=t(d),/document/.test(h)||h===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(d),n=[],t(["Top","Right","Left","Bottom"]).each((function(t,i){n[t]=l._num(e.css("padding"+i))})),l.containerOffset=e.offset(),l.containerPosition=e.position(),l.containerSize={height:e.innerHeight()-n[3],width:e.innerWidth()-n[1]},i=l.containerOffset,r=l.containerSize.height,o=l.containerSize.width,a=l._hasScroll(d,"left")?d.scrollWidth:o,s=l._hasScroll(d)?d.scrollHeight:r,l.parentData={element:d,left:i.left,top:i.top,width:a,height:s}))},resize:function(e){var n,i,r,o,a=t(this).resizable("instance"),s=a.options,l=a.containerOffset,u=a.position,c=a._aspectRatio||e.shiftKey,h={top:0,left:0},d=a.containerElement,p=!0;d[0]!==document&&/static/.test(d.css("position"))&&(h=l),u.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-h.left),c&&(a.size.height=a.size.width/a.aspectRatio,p=!1),a.position.left=s.helper?l.left:0),u.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),c&&(a.size.width=a.size.height*a.aspectRatio,p=!1),a.position.top=a._helper?l.top:0),r=a.containerElement.get(0)===a.element.parent().get(0),o=/relative|absolute/.test(a.containerElement.css("position")),r&&o?(a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top):(a.offset.left=a.element.offset().left,a.offset.top=a.element.offset().top),n=Math.abs(a.sizeDiff.width+(a._helper?a.offset.left-h.left:a.offset.left-l.left)),i=Math.abs(a.sizeDiff.height+(a._helper?a.offset.top-h.top:a.offset.top-l.top)),n+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-n,c&&(a.size.height=a.size.width/a.aspectRatio,p=!1)),i+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-i,c&&(a.size.width=a.size.height*a.aspectRatio,p=!1)),p||(a.position.left=a.prevPosition.left,a.position.top=a.prevPosition.top,a.size.width=a.prevSize.width,a.size.height=a.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),n=e.options,i=e.containerOffset,r=e.containerPosition,o=e.containerElement,a=t(e.helper),s=a.offset(),l=a.outerWidth()-e.sizeDiff.width,u=a.outerHeight()-e.sizeDiff.height;e._helper&&!n.animate&&/relative/.test(o.css("position"))&&t(this).css({left:s.left-r.left-i.left,width:l,height:u}),e._helper&&!n.animate&&/static/.test(o.css("position"))&&t(this).css({left:s.left-r.left-i.left,width:l,height:u})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance").options;t(e.alsoResize).each((function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseFloat(e.width()),height:parseFloat(e.height()),left:parseFloat(e.css("left")),top:parseFloat(e.css("top"))})}))},resize:function(e,n){var i=t(this).resizable("instance"),r=i.options,o=i.originalSize,a=i.originalPosition,s={height:i.size.height-o.height||0,width:i.size.width-o.width||0,top:i.position.top-a.top||0,left:i.position.left-a.left||0};t(r.alsoResize).each((function(){var e=t(this),i=t(this).data("ui-resizable-alsoresize"),r={},o=e.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(o,(function(t,e){var n=(i[e]||0)+(s[e]||0);n&&n>=0&&(r[e]=n||null)})),e.css(r)}))},stop:function(){t(this).removeData("ui-resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),n=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}),e._addClass(e.ghost,"ui-resizable-ghost"),!1!==t.uiBackCompat&&"string"==typeof e.options.ghost&&e.ghost.addClass(this.options.ghost),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,n=t(this).resizable("instance"),i=n.options,r=n.size,o=n.originalSize,a=n.originalPosition,s=n.axis,l="number"==typeof i.grid?[i.grid,i.grid]:i.grid,u=l[0]||1,c=l[1]||1,h=Math.round((r.width-o.width)/u)*u,d=Math.round((r.height-o.height)/c)*c,p=o.width+h,f=o.height+d,m=i.maxWidth&&i.maxWidth<p,g=i.maxHeight&&i.maxHeight<f,v=i.minWidth&&i.minWidth>p,y=i.minHeight&&i.minHeight>f;i.grid=l,v&&(p+=u),y&&(f+=c),m&&(p-=u),g&&(f-=c),/^(se|s|e)$/.test(s)?(n.size.width=p,n.size.height=f):/^(ne)$/.test(s)?(n.size.width=p,n.size.height=f,n.position.top=a.top-d):/^(sw)$/.test(s)?(n.size.width=p,n.size.height=f,n.position.left=a.left-h):((f-c<=0||p-u<=0)&&(e=n._getPaddingPlusBorderDimensions(this)),f-c>0?(n.size.height=f,n.position.top=a.top-d):(f=c-e.height,n.size.height=f,n.position.top=a.top+o.height-f),p-u>0?(n.size.width=p,n.position.left=a.left-h):(p=u-e.width,n.size.width=p,n.position.left=a.left+o.width-p))}}),t.ui.resizable,t.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var n=t(this).css(e).offset().top;n<0&&t(this).css("top",e.top-n)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(t=e.parent.children().eq(e.index)).length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var n=this;this._isOpen&&!1!==this._trigger("beforeClose",e)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||t.ui.safeBlur(t.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,(function(){n._trigger("close",e)})))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,n){var i=!1,r=this.uiDialog.siblings(".ui-front:visible").map((function(){return+t(this).css("z-index")})).get(),o=Math.max.apply(null,r);return o>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",o+1),i=!0),i&&!n&&this._trigger("focus",e),i},open:function(){var e=this;this._isOpen?this._moveToTop()&&this._focusTabbable():(this._isOpen=!0,this.opener=t(t.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,(function(){e._focusTabbable(),e._trigger("focus")})),this._makeFocusTarget(),this._trigger("open"))},_focusTabbable:function(){var t=this._focusedElement;t||(t=this.element.find("[autofocus]")),t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).trigger("focus")},_keepFocus:function(e){function n(){var e=t.ui.safeActiveElement(this.document[0]);this.uiDialog[0]===e||t.contains(this.uiDialog[0],e)||this._focusTabbable()}e.preventDefault(),n.call(this),this._delay(n)},_createWrapper:function(){this.uiDialog=t("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),void this.close(e);if(e.keyCode===t.ui.keyCode.TAB&&!e.isDefaultPrevented()){var n=this.uiDialog.find(":tabbable"),i=n.filter(":first"),r=n.filter(":last");e.target!==r[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==i[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay((function(){r.trigger("focus")})),e.preventDefault()):(this._delay((function(){i.trigger("focus")})),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=t("<button type='button'></button>").button({label:t("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(e,"ui-dialog-title"),this._title(e),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title?t.text(this.options.title):t.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var e=this,n=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(n)||t.isArray(n)&&!n.length?this._removeClass(this.uiDialog,"ui-dialog-buttons"):(t.each(n,(function(n,i){var r,o;i=t.isFunction(i)?{click:i,text:n}:i,i=t.extend({type:"button"},i),r=i.click,o={icon:i.icon,iconPosition:i.iconPosition,showLabel:i.showLabel,icons:i.icons,text:i.text},delete i.click,delete i.icon,delete i.iconPosition,delete i.showLabel,delete i.icons,"boolean"==typeof i.text&&delete i.text,t("<button></button>",i).button(o).appendTo(e.uiButtonSet).on("click",(function(){r.apply(e.element[0],arguments)}))})),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){var e=this,n=this.options;function i(t){return{position:t.position,offset:t.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,r){e._addClass(t(this),"ui-dialog-dragging"),e._blockFrames(),e._trigger("dragStart",n,i(r))},drag:function(t,n){e._trigger("drag",t,i(n))},stop:function(r,o){var a=o.offset.left-e.document.scrollLeft(),s=o.offset.top-e.document.scrollTop();n.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" top"+(s>=0?"+":"")+s,of:e.window},e._removeClass(t(this),"ui-dialog-dragging"),e._unblockFrames(),e._trigger("dragStop",r,i(o))}})},_makeResizable:function(){var e=this,n=this.options,i=n.resizable,r=this.uiDialog.css("position"),o="string"==typeof i?i:"n,e,s,w,se,sw,ne,nw";function a(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:o,start:function(n,i){e._addClass(t(this),"ui-dialog-resizing"),e._blockFrames(),e._trigger("resizeStart",n,a(i))},resize:function(t,n){e._trigger("resize",t,a(n))},stop:function(i,r){var o=e.uiDialog.offset(),s=o.left-e.document.scrollLeft(),l=o.top-e.document.scrollTop();n.height=e.uiDialog.height(),n.width=e.uiDialog.width(),n.position={my:"left top",at:"left"+(s>=0?"+":"")+s+" top"+(l>=0?"+":"")+l,of:e.window},e._removeClass(t(this),"ui-dialog-resizing"),e._unblockFrames(),e._trigger("resizeStop",i,a(r))}}).css("position",r)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=t(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),n=t.inArray(this,e);-1!==n&&e.splice(n,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var n=this,i=!1,r={};t.each(e,(function(t,e){n._setOption(t,e),t in n.sizeRelatedOptions&&(i=!0),t in n.resizableRelatedOptions&&(r[t]=e)})),i&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",r)},_setOption:function(e,n){var i,r,o=this.uiDialog;"disabled"!==e&&(this._super(e,n),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:t("<a>").text(""+this.options.closeText).html()}),"draggable"===e&&((i=o.is(":data(ui-draggable)"))&&!n&&o.draggable("destroy"),!i&&n&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&((r=o.is(":data(ui-resizable)"))&&!n&&o.resizable("destroy"),r&&"string"==typeof n&&o.resizable("option","handles",n),r||!1===n||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,n,i=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),i.minWidth>i.width&&(i.width=i.minWidth),t=this.uiDialog.css({height:"auto",width:i.width}).outerHeight(),e=Math.max(0,i.minHeight-t),n="number"==typeof i.maxHeight?Math.max(0,i.maxHeight-t):"none","auto"===i.height?this.element.css({minHeight:e,maxHeight:n,height:"auto"}):this.element.height(Math.max(0,i.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map((function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return!!t(e.target).closest(".ui-dialog").length||!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay((function(){e=!1})),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=t("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data("ui-dialog-overlays")-1;t?this.document.data("ui-dialog-overlays",t):(this._off(this.document,"focusin"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),!1!==t.uiBackCompat&&t.widget("ui.dialog",t.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(t,e){"dialogClass"===t&&this.uiDialog.removeClass(this.options.dialogClass).addClass(e),this._superApply(arguments)}}),t.ui.dialog,t.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,n=this.options,i=n.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(i)?i:function(t){return t.is(i)},this.proportions=function(){if(!arguments.length)return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});e=arguments[0]},this._addToManager(n.scope),n.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;e<t.length;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,n){if("accept"===e)this.accept=t.isFunction(n)?n:function(t){return t.is(n)};else if("scope"===e){var i=t.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(n)}this._super(e,n)},_activate:function(e){var n=t.ui.ddmanager.current;this._addActiveClass(),n&&this._trigger("activate",e,this.ui(n))},_deactivate:function(e){var n=t.ui.ddmanager.current;this._removeActiveClass(),n&&this._trigger("deactivate",e,this.ui(n))},_over:function(e){var n=t.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(n)))},_out:function(e){var n=t.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(n)))},_drop:function(e,n){var i=n||t.ui.ddmanager.current,r=!1;return!(!i||(i.currentItem||i.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var n=t(this).droppable("instance");if(n.options.greedy&&!n.options.disabled&&n.options.scope===i.options.scope&&n.accept.call(n.element[0],i.currentItem||i.element)&&v(i,t.extend(n,{offset:n.element.offset()}),n.options.tolerance,e))return r=!0,!1})),!r&&!!this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(i)),this.element))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var g,v=t.ui.intersect=function(){function t(t,e,n){return t>=e&&t<e+n}return function(e,n,i,r){if(!n.offset)return!1;var o=(e.positionAbs||e.position.absolute).left+e.margins.left,a=(e.positionAbs||e.position.absolute).top+e.margins.top,s=o+e.helperProportions.width,l=a+e.helperProportions.height,u=n.offset.left,c=n.offset.top,h=u+n.proportions().width,d=c+n.proportions().height;switch(i){case"fit":return u<=o&&s<=h&&c<=a&&l<=d;case"intersect":return u<o+e.helperProportions.width/2&&s-e.helperProportions.width/2<h&&c<a+e.helperProportions.height/2&&l-e.helperProportions.height/2<d;case"pointer":return t(r.pageY,c,n.proportions().height)&&t(r.pageX,u,n.proportions().width);case"touch":return(a>=c&&a<=d||l>=c&&l<=d||a<c&&l>d)&&(o>=u&&o<=h||s>=u&&s<=h||o<u&&s>h);default:return!1}}}();function y(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,n){var i,r,o=t.ui.ddmanager.droppables[e.options.scope]||[],a=n?n.type:null,s=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(i=0;i<o.length;i++)if(!(o[i].options.disabled||e&&!o[i].accept.call(o[i].element[0],e.currentItem||e.element))){for(r=0;r<s.length;r++)if(s[r]===o[i].element[0]){o[i].proportions().height=0;continue t}o[i].visible="none"!==o[i].element.css("display"),o[i].visible&&("mousedown"===a&&o[i]._activate.call(o[i],n),o[i].offset=o[i].element.offset(),o[i].proportions({width:o[i].element[0].offsetWidth,height:o[i].element[0].offsetHeight}))}},drop:function(e,n){var i=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&v(e,this,this.options.tolerance,n)&&(i=this._drop.call(this,n)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n)))})),i},dragStart:function(e,n){e.element.parentsUntil("body").on("scroll.droppable",(function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,n)}))},drag:function(e,n){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,n),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var i,r,o,a=v(e,this,this.options.tolerance,n),s=!a&&this.isover?"isout":a&&!this.isover?"isover":null;s&&(this.options.greedy&&(r=this.options.scope,(o=this.element.parents(":data(ui-droppable)").filter((function(){return t(this).droppable("instance").options.scope===r}))).length&&((i=t(o[0]).droppable("instance")).greedyChild="isover"===s)),i&&"isover"===s&&(i.isover=!1,i.isout=!0,i._out.call(i,n)),this[s]=!0,this["isout"===s?"isover":"isout"]=!1,this["isover"===s?"_over":"_out"].call(this,n),i&&"isout"===s&&(i.isout=!1,i.isover=!0,i._over.call(i,n)))}}))},dragStop:function(e,n){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,n)}},!1!==t.uiBackCompat&&t.widget("ui.droppable",t.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),t.ui.droppable,t.widget("ui.progressbar",{version:"1.12.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=t("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(t){if(void 0===t)return this.options.value;this.options.value=this._constrainedValue(t),this._refreshValue()},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=!1===t,"number"!=typeof t&&(t=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,n=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).width(n.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,e===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),t.widget("ui.selectable",t.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e.elementPos=t(e.element[0]).offset(),e.selectees=t(e.options.filter,e.element[0]),e._addClass(e.selectees,"ui-selectee"),e.selectees.each((function(){var n=t(this),i=n.offset(),r={left:i.left-e.elementPos.left,top:i.top-e.elementPos.top};t.data(this,"selectable-item",{element:this,$element:n,left:r.left,top:r.top,right:r.left+n.outerWidth(),bottom:r.top+n.outerHeight(),startselected:!1,selected:n.hasClass("ui-selected"),selecting:n.hasClass("ui-selecting"),unselecting:n.hasClass("ui-unselecting")})}))},this.refresh(),this._mouseInit(),this.helper=t("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(e){var n=this,i=this.options;this.opos=[e.pageX,e.pageY],this.elementPos=t(this.element[0]).offset(),this.options.disabled||(this.selectees=t(i.filter,this.element[0]),this._trigger("start",e),t(i.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),i.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each((function(){var i=t.data(this,"selectable-item");i.startselected=!0,e.metaKey||e.ctrlKey||(n._removeClass(i.$element,"ui-selected"),i.selected=!1,n._addClass(i.$element,"ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",e,{unselecting:i.element}))})),t(e.target).parents().addBack().each((function(){var i,r=t.data(this,"selectable-item");if(r)return i=!e.metaKey&&!e.ctrlKey||!r.$element.hasClass("ui-selected"),n._removeClass(r.$element,i?"ui-unselecting":"ui-selected")._addClass(r.$element,i?"ui-selecting":"ui-unselecting"),r.unselecting=!i,r.selecting=i,r.selected=i,i?n._trigger("selecting",e,{selecting:r.element}):n._trigger("unselecting",e,{unselecting:r.element}),!1})))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var n,i=this,r=this.options,o=this.opos[0],a=this.opos[1],s=e.pageX,l=e.pageY;return o>s&&(n=s,s=o,o=n),a>l&&(n=l,l=a,a=n),this.helper.css({left:o,top:a,width:s-o,height:l-a}),this.selectees.each((function(){var n=t.data(this,"selectable-item"),u=!1,c={};n&&n.element!==i.element[0]&&(c.left=n.left+i.elementPos.left,c.right=n.right+i.elementPos.left,c.top=n.top+i.elementPos.top,c.bottom=n.bottom+i.elementPos.top,"touch"===r.tolerance?u=!(c.left>s||c.right<o||c.top>l||c.bottom<a):"fit"===r.tolerance&&(u=c.left>o&&c.right<s&&c.top>a&&c.bottom<l),u?(n.selected&&(i._removeClass(n.$element,"ui-selected"),n.selected=!1),n.unselecting&&(i._removeClass(n.$element,"ui-unselecting"),n.unselecting=!1),n.selecting||(i._addClass(n.$element,"ui-selecting"),n.selecting=!0,i._trigger("selecting",e,{selecting:n.element}))):(n.selecting&&((e.metaKey||e.ctrlKey)&&n.startselected?(i._removeClass(n.$element,"ui-selecting"),n.selecting=!1,i._addClass(n.$element,"ui-selected"),n.selected=!0):(i._removeClass(n.$element,"ui-selecting"),n.selecting=!1,n.startselected&&(i._addClass(n.$element,"ui-unselecting"),n.unselecting=!0),i._trigger("unselecting",e,{unselecting:n.element}))),n.selected&&(e.metaKey||e.ctrlKey||n.startselected||(i._removeClass(n.$element,"ui-selected"),n.selected=!1,i._addClass(n.$element,"ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",e,{unselecting:n.element})))))})),!1}},_mouseStop:function(e){var n=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each((function(){var i=t.data(this,"selectable-item");n._removeClass(i.$element,"ui-unselecting"),i.unselecting=!1,i.startselected=!1,n._trigger("unselected",e,{unselected:i.element})})),t(".ui-selecting",this.element[0]).each((function(){var i=t.data(this,"selectable-item");n._removeClass(i.$element,"ui-selecting")._addClass(i.$element,"ui-selected"),i.selecting=!1,i.selected=!0,i.startselected=!0,n._trigger("selected",e,{selected:i.element})})),this._trigger("stop",e),this.helper.remove(),!1}}),t.widget("ui.selectmenu",[t.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=t()},_drawButton:function(){var e,n=this,i=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),e=t("<span>").appendTo(this.button),this._addClass(e,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(i).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",(function(){n._rendered||n._refreshMenu()}))},_drawMenu:function(){var e=this;this.menu=t("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=t("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(t,n){t.preventDefault(),e._setSelection(),e._select(n.item.data("ui-selectmenu-item"),t)},focus:function(t,n){var i=n.item.data("ui-selectmenu-item");null!=e.focusIndex&&i.index!==e.focusIndex&&(e._trigger("focus",t,{item:i}),e.isOpen||e._select(i,t)),e.focusIndex=i.index,e.button.attr("aria-activedescendant",e.menuItems.eq(i.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var t,e=this.element.find("option");this.menu.empty(),this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,e.length&&(t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t)))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(e){var n=t("<span>");return this._setText(n,e.label),this._addClass(n,"ui-selectmenu-text"),n},_renderMenu:function(e,n){var i=this,r="";t.each(n,(function(n,o){var a;o.optgroup!==r&&(a=t("<li>",{text:o.optgroup}),i._addClass(a,"ui-selectmenu-optgroup","ui-menu-divider"+(o.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),a.appendTo(e),r=o.optgroup),i._renderItemData(e,o)}))},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(e,n){var i=t("<li>"),r=t("<div>",{title:n.element.attr("title")});return n.disabled&&this._addClass(i,null,"ui-state-disabled"),this._setText(r,n.label),i.append(r).appendTo(e)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var n,i,r=".ui-menu-item";this.isOpen?n=this.menuItems.eq(this.focusIndex).parent("li"):(n=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),r+=":not(.ui-state-disabled)"),(i="first"===t||"last"===t?n["first"===t?"prevAll":"nextAll"](r).eq(-1):n[t+"All"](r).eq(0)).length&&this.menuInstance.focus(e,i)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?((t=window.getSelection()).removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(".ui-selectmenu-menu, #"+t.ui.escapeSelector(this.ids.button)).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection()).rangeCount&&(this.range=t.getRangeAt(0)):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var n=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),n=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move("prev",e);break;case t.ui.keyCode.RIGHT:this._move("next",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move("first",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),n=!1}n&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex).parent("li");e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var n=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(t)),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==n&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){if("icons"===t){var n=this.button.find("span.ui-icon");this._removeClass(n,null,this.options.icons.button)._addClass(n,null,e.button)}this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"width"===t&&this._resizeButton()},_setOptionDisabled:function(t){this._super(t),this.menuInstance.option("disabled",t),this.button.attr("aria-disabled",t),this._toggleClass(this.button,null,"ui-state-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;!1!==t?(null===t&&(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t)):this.button.css("width","")},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var t=this._super();return t.disabled=this.element.prop("disabled"),t},_parseOptions:function(e){var n=this,i=[];e.each((function(e,r){i.push(n._parseOption(t(r),e))})),this.items=i},_parseOption:function(t,e){var n=t.parent("optgroup");return{element:t,index:e,value:t.val(),label:t.text(),optgroup:n.attr("label")||"",disabled:n.prop("disabled")||t.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),t.widget("ui.slider",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,n,i=this.options,r=this.element.find(".ui-slider-handle"),o=[];for(n=i.values&&i.values.length||1,r.length>n&&(r.slice(n).remove(),r=r.slice(0,n)),e=r.length;e<n;e++)o.push("<span tabindex='0'></span>");this.handles=r.add(t(o.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each((function(e){t(this).data("ui-slider-handle-index",e).attr("tabIndex",0)}))},_createRange:function(){var e=this.options;e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=t("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==e.range&&"max"!==e.range||this._addClass(this.range,"ui-slider-range-"+e.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(e){var n,i,r,o,a,s,l,u=this,c=this.options;return!c.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(n),r=this._valueMax()-this._valueMin()+1,this.handles.each((function(e){var n=Math.abs(i-u.values(e));(r>n||r===n&&(e===u._lastChangedValue||u.values(e)===c.min))&&(r=n,o=t(this),a=e)})),!1!==this._start(e,a)&&(this._mouseSliding=!0,this._handleIndex=a,this._addClass(o,null,"ui-state-active"),o.trigger("focus"),s=o.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-s.left-o.width()/2,top:e.pageY-s.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,a,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},n=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,n),!1},_mouseStop:function(t){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,n,i,r,o;return"horizontal"===this.orientation?(e=this.elementSize.width,n=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,n=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(i=n/e)>1&&(i=1),i<0&&(i=0),"vertical"===this.orientation&&(i=1-i),r=this._valueMax()-this._valueMin(),o=this._valueMin()+i*r,this._trimAlignValue(o)},_uiHash:function(t,e,n){var i={handle:this.handles[t],handleIndex:t,value:void 0!==e?e:this.value()};return this._hasMultipleValues()&&(i.value=void 0!==e?e:this.values(t),i.values=n||this.values()),i},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(t,e){return this._trigger("start",t,this._uiHash(e))},_slide:function(t,e,n){var i,r=this.value(),o=this.values();this._hasMultipleValues()&&(i=this.values(e?0:1),r=this.values(e),2===this.options.values.length&&!0===this.options.range&&(n=0===e?Math.min(i,n):Math.max(i,n)),o[e]=n),n!==r&&!1!==this._trigger("slide",t,this._uiHash(e,n,o))&&(this._hasMultipleValues()?this.values(e,n):this.value(n))},_stop:function(t,e){this._trigger("stop",t,this._uiHash(e))},_change:function(t,e){this._keySliding||this._mouseSliding||(this._lastChangedValue=e,this._trigger("change",t,this._uiHash(e)))},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,n){var i,r,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(n),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this._hasMultipleValues()?this._values(e):this.value();for(i=this.options.values,r=arguments[0],o=0;o<i.length;o+=1)i[o]=this._trimAlignValue(r[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,n){var i,r=0;switch("range"===e&&!0===this.options.range&&("min"===n?(this.options.value=this._values(0),this.options.values=null):"max"===n&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(r=this.options.values.length),this._super(e,n),e){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(n),this.handles.css("horizontal"===n?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=r-1;i>=0;i--)this._change(null,i);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(t){this._super(t),this._toggleClass(null,"ui-state-disabled",!!t)},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,n,i;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this._hasMultipleValues()){for(n=this.options.values.slice(),i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(n[i]);return n}return[]},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,n=(t-this._valueMin())%e,i=t-n;return 2*Math.abs(n)>=e&&(i+=n>0?e:-e),parseFloat(i.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),n=this.options.step;(t=Math.round((t-e)/n)*n+e)>this.options.max&&(t-=n),this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),n=e.indexOf(".");return-1===n?0:e.length-n-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(t){"vertical"===t&&this.range.css({width:"",left:""}),"horizontal"===t&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var e,n,i,r,o,a=this.options.range,s=this.options,l=this,u=!this._animateOff&&s.animate,c={};this._hasMultipleValues()?this.handles.each((function(i){n=(l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())*100,c["horizontal"===l.orientation?"left":"bottom"]=n+"%",t(this).stop(1,1)[u?"animate":"css"](c,s.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[u?"animate":"css"]({left:n+"%"},s.animate),1===i&&l.range[u?"animate":"css"]({width:n-e+"%"},{queue:!1,duration:s.animate})):(0===i&&l.range.stop(1,1)[u?"animate":"css"]({bottom:n+"%"},s.animate),1===i&&l.range[u?"animate":"css"]({height:n-e+"%"},{queue:!1,duration:s.animate}))),e=n})):(i=this.value(),r=this._valueMin(),o=this._valueMax(),n=o!==r?(i-r)/(o-r)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[u?"animate":"css"](c,s.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[u?"animate":"css"]({width:n+"%"},s.animate),"max"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[u?"animate":"css"]({width:100-n+"%"},s.animate),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[u?"animate":"css"]({height:n+"%"},s.animate),"max"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[u?"animate":"css"]({height:100-n+"%"},s.animate))},_handleEvents:{keydown:function(e){var n,i,r,o=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(t(e.target),null,"ui-state-active"),!1===this._start(e,o)))return}switch(r=this.options.step,n=i=this._hasMultipleValues()?this.values(o):this.value(),e.keyCode){case t.ui.keyCode.HOME:i=this._valueMin();break;case t.ui.keyCode.END:i=this._valueMax();break;case t.ui.keyCode.PAGE_UP:i=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(n===this._valueMax())return;i=this._trimAlignValue(n+r);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(n===this._valueMin())return;i=this._trimAlignValue(n-r)}this._slide(e,o,i)},keyup:function(e){var n=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,n),this._change(e,n),this._removeClass(t(e.target),null,"ui-state-active"))}}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,n){return t>=e&&t<e+n},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){var e=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),t.each(this.items,(function(){e._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")}))},_destroy:function(){this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,n){var i=null,r=!1,o=this;return!(this.reverting||this.options.disabled||"static"===this.options.type||(this._refreshItems(e),t(e.target).parents().each((function(){if(t.data(this,o.widgetName+"-item")===o)return i=t(this),!1})),t.data(e.target,o.widgetName+"-item")===o&&(i=t(e.target)),!i||this.options.handle&&!n&&(t(this.options.handle,i).find("*").addBack().each((function(){this===e.target&&(r=!0)})),!r)||(this.currentItem=i,this._removeCurrentsFromItems(),0)))},_mouseStart:function(e,n,i){var r,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var n,i,r,o,a=this.options,s=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-this.document.scrollTop()<a.scrollSensitivity?s=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<a.scrollSensitivity&&(s=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),e.pageX-this.document.scrollLeft()<a.scrollSensitivity?s=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(s=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),!1!==s&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(r=(i=this.items[n]).item[0],(o=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&!(r===this.currentItem[0]||this.placeholder[1===o?"next":"prev"]()[0]===r||t.contains(this.placeholder[0],r)||"semi-dynamic"===this.options.type&&t.contains(this.element[0],r))){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(e,i),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,n){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var i=this,r=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=r.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=r.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,(function(){i._clear(e)}))}else this._clear(e,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new t.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var n=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},t(n).each((function(){var n=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);n&&i.push((e.key||n[1]+"[]")+"="+(e.key&&e.expression?n[1]:n[2]))})),!i.length&&e.key&&i.push(e.key+"="),i.join("&")},toArray:function(e){var n=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},n.each((function(){i.push(t(e.item||this).attr(e.attribute||"id")||"")})),i},_intersectsWith:function(t){var e=this.positionAbs.left,n=e+this.helperProportions.width,i=this.positionAbs.top,r=i+this.helperProportions.height,o=t.left,a=o+t.width,s=t.top,l=s+t.height,u=this.offset.click.top,c=this.offset.click.left,h="x"===this.options.axis||i+u>s&&i+u<l,d="y"===this.options.axis||e+c>o&&e+c<a,p=h&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:o<e+this.helperProportions.width/2&&n-this.helperProportions.width/2<a&&s<i+this.helperProportions.height/2&&r-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var e,n,i="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),r="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width);return!(!i||!r)&&(e=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection(),this.floating?"right"===n||"down"===e?2:1:e&&("down"===e?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),n=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),i=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"===r&&n||"left"===r&&!n:i&&("down"===i&&e||"up"===i&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){var n,i,r,o,a=[],s=[],l=this._connectWith();if(l&&e)for(n=l.length-1;n>=0;n--)for(i=(r=t(l[n],this.document[0])).length-1;i>=0;i--)(o=t.data(r[i],this.widgetFullName))&&o!==this&&!o.options.disabled&&s.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);function u(){a.push(this)}for(s.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=s.length-1;n>=0;n--)s[n][0].each(u);return t(a)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,(function(t){for(var n=0;n<e.length;n++)if(e[n]===t.item[0])return!1;return!0}))},_refreshItems:function(e){this.items=[],this.containers=[this];var n,i,r,o,a,s,l,u,c=this.items,h=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(n=d.length-1;n>=0;n--)for(i=(r=t(d[n],this.document[0])).length-1;i>=0;i--)(o=t.data(r[i],this.widgetFullName))&&o!==this&&!o.options.disabled&&(h.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(n=h.length-1;n>=0;n--)for(a=h[n][1],i=0,u=(s=h[n][0]).length;i<u;i++)(l=t(s[i])).data(this.widgetName+"-item",a),c.push({item:l,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){var n,i,r,o;for(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),n=this.items.length-1;n>=0;n--)(i=this.items[n]).instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(r=this.options.toleranceElement?t(this.options.toleranceElement,i.item):i.item,e||(i.width=r.outerWidth(),i.height=r.outerHeight()),o=r.offset(),i.left=o.left,i.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)o=this.containers[n].element.offset(),this.containers[n].containerCache.left=o.left,this.containers[n].containerCache.top=o.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(e){var n,i=(e=e||this).options;i.placeholder&&i.placeholder.constructor!==String||(n=i.placeholder,i.placeholder={element:function(){var i=e.currentItem[0].nodeName.toLowerCase(),r=t("<"+i+">",e.document[0]);return e._addClass(r,"ui-sortable-placeholder",n||e.currentItem[0].className)._removeClass(r,"ui-sortable-helper"),"tbody"===i?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(r)):"tr"===i?e._createTrPlaceholder(e.currentItem,r):"img"===i&&r.attr("src",e.currentItem.attr("src")),n||r.css("visibility","hidden"),r},update:function(t,r){n&&!i.forcePlaceholderSize||(r.height()||r.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(i.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),i.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,n){var i=this;e.children().each((function(){t("<td>&#160;</td>",i.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(n)}))},_contactContainers:function(e){var n,i,r,o,a,s,l,u,c,h,d=null,p=null;for(n=this.containers.length-1;n>=0;n--)if(!t.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(d&&t.contains(this.containers[n].element[0],d.element[0]))continue;d=this.containers[n],p=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",e,this._uiHash(this)),this.containers[n].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(r=1e4,o=null,a=(c=d.floating||this._isFloating(this.currentItem))?"left":"top",s=c?"width":"height",h=c?"pageX":"pageY",i=this.items.length-1;i>=0;i--)t.contains(this.containers[p].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(l=this.items[i].item.offset()[a],u=!1,e[h]-l>this.items[i][s]/2&&(u=!0),Math.abs(e[h]-l)<r&&(r=Math.abs(e[h]-l),o=this.items[i],this.direction=u?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var n=this.options,i=t.isFunction(n.helper)?t(n.helper.apply(this.element[0],[e,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||t("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),i[0].style.width&&!n.forceHelperSize||i.width(this.currentItem.width()),i[0].style.height&&!n.forceHelperSize||i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,n,i,r=this.options;"parent"===r.containment&&(r.containment=this.helper[0].parentNode),"document"!==r.containment&&"window"!==r.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===r.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===r.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(r.containment)||(e=t(r.containment)[0],n=t(r.containment).offset(),i="hidden"!==t(e).css("overflow"),this.containment=[n.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,n.left+(i?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(i?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,n){n||(n=this.position);var i="absolute"===e?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(r[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:r.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:r.scrollLeft())*i}},_generatePosition:function(e){var n,i,r=this.options,o=e.pageX,a=e.pageY,s="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(s[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),r.grid&&(n=this.originalPageY+Math.round((a-this.originalPageY)/r.grid[1])*r.grid[1],a=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-r.grid[1]:n+r.grid[1]:n,i=this.originalPageX+Math.round((o-this.originalPageX)/r.grid[0])*r.grid[0],o=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-r.grid[0]:i+r.grid[0]:i)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:s.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:s.scrollLeft())}},_rearrange:function(t,e,n,i){n?n[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay((function(){r===this.counter&&this.refreshPositions(!i)}))},_clear:function(t,e){this.reverting=!1;var n,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)"auto"!==this._storedCSS[n]&&"static"!==this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();function r(t,e,n){return function(i){n._trigger(t,i,e._uiHash(e))}}for(this.fromOutside&&!e&&i.push((function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))})),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||i.push((function(t){this._trigger("update",t,this._uiHash())})),this!==this.currentContainer&&(e||(i.push((function(t){this._trigger("remove",t,this._uiHash())})),i.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)e||i.push(r("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(i.push(r("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(n=0;n<i.length;n++)i[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===t.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var n=e||this;return{helper:n.helper,placeholder:n.placeholder||t([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:e?e.element:null}}}),t.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e=this._super(),n=this.element;return t.each(["min","max","step"],(function(t,i){var r=n.attr(i);null!=r&&r.length&&(e[i]=r)})),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){this.cancelBlur?delete this.cancelBlur:(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",t))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay((function(){this.spinning&&this._stop(t)}),100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){var n;function i(){this.element[0]===t.ui.safeActiveElement(this.document[0])||(this.element.trigger("focus"),this.previous=n,this._delay((function(){this.previous=n})))}n=this.element[0]===t.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay((function(){delete this.cancelBlur,i.call(this)})),!1!==this._start(e)&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){if(t(e.currentTarget).hasClass("ui-state-active"))return!1!==this._start(e)&&void this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(e){var n=this.options,i=t.ui.keyCode;switch(e.keyCode){case i.UP:return this._repeat(null,1,e),!0;case i.DOWN:return this._repeat(null,-1,e),!0;case i.PAGE_UP:return this._repeat(null,n.page,e),!0;case i.PAGE_DOWN:return this._repeat(null,-n.page,e),!0}return!1},_start:function(t){return!(!this.spinning&&!1===this._trigger("start",t)||(this.counter||(this.counter=1),this.spinning=!0,0))},_repeat:function(t,e,n){t=t||500,clearTimeout(this.timer),this.timer=this._delay((function(){this._repeat(40,e,n)}),t),this._spin(e*this.options.step,n)},_spin:function(t,e){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+t*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",e,{value:n})||(this._value(n),this.counter++)},_increment:function(e){var n=this.options.incremental;return n?t.isFunction(n)?n(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),n=e.indexOf(".");return-1===n?0:e.length-n-1},_adjustValue:function(t){var e,n,i=this.options;return n=t-(e=null!==i.min?i.min:0),t=e+(n=Math.round(n/i.step)*i.step),t=parseFloat(t.toFixed(this._precision())),null!==i.max&&t>i.max?i.max:null!==i.min&&t<i.min?i.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){var n,i,r;if("culture"===t||"numberFormat"===t)return n=this._parse(this.element.val()),this.options[t]=e,void this.element.val(this._format(n));"max"!==t&&"min"!==t&&"step"!==t||"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(i=this.buttons.first().find(".ui-icon"),this._removeClass(i,null,this.options.icons.up),this._addClass(i,null,e.up),r=this.buttons.last().find(".ui-icon"),this._removeClass(r,null,this.options.icons.down),this._addClass(r,null,e.down)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable")},_setOptions:y((function(t){this._super(t)})),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null!==t&&t===this._adjustValue(t)},_value:function(t,e){var n;""!==t&&null!==(n=this._parse(t))&&(e||(n=this._adjustValue(n)),t=this._format(n)),this.element.val(t),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:y((function(t){this._stepUp(t)})),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:y((function(t){this._stepDown(t)})),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:y((function(t){this._stepUp((t||1)*this.options.page)})),pageDown:y((function(t){this._stepDown((t||1)*this.options.page)})),value:function(t){if(!arguments.length)return this._parse(this.element.val());y(this._value).call(this,t)},widget:function(){return this.uiSpinner}}),!1!==t.uiBackCompat&&t.widget("ui.spinner",t.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),t.ui.spinner,t.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(g=/#.*$/,function(t){var e,n;e=t.href.replace(g,""),n=location.href.replace(g,"");try{e=decodeURIComponent(e)}catch(t){}try{n=decodeURIComponent(n)}catch(t){}return t.hash.length>1&&e===n}),_create:function(){var e=this,n=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,n.collapsible),this._processTabs(),n.active=this._initialActive(),t.isArray(n.disabled)&&(n.disabled=t.unique(n.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),(function(t){return e.tabs.index(t)})))).sort()),!1!==this.options.active&&this.anchors.length?this.active=this._findActive(n.active):this.active=t(),this._refresh(),this.active.length&&this.load(n.active)},_initialActive:function(){var e=this.options.active,n=this.options.collapsible,i=location.hash.substring(1);return null===e&&(i&&this.tabs.each((function(n,r){if(t(r).attr("aria-controls")===i)return e=n,!1})),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==e&&-1!==e||(e=!!this.tabs.length&&0)),!1!==e&&-1===(e=this.tabs.index(this.tabs.eq(e)))&&(e=!n&&0),!n&&!1===e&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var n=t(t.ui.safeActiveElement(this.document[0])).closest("li"),i=this.tabs.index(n),r=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:i++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:r=!1,i--;break;case t.ui.keyCode.END:i=this.anchors.length-1;break;case t.ui.keyCode.HOME:i=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(i);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(i!==this.options.active&&i);default:return}e.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,r),e.ctrlKey||e.metaKey||(n.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay((function(){this.option("active",i)}),this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,n){for(var i=this.tabs.length-1;-1!==t.inArray((e>i&&(e=0),e<0&&(e=i),e),this.options.disabled);)e=n?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).trigger("focus"),t},_setOption:function(t,e){"active"!==t?(this._super(t,e),"collapsible"===t&&(this._toggleClass("ui-tabs-collapsible",null,e),e||!1!==this.options.active||this._activate(0)),"event"===t&&this._setupEvents(e),"heightStyle"===t&&this._setupHeightStyle(e)):this._activate(e)},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,n=this.tablist.children(":has(a[href])");e.disabled=t.map(n.filter(".ui-state-disabled"),(function(t){return n.index(t)})),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this,n=this.tabs,i=this.anchors,r=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",(function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()})).on("focus"+this.eventNamespace,".ui-tabs-anchor",(function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()})),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map((function(){return t("a",this)[0]})).attr({role:"presentation",tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=t(),this.anchors.each((function(n,i){var r,o,a,s=t(i).uniqueId().attr("id"),l=t(i).closest("li"),u=l.attr("aria-controls");e._isLocal(i)?(a=(r=i.hash).substring(1),o=e.element.find(e._sanitizeSelector(r))):(r="#"+(a=l.attr("aria-controls")||t({}).uniqueId()[0].id),(o=e.element.find(r)).length||(o=e._createPanel(a)).insertAfter(e.panels[n-1]||e.tablist),o.attr("aria-live","polite")),o.length&&(e.panels=e.panels.add(o)),u&&l.data("ui-tabs-aria-controls",u),l.attr({"aria-controls":a,"aria-labelledby":s}),o.attr("aria-labelledby",s)})),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),n&&(this._off(n.not(this.tabs)),this._off(i.not(this.anchors)),this._off(r.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(e){var n,i,r;for(t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1),r=0;i=this.tabs[r];r++)n=t(i),!0===e||-1!==t.inArray(r,e)?(n.attr("aria-disabled","true"),this._addClass(n,null,"ui-state-disabled")):(n.removeAttr("aria-disabled"),this._removeClass(n,null,"ui-state-disabled"));this.options.disabled=e,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===e)},_setupEvents:function(e){var n={};e&&t.each(e.split(" "),(function(t,e){n[e]="_eventHandler"})),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var n,i=this.element.parent();"fill"===e?(n=i.height(),n-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each((function(){var e=t(this),i=e.css("position");"absolute"!==i&&"fixed"!==i&&(n-=e.outerHeight(!0))})),this.element.children().not(this.panels).each((function(){n-=t(this).outerHeight(!0)})),this.panels.each((function(){t(this).height(Math.max(0,n-t(this).innerHeight()+t(this).height()))})).css("overflow","auto")):"auto"===e&&(n=0,this.panels.each((function(){n=Math.max(n,t(this).height("").height())})).height(n))},_eventHandler:function(e){var n=this.options,i=this.active,r=t(e.currentTarget).closest("li"),o=r[0]===i[0],a=o&&n.collapsible,s=a?t():this._getPanelForTab(r),l=i.length?this._getPanelForTab(i):t(),u={oldTab:i,oldPanel:l,newTab:a?t():r,newPanel:s};e.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||o&&!n.collapsible||!1===this._trigger("beforeActivate",e,u)||(n.active=!a&&this.tabs.index(r),this.active=o?t():r,this.xhr&&this.xhr.abort(),l.length||s.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),s.length&&this.load(this.tabs.index(r),e),this._toggle(e,u))},_toggle:function(e,n){var i=this,r=n.newPanel,o=n.oldPanel;function a(){i.running=!1,i._trigger("activate",e,n)}function s(){i._addClass(n.newTab.closest("li"),"ui-tabs-active","ui-state-active"),r.length&&i.options.show?i._show(r,i.options.show,a):(r.show(),a())}this.running=!0,o.length&&this.options.hide?this._hide(o,this.options.hide,(function(){i._removeClass(n.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),s()})):(this._removeClass(n.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),o.hide(),s()),o.attr("aria-hidden","true"),n.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),r.length&&o.length?n.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter((function(){return 0===t(this).attr("tabIndex")})).attr("tabIndex",-1),r.attr("aria-hidden","false"),n.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var n,i=this._findActive(e);i[0]!==this.active[0]&&(i.length||(i=this.active),n=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:t.noop}))},_findActive:function(e){return!1===e?t():this.tabs.eq(e)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+t.ui.escapeSelector(e)+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each((function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")})),this.tabs.each((function(){var e=t(this),n=e.data("ui-tabs-aria-controls");n?e.attr("aria-controls",n).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")})),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var n=this.options.disabled;!1!==n&&(void 0===e?n=!1:(e=this._getIndex(e),n=t.isArray(n)?t.map(n,(function(t){return t!==e?t:null})):t.map(this.tabs,(function(t,n){return n!==e?n:null}))),this._setOptionDisabled(n))},disable:function(e){var n=this.options.disabled;if(!0!==n){if(void 0===e)n=!0;else{if(e=this._getIndex(e),-1!==t.inArray(e,n))return;n=t.isArray(n)?t.merge([e],n).sort():[e]}this._setOptionDisabled(n)}},load:function(e,n){e=this._getIndex(e);var i=this,r=this.tabs.eq(e),o=r.find(".ui-tabs-anchor"),a=this._getPanelForTab(r),s={tab:r,panel:a},l=function(t,e){"abort"===e&&i.panels.stop(!1,!0),i._removeClass(r,"ui-tabs-loading"),a.removeAttr("aria-busy"),t===i.xhr&&delete i.xhr};this._isLocal(o[0])||(this.xhr=t.ajax(this._ajaxSettings(o,n,s)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(r,"ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.done((function(t,e,r){setTimeout((function(){a.html(t),i._trigger("load",n,s),l(r,e)}),1)})).fail((function(t,e){setTimeout((function(){l(t,e)}),1)}))))},_ajaxSettings:function(e,n,i){var r=this;return{url:e.attr("href").replace(/#.*$/,""),beforeSend:function(e,o){return r._trigger("beforeLoad",n,t.extend({jqXHR:e,ajaxSettings:o},i))}}},_getPanelForTab:function(e){var n=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}}),!1!==t.uiBackCompat&&t.widget("ui.tabs",t.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),t.ui.tabs,t.widget("ui.tooltip",{version:"1.12.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(e,n){var i=(e.attr("aria-describedby")||"").split(/\s+/);i.push(n),e.data("ui-tooltip-id",n).attr("aria-describedby",t.trim(i.join(" ")))},_removeDescribedBy:function(e){var n=e.data("ui-tooltip-id"),i=(e.attr("aria-describedby")||"").split(/\s+/),r=t.inArray(n,i);-1!==r&&i.splice(r,1),e.removeData("ui-tooltip-id"),(i=t.trim(i.join(" ")))?e.attr("aria-describedby",i):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=t("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=t([])},_setOption:function(e,n){var i=this;this._super(e,n),"content"===e&&t.each(this.tooltips,(function(t,e){i._updateContent(e.element)}))},_setOptionDisabled:function(t){this[t?"_disable":"_enable"]()},_disable:function(){var e=this;t.each(this.tooltips,(function(n,i){var r=t.Event("blur");r.target=r.currentTarget=i.element[0],e.close(r,!0)})),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter((function(){var e=t(this);if(e.is("[title]"))return e.data("ui-tooltip-title",e.attr("title")).removeAttr("title")})))},_enable:function(){this.disabledTitles.each((function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})),this.disabledTitles=t([])},open:function(e){var n=this,i=t(e?e.target:this.element).closest(this.options.items);i.length&&!i.data("ui-tooltip-id")&&(i.attr("title")&&i.data("ui-tooltip-title",i.attr("title")),i.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&i.parents().each((function(){var e,i=t(this);i.data("ui-tooltip-open")&&((e=t.Event("blur")).target=e.currentTarget=this,n.close(e,!0)),i.attr("title")&&(i.uniqueId(),n.parents[this.id]={element:this,title:i.attr("title")},i.attr("title",""))})),this._registerCloseHandlers(e,i),this._updateContent(i,e))},_updateContent:function(t,e){var n,i=this.options.content,r=this,o=e?e.type:null;if("string"==typeof i||i.nodeType||i.jquery)return this._open(e,t,i);(n=i.call(t[0],(function(n){r._delay((function(){t.data("ui-tooltip-open")&&(e&&(e.type=o),this._open(e,t,n))}))})))&&this._open(e,t,n)},_open:function(e,n,i){var r,o,a,s,l=t.extend({},this.options.position);function u(t){l.of=t,o.is(":hidden")||o.position(l)}i&&((r=this._find(n))?r.tooltip.find(".ui-tooltip-content").html(i):(n.is("[title]")&&(e&&"mouseover"===e.type?n.attr("title",""):n.removeAttr("title")),r=this._tooltip(n),o=r.tooltip,this._addDescribedBy(n,o.attr("id")),o.find(".ui-tooltip-content").html(i),this.liveRegion.children().hide(),(s=t("<div>").html(o.find(".ui-tooltip-content").html())).removeAttr("name").find("[name]").removeAttr("name"),s.removeAttr("id").find("[id]").removeAttr("id"),s.appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:u}),u(e)):o.position(t.extend({of:n},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(a=this.delayedShow=setInterval((function(){o.is(":visible")&&(u(l.of),clearInterval(a))}),t.fx.interval)),this._trigger("open",e,{tooltip:o})))},_registerCloseHandlers:function(e,n){var i={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var i=t.Event(e);i.currentTarget=n[0],this.close(i,!0)}}};n[0]!==this.element[0]&&(i.remove=function(){this._removeTooltip(this._find(n).tooltip)}),e&&"mouseover"!==e.type||(i.mouseleave="close"),e&&"focusin"!==e.type||(i.focusout="close"),this._on(!0,n,i)},close:function(e){var n,i=this,r=t(e?e.currentTarget:this.element),o=this._find(r);o?(n=o.tooltip,o.closing||(clearInterval(this.delayedShow),r.data("ui-tooltip-title")&&!r.attr("title")&&r.attr("title",r.data("ui-tooltip-title")),this._removeDescribedBy(r),o.hiding=!0,n.stop(!0),this._hide(n,this.options.hide,(function(){i._removeTooltip(t(this))})),r.removeData("ui-tooltip-open"),this._off(r,"mouseleave focusout keyup"),r[0]!==this.element[0]&&this._off(r,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,(function(e,n){t(n.element).attr("title",n.title),delete i.parents[e]})),o.closing=!0,this._trigger("close",e,{tooltip:n}),o.hiding||(o.closing=!1))):r.removeData("ui-tooltip-open")},_tooltip:function(e){var n=t("<div>").attr("role","tooltip"),i=t("<div>").appendTo(n),r=n.uniqueId().attr("id");return this._addClass(i,"ui-tooltip-content"),this._addClass(n,"ui-tooltip","ui-widget ui-widget-content"),n.appendTo(this._appendTo(e)),this.tooltips[r]={element:e,tooltip:n}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_appendTo:function(t){var e=t.closest(".ui-front, dialog");return e.length||(e=this.document[0].body),e},_destroy:function(){var e=this;t.each(this.tooltips,(function(n,i){var r=t.Event("blur"),o=i.element;r.target=r.currentTarget=o[0],e.close(r,!0),t("#"+n).remove(),o.data("ui-tooltip-title")&&(o.attr("title")||o.attr("title",o.data("ui-tooltip-title")),o.removeData("ui-tooltip-title"))})),this.liveRegion.remove()}}),!1!==t.uiBackCompat&&t.widget("ui.tooltip",t.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var t=this._superApply(arguments);return this.options.tooltipClass&&t.tooltip.addClass(this.options.tooltipClass),t}}),t.ui.tooltip})?i.apply(e,r):i)||(t.exports=o)},192:function(t,e){!function(t){if(t.support.touch="ontouchend"in document,t.support.touch){var e,n=t.ui.mouse.prototype,i=n._mouseInit,r=n._mouseDestroy;n._touchStart=function(t){!e&&this._mouseCapture(t.originalEvent.changedTouches[0])&&(e=!0,this._touchMoved=!1,o(t,"mouseover"),o(t,"mousemove"),o(t,"mousedown"))},n._touchMove=function(t){e&&(this._touchMoved=!0,o(t,"mousemove"))},n._touchEnd=function(t){e&&(o(t,"mouseup"),o(t,"mouseout"),this._touchMoved||o(t,"click"),e=!1)},n._mouseInit=function(){this.element.bind({touchstart:t.proxy(this,"_touchStart"),touchmove:t.proxy(this,"_touchMove"),touchend:t.proxy(this,"_touchEnd")}),i.call(this)},n._mouseDestroy=function(){this.element.unbind({touchstart:t.proxy(this,"_touchStart"),touchmove:t.proxy(this,"_touchMove"),touchend:t.proxy(this,"_touchEnd")}),r.call(this)}}function o(t,e){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var n=t.originalEvent.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(e,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(i)}}}(jQuery)},193:function(t,e){!function(t,e){if(t.support.htmlMenuitem="HTMLMenuItemElement"in window,t.support.htmlCommand="HTMLCommandElement"in window,t.support.eventSelectstart="onselectstart"in document.documentElement,!t.ui||!t.ui.widget){var n=t.cleanData;t.cleanData=function(e){for(var i,r=0;null!=(i=e[r]);r++)try{t(i).triggerHandler("remove")}catch(t){}n(e)}}var i=null,r=!1,o=t(window),a=0,s={},l={},u={},c={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(e){if(t.ui&&t.ui.position)e.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var n=this.offset();n.top+=this.outerHeight(),n.left+=this.outerWidth()/2-e.outerWidth()/2,e.css(n)}},position:function(t,e,n){var i;if(e||n){i="maintain"===e&&"maintain"===n?t.$menu.position():{top:n,left:e};var r=o.scrollTop()+o.height(),a=o.scrollLeft()+o.width(),s=t.$menu.height(),l=t.$menu.width();i.top+s>r&&(i.top-=s),i.top<0&&(i.top=0),i.left+l>a&&(i.left-=l),t.$menu.css(i)}else t.determinePosition.call(this,t.$menu)},positionSubmenu:function(e){if(t.ui&&t.ui.position)e.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var n={top:0,left:this.outerWidth()};e.css(n)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:t.noop,hide:t.noop},callback:null,items:{}},h={timer:null,pageX:null,pageY:null},d={abortevent:function(t){t.preventDefault(),t.stopImmediatePropagation()},contextmenu:function(e){var n=t(this);if("right"==e.data.trigger&&(e.preventDefault(),e.stopImmediatePropagation()),!("right"!=e.data.trigger&&e.originalEvent||n.hasClass("context-menu-active")||n.hasClass("context-menu-disabled"))){if(i=n,e.data.build){var r=e.data.build(i,e);if(!1===r)return;if(e.data=t.extend(!0,{},c,e.data,r||{}),!e.data.items||t.isEmptyObject(e.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");e.data.$trigger=i,p.create(e.data)}p.show.call(n,e.data,e.pageX,e.pageY)}},click:function(e){e.preventDefault(),e.stopImmediatePropagation(),t(this).trigger(t.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))},mousedown:function(e){var n=t(this);i&&i.length&&!i.is(n)&&i.data("contextMenu").$menu.trigger("contextmenu:hide"),2==e.button&&(i=n.data("contextMenuActive",!0))},mouseup:function(e){var n=t(this);n.data("contextMenuActive")&&i&&i.length&&i.is(n)&&!n.hasClass("context-menu-disabled")&&(e.preventDefault(),e.stopImmediatePropagation(),i=n,n.trigger(t.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))),n.removeData("contextMenuActive")},mouseenter:function(e){var n=t(this),r=t(e.relatedTarget),o=t(document);r.is(".context-menu-list")||r.closest(".context-menu-list").length||i&&i.length||(h.pageX=e.pageX,h.pageY=e.pageY,h.data=e.data,o.on("mousemove.contextMenuShow",d.mousemove),h.timer=setTimeout((function(){h.timer=null,o.off("mousemove.contextMenuShow"),i=n,n.trigger(t.Event("contextmenu",{data:h.data,pageX:h.pageX,pageY:h.pageY}))}),e.data.delay))},mousemove:function(t){h.pageX=t.pageX,h.pageY=t.pageY},mouseleave:function(e){var n=t(e.relatedTarget);if(!n.is(".context-menu-list")&&!n.closest(".context-menu-list").length){try{clearTimeout(h.timer)}catch(e){}h.timer=null}},layerClick:function(e){var n,i,r=t(this).data("contextMenuRoot"),a=e.button,s=e.pageX,l=e.pageY;e.preventDefault(),e.stopImmediatePropagation(),setTimeout((function(){var u,c="left"==r.trigger&&0===a||"right"==r.trigger&&2===a;if(document.elementFromPoint&&(r.$layer.hide(),n=document.elementFromPoint(s-o.scrollLeft(),l-o.scrollTop()),r.$layer.show()),r.reposition&&c)if(document.elementFromPoint){if(r.$trigger.is(n)||r.$trigger.has(n).length)return void r.position.call(r.$trigger,r,s,l)}else if(i=r.$trigger.offset(),u=t(window),i.top+=u.scrollTop(),i.top<=e.pageY&&(i.left+=u.scrollLeft(),i.left<=e.pageX&&(i.bottom=i.top+r.$trigger.outerHeight(),i.bottom>=e.pageY&&(i.right=i.left+r.$trigger.outerWidth(),i.right>=e.pageX))))return void r.position.call(r.$trigger,r,s,l);n&&c&&r.$trigger.one("contextmenu:hidden",(function(){t(n).contextMenu({x:s,y:l})})),r.$menu.trigger("contextmenu:hide")}),50)},keyStop:function(t,e){e.isInput||t.preventDefault(),t.stopPropagation()},key:function(t){var e={};switch(i&&(e=i.data("contextMenu")||{}),t.keyCode){case 9:case 38:if(d.keyStop(t,e),e.isInput){if(9==t.keyCode&&t.shiftKey)return t.preventDefault(),e.$selected&&e.$selected.find("input, textarea, select").blur(),void e.$menu.trigger("prevcommand");if(38==t.keyCode&&"checkbox"==e.$selected.find("input, textarea, select").prop("type"))return void t.preventDefault()}else if(9!=t.keyCode||t.shiftKey)return void e.$menu.trigger("prevcommand");case 40:if(d.keyStop(t,e),!e.isInput)return void e.$menu.trigger("nextcommand");if(9==t.keyCode)return t.preventDefault(),e.$selected&&e.$selected.find("input, textarea, select").blur(),void e.$menu.trigger("nextcommand");if(40==t.keyCode&&"checkbox"==e.$selected.find("input, textarea, select").prop("type"))return void t.preventDefault();break;case 37:if(d.keyStop(t,e),e.isInput||!e.$selected||!e.$selected.length)break;if(!e.$selected.parent().hasClass("context-menu-root")){var n=e.$selected.parent().parent();return e.$selected.trigger("contextmenu:blur"),void(e.$selected=n)}break;case 39:if(d.keyStop(t,e),e.isInput||!e.$selected||!e.$selected.length)break;var r=e.$selected.data("contextMenu")||{};if(r.$menu&&e.$selected.hasClass("context-menu-submenu"))return e.$selected=null,r.$selected=null,void r.$menu.trigger("nextcommand");break;case 35:case 36:return e.$selected&&e.$selected.find("input, textarea, select").length?void 0:((e.$selected&&e.$selected.parent()||e.$menu).children(":not(.disabled, .not-selectable)")[36==t.keyCode?"first":"last"]().trigger("contextmenu:focus"),void t.preventDefault());case 13:if(d.keyStop(t,e),e.isInput){if(e.$selected&&!e.$selected.is("textarea, select"))return void t.preventDefault();break}return void(e.$selected&&e.$selected.trigger("mouseup"));case 32:case 33:case 34:return void d.keyStop(t,e);case 27:return d.keyStop(t,e),void e.$menu.trigger("contextmenu:hide");default:var o=String.fromCharCode(t.keyCode).toUpperCase();if(e.accesskeys&&e.accesskeys[o])return void e.accesskeys[o].$node.trigger(e.accesskeys[o].$menu?"contextmenu:focus":"mouseup")}t.stopPropagation(),e.$selected&&e.$selected.trigger(t)},prevItem:function(e){e.stopPropagation();var n=t(this).data("contextMenu")||{};if(n.$selected){var i=n.$selected;(n=n.$selected.parent().data("contextMenu")||{}).$selected=i}for(var r=n.$menu.children(),o=n.$selected&&n.$selected.prev().length?n.$selected.prev():r.last(),a=o;o.hasClass("disabled")||o.hasClass("not-selectable");)if((o=o.prev().length?o.prev():r.last()).is(a))return;n.$selected&&d.itemMouseleave.call(n.$selected.get(0),e),d.itemMouseenter.call(o.get(0),e);var s=o.find("input, textarea, select");s.length&&s.focus()},nextItem:function(e){e.stopPropagation();var n=t(this).data("contextMenu")||{};if(n.$selected){var i=n.$selected;(n=n.$selected.parent().data("contextMenu")||{}).$selected=i}for(var r=n.$menu.children(),o=n.$selected&&n.$selected.next().length?n.$selected.next():r.first(),a=o;o.hasClass("disabled")||o.hasClass("not-selectable");)if((o=o.next().length?o.next():r.first()).is(a))return;n.$selected&&d.itemMouseleave.call(n.$selected.get(0),e),d.itemMouseenter.call(o.get(0),e);var s=o.find("input, textarea, select");s.length&&s.focus()},focusInput:function(e){var n=t(this).closest(".context-menu-item"),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;o.$selected=r.$selected=n,o.isInput=r.isInput=!0},blurInput:function(e){var n=t(this).closest(".context-menu-item").data(),i=n.contextMenu;n.contextMenuRoot.isInput=i.isInput=!1},menuMouseenter:function(e){t(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(e){var n=t(this).data().contextMenuRoot;n.$layer&&n.$layer.is(e.relatedTarget)&&(n.hovering=!1)},itemMouseenter:function(e){var n=t(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;o.hovering=!0,e&&o.$layer&&o.$layer.is(e.relatedTarget)&&(e.preventDefault(),e.stopImmediatePropagation()),(r.$menu?r:o).$menu.children(".hover").trigger("contextmenu:blur"),n.hasClass("disabled")||n.hasClass("not-selectable")?r.$selected=null:n.trigger("contextmenu:focus")},itemMouseleave:function(e){var n=t(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;if(o!==r&&o.$layer&&o.$layer.is(e.relatedTarget))return o.$selected&&o.$selected.trigger("contextmenu:blur"),e.preventDefault(),e.stopImmediatePropagation(),void(o.$selected=r.$selected=r.$node);n.trigger("contextmenu:blur")},itemClick:function(e){var n,i=t(this),r=i.data(),o=r.contextMenu,a=r.contextMenuRoot,s=r.contextMenuKey;if(o.items[s]&&!i.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){if(e.preventDefault(),e.stopImmediatePropagation(),t.isFunction(a.callbacks[s])&&Object.prototype.hasOwnProperty.call(a.callbacks,s))n=a.callbacks[s];else{if(!t.isFunction(a.callback))return;n=a.callback}!1!==n.call(a.$trigger,s,a)?a.$menu.trigger("contextmenu:hide"):a.$menu.parent().length&&p.update.call(a.$trigger,a)}},inputClick:function(t){t.stopImmediatePropagation()},hideMenu:function(e,n){var i=t(this).data("contextMenuRoot");p.hide.call(i.$trigger,i,n&&n.force)},focusItem:function(e){e.stopPropagation();var n=t(this),i=n.data(),r=i.contextMenu,o=i.contextMenuRoot;n.addClass("hover").siblings(".hover").trigger("contextmenu:blur"),r.$selected=o.$selected=n,r.$node&&o.positionSubmenu.call(r.$node,r.$menu)},blurItem:function(e){e.stopPropagation();var n=t(this),i=n.data().contextMenu;n.removeClass("hover"),i.$selected=null}},p={show:function(e,n,r){var o=t(this),a={};t("#context-menu-layer").trigger("mousedown"),e.$trigger=o,!1!==e.events.show.call(o,e)?(p.update.call(o,e),e.position.call(o,e,n,r),e.zIndex&&(a.zIndex=function(t){for(var e=0,n=t;e=Math.max(e,parseInt(n.css("z-index"),10)||0),(n=n.parent())&&n.length&&!("html body".indexOf(n.prop("nodeName").toLowerCase())>-1););return e}(o)+e.zIndex),p.layer.call(e.$menu,e,a.zIndex),e.$menu.find("ul").css("zIndex",a.zIndex+1),e.$menu.css(a)[e.animation.show](e.animation.duration,(function(){o.trigger("contextmenu:visible")})),o.data("contextMenu",e).addClass("context-menu-active"),t(document).off("keydown.contextMenu").on("keydown.contextMenu",d.key),e.autoHide&&t(document).on("mousemove.contextMenuAutoHide",(function(t){var n=o.offset();n.right=n.left+o.outerWidth(),n.bottom=n.top+o.outerHeight(),!e.$layer||e.hovering||t.pageX>=n.left&&t.pageX<=n.right&&t.pageY>=n.top&&t.pageY<=n.bottom||e.$menu.trigger("contextmenu:hide")}))):i=null},hide:function(e,n){var r=t(this);if(e||(e=r.data("contextMenu")||{}),n||!e.events||!1!==e.events.hide.call(r,e)){if(r.removeData("contextMenu").removeClass("context-menu-active"),e.$layer){setTimeout((o=e.$layer,function(){o.remove()}),10);try{delete e.$layer}catch(t){e.$layer=null}}var o;i=null,e.$menu.find(".hover").trigger("contextmenu:blur"),e.$selected=null,t(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),e.$menu&&e.$menu[e.animation.hide](e.animation.duration,(function(){e.build&&(e.$menu.remove(),t.each(e,(function(t,n){switch(t){case"ns":case"selector":case"build":case"trigger":return!0;default:e[t]=void 0;try{delete e[t]}catch(t){}return!0}}))),setTimeout((function(){r.trigger("contextmenu:hidden")}),10)}))}},create:function(e,n){void 0===n&&(n=e),e.$menu=t('<ul class="context-menu-list"></ul>').addClass(e.className||"").data({contextMenu:e,contextMenuRoot:n}),t.each(["callbacks","commands","inputs"],(function(t,i){e[i]={},n[i]||(n[i]={})})),n.accesskeys||(n.accesskeys={}),t.each(e.items,(function(i,r){var o=t('<li class="context-menu-item"></li>').addClass(r.className||""),a=null,s=null;if(o.on("click",t.noop),r.$node=o.data({contextMenu:e,contextMenuRoot:n,contextMenuKey:i}),r.accesskey)for(var l,c=function(t){for(var e,n=t.split(/\s+/),i=[],r=0;e=n[r];r++)e=e.charAt(0).toUpperCase(),i.push(e);return i}(r.accesskey),h=0;l=c[h];h++)if(!n.accesskeys[l]){n.accesskeys[l]=r,r._name=r.name.replace(new RegExp("("+l+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if("string"==typeof r)o.addClass("context-menu-separator not-selectable");else if(r.type&&u[r.type])u[r.type].call(o,r,e,n),t.each([e,n],(function(e,n){n.commands[i]=r,t.isFunction(r.callback)&&(n.callbacks[i]=r.callback)}));else{switch("html"==r.type?o.addClass("context-menu-html not-selectable"):r.type?(a=t("<label></label>").appendTo(o),t("<span></span>").text(r._name||r.name).appendTo(a),o.addClass("context-menu-input"),e.hasTypes=!0,t.each([e,n],(function(t,e){e.commands[i]=r,e.inputs[i]=r}))):r.items&&(r.type="sub"),r.type){case"text":s=t('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+i).val(r.value||"").appendTo(a);break;case"textarea":s=t('<textarea name=""></textarea>').attr("name","context-menu-input-"+i).val(r.value||"").appendTo(a),r.height&&s.height(r.height);break;case"checkbox":s=t('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+i).val(r.value||"").prop("checked",!!r.selected).prependTo(a);break;case"radio":s=t('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+r.radio).val(r.value||"").prop("checked",!!r.selected).prependTo(a);break;case"select":s=t('<select name="">').attr("name","context-menu-input-"+i).appendTo(a),r.options&&(t.each(r.options,(function(e,n){t("<option></option>").val(e).text(n).appendTo(s)})),s.val(r.selected));break;case"sub":t("<span></span>").text(r._name||r.name).appendTo(o),r.appendTo=r.$node,p.create(r,n),o.data("contextMenu",r).addClass("context-menu-submenu"),r.callback=null;break;case"html":t(r.html).appendTo(o);break;default:t.each([e,n],(function(e,n){n.commands[i]=r,t.isFunction(r.callback)&&(n.callbacks[i]=r.callback)})),t("<span></span>").text(r._name||r.name||"").appendTo(o)}r.type&&"sub"!=r.type&&"html"!=r.type&&(s.on("focus",d.focusInput).on("blur",d.blurInput),r.events&&s.on(r.events,e)),r.icon&&o.addClass("icon icon-"+r.icon)}r.$input=s,r.$label=a,o.appendTo(e.$menu),!e.hasTypes&&t.support.eventSelectstart&&o.on("selectstart.disableTextSelect",d.abortevent)})),e.$node||e.$menu.css("display","none").addClass("context-menu-root"),e.$menu.appendTo(e.appendTo||document.body)},resize:function(e,n){e.css({position:"absolute",display:"block"}),e.data("width",Math.ceil(e.width())+1),e.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),e.find("> li > ul").each((function(){p.resize(t(this),!0)})),n||e.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).width((function(){return t(this).data("width")}))},update:function(e,n){var i=this;void 0===n&&(n=e,p.resize(e.$menu)),e.$menu.children().each((function(){var r=t(this),o=r.data("contextMenuKey"),a=e.items[o],s=t.isFunction(a.disabled)&&a.disabled.call(i,o,n)||!0===a.disabled;if(r[s?"addClass":"removeClass"]("disabled"),a.type)switch(r.find("input, select, textarea").prop("disabled",s),a.type){case"text":case"textarea":a.$input.val(a.value||"");break;case"checkbox":case"radio":a.$input.val(a.value||"").prop("checked",!!a.selected);break;case"select":a.$input.val(a.selected||"")}a.$menu&&p.update.call(i,a,n)}))},layer:function(e,n){var i=e.$layer=t('<div id="context-menu-layer" style="position:fixed; z-index:'+n+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:o.height(),width:o.width(),display:"block"}).data("contextMenuRoot",e).insertBefore(this).on("contextmenu",d.abortevent).on("mousedown",d.layerClick);return void 0===document.body.style.maxWidth&&i.css({position:"absolute",height:t(document).height()}),i}};function f(e){return e.id&&t('label[for="'+e.id+'"]').val()||e.name}t.fn.contextMenu=function(e){if(void 0===e)this.first().trigger("contextmenu");else if(e.x&&e.y)this.first().trigger(t.Event("contextmenu",{pageX:e.x,pageY:e.y}));else if("hide"===e){var n=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;n&&n.trigger("contextmenu:hide")}else"destroy"===e?t.contextMenu("destroy",{context:this}):t.isPlainObject(e)?(e.context=this,t.contextMenu("create",e)):e?this.removeClass("context-menu-disabled"):e||this.addClass("context-menu-disabled");return this},t.contextMenu=function(e,n){"string"!=typeof e&&(n=e,e="create"),"string"==typeof n?n={selector:n}:void 0===n&&(n={});var i=t.extend(!0,{},c,n||{}),o=t(document),u=o,h=!1;switch(i.context&&i.context.length?(u=t(i.context).first(),i.context=u.get(0),h=i.context!==document):i.context=document,e){case"create":if(!i.selector)throw new Error("No selector specified");if(i.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+i.selector+'" as it contains a reserved className');if(!i.build&&(!i.items||t.isEmptyObject(i.items)))throw new Error("No Items specified");switch(a++,i.ns=".contextMenu"+a,h||(s[i.selector]=i.ns),l[i.ns]=i,i.trigger||(i.trigger="right"),r||(o.on({"contextmenu:hide.contextMenu":d.hideMenu,"prevcommand.contextMenu":d.prevItem,"nextcommand.contextMenu":d.nextItem,"contextmenu.contextMenu":d.abortevent,"mouseenter.contextMenu":d.menuMouseenter,"mouseleave.contextMenu":d.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",d.inputClick).on({"mouseup.contextMenu":d.itemClick,"contextmenu:focus.contextMenu":d.focusItem,"contextmenu:blur.contextMenu":d.blurItem,"contextmenu.contextMenu":d.abortevent,"mouseenter.contextMenu":d.itemMouseenter,"mouseleave.contextMenu":d.itemMouseleave},".context-menu-item"),r=!0),u.on("contextmenu"+i.ns,i.selector,i,d.contextmenu),h&&u.on("remove"+i.ns,(function(){t(this).contextMenu("destroy")})),i.trigger){case"hover":u.on("mouseenter"+i.ns,i.selector,i,d.mouseenter).on("mouseleave"+i.ns,i.selector,i,d.mouseleave);break;case"left":u.on("click"+i.ns,i.selector,i,d.click)}i.build||p.create(i);break;case"destroy":var f;if(h){var m=i.context;t.each(l,(function(e,n){if(n.context!==m)return!0;(f=t(".context-menu-list").filter(":visible")).length&&f.data().contextMenuRoot.$trigger.is(t(n.context).find(n.selector))&&f.trigger("contextmenu:hide",{force:!0});try{l[n.ns].$menu&&l[n.ns].$menu.remove(),delete l[n.ns]}catch(t){l[n.ns]=null}return t(n.context).off(n.ns),!0}))}else if(i.selector){if(s[i.selector]){(f=t(".context-menu-list").filter(":visible")).length&&f.data().contextMenuRoot.$trigger.is(i.selector)&&f.trigger("contextmenu:hide",{force:!0});try{l[s[i.selector]].$menu&&l[s[i.selector]].$menu.remove(),delete l[s[i.selector]]}catch(t){l[s[i.selector]]=null}o.off(s[i.selector])}}else o.off(".contextMenu .contextMenuAutoHide"),t.each(l,(function(e,n){t(n.context).off(n.ns)})),s={},l={},a=0,r=!1,t("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!t.support.htmlCommand&&!t.support.htmlMenuitem||"boolean"==typeof n&&n)&&t('menu[type="context"]').each((function(){this.id&&t.contextMenu({selector:"[contextmenu="+this.id+"]",items:t.contextMenu.fromMenu(this)})})).css("display","none");break;default:throw new Error('Unknown operation "'+e+'"')}return this},t.contextMenu.setInputValues=function(e,n){void 0===n&&(n={}),t.each(e.inputs,(function(t,e){switch(e.type){case"text":case"textarea":e.value=n[t]||"";break;case"checkbox":e.selected=!!n[t];break;case"radio":e.selected=(n[e.radio]||"")==e.value;break;case"select":e.selected=n[t]||""}}))},t.contextMenu.getInputValues=function(e,n){return void 0===n&&(n={}),t.each(e.inputs,(function(t,e){switch(e.type){case"text":case"textarea":case"select":n[t]=e.$input.val();break;case"checkbox":n[t]=e.$input.prop("checked");break;case"radio":e.$input.prop("checked")&&(n[e.radio]=e.value)}})),n},t.contextMenu.fromMenu=function(e){var n={};return function e(n,i,r){return r||(r=0),i.each((function(){var i,o,a=t(this),s=this,l=this.nodeName.toLowerCase();switch("label"==l&&a.find("input, textarea, select").length&&(i=a.text(),l=(s=(a=a.children().first()).get(0)).nodeName.toLowerCase()),l){case"menu":o={name:a.attr("label"),items:{}},r=e(o.items,a.children(),r);break;case"a":case"button":o={name:a.text(),disabled:!!a.attr("disabled"),callback:function(){a.click()}};break;case"menuitem":case"command":switch(a.attr("type")){case void 0:case"command":case"menuitem":o={name:a.attr("label"),disabled:!!a.attr("disabled"),callback:function(){a.click()}};break;case"checkbox":o={type:"checkbox",disabled:!!a.attr("disabled"),name:a.attr("label"),selected:!!a.attr("checked")};break;case"radio":o={type:"radio",disabled:!!a.attr("disabled"),name:a.attr("label"),radio:a.attr("radiogroup"),value:a.attr("id"),selected:!!a.attr("checked")};break;default:o=void 0}break;case"hr":o="-------";break;case"input":switch(a.attr("type")){case"text":o={type:"text",name:i||f(s),disabled:!!a.attr("disabled"),value:a.val()};break;case"checkbox":o={type:"checkbox",name:i||f(s),disabled:!!a.attr("disabled"),selected:!!a.attr("checked")};break;case"radio":o={type:"radio",name:i||f(s),disabled:!!a.attr("disabled"),radio:!!a.attr("name"),value:a.val(),selected:!!a.attr("checked")};break;default:o=void 0}break;case"select":o={type:"select",name:i||f(s),disabled:!!a.attr("disabled"),selected:a.val(),options:{}},a.children().each((function(){o.options[this.value]=t(this).text()}));break;case"textarea":o={type:"textarea",name:i||f(s),disabled:!!a.attr("disabled"),value:a.val()};break;case"label":break;default:o={type:"html",html:a.clone(!0)}}o&&(r++,n["key"+r]=o)})),r}(n,t(e).children()),n},t.contextMenu.defaults=c,t.contextMenu.types=u,t.contextMenu.handle=d,t.contextMenu.op=p,t.contextMenu.menus=l}(jQuery)},194:function(t,e){!function(t){"use strict";!function(t,e,n,i){t.widget("selectBox.selectBoxIt",{VERSION:"3.8.1",options:{showEffect:"none",showEffectOptions:{},showEffectSpeed:"medium",hideEffect:"none",hideEffectOptions:{},hideEffectSpeed:"medium",showFirstOption:!0,defaultText:"",defaultIcon:"",downArrowIcon:"",theme:"default",keydownOpen:!0,isMobile:function(){var t=navigator.userAgent||navigator.vendor||e.opera;return/iPhone|iPod|iPad|Silk|Android|BlackBerry|Opera Mini|IEMobile/.test(t)},native:!1,aggressiveChange:!1,selectWhenHidden:!0,viewport:t(e),similarSearch:!1,copyAttributes:["title","rel"],copyClasses:"button",nativeMousedown:!1,customShowHideEvent:!1,autoWidth:!0,html:!0,populate:"",dynamicPositioning:!0,hideCurrent:!1},getThemes:function(){var e=t(this.element).attr("data-theme")||"c";return{bootstrap:{focus:"active",hover:"",enabled:"enabled",disabled:"disabled",arrow:"caret",button:"btn",list:"dropdown-menu",container:"bootstrap",open:"open"},jqueryui:{focus:"ui-state-focus",hover:"ui-state-hover",enabled:"ui-state-enabled",disabled:"ui-state-disabled",arrow:"ui-icon ui-icon-triangle-1-s",button:"ui-widget ui-state-default",list:"ui-widget ui-widget-content",container:"jqueryui",open:"selectboxit-open"},jquerymobile:{focus:"ui-btn-down-"+e,hover:"ui-btn-hover-"+e,enabled:"ui-enabled",disabled:"ui-disabled",arrow:"ui-icon ui-icon-arrow-d ui-icon-shadow",button:"ui-btn ui-btn-icon-right ui-btn-corner-all ui-shadow ui-btn-up-"+e,list:"ui-btn ui-btn-icon-right ui-btn-corner-all ui-shadow ui-btn-up-"+e,container:"jquerymobile",open:"selectboxit-open"},default:{focus:"selectboxit-focus",hover:"selectboxit-hover",enabled:"selectboxit-enabled",disabled:"selectboxit-disabled",arrow:"selectboxit-default-arrow",button:"selectboxit-btn",list:"selectboxit-list",container:"selectboxit-container",open:"selectboxit-open"}}},isDeferred:function(e){return t.isPlainObject(e)&&e.promise&&e.done},_create:function(e){var i=this.options.populate,r=this.options.theme;if(this.element.is("select"))return this.widgetProto=t.Widget.prototype,this.originalElem=this.element[0],this.selectBox=this.element,this.options.populate&&this.add&&!e&&this.add(i),this.selectItems=this.element.find("option"),this.firstSelectItem=this.selectItems.slice(0,1),this.documentHeight=t(n).height(),this.theme=t.isPlainObject(r)?t.extend({},this.getThemes().default,r):this.getThemes()[r]?this.getThemes()[r]:this.getThemes().default,this.currentFocus=0,this.blur=!0,this.textArray=[],this.currentIndex=0,this.currentText="",this.flipped=!1,e||(this.selectBoxStyles=this.selectBox.attr("style")),this._createDropdownButton()._createUnorderedList()._copyAttributes()._replaceSelectBox()._addClasses(this.theme)._eventHandlers(),this.originalElem.disabled&&this.disable&&this.disable(),this._ariaAccessibility&&this._ariaAccessibility(),this.isMobile=this.options.isMobile(),this._mobile&&this._mobile(),this.options.native&&this._applyNativeSelect(),this.triggerEvent("create"),this},_createDropdownButton:function(){var e=this.originalElemId=this.originalElem.id||"",n=this.originalElemValue=this.originalElem.value||"",i=this.originalElemName=this.originalElem.name||"",r=this.options.copyClasses,o=this.selectBox.attr("class")||"";return this.dropdownText=t("<span/>",{id:e&&e+"SelectBoxItText",class:"selectboxit-text",unselectable:"on",text:this.firstSelectItem.text()}).attr("data-val",n),this.dropdownImageContainer=t("<span/>",{class:"selectboxit-option-icon-container"}),this.dropdownImage=t("<i/>",{id:e&&e+"SelectBoxItDefaultIcon",class:"selectboxit-default-icon",unselectable:"on"}),this.dropdown=t("<span/>",{id:e&&e+"SelectBoxIt",class:"selectboxit "+("button"===r?o:"")+" "+(this.selectBox.prop("disabled")?this.theme.disabled:this.theme.enabled),name:i,tabindex:this.selectBox.attr("tabindex")||"0",unselectable:"on"}).append(this.dropdownImageContainer.append(this.dropdownImage)).append(this.dropdownText),this.dropdownContainer=t("<span/>",{id:e&&e+"SelectBoxItContainer",class:"selectboxit-container "+this.theme.container+" "+("container"===r?o:"")}).append(this.dropdown),this},_createUnorderedList:function(){var e,n,i,r,o,a,s,l,u,c,h,d,p,f=this,m="",g=f.originalElemId||"",v=t("<ul/>",{id:g&&g+"SelectBoxItOptions",class:"selectboxit-options",tabindex:-1});if(f.options.showFirstOption||(f.selectItems.first().attr("disabled","disabled"),f.selectItems=f.selectBox.find("option").slice(1)),f.selectItems.each((function(g){d=t(this),n="",i="",e=d.prop("disabled"),r=d.attr("data-icon")||"",o=d.attr("data-iconurl")||"",a=o?"selectboxit-option-icon-url":"",s=o?"style=\"background-image:url('"+o+"');\"":"",l=d.attr("data-selectedtext"),u=d.attr("data-text"),h=u||d.text(),(p=d.parent()).is("optgroup")&&(n="selectboxit-optgroup-option",0===d.index()&&(i='<span class="selectboxit-optgroup-header '+p.first().attr("class")+'"data-disabled="true">'+p.first().attr("label")+"</span>")),d.attr("value",this.value),m+=i+'<li data-id="'+g+'" data-val="'+this.value+'" data-disabled="'+e+'" class="'+n+" selectboxit-option "+(t(this).attr("class")||"")+'"><a class="selectboxit-option-anchor"><span class="selectboxit-option-icon-container"><i class="selectboxit-option-icon '+r+" "+(a||f.theme.container)+'"'+s+"></i></span>"+(f.options.html?h:f.htmlEscape(h))+"</a></li>",c=d.attr("data-search"),f.textArray[g]=e?"":c||h,this.selected&&(f._setText(f.dropdownText,l||h),f.currentFocus=g)})),f.options.defaultText||f.selectBox.attr("data-text")){var y=f.options.defaultText||f.selectBox.attr("data-text");f._setText(f.dropdownText,y),f.options.defaultText=y}return v.append(m),f.list=v,f.dropdownContainer.append(f.list),f.listItems=f.list.children("li"),f.listAnchors=f.list.find("a"),f.listItems.first().addClass("selectboxit-option-first"),f.listItems.last().addClass("selectboxit-option-last"),f.list.find("li[data-disabled='true']").not(".optgroupHeader").addClass(f.theme.disabled),f.dropdownImage.addClass(f.selectBox.attr("data-icon")||f.options.defaultIcon||f.listItems.eq(f.currentFocus).find("i").attr("class")),f.dropdownImage.attr("style",f.listItems.eq(f.currentFocus).find("i").attr("style")),f},_replaceSelectBox:function(){var e,n,r=this.originalElem.id||"",o=this.selectBox.attr("data-size"),a=this.listSize=o===i?"auto":"0"===o?"auto":+o;return this.selectBox.css("display","none").after(this.dropdownContainer),this.dropdownContainer.appendTo("body").addClass("selectboxit-rendering"),this.dropdown.height(),this.downArrow=t("<i/>",{id:r&&r+"SelectBoxItArrow",class:"selectboxit-arrow",unselectable:"on"}),this.downArrowContainer=t("<span/>",{id:r&&r+"SelectBoxItArrowContainer",class:"selectboxit-arrow-container",unselectable:"on"}).append(this.downArrow),this.dropdown.append(this.downArrowContainer),this.listItems.removeClass("selectboxit-selected").eq(this.currentFocus).addClass("selectboxit-selected"),e=this.downArrowContainer.outerWidth(!0),n=this.dropdownImage.outerWidth(!0),this.options.autoWidth&&(this.dropdown.css({width:"auto"}).css({width:this.list.outerWidth(!0)+e+n}),this.list.css({"min-width":this.dropdown.width()})),this.dropdownText.css({"max-width":this.dropdownContainer.outerWidth(!0)-(e+n)}),this.selectBox.after(this.dropdownContainer),this.dropdownContainer.removeClass("selectboxit-rendering"),"number"===t.type(a)&&(this.maxHeight=this.listAnchors.outerHeight(!0)*a),this},_scrollToView:function(t){var e=this.listItems.eq(this.currentFocus),n=this.list.scrollTop(),i=e.height(),r=e.position().top,o=Math.abs(r),a=this.list.height();return"search"===t?a-r<i?this.list.scrollTop(n+(r-(a-i))):r<-1&&this.list.scrollTop(r-i):"up"===t?r<-1&&this.list.scrollTop(n-o):"down"===t&&a-r<i&&this.list.scrollTop(n+(o-a+i)),this},_callbackSupport:function(e){return t.isFunction(e)&&e.call(this,this.dropdown),this},_setText:function(t,e){return this.options.html?t.html(e):t.text(e),this},open:function(t){var e=this,n=e.options.showEffect,i=e.options.showEffectSpeed,r=e.options.showEffectOptions,o=e.options.native,a=e.isMobile;return!e.listItems.length||e.dropdown.hasClass(e.theme.disabled)?e:(o||a||this.list.is(":visible")||(e.triggerEvent("open"),e._dynamicPositioning&&e.options.dynamicPositioning&&e._dynamicPositioning(),"none"===n?e.list.show():"show"===n||"slideDown"===n||"fadeIn"===n?e.list[n](i):e.list.show(n,r,i),e.list.promise().done((function(){e._scrollToView("search"),e.triggerEvent("opened")}))),e._callbackSupport(t),e)},close:function(t){var e=this,n=e.options.hideEffect,i=e.options.hideEffectSpeed,r=e.options.hideEffectOptions,o=e.options.native,a=e.isMobile;return o||a||!e.list.is(":visible")||(e.triggerEvent("close"),"none"===n?e.list.hide():"hide"===n||"slideUp"===n||"fadeOut"===n?e.list[n](i):e.list.hide(n,r,i),e.list.promise().done((function(){e.triggerEvent("closed")}))),e._callbackSupport(t),e},toggle:function(){var t=this.list.is(":visible");t?this.close():t||this.open()},_keyMappings:{38:"up",40:"down",13:"enter",8:"backspace",9:"tab",32:"space",27:"esc"},_keydownMethods:function(){var t=this,e=t.list.is(":visible")||!t.options.keydownOpen;return{down:function(){t.moveDown&&e&&t.moveDown()},up:function(){t.moveUp&&e&&t.moveUp()},enter:function(){var e=t.listItems.eq(t.currentFocus);t._update(e),"true"!==e.attr("data-preventclose")&&t.close(),t.triggerEvent("enter")},tab:function(){t.triggerEvent("tab-blur"),t.close()},backspace:function(){t.triggerEvent("backspace")},esc:function(){t.close()}}},_eventHandlers:function(){var e,n,i=this,r=i.options.nativeMousedown,o=i.options.customShowHideEvent,a=i.focusClass,s=i.hoverClass,l=i.openClass;return this.dropdown.on({"click.selectBoxIt":function(){i.dropdown.trigger("focus",!0),i.originalElem.disabled||(i.triggerEvent("click"),r||o||i.toggle())},"mousedown.selectBoxIt":function(){t(this).data("mdown",!0),i.triggerEvent("mousedown"),r&&!o&&i.toggle()},"mouseup.selectBoxIt":function(){i.triggerEvent("mouseup")},"blur.selectBoxIt":function(){i.blur&&(i.triggerEvent("blur"),i.close(),t(this).removeClass(a))},"focus.selectBoxIt":function(e,n){var r=t(this).data("mdown");t(this).removeData("mdown"),r||n||setTimeout((function(){i.triggerEvent("tab-focus")}),0),n||(t(this).hasClass(i.theme.disabled)||t(this).addClass(a),i.triggerEvent("focus"))},"keydown.selectBoxIt":function(t){var e=i._keyMappings[t.keyCode],n=i._keydownMethods()[e];n&&(n(),!i.options.keydownOpen||"up"!==e&&"down"!==e||i.open()),n&&"tab"!==e&&t.preventDefault()},"keypress.selectBoxIt":function(t){var e=t.charCode||t.keyCode,n=i._keyMappings[t.charCode||t.keyCode],r=String.fromCharCode(e);i.search&&(!n||n&&"space"===n)&&i.search(r,!0,!0),"space"===n&&t.preventDefault()},"mouseenter.selectBoxIt":function(){i.triggerEvent("mouseenter")},"mouseleave.selectBoxIt":function(){i.triggerEvent("mouseleave")}}),i.list.on({"mouseover.selectBoxIt":function(){i.blur=!1},"mouseout.selectBoxIt":function(){i.blur=!0},"focusin.selectBoxIt":function(){i.dropdown.trigger("focus",!0)}}),i.list.on({"mousedown.selectBoxIt":function(){i._update(t(this)),i.triggerEvent("option-click"),"false"===t(this).attr("data-disabled")&&"true"!==t(this).attr("data-preventclose")&&i.close(),setTimeout((function(){i.dropdown.trigger("focus",!0)}),0)},"focusin.selectBoxIt":function(){i.listItems.not(t(this)).removeAttr("data-active"),t(this).attr("data-active","");var e=i.list.is(":hidden");(i.options.searchWhenHidden&&e||i.options.aggressiveChange||e&&i.options.selectWhenHidden)&&i._update(t(this)),t(this).addClass(a)},"mouseup.selectBoxIt":function(){r&&!o&&(i._update(t(this)),i.triggerEvent("option-mouseup"),"false"===t(this).attr("data-disabled")&&"true"!==t(this).attr("data-preventclose")&&i.close())},"mouseenter.selectBoxIt":function(){"false"===t(this).attr("data-disabled")&&(i.listItems.removeAttr("data-active"),t(this).addClass(a).attr("data-active",""),i.listItems.not(t(this)).removeClass(a),t(this).addClass(a),i.currentFocus=+t(this).attr("data-id"))},"mouseleave.selectBoxIt":function(){"false"===t(this).attr("data-disabled")&&(i.listItems.not(t(this)).removeClass(a).removeAttr("data-active"),t(this).addClass(a),i.currentFocus=+t(this).attr("data-id"))},"blur.selectBoxIt":function(){t(this).removeClass(a)}},".selectboxit-option"),i.list.on({"click.selectBoxIt":function(t){t.preventDefault()}},"a"),i.selectBox.on({"change.selectBoxIt, internal-change.selectBoxIt":function(t,r){var o,a;r||(o=i.list.find('li[data-val="'+i.originalElem.value+'"]')).length&&(i.listItems.eq(i.currentFocus).removeClass(i.focusClass),i.currentFocus=+o.attr("data-id")),a=(o=i.listItems.eq(i.currentFocus)).attr("data-selectedtext"),e=o.attr("data-text"),n=e||o.find("a").text(),i._setText(i.dropdownText,a||n),i.dropdownText.attr("data-val",i.originalElem.value),o.find("i").attr("class")&&(i.dropdownImage.attr("class",o.find("i").attr("class")).addClass("selectboxit-default-icon"),i.dropdownImage.attr("style",o.find("i").attr("style"))),i.triggerEvent("changed")},"disable.selectBoxIt":function(){i.dropdown.addClass(i.theme.disabled)},"enable.selectBoxIt":function(){i.dropdown.removeClass(i.theme.disabled)},"open.selectBoxIt":function(){var t,e=i.list.find("li[data-val='"+i.dropdownText.attr("data-val")+"']");e.length||(e=i.listItems.not("[data-disabled=true]").first()),i.currentFocus=+e.attr("data-id"),t=i.listItems.eq(i.currentFocus),i.dropdown.addClass(l).removeClass(s).addClass(a),i.listItems.removeClass(i.selectedClass).removeAttr("data-active").not(t).removeClass(a),t.addClass(i.selectedClass).addClass(a),i.options.hideCurrent&&(i.listItems.show(),t.hide())},"close.selectBoxIt":function(){i.dropdown.removeClass(l)},"blur.selectBoxIt":function(){i.dropdown.removeClass(a)},"mouseenter.selectBoxIt":function(){t(this).hasClass(i.theme.disabled)||i.dropdown.addClass(s)},"mouseleave.selectBoxIt":function(){i.dropdown.removeClass(s)},destroy:function(t){t.preventDefault(),t.stopPropagation()}}),i},_update:function(t){var e=this.options.defaultText||this.selectBox.attr("data-text"),n=this.listItems.eq(this.currentFocus);"false"===t.attr("data-disabled")&&(this.listItems.eq(this.currentFocus).attr("data-selectedtext"),n.attr("data-text")||n.text(),(e&&this.options.html?this.dropdownText.html()===e:this.dropdownText.text()===e)&&this.selectBox.val()===t.attr("data-val")?this.triggerEvent("change"):(this.selectBox.val(t.attr("data-val")),this.currentFocus=+t.attr("data-id"),this.originalElem.value!==this.dropdownText.attr("data-val")&&this.triggerEvent("change")))},_addClasses:function(t){this.focusClass=t.focus,this.hoverClass=t.hover;var e=t.button,n=t.list,i=t.arrow,r=t.container;this.openClass=t.open;return this.selectedClass="selectboxit-selected",this.downArrow.addClass(this.selectBox.attr("data-downarrow")||this.options.downArrowIcon||i),this.dropdownContainer.addClass(r),this.dropdown.addClass(e),this.list.addClass(n),this},refresh:function(t,e){return this._destroySelectBoxIt()._create(!0),e||this.triggerEvent("refresh"),this._callbackSupport(t),this},htmlEscape:function(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},triggerEvent:function(t){var e=this.options.showFirstOption?this.currentFocus:this.currentFocus-1>=0?this.currentFocus:0;return this.selectBox.trigger(t,{selectbox:this.selectBox,selectboxOption:this.selectItems.eq(e),dropdown:this.dropdown,dropdownOption:this.listItems.eq(this.currentFocus)}),this},_copyAttributes:function(){return this._addSelectBoxAttributes&&this._addSelectBoxAttributes(),this},_realOuterWidth:function(t){if(t.is(":visible"))return t.outerWidth(!0);var e,n=t.clone();return n.css({visibility:"hidden",display:"block",position:"absolute"}).appendTo("body"),e=n.outerWidth(!0),n.remove(),e}});var r=t.selectBox.selectBoxIt.prototype;r.add=function(e,n){this._populate(e,(function(e){var i,r,o=this,a=t.type(e),s=0,l=[],u=o._isJSON(e),c=u&&o._parseJSON(e);if(e&&("array"===a||u&&c.data&&"array"===t.type(c.data))||"object"===a&&e.data&&"array"===t.type(e.data)){for(o._isJSON(e)&&(e=c),e.data&&(e=e.data),r=e.length;s<=r-1;s+=1)i=e[s],t.isPlainObject(i)?l.push(t("<option/>",i)):"string"===t.type(i)&&l.push(t("<option/>",{text:i,value:i}));o.selectBox.append(l)}else e&&"string"===a&&!o._isJSON(e)?o.selectBox.append(e):e&&"object"===a?o.selectBox.append(t("<option/>",e)):e&&o._isJSON(e)&&t.isPlainObject(o._parseJSON(e))&&o.selectBox.append(t("<option/>",o._parseJSON(e)));return o.dropdown?o.refresh((function(){o._callbackSupport(n)}),!0):o._callbackSupport(n),o}))},r._parseJSON=function(e){return JSON&&JSON.parse&&JSON.parse(e)||t.parseJSON(e)},r._isJSON=function(t){try{return this._parseJSON(t),!0}catch(t){return!1}},r._populate=function(e,n){var i=this;return e=t.isFunction(e)?e.call():e,i.isDeferred(e)?e.done((function(t){n.call(i,t)})):n.call(i,e),i},r._ariaAccessibility=function(){var e=this,n=t("label[for='"+e.originalElem.id+"']");return e.dropdownContainer.attr({role:"combobox","aria-autocomplete":"list","aria-haspopup":"true","aria-expanded":"false","aria-owns":e.list[0].id}),e.dropdownText.attr({"aria-live":"polite"}),e.dropdown.on({"disable.selectBoxIt":function(){e.dropdownContainer.attr("aria-disabled","true")},"enable.selectBoxIt":function(){e.dropdownContainer.attr("aria-disabled","false")}}),n.length&&e.dropdownContainer.attr("aria-labelledby",n[0].id),e.list.attr({role:"listbox","aria-hidden":"true"}),e.listItems.attr({role:"option"}),e.selectBox.on({"open.selectBoxIt":function(){e.list.attr("aria-hidden","false"),e.dropdownContainer.attr("aria-expanded","true")},"close.selectBoxIt":function(){e.list.attr("aria-hidden","true"),e.dropdownContainer.attr("aria-expanded","false")}}),e},r._addSelectBoxAttributes=function(){var e=this;return e._addAttributes(e.selectBox.prop("attributes"),e.dropdown),e.selectItems.each((function(n){e._addAttributes(t(this).prop("attributes"),e.listItems.eq(n))})),e},r._addAttributes=function(e,n){var i=this.options.copyAttributes;return e.length&&t.each(e,(function(e,r){var o=r.name.toLowerCase(),a=r.value;"null"===a||-1===t.inArray(o,i)&&-1===o.indexOf("data")||n.attr(o,a)})),this},r.destroy=function(t){return this._destroySelectBoxIt(),this.widgetProto.destroy.call(this),this._callbackSupport(t),this},r._destroySelectBoxIt=function(){return this.dropdown.off(".selectBoxIt"),t.contains(this.dropdownContainer[0],this.originalElem)&&this.dropdownContainer.before(this.selectBox),this.dropdownContainer.remove(),this.selectBox.removeAttr("style").attr("style",this.selectBoxStyles),this.triggerEvent("destroy"),this},r.disable=function(t){return this.options.disabled||(this.close(),this.selectBox.attr("disabled","disabled"),this.dropdown.removeAttr("tabindex").removeClass(this.theme.enabled).addClass(this.theme.disabled),this.setOption("disabled",!0),this.triggerEvent("disable")),this._callbackSupport(t),this},r.disableOption=function(e,n){var i,r,o;return"number"===t.type(e)&&(this.close(),i=this.selectBox.find("option").eq(e),this.triggerEvent("disable-option"),i.attr("disabled","disabled"),this.listItems.eq(e).attr("data-disabled","true").addClass(this.theme.disabled),this.currentFocus===e&&(r=this.listItems.eq(this.currentFocus).nextAll("li").not("[data-disabled='true']").first().length,o=this.listItems.eq(this.currentFocus).prevAll("li").not("[data-disabled='true']").first().length,r?this.moveDown():o?this.moveUp():this.disable())),this._callbackSupport(n),this},r._isDisabled=function(t){return this.originalElem.disabled&&this.disable(),this},r._dynamicPositioning=function(){if("number"===t.type(this.listSize))this.list.css("max-height",this.maxHeight||"none");else{var e=this.dropdown.offset().top,n=this.list.data("max-height")||this.list.outerHeight(),i=this.dropdown.outerHeight(),r=this.options.viewport,o=r.height(),a=t.isWindow(r.get(0))?r.scrollTop():r.offset().top,s=!(e+i+n<=o+a);if(this.list.data("max-height")||this.list.data("max-height",this.list.outerHeight()),s)if(this.dropdown.offset().top-a>=n)this.list.css("max-height",n),this.list.css("top",this.dropdown.position().top-this.list.outerHeight());else{var l=Math.abs(e+i+n-(o+a)),u=Math.abs(this.dropdown.offset().top-a-n);l<u?(this.list.css("max-height",n-l-i/2),this.list.css("top","auto")):(this.list.css("max-height",n-u-i/2),this.list.css("top",this.dropdown.position().top-this.list.outerHeight()))}else this.list.css("max-height",n),this.list.css("top","auto")}return this},r.enable=function(t){return this.options.disabled&&(this.triggerEvent("enable"),this.selectBox.removeAttr("disabled"),this.dropdown.attr("tabindex",0).removeClass(this.theme.disabled).addClass(this.theme.enabled),this.setOption("disabled",!1),this._callbackSupport(t)),this},r.enableOption=function(e,n){var i;return"number"===t.type(e)&&(i=this.selectBox.find("option").eq(e),this.triggerEvent("enable-option"),i.removeAttr("disabled"),this.listItems.eq(e).attr("data-disabled","false").removeClass(this.theme.disabled)),this._callbackSupport(n),this},r.moveDown=function(t){this.currentFocus+=1;var e="true"===this.listItems.eq(this.currentFocus).attr("data-disabled"),n=this.listItems.eq(this.currentFocus).nextAll("li").not("[data-disabled='true']").first().length;if(this.currentFocus===this.listItems.length)this.currentFocus-=1;else{if(e&&n)return this.listItems.eq(this.currentFocus-1).blur(),void this.moveDown();e&&!n?this.currentFocus-=1:(this.listItems.eq(this.currentFocus-1).blur().end().eq(this.currentFocus).focusin(),this._scrollToView("down"),this.triggerEvent("moveDown"))}return this._callbackSupport(t),this},r.moveUp=function(t){this.currentFocus-=1;var e="true"===this.listItems.eq(this.currentFocus).attr("data-disabled"),n=this.listItems.eq(this.currentFocus).prevAll("li").not("[data-disabled='true']").first().length;if(-1===this.currentFocus)this.currentFocus+=1;else{if(e&&n)return this.listItems.eq(this.currentFocus+1).blur(),void this.moveUp();e&&!n?this.currentFocus+=1:(this.listItems.eq(this.currentFocus+1).blur().end().eq(this.currentFocus).focusin(),this._scrollToView("up"),this.triggerEvent("moveUp"))}return this._callbackSupport(t),this},r._setCurrentSearchOption=function(t){return(this.options.aggressiveChange||this.options.selectWhenHidden||this.listItems.eq(t).is(":visible"))&&!0!==this.listItems.eq(t).data("disabled")&&(this.listItems.eq(this.currentFocus).blur(),this.currentIndex=t,this.currentFocus=t,this.listItems.eq(this.currentFocus).focusin(),this._scrollToView("search"),this.triggerEvent("search")),this},r._searchAlgorithm=function(t,e){var n,i,r,o,a=!1,s=this.textArray,l=this.currentText;for(n=t,r=s.length;n<r;n+=1){for(o=s[n],i=0;i<r;i+=1)-1!==s[i].search(e)&&(a=!0,i=r);if(a||(this.currentText=this.currentText.charAt(this.currentText.length-1).replace(/[|()\[{.+*?$\\]/g,"\\$0"),l=this.currentText),e=new RegExp(l,"gi"),l.length<3){if(e=new RegExp(l.charAt(0),"gi"),-1!==o.charAt(0).search(e))return this._setCurrentSearchOption(n),(o.substring(0,l.length).toLowerCase()!==l.toLowerCase()||this.options.similarSearch)&&(this.currentIndex+=1),!1}else if(-1!==o.search(e))return this._setCurrentSearchOption(n),!1;if(o.toLowerCase()===this.currentText.toLowerCase())return this._setCurrentSearchOption(n),this.currentText="",!1}return!0},r.search=function(t,e,n){return n?this.currentText+=t.replace(/[|()\[{.+*?$\\]/g,"\\$0"):this.currentText=t.replace(/[|()\[{.+*?$\\]/g,"\\$0"),this._searchAlgorithm(this.currentIndex,new RegExp(this.currentText,"gi"))&&this._searchAlgorithm(0,this.currentText),this._callbackSupport(e),this},r._updateMobileText=function(){var t,e;e=(t=this.selectBox.find("option").filter(":selected")).attr("data-text")||t.text(),this._setText(this.dropdownText,e),this.list.find('li[data-val="'+t.val()+'"]').find("i").attr("class")&&this.dropdownImage.attr("class",this.list.find('li[data-val="'+t.val()+'"]').find("i").attr("class")).addClass("selectboxit-default-icon")},r._applyNativeSelect=function(){return this.dropdownContainer.append(this.selectBox),this.dropdown.attr("tabindex","-1"),this.selectBox.css({display:"block",visibility:"visible",width:this._realOuterWidth(this.dropdown),height:this.dropdown.outerHeight(),opacity:"0",position:"absolute",top:"0",left:"0",cursor:"pointer","z-index":"999999",margin:this.dropdown.css("margin"),padding:"0","-webkit-appearance":"menulist-button"}),this.originalElem.disabled&&this.triggerEvent("disable"),this},r._mobileEvents=function(){var t=this;t.selectBox.on({"changed.selectBoxIt":function(){t.hasChanged=!0,t._updateMobileText(),t.triggerEvent("option-click")},"mousedown.selectBoxIt":function(){t.hasChanged||!t.options.defaultText||t.originalElem.disabled||(t._updateMobileText(),t.triggerEvent("option-click"))},"enable.selectBoxIt":function(){t.selectBox.removeClass("selectboxit-rendering")},"disable.selectBoxIt":function(){t.selectBox.addClass("selectboxit-rendering")}})},r._mobile=function(t){return this.isMobile&&(this._applyNativeSelect(),this._mobileEvents()),this},r.remove=function(e,n){var i,r,o=this,a=t.type(e),s=0,l="";if("array"===a){for(r=e.length;s<=r-1;s+=1)i=e[s],"number"===t.type(i)&&(l.length?l+=", option:eq("+i+")":l+="option:eq("+i+")");o.selectBox.find(l).remove()}else"number"===a?o.selectBox.find("option").eq(e).remove():o.selectBox.find("option").remove();return o.dropdown?o.refresh((function(){o._callbackSupport(n)}),!0):o._callbackSupport(n),o},r.selectOption=function(e,n){var i=t.type(e);return"number"===i?this.selectBox.val(this.selectItems.eq(e).val()).change():"string"===i&&this.selectBox.val(e).change(),this._callbackSupport(n),this},r.setOption=function(e,n,i){var r=this;return"string"===t.type(e)&&(r.options[e]=n),r.refresh((function(){r._callbackSupport(i)}),!0),r},r.setOptions=function(e,n){var i=this;return t.isPlainObject(e)&&(i.options=t.extend({},i.options,e)),i.refresh((function(){i._callbackSupport(n)}),!0),i},r.wait=function(t,e){return this.widgetProto._delay.call(this,e,t),this}}(window.jQuery,window,document)}()},195:function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e,n=this,i=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=i(" "),n.s1=i(" "),n.s2=i(" "),n.s0-=i(t),n.s0<0&&(n.s0+=1),n.s1-=i(t),n.s1<0&&(n.s1+=1),n.s2-=i(t),n.s2<0&&(n.s2+=1),i=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function l(t,e){var n=new a(t),i=e&&e.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,i&&("object"==typeof i&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=l:n(16)&&n(37)?void 0===(i=function(){return l}.call(e,n,e,r))||(r.exports=i):this.alea=l}(0,t,n(16))}).call(this,n(14)(t))},196:function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function l(t,e){var n=new a(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=l:n(16)&&n(37)?void 0===(i=function(){return l}.call(e,n,e,r))||(r.exports=i):this.xor128=l}(0,t,n(16))}).call(this,n(14)(t))},197:function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function l(t,e){var n=new a(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=l:n(16)&&n(37)?void 0===(i=function(){return l}.call(e,n,e,r))||(r.exports=i):this.xorwow=l}(0,t,n(16))}).call(this,n(14)(t))},198:function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],n^=(t^=t<<13)^t<<9,i[r]=n,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function l(t,e){null==t&&(t=+new Date);var n=new a(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.x&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=l:n(16)&&n(37)?void 0===(i=function(){return l}.call(e,n,e,r))||(r.exports=i):this.xorshift7=l}(0,t,n(16))}).call(this,n(14)(t))},199:function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,o=e.i;return e.w=i=i+1640531527|0,n=r[o+34&127],t=r[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=r[o]=n^t,e.i=o,n+(i^i>>>16)|0},function(t,e){var n,i,r,o,a,s=[],l=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,l=Math.max(l,e.length)),r=0,o=-32;o<l;++o)e&&(i^=e.charCodeAt((o+32)%e.length)),0===o&&(a=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,o>=0&&(a=a+1640531527|0,r=0==(n=s[127&o]^=i+a)?r+1:0);for(r>=128&&(s[127&(e&&e.length||0)]=-1),r=127,o=512;o>0;--o)i=s[r+34&127],n=s[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,s[r]=i^n;t.w=a,t.X=s,t.i=r}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function l(t,e){null==t&&(t=+new Date);var n=new a(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.X&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=l:n(16)&&n(37)?void 0===(i=function(){return l}.call(e,n,e,r))||(r.exports=i):this.xor4096=l}(0,t,n(16))}).call(this,n(14)(t))},2:function(t,e,n){"use strict";e.a={mainProperties:{type:{defaultValue:"md2d",immutable:!0},isBeingEdited:{defaultValue:!1,serialize:!1},imagePath:{defaultValue:"",immutable:!0},dnaEngineImagesPath:{defaultValue:"",immutable:!0},minX:{serialize:!1},maxX:{serialize:!1},minY:{serialize:!1},maxY:{serialize:!1},width:{defaultValue:10,unitType:"length",immutable:!0},height:{defaultValue:10,unitType:"length",immutable:!0},unitsScheme:{defaultValue:"md2d"},lennardJonesForces:{defaultValue:!0,storeInTickHistory:!0},coulombForces:{defaultValue:!0,storeInTickHistory:!0},temperatureControl:{defaultValue:!1,storeInTickHistory:!0},targetTemperature:{defaultValue:300,unitType:"temperature",storeInTickHistory:!0},modelSampleRate:{defaultValue:"default"},gravitationalField:{defaultValue:!1,unitType:"acceleration",storeInTickHistory:!0},timeStep:{defaultValue:1,unitType:"time",storeInTickHistory:!0},dielectricConstant:{defaultValue:1},realisticDielectricEffect:{defaultValue:!0},solventForceFactor:{defaultValue:1.25},solventForceType:{defaultValue:0},additionalSolventForceMult:{defaultValue:4},additionalSolventForceThreshold:{defaultValue:10,unitType:"length"},polarAAEpsilon:{defaultValue:-2},viscosity:{defaultValue:1,storeInTickHistory:!0},timeStepsPerTick:{defaultValue:50,storeInTickHistory:!0},DNAState:{defaultValue:"dna"},DNA:{defaultValue:"",validate:function(t){if(/[agtc]/.test(t)&&(t=t.toUpperCase()),/[^AGTC]/.test(t))throw new Error("DNA code on sense strand can be defined using only A, G, T or C characters.");return t}},DNAMutations:{defaultValue:!0},useQuantumDynamics:{defaultValue:!1},useChemicalReactions:{defaultValue:!1},useDuration:{defaultValue:"codap",storeInTickHistory:!1,validate:function(t){if(!0===t||!1===t||"codap"===t)return t;throw new Error("Invalid 'useDuration' value: "+t)}},requestedDuration:{defaultValue:null,storeInTickHistory:!1},skipPECheckOnAddAtom:{defaultValue:!1}},viewOptions:{viewPortWidth:{unitType:"length",immutable:!0},viewPortHeight:{unitType:"length",immutable:!0},viewPortZoom:{defaultValue:1},viewPortX:{unitType:"length"},viewPortY:{unitType:"length"},viewPortDrag:{defaultValue:!1},backgroundColor:{defaultValue:"#eeeeee"},showClock:{defaultValue:!0,storeInTickHistory:!0},markColor:{defaultValue:"#f8b500"},atomRadiusScale:{defaultValue:1},keShading:{defaultValue:!1,storeInTickHistory:!0},keShadingMinEnergy:{defaultValue:0,storeInTickHistory:!0},keShadingMaxEnergy:{defaultValue:.2,storeInTickHistory:!0},chargeShading:{defaultValue:!1,storeInTickHistory:!0},chargeShadingStyle:{defaultValue:"biology",storeInTickHistory:!0},aminoAcidColorScheme:{defaultValue:"hydrophobicity"},aminoAcidLabels:{defaultValue:!0},useThreeLetterCode:{defaultValue:!0},showChargeSymbols:{defaultValue:!0},showVDWLines:{defaultValue:!1,storeInTickHistory:!0},VDWLinesCutoff:{defaultValue:"medium"},showVelocityVectors:{defaultValue:!1,storeInTickHistory:!0},showForceVectors:{defaultValue:!1,storeInTickHistory:!0},showElectricField:{defaultValue:!1,storeInTickHistory:!0},electricFieldDensity:{defaultValue:18,storeInTickHistory:!0},electricFieldColor:{defaultValue:"auto"},showAtomTrace:{storeInTickHistory:!0,defaultValue:!1},atomTraceId:{storeInTickHistory:!0,defaultValue:0},images:{defaultValue:[]},imageMapping:{defaultValue:{}},textBoxes:{defaultValue:[]},xlabel:{defaultValue:!1},ylabel:{defaultValue:!1},xunits:{defaultValue:!1},yunits:{defaultValue:!1},controlButtons:{defaultValue:"play"},controlButtonStyle:{defaultValue:"video",propertyChangeInvalidates:!1,serialize:!1},gridLines:{defaultValue:!1},atomNumbers:{defaultValue:!1},enableAtomTooltips:{defaultValue:!1},enableKeyboardHandlers:{defaultValue:!0},atomTraceColor:{defaultValue:"#6913c5"},velocityVectors:{defaultValue:{color:"#000",width:.01,length:2}},forceVectors:{defaultValue:{color:"#169C30",width:.01,length:2}},forceVectorsDirectionOnly:{defaultValue:!1},onAtomDrag:{defaultValue:"translate"}},atom:{x:{required:!0,unitType:"length"},y:{required:!0,unitType:"length"},element:{defaultValue:0},vx:{defaultValue:0,unitType:"velocity"},vy:{defaultValue:0,unitType:"velocity"},ax:{defaultValue:0,unitType:"acceleration",serialize:!1},ay:{defaultValue:0,unitType:"acceleration",serialize:!1},charge:{defaultValue:0,unitType:"charge"},friction:{defaultValue:0,unitType:"dampingCoefficient"},radical:{defaultValue:0},visible:{defaultValue:1},pinned:{defaultValue:0},marked:{defaultValue:0},draggable:{defaultValue:0},draggableWhenStopped:{defaultValue:1},radius:{readOnly:!0,unitType:"length",serialize:!1},px:{readOnly:!0,unitType:"momentum",serialize:!1},py:{readOnly:!0,unitType:"momentum",serialize:!1},speed:{readOnly:!0,unitType:"velocity",serialize:!1},mass:{readOnly:!0,unitType:"mass",serialize:!1},excitation:{},sharedElectrons:{}},element:{mass:{defaultValue:120,unitType:"mass"},sigma:{defaultValue:.3,unitType:"length"},epsilon:{defaultValue:-.1,unitType:"energy"},radius:{unitType:"length",readOnly:!0,serialize:!1},color:{defaultValue:-855310}},pairwiseLJProperties:{element1:{defaultValue:0},element2:{defaultValue:0},sigma:{unitType:"length"},epsilon:{unitType:"energy"}},obstacle:{width:{unitType:"length",required:!0},height:{unitType:"length",required:!0},x:{defaultValue:0,unitType:"length"},y:{defaultValue:0,unitType:"length"},mass:{defaultValue:1/0,unitType:"mass"},vx:{defaultValue:0,unitType:"velocity"},vy:{defaultValue:0,unitType:"velocity"},externalAx:{defaultValue:0,unitType:"acceleration"},externalAy:{defaultValue:0,unitType:"acceleration"},displayExternalAcceleration:{defaultValue:!0},friction:{defaultValue:0,unitType:"inverseTime"},westProbe:{defaultValue:!1},westProbeValue:{unitType:"pressure",readOnly:!0,serialize:!1},northProbe:{defaultValue:!1},northProbeValue:{unitType:"pressure",readOnly:!0,serialize:!1},eastProbe:{defaultValue:!1},eastProbeValue:{unitType:"pressure",readOnly:!0,serialize:!1},southProbe:{defaultValue:!1},southProbeValue:{unitType:"pressure",readOnly:!0,serialize:!1},color:{defaultValue:"rgb(128,128,128)"},visible:{defaultValue:!0},permeability:{defaultValue:[]}},shape:{type:{defaultValue:"rectangle",required:!0},width:{unitType:"length",required:!0},height:{unitType:"length",required:!0},x:{defaultValue:0,unitType:"length"},y:{defaultValue:0,unitType:"length"},fence:{defaultValue:0},color:{defaultValue:"transparent"},lineColor:{defaultValue:"black"},lineDashes:{defaultValue:"none"},lineWeight:{defaultValue:1},layer:{defaultValue:1},layerPosition:{defaultValue:1},visible:{defaultValue:1}},line:{x1:{defaultValue:0,required:!0,unitType:"length"},y1:{defaultValue:0,required:!0,unitType:"length"},x2:{defaultValue:0,required:!0,unitType:"length"},y2:{defaultValue:0,required:!0,unitType:"length"},beginStyle:{defaultValue:"none"},endStyle:{defaultValue:"none"},fence:{defaultValue:0},lineColor:{defaultValue:"black"},lineDashes:{defaultValue:"none"},lineWeight:{defaultValue:1},layer:{defaultValue:1},layerPosition:{defaultValue:1},visible:{defaultValue:1}},radialBond:{atom1:{defaultValue:0},atom2:{defaultValue:0},length:{unitType:"length",required:!0},strength:{unitType:"stiffness",required:!0},type:{defaultValue:101}},angularBond:{atom1:{defaultValue:0},atom2:{defaultValue:0},atom3:{defaultValue:0},strength:{unitType:"rotationalStiffness",required:!0},angle:{unitType:"angle",required:!0}},restraint:{atomIndex:{required:!0},k:{defaultValue:2e3,unitType:"stiffness"},x0:{defaultValue:0,unitType:"length"},y0:{defaultValue:0,unitType:"length"}},electricField:{intensity:{defaultValue:.004},orientation:{defaultValue:"E"},shapeIdx:{defaultValue:null}},textBox:{text:{defaultValue:""},x:{defaultValue:0,unitType:"length"},y:{defaultValue:0,unitType:"length"},anchor:{defaultValue:"lower-left"},layer:{defaultValue:1},width:{},height:{},frame:{},color:{},calloutPoint:{},backgroundColor:{defaultValue:"white"},strokeWidthEms:{defaultValue:.03},strokeOpacity:{defaultValue:1},strokeColor:{defaultValue:"#000000"},rotate:{defaultValue:0},fontSize:{defaultValue:.12},hostType:{},hostIndex:{},textAlign:{}},chemicalReactions:{updateInterval:{defaultValue:10},createAngularBonds:{defaultValue:!0},noLoops:{defaultValue:!1},valenceElectrons:{defaultValue:[1,1,7,7]},bondEnergy:{defaultValue:{default:6,"0-0":4,"1-1":4,"2-2":4,"3-3":4}},activationEnergy:{defaultValue:{default:.2}},bondProbability:{defaultValue:{default:[.8,.15,.05]},validate:function(t){return Object.keys(t).forEach((function(e){var n=t[e];if(Math.abs(n[0]+n[1]+n[2]-1)>.001)throw new Error("Bond type probability values should sum to one.")})),t}}},image:{imageUri:{required:!0},imageX:{defaultValue:0,required:!0},imageY:{defaultValue:0,required:!0},imageHostType:{defaultValue:""},imageHostIndex:{defaultValue:0},imageLayer:{defaultValue:1},imageLayerPosition:{defaultValue:1},visible:{defaultValue:!0},rotation:{defaultValue:0},scale:{defaultValue:1},opacity:{defaultValue:1}},quantumDynamics:{elementEnergyLevels:{defaultValue:[]},photons:{defaultValue:{}},radiationlessEmissionProbability:{defaultValue:1},lightSource:{defaultValue:{on:!1,monochromatic:!0,frequency:1,radiationPeriod:1e3,numberOfBeams:10,angleOfIncidence:0}}},photon:{x:{serialize:!0},y:{serialize:!0},vx:{defaultValue:0,serialize:!0},vy:{defaultValue:0,serialize:!0},angularFrequency:{serialize:!0}}}},200:function(t,e,n){(function(t){var i;!function(t,r,o){function a(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function l(t,e){var n=new a(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&s(i,n),r.state=function(){return s(n,{})}),r}r&&r.exports?r.exports=l:n(16)&&n(37)?void 0===(i=function(){return l}.call(e,n,e,r))||(r.exports=i):this.tychei=l}(0,t,n(16))}).call(this,n(14)(t))},201:function(t,e,n){var i;!function(r,o,a){var s,l=a.pow(256,6),u=a.pow(2,52),c=2*u;function h(t,e,n){var i=[],h=f(function t(e,n){var i,r=[],o=typeof e;if(n&&"object"==o)for(i in e)try{r.push(t(e[i],n-1))}catch(t){}return r.length?r:"string"==o?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,m(o)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(256):(t=new Uint8Array(256),(r.crypto||r.msCrypto).getRandomValues(t)),m(t)}catch(t){var e=r.navigator,n=e&&e.plugins;return[+new Date,r,n,r.screen,m(o)]}}():t,3),i),g=new d(i),v=function(){for(var t=g.g(6),e=l,n=0;t<u;)t=256*(t+n),e*=256,n=g.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return v.int32=function(){return 0|g.g(4)},v.quick=function(){return g.g(4)/4294967296},v.double=v,f(m(g.S),o),(e.pass||n||function(t,e,n,i){return i&&(i.S&&p(i,g),t.state=function(){return p(g,{})}),n?(a.random=t,e):t})(v,h,"global"in e?e.global:this==a,e.state)}function d(t){var e,n=t.length,i=this,r=0,o=i.i=i.j=0,a=i.S=[];for(n||(t=[n++]);r<256;)a[r]=r++;for(r=0;r<256;r++)a[r]=a[o=255&o+t[r%n]+(e=a[r])],a[o]=e;(i.g=function(t){for(var e,n=0,r=i.i,o=i.j,a=i.S;t--;)e=a[r=255&r+1],n=256*n+a[255&(a[r]=a[o=255&o+e])+(a[o]=e)];return i.i=r,i.j=o,n})(256)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function f(t,e){for(var n,i=t+"",r=0;r<i.length;)e[255&r]=255&(n^=19*e[255&r])+i.charCodeAt(r++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(f(a.random(),o),t.exports){t.exports=h;try{s=n(202)}catch(t){}}else void 0===(i=function(){return h}.call(e,n,e,t))||(t.exports=i)}("undefined"!=typeof self?self:this,[],Math)},202:function(t,e){},203:function(t,e,n){var i=n(118),r=n(119);t.exports=function(t,e,n,o,a){var s=Object.create({});t&&"object"==typeof t&&(e=t.namespace,n=t.targetWindow,o=t.targetOrigin,a=t.phone,t=t.handler),a||(n===window.parent?(a=r()).initialize():a=new i(n,o)),a.addListener(e,function(t){var n;"call"===t.messageType&&"function"==typeof this.handler?this.handler.call(void 0,t.value,(function(n){a.post(e,{messageType:"returnValue",uuid:t.uuid,value:n})})):"returnValue"===t.messageType&&(n=s[t.uuid])&&(window.clearTimeout(n.timeout),n.callback&&n.callback.call(void 0,t.value),s[t.uuid]=null)}.bind(this)),this.handler=t,this.call=function(t,n){var i=function(){for(var t="abcdefghijklmnopqrstuvwxyz0123456789",e=t.length,n=[],i=0;i<10;i++)n.push(t[Math.floor(Math.random()*e)]);return n.join("")}();s[i]={callback:n,timeout:window.setTimeout((function(){n&&n(void 0,new Error("IframePhone timed out waiting for reply"))}),2e3)},a.post(e,{messageType:"call",uuid:i,value:t})}.bind(this),this.disconnect=function(){a.disconnect()}.bind(this)}},204:function(t,e,n){!function(t){var e=t.Markdown=function(t){switch(typeof t){case"undefined":this.dialect=e.dialects.Gruber;break;case"object":this.dialect=t;break;default:if(!(t in e.dialects))throw new Error("Unknown Markdown dialect '"+String(t)+"'");this.dialect=e.dialects[t]}this.em_state=[],this.strong_state=[],this.debug_indent=""};function i(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function r(){var t=n(17);return"Markdown.mk_block( "+t.inspect(this.toString())+", "+t.inspect(this.trailing)+", "+t.inspect(this.lineNumber)+" )"}t.parse=function(t,n){return new e(n).toTree(t)},t.toHTML=function(e,n,i){var r=t.toHTMLTree(e,n,i);return t.renderJsonML(r)},t.toHTMLTree=function(t,e,n){"string"==typeof t&&(t=this.parse(t,e));var i=d(t),r={};i&&i.references&&(r=i.references);var o=function t(e,n,i){var r;i=i||{};var o=e.slice(0);"function"==typeof i.preprocessTreeNode&&(o=i.preprocessTreeNode(o,n));var a=d(o);if(a){for(r in o[1]={},a)o[1][r]=a[r];a=o[1]}if("string"==typeof o)return o;switch(o[0]){case"header":o[0]="h"+o[1].level,delete o[1].level;break;case"bulletlist":o[0]="ul";break;case"numberlist":o[0]="ol";break;case"listitem":o[0]="li";break;case"para":o[0]="p";break;case"markdown":o[0]="html",a&&delete a.references;break;case"code_block":o[0]="pre",r=a?2:1;var s=["code"];s.push.apply(s,o.splice(r,o.length-r)),o[r]=s;break;case"inlinecode":o[0]="code";break;case"img":o[1].src=o[1].href,delete o[1].href;break;case"linebreak":o[0]="br";break;case"link":o[0]="a";break;case"link_ref":if(o[0]="a",!(l=n[a.ref]))return a.original;delete a.ref,a.href=l.href,l.title&&(a.title=l.title),delete a.original;break;case"img_ref":var l;if(o[0]="img",!(l=n[a.ref]))return a.original;delete a.ref,a.src=l.href,l.title&&(a.title=l.title),delete a.original}if(r=1,a){for(var u in o[1]){r=2;break}1===r&&o.splice(r,1)}for(;r<o.length;++r)o[r]=t(o[r],n,i);return o}(t,r,n);return function t(e){var n=d(e)?2:1;for(;n<e.length;)"string"==typeof e[n]?n+1<e.length&&"string"==typeof e[n+1]?e[n]+=e.splice(n+1,1)[0]:++n:(t(e[n]),++n)}(o),o};var o=e.mk_block=function(t,e,n){1==arguments.length&&(e="\n\n");var o=new String(t);return o.trailing=e,o.inspect=r,o.toSource=i,null!=n&&(o.lineNumber=n),o};function s(t){for(var e=0,n=-1;-1!==(n=t.indexOf("\n",n+1));)e++;return e}function l(t,e){var n=t+"_state",i="strong"==t?"em_state":"strong_state";function r(t){this.len_after=t,this.name="close_"+e}return function(o,a){if(this[n][0]==e)return this[n].shift(),[o.length,new r(o.length-e.length)];var s=this[i].slice(),l=this[n].slice();this[n].unshift(e);var u=this.processInline(o.substr(e.length)),c=u[u.length-1];this[n].shift();return c instanceof r?(u.pop(),[o.length-c.len_after,[t].concat(u)]):(this[i]=s,this[n]=l,[e.length,e])}}e.prototype.split_blocks=function(t,e){t=t.replace(/(\r\n|\n|\r)/g,"\n");var n,i=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,r=[],a=1;for(null!=(n=/^(\s*\n)/.exec(t))&&(a+=s(n[0]),i.lastIndex=n[0].length);null!==(n=i.exec(t));)"\n#"==n[2]&&(n[2]="\n",i.lastIndex--),r.push(o(n[1],n[2],a)),a+=s(n[0]);return r},e.prototype.processBlock=function(t,e){var n=this.dialect.block,i=n.__order__;if("__call__"in n)return n.__call__.call(this,t,e);for(var r=0;r<i.length;r++){var o=n[i[r]].call(this,t,e);if(o)return(!c(o)||o.length>0&&!c(o[0]))&&this.debug(i[r],"didn't return a proper array"),o}return[]},e.prototype.processInline=function(t){return this.dialect.inline.__call__.call(this,String(t))},e.prototype.toTree=function(t,e){var n=t instanceof Array?t:this.split_blocks(t),i=this.tree;try{for(this.tree=e||this.tree||["markdown"];n.length;){var r=this.processBlock(n.shift(),n);r.length&&this.tree.push.apply(this.tree,r)}return this.tree}finally{e&&(this.tree=i)}},e.prototype.debug=function(){var t=Array.prototype.slice.call(arguments);t.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,t),"undefined"!=typeof console&&void 0!==console.log&&console.log.apply(null,t)},e.prototype.loop_re_over_block=function(t,e,n){for(var i,r=e.valueOf();r.length&&null!=(i=t.exec(r));)r=r.substr(i[0].length),n.call(this,i);return r},e.dialects={},e.dialects.Gruber={block:{atxHeader:function(t,e){var n=t.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(n){var i=["header",{level:n[1].length}];return Array.prototype.push.apply(i,this.processInline(n[2])),n[0].length<t.length&&e.unshift(o(t.substr(n[0].length),t.trailing,t.lineNumber+2)),[i]}},setextHeader:function(t,e){var n=t.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(n){var i=["header",{level:"="===n[2]?1:2},n[1]];return n[0].length<t.length&&e.unshift(o(t.substr(n[0].length),t.trailing,t.lineNumber+2)),[i]}},code:function(t,e){var n=[],i=/^(?: {0,3}\t| {4})(.*)\n?/;if(t.match(i)){t:for(;;){var r=this.loop_re_over_block(i,t.valueOf(),(function(t){n.push(t[1])}));if(r.length){e.unshift(o(r,t.trailing));break t}if(!e.length)break t;if(!e[0].match(i))break t;n.push(t.trailing.replace(/[^\n]/g,"").substring(2)),t=e.shift()}return[["code_block",n.join("\n")]]}},horizRule:function(t,e){var n=t.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(n){var i=[["hr"]];return n[1]&&i.unshift.apply(i,this.processBlock(n[1],[])),n[3]&&e.unshift(o(n[3])),i}},lists:function(){var t=/[*+-]/,e=new RegExp("^( {0,3})([*+-]|\\d+\\.)[ \t]+"),n="(?: {0,3}\\t| {4})";function i(t,e,n,i){if(e)t.push(["para"].concat(n));else{var r=t[t.length-1]instanceof Array&&"para"==t[t.length-1][0]?t[t.length-1]:t;i&&t.length>1&&n.unshift(i);for(var o=0;o<n.length;o++){var a=n[o];"string"==typeof a&&r.length>1&&"string"==typeof r[r.length-1]?r[r.length-1]+=a:r.push(a)}}}function r(t,e){for(var i=new RegExp("^("+n+"{"+t+"}.*?\\n?)*$"),r=new RegExp("^"+n+"{"+t+"}","gm"),a=[];e.length>0&&i.exec(e[0]);){var s=e.shift(),l=s.replace(r,"");a.push(o(l,s.trailing,s.lineNumber))}return a}function a(t,e,n){var i=t.list,r=i[i.length-1];if(!(r[1]instanceof Array&&"para"==r[1][0]))if(e+1==n.length)r.push(["para"].concat(r.splice(1,r.length-1)));else{var o=r.pop();r.push(["para"].concat(r.splice(1,r.length-1)),o)}}return function(o,s){var l=o.match(e);if(l){for(var c,h,d,p=[],f=E(l),m=!1,g=[p[0].list];;){for(var v=o.split(/(?=\n)/),y="",b=0;b<v.length;b++){var _="",x=v[b].replace(/^\n/,(function(t){return _=t,""})),w=(d=p.length,new RegExp("(?:^("+n+"{0,"+d+"} {0,3})([*+-]|\\d+\\.)\\s+)|(^"+n+"{0,"+(d-1)+"}[ ]{0,4})"));if(void 0!==(l=x.match(w))[1]){y.length&&(i(c,m,this.processInline(y),_),m=!1,y=""),l[1]=l[1].replace(/ {0,3}\t/g,"    ");var C=Math.floor(l[1].length/4)+1;if(C>p.length)f=E(l),c.push(f),c=f[1]=["listitem"];else{var T=!1;for(h=0;h<p.length;h++)if(p[h].indent==l[1]){f=p[h].list,p.splice(h+1,p.length-(h+1)),T=!0;break}T||(++C<=p.length?(p.splice(C,p.length-C),f=p[C-1].list):(f=E(l),c.push(f))),c=["listitem"],f.push(c)}_=""}x.length>l[0].length&&(y+=_+x.substr(l[0].length))}y.length&&(i(c,m,this.processInline(y),_),m=!1,y="");var S=r(p.length,s);S.length>0&&(u(p,a,this),c.push.apply(c,this.toTree(S,[])));var k=s[0]&&s[0].valueOf()||"";if(!k.match(e)&&!k.match(/^ /))break;o=s.shift();var A=this.dialect.block.horizRule(o,s);if(A){g.push.apply(g,A);break}u(p,a,this),m=!0}return g}function E(e){var n=t.exec(e[2])?["bulletlist"]:["numberlist"];return p.push({list:n,indent:e[1]}),n}}}(),blockquote:function(t,e){if(t.match(/^>/m)){var n=[];if(">"!=t[0]){for(var i=t.split(/\n/),r=[],a=t.lineNumber;i.length&&">"!=i[0][0];)r.push(i.shift()),a++;var s=o(r.join("\n"),"\n",t.lineNumber);n.push.apply(n,this.processBlock(s,[])),t=o(i.join("\n"),t.trailing,a)}for(;e.length&&">"==e[0][0];){var l=e.shift();t=o(t+t.trailing+l,l.trailing,t.lineNumber)}var u=t.replace(/^> ?/gm,""),c=(this.tree,this.toTree(u,["blockquote"])),p=d(c);return p&&p.references&&(delete p.references,h(p)&&c.splice(1,1)),n.push(c),n}},referenceDefn:function(t,e){var n=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(t.match(n)){d(this.tree)||this.tree.splice(1,0,{});var i=d(this.tree);void 0===i.references&&(i.references={});var r=this.loop_re_over_block(n,t,(function(t){t[2]&&"<"==t[2][0]&&">"==t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1));var e=i.references[t[1].toLowerCase()]={href:t[2]};void 0!==t[4]?e.title=t[4]:void 0!==t[5]&&(e.title=t[5])}));return r.length&&e.unshift(o(r,t.trailing)),[]}},para:function(t,e){return[["para"].concat(this.processInline(t))]}}},e.dialects.Gruber.inline={__oneElement__:function(t,e,n){var i,r;return e=e||this.dialect.inline.__patterns__,(i=new RegExp("([\\s\\S]*?)("+(e.source||e)+")").exec(t))?i[1]?[i[1].length,i[1]]:(i[2]in this.dialect.inline&&(r=this.dialect.inline[i[2]].call(this,t.substr(i.index),i,n||[])),r=r||[i[2].length,i[2]]):[t.length,t]},__call__:function(t,e){var n,i=[];function r(t){"string"==typeof t&&"string"==typeof i[i.length-1]?i[i.length-1]+=t:i.push(t)}for(;t.length>0;)n=this.dialect.inline.__oneElement__.call(this,t,e,i),t=t.substr(n.shift()),u(n,r);return i},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(t){return this.dialect.inline.__escape__.exec(t)?[2,t.charAt(1)]:[1,"\\"]},"![":function(t){var e=t.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(e){e[2]&&"<"==e[2][0]&&">"==e[2][e[2].length-1]&&(e[2]=e[2].substring(1,e[2].length-1)),e[2]=this.dialect.inline.__call__.call(this,e[2],/\\/)[0];var n={alt:e[1],href:e[2]||""};return void 0!==e[4]&&(n.title=e[4]),[e[0].length,["img",n]]}return(e=t.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/))?[e[0].length,["img_ref",{alt:e[1],ref:e[2].toLowerCase(),original:e[0]}]]:[2,"!["]},"[":function(t){var n=String(t),i=e.DialectHelpers.inline_until_char.call(this,t.substr(1),"]");if(!i)return[1,"["];var r,o,a=1+i[0],s=i[1],l=(t=t.substr(a)).match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(l){var u=l[1];if(a+=l[0].length,u&&"<"==u[0]&&">"==u[u.length-1]&&(u=u.substring(1,u.length-1)),!l[3])for(var c=1,h=0;h<u.length;h++)switch(u[h]){case"(":c++;break;case")":0==--c&&(a-=u.length-h,u=u.substring(0,h))}return o={href:(u=this.dialect.inline.__call__.call(this,u,/\\/)[0])||""},void 0!==l[3]&&(o.title=l[3]),r=["link",o].concat(s),[a,r]}return(l=t.match(/^\s*\[(.*?)\]/))?(a+=l[0].length,r=["link_ref",o={ref:(l[1]||String(s)).toLowerCase(),original:n.substr(0,a)}].concat(s),[a,r]):1==s.length&&"string"==typeof s[0]?(r=["link_ref",o={ref:s[0].toLowerCase(),original:n.substr(0,a)},s[0]],[a,r]):[1,"["]},"<":function(t){var e;return null!=(e=t.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?e[3]?[e[0].length,["link",{href:"mailto:"+e[3]},e[3]]]:"mailto"==e[2]?[e[0].length,["link",{href:e[1]},e[1].substr("mailto:".length)]]:[e[0].length,["link",{href:e[1]},e[1]]]:[1,"<"]},"`":function(t){var e=t.match(/(`+)(([\s\S]*?)\1)/);return e&&e[2]?[e[1].length+e[2].length,["inlinecode",e[3]]]:[1,"`"]},"  \n":function(t){return[3,["linebreak"]]}},e.dialects.Gruber.inline["**"]=l("strong","**"),e.dialects.Gruber.inline.__=l("strong","__"),e.dialects.Gruber.inline["*"]=l("em","*"),e.dialects.Gruber.inline._=l("em","_"),e.buildBlockOrder=function(t){var e=[];for(var n in t)"__order__"!=n&&"__call__"!=n&&e.push(n);t.__order__=e},e.buildInlinePatterns=function(t){var e=[];for(var n in t)if(!n.match(/^__.*__$/)){var i=n.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");e.push(1==n.length?i:"(?:"+i+")")}e=e.join("|"),t.__patterns__=e;var r=t.__call__;t.__call__=function(t,n){return null!=n?r.call(this,t,n):r.call(this,t,e)}},e.DialectHelpers={},e.DialectHelpers.inline_until_char=function(t,e){for(var n=0,i=[];;){if(t.charAt(n)==e)return[++n,i];if(n>=t.length)return null;var r=this.dialect.inline.__oneElement__.call(this,t.substr(n));n+=r[0],i.push.apply(i,r.slice(1))}},e.subclassDialect=function(t){function e(){}function n(){}return e.prototype=t.block,n.prototype=t.inline,{block:new e,inline:new n}},e.buildBlockOrder(e.dialects.Gruber.block),e.buildInlinePatterns(e.dialects.Gruber.inline),e.dialects.Maruku=e.subclassDialect(e.dialects.Gruber),e.dialects.Maruku.processMetaHash=function(t){for(var e=function(t){var e=t.split(""),n=[""],i=!1;for(;e.length;){var r=e.shift();switch(r){case" ":i?n[n.length-1]+=r:n.push("");break;case"'":case'"':i=!i;break;case"\\":r=e.shift();default:n[n.length-1]+=r}}return n}(t),n={},i=0;i<e.length;++i)if(/^#/.test(e[i]))n.id=e[i].substring(1);else if(/^\./.test(e[i]))n.class?n.class=n.class+e[i].replace(/./," "):n.class=e[i].substring(1);else if(/\=/.test(e[i])){var r=e[i].split(/\=/);n[r[0]]=r[1]}return n},e.dialects.Maruku.block.document_meta=function(t,e){if(!(t.lineNumber>1)&&t.match(/^(?:\w+:.*\n)*\w+:.*$/)){d(this.tree)||this.tree.splice(1,0,{});var n=t.split(/\n/);for(p in n){var i=n[p].match(/(\w+):\s*(.*)$/),r=i[1].toLowerCase(),o=i[2];this.tree[1][r]=o}return[]}},e.dialects.Maruku.block.block_meta=function(t,e){var n=t.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(n){var i,r=this.dialect.processMetaHash(n[2]);if(""===n[1]){var o=this.tree[this.tree.length-1];if(i=d(o),"string"==typeof o)return;for(a in i||(i={},o.splice(1,0,i)),r)i[a]=r[a];return[]}var s=t.replace(/\n.*$/,""),l=this.processBlock(s,[]);for(a in(i=d(l[0]))||(i={},l[0].splice(1,0,i)),r)i[a]=r[a];return l}},e.dialects.Maruku.block.definition_list=function(t,e){var n,i=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,r=["dl"];if(s=t.match(i)){for(var o=[t];e.length&&i.exec(e[0]);)o.push(e.shift());for(var a=0;a<o.length;++a){var s,l=(s=o[a].match(i))[1].replace(/\n$/,"").split(/\n/),u=s[2].split(/\n:\s+/);for(n=0;n<l.length;++n)r.push(["dt",l[n]]);for(n=0;n<u.length;++n)r.push(["dd"].concat(this.processInline(u[n].replace(/(\n)\s+/,"$1"))))}return[r]}},e.dialects.Maruku.block.table=function(t,e){var n,i,r=function(t,e){(e=e||"\\s").match(/^[\\|\[\]{}?*.+^$]$/)&&(e="\\"+e);for(var n,i=[],r=new RegExp("^((?:\\\\.|[^\\\\"+e+"])*)"+e+"(.*)");n=t.match(r);)i.push(n[1]),t=n[2];return i.push(t),i};if(i=t.match(/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/))i[3]=i[3].replace(/^\s*\|/gm,"");else if(!(i=t.match(/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/)))return;var o=["table",["thead",["tr"]],["tbody"]];i[2]=i[2].replace(/\|\s*$/,"").split("|");var a=[];for(u(i[2],(function(t){t.match(/^\s*-+:\s*$/)?a.push({align:"right"}):t.match(/^\s*:-+\s*$/)?a.push({align:"left"}):t.match(/^\s*:-+:\s*$/)?a.push({align:"center"}):a.push({})})),i[1]=r(i[1].replace(/\|\s*$/,""),"|"),n=0;n<i[1].length;n++)o[1][1].push(["th",a[n]||{}].concat(this.processInline(i[1][n].trim())));return u(i[3].replace(/\|\s*$/gm,"").split("\n"),(function(t){var e=["tr"];for(t=r(t,"|"),n=0;n<t.length;n++)e.push(["td",a[n]||{}].concat(this.processInline(t[n].trim())));o[2].push(e)}),this),[o]},e.dialects.Maruku.inline["{:"]=function(t,e,n){if(!n.length)return[2,"{:"];var i=n[n.length-1];if("string"==typeof i)return[2,"{:"];var r=t.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!r)return[2,"{:"];var o=this.dialect.processMetaHash(r[1]),a=d(i);for(var s in a||(a={},i.splice(1,0,a)),o)a[s]=o[s];return[r[0].length,""]},e.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,e.buildBlockOrder(e.dialects.Maruku.block),e.buildInlinePatterns(e.dialects.Maruku.inline);var u,c=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)};u=Array.prototype.forEach?function(t,e,n){return t.forEach(e,n)}:function(t,e,n){for(var i=0;i<t.length;i++)e.call(n||t,t[i],i,t)};var h=function(t){for(var e in t)if(hasOwnProperty.call(t,e))return!1;return!0};function d(t){return c(t)&&t.length>1&&"object"==typeof t[1]&&!c(t[1])?t[1]:void 0}function f(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function m(t){if("string"==typeof t)return f(t);var e=t.shift(),n={},i=[];for(!t.length||"object"!=typeof t[0]||t[0]instanceof Array||(n=t.shift());t.length;)i.push(m(t.shift()));var r="";for(var o in n)r+=" "+o+'="'+f(n[o])+'"';return"img"==e||"br"==e||"hr"==e?"<"+e+r+"/>":"<"+e+r+">"+i.join("")+"</"+e+">"}t.renderJsonML=function(t,e){(e=e||{}).root=e.root||!1;var n=[];if(e.root)n.push(m(t));else for(t.shift(),!t.length||"object"!=typeof t[0]||t[0]instanceof Array||t.shift();t.length;)n.push(m(t.shift()));return n.join("\n\n")}}(e)},205:function(t,e){t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=e[t]||t;for(var n=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],i=0;i<n.length;i++){var r=n[i].re,o=n[i].process,a=r.exec(t);if(a){var s=o(a);this.r=s[0],this.g=s[1],this.b=s[2],s.length>3&&(this.alpha=s[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),n=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==n.length&&(n="0"+n),"#"+t+e+n},this.getHelpXML=function(){for(var t=new Array,i=0;i<n.length;i++)for(var r=n[i].example,o=0;o<r.length;o++)t[t.length]=r[o];for(var a in e)t[t.length]=a;var s=document.createElement("ul");s.setAttribute("id","rgbcolor-examples");for(i=0;i<t.length;i++)try{var l=document.createElement("li"),u=new RGBColor(t[i]),c=document.createElement("div");c.style.cssText="margin: 3px; border: 1px solid black; background:"+u.toHex()+"; color:"+u.toHex(),c.appendChild(document.createTextNode("test"));var h=document.createTextNode(" "+t[i]+" -> "+u.toRGB()+" -> "+u.toHex());l.appendChild(c),l.appendChild(h),s.appendChild(l)}catch(t){}return s}}},206:function(t,e){var n=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],i=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function r(t,e,n,i,r){if("string"==typeof t)t=document.getElementById(t);else if("undefined"!=typeof HTMLCanvasElement&&!t instanceof HTMLCanvasElement)return;var o,a=t.getContext("2d");try{try{o=a.getImageData(e,n,i,r)}catch(t){throw new Error("unable to access local image data: "+t)}}catch(t){throw new Error("unable to access image data: "+t)}return o}function o(t,e,n,i,o,s){if(!(isNaN(s)||s<1)){s|=0;var l=r(t,e,n,i,o);l=a(l,e,n,i,o,s),t.getContext("2d").putImageData(l,e,n)}}function a(t,e,r,o,a,s){var l,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E,M,P,D,O,I=t.data,L=s+s+1,R=o-1,N=a-1,F=s+1,B=F*(F+1)/2,z=new u,j=z;for(h=1;h<L;h++)if(j=j.next=new u,h==F)var V=j;j.next=z;var H=null,W=null;m=f=0;var U=n[s],$=i[s];for(c=0;c<a;c++){for(T=S=k=A=g=v=y=b=0,_=F*(E=I[f]),x=F*(M=I[f+1]),w=F*(P=I[f+2]),C=F*(D=I[f+3]),g+=B*E,v+=B*M,y+=B*P,b+=B*D,j=z,h=0;h<F;h++)j.r=E,j.g=M,j.b=P,j.a=D,j=j.next;for(h=1;h<F;h++)d=f+((R<h?R:h)<<2),g+=(j.r=E=I[d])*(O=F-h),v+=(j.g=M=I[d+1])*O,y+=(j.b=P=I[d+2])*O,b+=(j.a=D=I[d+3])*O,T+=E,S+=M,k+=P,A+=D,j=j.next;for(H=z,W=V,l=0;l<o;l++)I[f+3]=D=b*U>>$,0!=D?(D=255/D,I[f]=(g*U>>$)*D,I[f+1]=(v*U>>$)*D,I[f+2]=(y*U>>$)*D):I[f]=I[f+1]=I[f+2]=0,g-=_,v-=x,y-=w,b-=C,_-=H.r,x-=H.g,w-=H.b,C-=H.a,d=m+((d=l+s+1)<R?d:R)<<2,g+=T+=H.r=I[d],v+=S+=H.g=I[d+1],y+=k+=H.b=I[d+2],b+=A+=H.a=I[d+3],H=H.next,_+=E=W.r,x+=M=W.g,w+=P=W.b,C+=D=W.a,T-=E,S-=M,k-=P,A-=D,W=W.next,f+=4;m+=o}for(l=0;l<o;l++){for(S=k=A=T=v=y=b=g=0,_=F*(E=I[f=l<<2]),x=F*(M=I[f+1]),w=F*(P=I[f+2]),C=F*(D=I[f+3]),g+=B*E,v+=B*M,y+=B*P,b+=B*D,j=z,h=0;h<F;h++)j.r=E,j.g=M,j.b=P,j.a=D,j=j.next;for(p=o,h=1;h<=s;h++)f=p+l<<2,g+=(j.r=E=I[f])*(O=F-h),v+=(j.g=M=I[f+1])*O,y+=(j.b=P=I[f+2])*O,b+=(j.a=D=I[f+3])*O,T+=E,S+=M,k+=P,A+=D,j=j.next,h<N&&(p+=o);for(f=l,H=z,W=V,c=0;c<a;c++)I[(d=f<<2)+3]=D=b*U>>$,D>0?(D=255/D,I[d]=(g*U>>$)*D,I[d+1]=(v*U>>$)*D,I[d+2]=(y*U>>$)*D):I[d]=I[d+1]=I[d+2]=0,g-=_,v-=x,y-=w,b-=C,_-=H.r,x-=H.g,w-=H.b,C-=H.a,d=l+((d=c+F)<N?d:N)*o<<2,g+=T+=H.r=I[d],v+=S+=H.g=I[d+1],y+=k+=H.b=I[d+2],b+=A+=H.a=I[d+3],H=H.next,_+=E=W.r,x+=M=W.g,w+=P=W.b,C+=D=W.a,T-=E,S-=M,k-=P,A-=D,W=W.next,f+=o}return t}function s(t,e,n,i,o,a){if(!(isNaN(a)||a<1)){a|=0;var s=r(t,e,n,i,o);s=l(s,e,n,i,o,a),t.getContext("2d").putImageData(s,e,n)}}function l(t,e,r,o,a,s){var l,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E,M=t.data,P=s+s+1,D=o-1,O=a-1,I=s+1,L=I*(I+1)/2,R=new u,N=R;for(h=1;h<P;h++)if(N=N.next=new u,h==I)var F=N;N.next=R;var B=null,z=null;m=f=0;var j=n[s],V=i[s];for(c=0;c<a;c++){for(w=C=T=g=v=y=0,b=I*(S=M[f]),_=I*(k=M[f+1]),x=I*(A=M[f+2]),g+=L*S,v+=L*k,y+=L*A,N=R,h=0;h<I;h++)N.r=S,N.g=k,N.b=A,N=N.next;for(h=1;h<I;h++)d=f+((D<h?D:h)<<2),g+=(N.r=S=M[d])*(E=I-h),v+=(N.g=k=M[d+1])*E,y+=(N.b=A=M[d+2])*E,w+=S,C+=k,T+=A,N=N.next;for(B=R,z=F,l=0;l<o;l++)M[f]=g*j>>V,M[f+1]=v*j>>V,M[f+2]=y*j>>V,g-=b,v-=_,y-=x,b-=B.r,_-=B.g,x-=B.b,d=m+((d=l+s+1)<D?d:D)<<2,g+=w+=B.r=M[d],v+=C+=B.g=M[d+1],y+=T+=B.b=M[d+2],B=B.next,b+=S=z.r,_+=k=z.g,x+=A=z.b,w-=S,C-=k,T-=A,z=z.next,f+=4;m+=o}for(l=0;l<o;l++){for(C=T=w=v=y=g=0,b=I*(S=M[f=l<<2]),_=I*(k=M[f+1]),x=I*(A=M[f+2]),g+=L*S,v+=L*k,y+=L*A,N=R,h=0;h<I;h++)N.r=S,N.g=k,N.b=A,N=N.next;for(p=o,h=1;h<=s;h++)f=p+l<<2,g+=(N.r=S=M[f])*(E=I-h),v+=(N.g=k=M[f+1])*E,y+=(N.b=A=M[f+2])*E,w+=S,C+=k,T+=A,N=N.next,h<O&&(p+=o);for(f=l,B=R,z=F,c=0;c<a;c++)M[d=f<<2]=g*j>>V,M[d+1]=v*j>>V,M[d+2]=y*j>>V,g-=b,v-=_,y-=x,b-=B.r,_-=B.g,x-=B.b,d=l+((d=c+I)<O?d:O)*o<<2,g+=w+=B.r=M[d],v+=C+=B.g=M[d+1],y+=T+=B.b=M[d+2],B=B.next,b+=S=z.r,_+=k=z.g,x+=A=z.b,w-=S,C-=k,T-=A,z=z.next,f+=o}return t}function u(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}t.exports={image:function(t,e,n,i){if("string"==typeof t)t=document.getElementById(t);else if("undefined"!=typeof HTMLImageElement&&!t instanceof HTMLImageElement)return;var r=t.naturalWidth,a=t.naturalHeight;if("string"==typeof e)e=document.getElementById(e);else if("undefined"!=typeof HTMLCanvasElement&&!e instanceof HTMLCanvasElement)return;e.style.width=r+"px",e.style.height=a+"px",e.width=r,e.height=a;var l=e.getContext("2d");l.clearRect(0,0,r,a),l.drawImage(t,0,0),isNaN(n)||n<1||(i?o(e,0,0,r,a,n):s(e,0,0,r,a,n))},canvasRGBA:o,canvasRGB:s,imageDataRGBA:a,imageDataRGB:l}},21:function(t,e,n){"use strict";e.a={iterationsLimit:35,minModelWidth:150,minFontSize:.65,canonicalFontSize:.9,canonicalWidth:565,containerColors:["rgba(0,0,255,0.1)","rgba(255,0,0,0.1)","rgba(0,255,0,0.1)","rgba(255,255,0,0.1)","rgba(0,255,255,0.1)","rgba(255,255,128,0.1)","rgba(128,255,0,0.1)","rgba(255,128,0,0.1)"]}},22:function(t,e,n){t.exports=function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=n[a]={exports:{}};e[a][0].call(l.exports,(function(t){var n=e[a][1][t];return r(n||t)}),l,l.exports,t,e,n,i)}return n[a].exports}for(var o=!1,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){e.exports.numberWidth=function(t,e,n,i,r){var o,a,s,l,u;return(a=(o=t.append("svg").attr("width",e).attr("height",n).attr("class","graph")).append("g").append("text").attr("class","axis").attr("x",-i/4+"px").attr("dy",".35em").attr("text-anchor","end").text(r)).node().getBBox?(l=(s=a.node().getBBox()).width,u=s.height):(l=0,u=0),o.remove(),[l,u]},e.exports.axisProcessDrag=function(t,e,n){var i,r,o=n,a=0,s=n[0],l=n[1];return 0!==e&&(s>=0&&l>s?e>(r=.4*(i=t-(a=s))+a)&&(change=i/(e-a),o=[s,s+(l-a)*change]):s<0&&l>0?(r=.4*(i=t-(a=0))+a,(t>=0&&e>r||t<0&&e<r)&&(change=i/(e-a),o=[s*change,l*change])):s<0&&l<0&&e<(r=.4*(i=t-(a=l))+a)&&(change=i/(e-a),o=[l+(s-a)*change,l])),o[0]=+o[0].toPrecision(5),o[1]=+o[1].toPrecision(5),o}},{}],2:[function(t,e,n){var i=t("./axis"),r=t("./i18n");e.exports=function(t,e,n){var o,a,s,l,u,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E,M,P,D,O,I,L,R,N,F,B,z,j,V,H,W,U,G,q,Y,X,Q,K,J,Z,tt,et,nt,it,rt,ot,at,st,lt,ut,ct,ht,dt,pt,ft,mt,gt,vt,yt,bt,_t,xt,wt,Ct,Tt,St,kt,At={},Et=function(t){return t?"#ccc":"#666"},Mt=function(t){return"translate("+w(t)+",0)"},Pt=function(t){return"translate(0,"+C(t)+")"},Dt=[],Ot=[],It={category:"medium",value:3,icon:120,tiny:240,small:480,medium:960,large:1920},Lt=NaN,Rt=NaN,Nt=null,Ft=null,Bt=[],zt=[],jt=[],Vt={showButtons:!0,buttonsStyle:"icons",buttonsLayout:"vertical",legendVisible:!1,responsiveLayout:!1,fontScaleRelativeToParent:!0,hideAxisValues:!1,enableAutoScaleButton:!0,enableAxisScaling:!0,enableZooming:!0,enableSelectionButton:!1,clearSelectionOnLeavingSelectMode:!1,enableDrawButton:!1,enableLegendButton:!0,titlePosition:"center",drawIndex:0,dataType:"points",dataPoints:[],dataSamples:[],sampleInterval:1,dataSampleStart:0,sortPoints:!0,title:"graph",xlabel:"x-axis",ylabel:"y-axis",xmax:10,xmin:0,ymax:10,ymin:0,autoScaleX:!0,autoScaleY:!0,autoScalePadding:.3,xTickCount:10,yTickCount:10,xFormatter:".3s",yFormatter:".3s",xscale:"linear",yscale:"linear",xscaleExponent:.5,yscaleExponent:.5,axisShift:10,markAllDataPoints:!1,markNearbyDataPoints:!1,extraCirclesVisibleOnHover:2,showRulersOnSelection:!1,lineWidth:2,dataChange:!1,addData:!1,notification:!1,lines:!0,bars:!1,onAutoscale:null,onXDomainChange:null,onYDomainChange:null,dataColors:["#a00000","#2ca000","#2c00a0"],legendLabels:[]},Ht={xmin:null,xmax:null,ymin:null,ymax:null},Wt=!1,Ut=!1,$t=!0,Gt=!1;function qt(t,n,i){switch(!n&&e||(e=function(t){if(t)for(var e in Vt)void 0===t[e]&&(t[e]=Vt[e]);else t=Vt;return t.axisShift<1&&(t.axisShift=1),t}(n)),e.lang&&(r.lang=e.lang),Yt(t,i),e.xrange=e.xmax-e.xmin,e.yrange=e.ymax-e.ymin,(Ot="[object Array]"===Object.prototype.toString.call(e.title)?e.title:[e.title]).reverse(),wt=e.sampleInterval,Ct=e.dataSampleStart,ft=e.lineWidth,h={width:120,height:120},function(){function t(t,e){var n=t.domain,i=t.nice;return t.domain=function(){var i=n.apply(t,arguments);return arguments.length&&e(),i},t.nice=function(){var n=i.apply(t,arguments);return e(),n},t}w=t(d3.scale[e.xscale](),(function(){e.xmin=w.domain()[0],e.xmax=w.domain()[1],e.onXDomainChange&&e.onXDomainChange.call(null,e.xmin,e.xmax)})),C=t(d3.scale[e.yscale](),(function(){e.ymin=C.domain()[0],e.ymax=C.domain()[1],e.onYDomainChange&&e.onYDomainChange.call(null,e.ymin,e.ymax)})),Jt()}(),E=d3.format(e.xFormatter),M=d3.format(e.yFormatter),k=function(t){var e=w.domain(),n=Math.abs(.01*(e[1]-e[0]));return Math.abs(0+t)<n&&(t=0),E(t)},A=function(t){var e=C.domain(),n=Math.abs(.01*(e[1]-e[0]));return Math.abs(0+t)<n&&(t=0),M(t)},T=e.xTickCount,S=e.yTickCount,vt=bt=1/0,yt=_t=-1/0,mt=[],e.dataType){case"fake":o=e.yrange/2,a=o/2,e.datacount=h.width/30,e.xtic=e.xrange/e.datacount,e.ytic=e.yrange/e.datacount,zt=d3.range(e.datacount).map((function(t){return[t*e.xtic+e.xmin,e.ymin+a+Math.random()*o]})),mt=[zt];break;case"points":Je(e.dataPoints);break;case"samples":Ze(e.dataSamples,wt,Ct)}var o,a;Bt=[],Ft=null,ee(zt.length)}function Yt(t,i){t&&(o=d3.select(t),a=o.node(),s=$(a),l=o.property("clientWidth"),u=o.property("clientHeight")),i&&(n=i),void 0!==d&&(d.remove(),d=void 0),void 0!==R&&(R.remove(),R=void 0),void 0!==B&&(B.remove(),B=void 0),V=e.dataChange?"ns-resize":"crosshair",Xt(),Lt=NaN,Rt=NaN,Nt=null}function Xt(t,n){t||n?(l=t,a.style.width=l+"px",n?(u=n,a.style.height=u+"px"):(a.style.height="100%",n=o.property("clientHeight"),u=n,a.style.height=u+"px")):(l=Math.max(o.property("clientWidth"),60),u=Math.max(o.property("clientHeight"),60)),e.responsiveLayout?l<=It.icon?(It.category="icon",It.value=0):l<=It.tiny?(It.category="tiny",It.value=1):l<=It.small?(It.category="small",It.value=2):l<=It.medium?(It.category="medium",It.value=3):(It.category="large",It.value=4):(It.category="large",It.value=4)}function Qt(){var t=H;return e.title&&(t=1.8*U),"horizontal"===e.buttonsLayout&&(t+=1.3*H),t}function Kt(){switch(X=[H,H],Q=[2*H,H],void 0!==w&&(w.ticks(T).forEach((function(t){var e=i.numberWidth(o,l,u,G,k(t));e[0]>X[0]&&(X=e)})),C.ticks(S).forEach((function(t){var e=i.numberWidth(o,l,u,G,A(t));e[0]>Q[0]&&(Q=e)}))),K=X[0],Z=X[1],it=.6*K,rt=(et=(at=1.1*Z)+1.3*Z)-Z/3,J=Q[0],tt=Q[1],nt=(st=J+Z/4)+tt,ot=-(st+tt/4),e.hideAxisValues&&(rt-=1.3*Z,ot=-Y/4),It.value){case 0:c={top:W,right:W,bottom:1.25*q,left:1.25*Y};break;case 1:c={top:Qt(),right:W,bottom:1.25*q,left:1.25*Y};break;case 2:c={top:Qt(),right:it,bottom:e.hideAxisValues?1.25*q:1.25*G,left:e.hideAxisValues?1.25*Y:1.25*J},T=Math.max(6,e.xTickCount/2),S=Math.max(6,e.yTickCount/2);break;case 3:default:c={top:Qt(),right:it,bottom:e.hideAxisValues?1.25*q:e.xlabel?et:1.25*G,left:e.hideAxisValues?1.25*Y:e.ylabel?nt:J}}It.value>2?c.top+=(Ot.length-1)*It.value/3*It.value/3*H:Ot=[Ot[0]],h.width=Math.max(l-c.left-c.right,60),h.height=Math.max(u-c.top-c.bottom,60)}function Jt(){Zt(),te()}function Zt(){w.domain([e.xmin,e.xmax]).range([0,h.width])}function te(){C.domain([e.ymin,e.ymax]).range([h.height,0])}function ee(t){return"number"==typeof t?xt=t:"last"===t&&(xt=0,mt.forEach((function(t){t.length>xt&&(xt=t.length)}))),"number"!=typeof xt&&(xt=zt.length-1),xt}function ne(t,e,n){var i=0,r=[];for(e=e||1,n=n||0,i=0;i<t.length;i++)r.push([i*e+n,t[i]]);return r}function ie(){if((P=o.append("div")).attr("class","button-layer").style("z-index",3),e.enableLegendButton&&e.legendLabels.length>0&&((O=P.append("a")).attr({class:"graph-button legend",title:r.t("tooltips.legend")}).on("click",(function(){e.legendVisible=!e.legendVisible,je()})),"icons"===e.buttonsStyle?O.append("i").attr("class","icon-list-ul"):O.text(r.t("labels.legend"))),e.enableAutoScaleButton){var t=P.append("a");t.attr({class:"graph-button autoscale",title:r.t("tooltips.autoscale")}).on("click",(function(){De(!0),ce()})),"icons"===e.buttonsStyle?t.append("i").attr("class","icon-picture"):t.text(r.t("labels.autoscale"))}e.enableSelectionButton&&((I=P.append("a")).attr({class:"graph-button selection",title:r.t("tooltips.selection")}).on("click",(function(){Ie()})),"icons"===e.buttonsStyle?I.append("i").attr("class","icon-cut"):I.text(r.t("labels.selection"))),e.enableDrawButton&&((L=P.append("a")).attr({class:"graph-button draw",title:r.t("tooltips.draw")}).on("click",(function(){Wt&&Ut&&Ie(),ze(!Gt)})),"icons"===e.buttonsStyle?L.append("i").attr("class","icon-pencil"):L.text(r.t("labels.draw"))),re()}function re(){"vertical"===e.buttonsLayout?(P.style({top:c.top+.5*W+"px",right:c.right+.5*W+"px"}),P.classed("horizontal",!1)):"horizontal"===e.buttonsLayout&&(P.style({top:c.top-1.8*H+"px",width:c.left+h.width+"px"}),P.classed("horizontal",!0))}function oe(){d=o.append("svg").attr("width",l).attr("height",u).attr("class","graph").style("z-index",2),p=d.append("g").attr("transform","translate("+c.left+","+c.top+")"),(f=p.append("rect").attr("class","plot").attr("width",h.width).attr("height",h.height).attr("pointer-events","all").attr("fill","rgba(255,255,255,0)").on("mousemove",ve).on("mousedown",be).on("touchstart",be)).call(ue()),R=o.append("div").attr("class","background").style({width:h.width+"px",height:h.height+"px",top:c.top+"px",left:c.left+"px","z-index":0}),B=o.append("canvas"),z=B.node(),Ve(),m=p.append("svg").attr("class","viewbox").attr("top",0).attr("left",0).attr("width",h.width).attr("height",h.height).attr("viewBox","0 0 "+h.width+" "+h.height),b=m.append("line").attr("stroke",Et).attr("stroke-dasharray","2,2").attr("y1",0).attr("y2",h.height).attr("x1",(function(){return null===Ft?0:Ft[0]})).attr("x2",(function(){return null===Ft?0:Ft[0]})).attr("class","ruler hidden"),_=m.append("line").attr("stroke",Et).attr("stroke-dasharray","2,2").attr("x1",0).attr("x2",h.width).attr("y1",(function(){return null===Ft?0:Ft[1]})).attr("y2",(function(){return null===Ft?0:Ft[1]})).attr("class","ruler hidden"),ut=d.append("rect").attr("class","axis axis-y"+(e.enableAxisScaling?" axis-draggable":"")).attr("x",c.left-st).attr("y",c.top).attr("rx",tt/6).attr("width",st).attr("height",h.height).attr("pointer-events","all").on("mousedown",Ae).on("touchstart",Ae),ht=ut.append("title"),lt=d.append("rect").attr("class","axis axis-x"+(e.enableAxisScaling?" axis-draggable":"")).attr("x",c.left).attr("y",h.height+c.top).attr("rx",tt/6).attr("width",h.width).attr("height",at).attr("pointer-events","all").on("mousedown",ke).on("touchstart",ke),ct=lt.append("title"),It.value<=2&&e.ylabel&&ct.text(e.xlabel),It.catefory&&e.ylabel&&ht.text(e.ylabel),le(),St=m.append("g").attr("class","brush"),It.value>2&&(v=p.append("text").attr("class","axis").attr("class","xlabel").text(e.xlabel).attr("x",h.width/2).attr("y",h.height).attr("dy",rt+"px").style("text-anchor","middle")),It.value>2&&(y=p.append("g").append("text").attr("class","axis").attr("class","ylabel").text(e.ylabel).style("text-anchor","middle").attr("transform","translate("+ot+" "+h.height/2+") rotate(-90)"),"small"===It.category&&ut.append("title").text(e.ylabel)),e.title&&It.value>0?(N=d.append("rect").attr("class","title-background").attr("x",0).attr("y",0).attr("width",h.width+c.left).attr("height",c.top-.8*W),(g=d.selectAll("text").data(Ot,(function(t){return t}))).enter().append("text").attr("class","title").text((function(t){return t})).attr("x","center"===e.titlePosition?function(){return c.left+h.width/2-Math.min(h.width,se(this))/2}:"10px").attr("y",1.1*U).attr("dy",(function(t,e){return-e*U+"px"})),x=g.append("title").text("")):e.title&&(x=f.append("title").text(e.title)),d3.select(a).on("mousemove.drag",Me).on("touchmove.drag",Me).on("mouseup.drag",Pe).on("touchend.drag",Pe),F=p.append("text").attr("class","graph-notification").text(n).attr("x",h.width/2).attr("y",h.height/2).style("text-anchor","middle"),me(),ge()}function ae(){if(p.attr("width",l).attr("height",u).attr("transform","translate("+c.left+","+c.top+")"),f.attr("width",h.width).attr("height",h.height),R.style({width:h.width+"px",height:h.height+"px",top:c.top+"px",left:c.left+"px","z-index":0}),m.attr("top",0).attr("left",0).attr("width",h.width).attr("height",h.height).attr("viewBox","0 0 "+h.width+" "+h.height),ut.attr("x",c.left-st).attr("y",c.top-tt/2).attr("width",st).attr("height",h.height+tt),lt.attr("x",c.left).attr("y",h.height+c.top).attr("width",h.width).attr("height",at),le(),e.title&&It.value>0?(N.attr("x",0).attr("y",0).attr("width",h.width+c.left).attr("height",1.8*U-.8*W),g.attr("x","center"===e.titlePosition?function(){return c.left+h.width/2-Math.min(h.width,se(this))/2}:"10px").attr("y",1.1*U).attr("dy",(function(t,e){return-e*U+"px"})),x.text("")):e.title&&x.text(e.title),e.xlabel&&It.value>2?(v.attr("x",h.width/2).attr("y",h.height).attr("dy",rt+"px"),ct.text("")):ct.text(e.xlabel),e.ylabel&&It.value>2){var t=ot;y.attr("transform","translate("+t+" "+h.height/2+") rotate(-90)"),ht.text("")}else ht.text(e.ylabel);F.attr("x",h.width/2).attr("y",h.height/2),p.selectAll("g.x").remove(),p.selectAll("g.y").remove(),Wt&&Ut&&Be(),me(),ge(),Ve(),re()}function se(t){return t.getComputedTextLength?t.getComputedTextLength():100}function le(){It.value<=1?(lt.style({fill:"rgba(196, 196, 196, 0.2)"}),ut.style({fill:"rgba(196, 196, 196, 0.2)"})):(lt.style({fill:null}),ut.style({fill:null}))}function ue(){return e.enableZooming?d3.behavior.zoom().x(w).y(C).on("zoom",ce):function(){}}function ce(){Kt(),ae();var t=p.selectAll("g.x").data(w.ticks(T),String).attr("transform",Mt),n=t.enter().insert("g","a").attr("class","x").attr("transform",Mt);n.append("line").attr("stroke",Et).attr("y1",0).attr("y2",h.height),It.value>1&&!e.hideAxisValues&&n.append("text").attr("class","axis").attr("y",h.height).attr("dy",G+"px").attr("text-anchor","middle").text(k).on("mouseover",(function(){d3.select(this).style("font-weight","bold")})).on("mouseout",(function(){d3.select(this).style("font-weight","normal")})),t.exit().remove();var i=p.selectAll("g.y").data(C.ticks(S),String).attr("transform",Pt),r=i.enter().insert("g","a").attr("class","y").attr("transform",Pt).attr("background-fill","#FFEEB6");if(r.append("line").attr("stroke",Et).attr("x1",0).attr("x2",h.width),It.value>1){if("log"===e.yscale){var o=r[0].length;r=o>100?r.filter((function(t){return!!t.toString().match(/(\.[0]*|^)[1]/)})):o>50?r.filter((function(t){return!!t.toString().match(/(\.[0]*|^)[12]/)})):r.filter((function(t){return!!t.toString().match(/(\.[0]*|^)[125]/)}))}e.hideAxisValues||r.append("text").attr("class","axis").attr("x",-G/4+"px").attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(A).on("mouseover",(function(){d3.select(this).style("font-weight","bold")})).on("mouseout",(function(){d3.select(this).style("font-weight","normal")}))}i.exit().remove();var a={line:"line",bar:"rect"},s=p.selectAll("g.annotation").data(Dt);s.enter().append("g").attr("class","annotation").each((function(t,e){d3.select(this).append(a[t.type])})),s.each((function(t,e){d3.select(this.childNodes[0]).attr(function(t){switch(t.type){case"line":return{stroke:t.data.hasOwnProperty("stroke")?t.data.stroke:"#f00",x1:t.data.hasOwnProperty("x1")?w(t.data.x1):0,x2:t.data.hasOwnProperty("x2")?w(t.data.x2):h.width,y1:t.data.hasOwnProperty("y1")?C(t.data.y1):0,y2:t.data.hasOwnProperty("y2")?C(t.data.y2):h.height};case"bar":return{stroke:t.data.hasOwnProperty("stroke")?t.data.stroke:"#f00",fill:t.data.hasOwnProperty("stroke")?t.data.stroke:"#f00",x:t.data.hasOwnProperty("x1")?w(t.data.x1):0,y:t.data.hasOwnProperty("y2")?C(t.data.y2):0,width:t.data.hasOwnProperty("x2")?w(t.data.x2)-w(t.data.x1):h.width,height:t.data.hasOwnProperty("y1")?C(t.data.y1)-C(t.data.y2):h.height,"fill-opacity":.5}}return{}}(t)).call(ue())})),s.exit().remove(),f.call(ue()),he()}function he(t){ee(t),He(xt),me(),d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function de(t){ee(t),De()?ce():he(xt)}function pe(t){var e=[];return t===Ft&&e.push("selected"),0===e.length?null:e.join(" ")}function fe(){var t=w.domain(),e=w.range();dt=(e[1]-e[0])/(t[1]-t[0]),dt=Math.min(Math.max(dt,4),8),pt=dt/3}function me(){var t,n=null;e.markAllDataPoints&&It.value>1?n=(n=[]).concat.apply(n,mt):e.markNearbyDataPoints&&It.value>1&&(n=Bt.slice(0),null!==Ft&&-1===n.indexOf(Ft)&&n.push(Ft)),null!==n&&(fe(),(t=p.select("svg").selectAll("circle").data(n)).enter().append("circle").attr("class",pe).attr("cx",(function(t){return w(t[0])})).attr("cy",(function(t){return C(t[1])})).attr("r",dt).style("stroke-width",pt).style("cursor",V).on("mousedown.drag",Ee).on("touchstart.drag",Ee).append("title").text((function(t){return"( "+k(t[0])+", "+A(t[1])+" )"})),t.attr("class",pe).attr("cx",(function(t){return w(t[0])})).attr("cy",(function(t){return C(t[1])})).select("title").text((function(t){return"( "+k(t[0])+", "+A(t[1])+" )"})),t.exit().remove()),ge()}function ge(){e.showRulersOnSelection&&null!==Ft?(b.attr("y1",0).attr("y2",h.height).attr("x1",(function(){return null===Ft?0:w(Ft[0])})).attr("x2",(function(){return null===Ft?0:w(Ft[0])})).attr("class",(function(){return"ruler"+(null===Ft?" hidden":"")})),_.attr("x1",0).attr("x2",h.width).attr("y1",(function(){return null===Ft?0:C(Ft[1])})).attr("y2",(function(){return null===Ft?0:C(Ft[1])})).attr("class",(function(){return"ruler"+(null===Ft?" hidden":"")}))):(b.attr("class","ruler hidden"),_.attr("class","ruler hidden"))}function ve(){if(e.markNearbyDataPoints){var t,n,i,r,o,a=d3.mouse(p.node()),s=w.invert(Math.max(0,Math.min(h.width,a[0])));for(Bt=[],o=0;o<mt.length;o++)zt=mt[o],null!==(t=ye(s,o))&&((i=(n=zt.indexOf(t))-e.extraCirclesVisibleOnHover)<0&&(i=0),(r=n+(e.extraCirclesVisibleOnHover+1))>zt.length-1&&(r=zt.length),Bt=Bt.concat(zt.slice(i,r)));he()}}function ye(t,e){if(null==e&&(e=0),0===(zt=mt[e]).length)return null;for(var n,i,r,o,a=0,s=zt.length-1;a<s;)n=Math.floor((a+s)/2),zt[n][0]<t?a=n+1:s=n;return i=zt[n-1],r=zt[n],o=zt[n+1],void 0!==i&&Math.abs(i[0]-t)<=Math.abs(r[0]-t)?i:void 0===o||Math.abs(r[0]-t)<=Math.abs(o[0]-t)?r:o}function be(){var t;Gt?(d3.event.preventDefault(),xe(t=d3.mouse(p.node())),Lt=t[0],Rt=t[0],Nt=!1):e.enableAxisScaling&&(d3.event.preventDefault(),d3.select("body").style("cursor","move"),d3.event.altKey&&(f.style("cursor","nesw-resize"),d3.event.shiftKey&&e.addData?xe():(t=d3.mouse(p.node()),Lt=w.invert(t[0]),Rt=C.invert(t[1]),Nt=!1,d3.event.stopPropagation())))}function _e(t,e){jt.forEach((function(n){n.call(null,{action:t,point:e})}))}function xe(t){t||(t=d3.mouse(p.node()));var n,i=[],r=gt[e.drawIndex];zt=mt[e.drawIndex],i[0]=w.invert(Math.max(0,Math.min(h.width,t[0]))),i[1]=C.invert(Math.max(0,Math.min(h.height,t[1]))),zt.push(i),r.push(i),_e("added",i),Ke(zt),Ft=i,n=zt.indexOf(i),(xt==zt.length-2||xt>=n)&&xt++,zt=mt[0],he()}function we(t,e,n){return t<n&&n<=e}function Ce(t,e,n){return t<=n&&n<e}function Te(t,n){var i,r,o,a,s,l=t,u=n,c=!1,h=we;for(t>n&&(l=n,u=t,h=Ce),a=gt[e.drawIndex],i=0;i<a.length;i++)(r=a[i])&&h(l,u,r[0])&&(o=a[i].slice(),a[i][0]=null,a[i][1]=null,_e("removed",o),c=!0);c&&(Ke(s=Xe(a)),mt[e.drawIndex]=s,zt=mt[0],he())}function Se(){return!1}function ke(){if(e.enableAxisScaling){a.focus(),document.onselectstart=Se,d3.event.preventDefault();var t=d3.mouse(p.node());Lt=w.invert(t[0])}}function Ae(){if(e.enableAxisScaling){a.focus(),d3.event.preventDefault(),document.onselectstart=Se;var t=d3.mouse(p.node());Rt=C.invert(t[1])}}function Ee(t){a.focus(),d3.event.preventDefault(),document.onselectstart=Se,Ft=Nt=Ft===t?null:t,he()}function Me(){var t,n,r,o,a,s,l,u,c=d3.mouse(p.node());document.onselectstart=function(){return!0},d3.event.preventDefault(),Nt&&(e.dataChange?Nt[1]=C.invert(Math.max(0,Math.min(h.height,c[1]))):(mt.forEach((function(e){var i=e.indexOf(Nt);-1!==i&&(t=e,n=i)})),n&&n<t.length-1&&(r=w.invert(c[0]),o=Nt[0],a=t[n+1],l=o-(o-(s=t[n-1])[0])/2,u=o+(a[0]-o)/2,r<l?Ft=Nt=s:r>u&&(Ft=Nt=a))),he()),!Gt||isNaN(Lt)||isNaN(Rt)?(isNaN(Lt)||(d3.select("body").style("cursor","col-resize"),f.style("cursor","col-resize"),w.domain(i.axisProcessDrag(Lt,w.invert(c[0]),w.domain())),fe(),ce(),d3.event.stopPropagation()),isNaN(Rt)||(d3.select("body").style("cursor","row-resize"),f.style("cursor","row-resize"),C.domain(i.axisProcessDrag(Rt,C.invert(c[1]),C.domain())),ce(),d3.event.stopPropagation())):(function(t){var e=w.invert(t[0]),n=C.invert(t[1]),i=w.domain()[0],r=w.domain()[1],o=C.domain()[0],a=C.domain()[1];return e>=i&&e<=r&&n>=o&&n<=a}(c)?(Te(w.invert(Math.max(0,Math.min(h.width,Lt))),w.invert(Math.max(0,Math.min(h.width,c[0])))),xe(c),Lt=c[0],Rt=c[0]):Pe(),d3.event.stopPropagation())}function Pe(){d3.select("body").style("cursor","auto"),f.style("cursor","auto"),document.onselectstart=function(){return!0},isNaN(Lt)||(ce(),Lt=NaN),isNaN(Rt)||(ce(),Rt=NaN),Nt=null}function De(t){var n,i,r,o=-1/0;if(mt.forEach((function(t){t.length>o&&(o=t.length)})),o>1){if(e.autoScaleX||t){var a=t?.05:e.autoScalePadding;n=Oe("x",vt,yt,a,t)}if(e.autoScaleY||t){var s=t?.05:e.autoScalePadding;i=Oe("y",bt,_t,s,t)}r=n||i}else r=void 0;return t&&e.onAutoscale&&e.onAutoscale.call(null),r}function Oe(t,n,i,r,o){if(n===i)return!1;var a,s="x"===t?w:C,l=s.domain()[0],u=s.domain()[1],c=!1,h=function(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)};switch(e[t+"scale"]){case"linear":a=function(t){return t};break;case"log":n=Math.log(n)/Math.log(10),i=Math.log(i)/Math.log(10),a=function(t){return Math.pow(10,t)};break;case"pow":var d=e[t+"scaleExponent"];n=h(n,d),i=h(i,d),a=function(t){return h(t,1/d)}}var p=(i-n)*r;return(i>u||o)&&(u=i+p,c=!0),(n<l||o)&&(l=n-p,c=!0),c&&s.domain([a(l),a(u)]).nice(),c}function Ie(){ze(!1),Re()||(Ne(!1),Re(!0)),Ne()?((e.clearSelectionOnLeavingSelectMode||Le()===[])&&Le(null),Ne(!1)):(null==Le()&&Le([]),Ne(!0))}function Le(t){return arguments.length?(null===t?Wt=!1:0===t.length?(Wt=!0,Ht.xmin=1/0,Ht.xmax=1/0):(Wt=!0,Ht.xmin=t[0],Ht.xmax=t[1]),Be(),Tt&&Tt(Le()),At):Wt?Ht.xmax===1/0&&Ht.xmin===1/0?[]:[Ht.xmin,Ht.xmax]:null}function Re(t){return arguments.length?(Ut!==(t=!!t)&&(Ut=t,Be()),At):Ut}function Ne(t){return arguments.length?($t!==(t=!!t)&&($t=t,I&&(t?I.classed("active",!0):I.classed("active",!1)),Be()),At):$t}function Fe(){var t;$t&&Le((t=kt.extent())[0]!==t[1]?t:[])}function Be(){Wt&&Ut?(kt=kt||d3.svg.brush().x(w).extent([Ht.xmin||0,Ht.xmax||0]).on("brush",Fe),St.call(kt.extent([Ht.xmin||0,Ht.xmax||0])).style("display","inline").style("pointer-events",$t?"all":"none").selectAll("rect").attr("height",h.height)):St.style("display","none")}function ze(t){return arguments.length?(Gt!==(t=!!t)&&(Gt=t,L&&(t?L.classed("active",!0):L.classed("active",!1))),At):Gt}function je(){return O&&(e.legendVisible?O.classed("active",!0):O.classed("active",!1)),D&&(e.legendVisible?(D.classed("legend-invisible",!1),D.style({top:c.top+W+"px",right:c.right+W+(e.showButtons&&"vertical"===e.buttonsLayout?P.property("clientWidth"):0)+"px"})):D.classed("legend-invisible",!0)),At}function Ve(){B.attr("class","overlay").style({position:"absolute",width:h.width+"px",height:h.height+"px",top:c.top+"px",left:c.left+"px","z-index":1}),(z=B.node()).width=h.width,z.height=h.height,z.top=c.top,z.left=c.left,z.getContext&&((j=z.getContext("2d")).globalCompositeOperation="source-over",j.lineWidth=ft,j.fillStyle="rgba(255,255,255, 0.0)",j.fillRect(0,0,z.width,z.height),j.strokeStyle="rgba(255,65,0, 1.0)",j.globalAlpha=1),He(xt)}function He(t){var n,i,r,o,a,s,l,u,c,h,d,p,f=C(1e-5),m=e.lines,g=e.bars,v=mt.length;if(void 0!==z.getContext)if(ee(t),z.getContext&&(z.width=z.width,j.lineWidth=ft,j.fillStyle="rgba(255,255,255, 0.0)",j.fillRect(0,0,z.width,z.height),j.strokeStyle="rgba(255,65,0, 1.0)",j.globalAlpha=1),j.fillRect(0,0,z.width,z.height),j.lineWidth=ft,c=w.domain()[0],h=w.domain()[1],p=Math.max(0,c),m){for(n=0;n<v;n++)if(0!==(u=(zt=mt[n]).length))if(1!==u){for(l=0,i=0;i<u&&!(null!=zt[i][0]&&null!=zt[i][1]&&zt[i][0]>=c);i++)l++;if(!(l>=u)){for(l>0&&l--,a=w(zt[l][0]),s=C(zt[l][1]),We(n),j.beginPath(),j.moveTo(a,s),o=zt[l][0],l++,r=Math.min(t,u);l<r&&!(null!=zt[l][0]&&null!=zt[l][1]&&(o=zt[l][0],a=w(o),s=C(zt[l][1]),j.lineTo(a,s),o>=h));l++);if(j.stroke(),l<u&&o<h){for(We(n,!0),j.lineWidth=ft/2;l<u&&!(null!=zt[l][0]&&null!=zt[l][1]&&(o=zt[l][0],a=w(o),s=C(zt[l][1]),j.lineTo(a,s),o>=h));l++);j.stroke(),j.lineWidth=ft}}}else Ue(n),j.fillRect(w(zt[0][0]),C(zt[0][1]),ft,ft)}else if(g)for(n=0;n<v;n++){for(u=(zt=mt[n]).length,We(n),d=t-1,l=p;l<d;l++)null!=zt[l][0]&&null!=zt[l][1]&&(a=w(zt[l][0]),0!==(s=C(zt[l][1]))&&(j.beginPath(),j.moveTo(a,f),j.lineTo(a,s),j.stroke()));if(l<(d=zt.length-1))for(We(n,!0);l<d;l++)null!=zt[l][0]&&null!=zt[l][1]&&(a=w(zt[l][0]),s=C(zt[l][1]),j.beginPath(),j.moveTo(a,f),j.lineTo(a,s),j.stroke())}else for(n=0;n<v;n++){for(u=(zt=mt[n]).length,l=0,i=0;i<u&&!(null!=zt[i][0]&&null!=zt[i][1]&&zt[i][0]>=c);i++)l++;if(l>0&&--l,!(l>=u)){for(Ue(n),r=Math.min(t,u);l<r&&!(null!=zt[l][0]&&null!=zt[l][1]&&(o=zt[l][0],a=w(o),s=C(zt[l][1]),j.fillRect(a,s,ft,ft),o>=h));l++);if(l<u&&o<h)for(Ue(n,!0);l<u&&!(null!=zt[l][0]&&null!=zt[l][1]&&(o=zt[l][0],a=w(o),s=C(zt[l][1]),j.fillRect(a,s,ft,ft),o>=h));l++);}}}function We(t,e){j.strokeStyle=$e(t),j.globalAlpha=e?.5:1}function Ue(t,e){j.fillStyle=$e(t),j.globalAlpha=e?.4:1}function $e(t){var n=Math.min(t,e.dataColors.length-1);return n<0?"black":e.dataColors[n]}function Ge(t,e){return t[0]<e[0]?-1:t[0]>e[0]?1:0}function qe(t,n){if(e.sortPoints&&!(t.length<2))if(null!=n){var i=t[n],r=t[n-1],o=t[n+1];(r&&r[0]>i[0]||o&&i[0]>o[0])&&t.sort(Ge)}else t.sort(Ge)}function Ye(t){t[0]<vt&&(vt=t[0]),t[1]<bt&&(bt=t[1]),t[0]>yt&&(yt=t[0]),t[1]>_t&&(_t=t[1])}function Xe(t){var e=[];return t.forEach((function(t){null!=t&&null!=t[0]&&null!=t[1]&&e.push(t)})),e}function Qe(t){var e=[];return t.forEach((function(t,n){null!=t&&null!=t[0]&&null!=t[1]&&(e[n]=t)})),e}function Ke(t){var n=e.sortPoints;t.forEach((function(t,e,i){Ye(t),n&&e>0&&t[0]<i[e-1][0]&&(n=!1)})),!n&&e.sortPoints&&t.sort(Ge)}function Je(t){if(vt=bt=1/0,yt=_t=-1/0,mt=[],gt=[],t&&0!==t.length)if("[object Array]"===Object.prototype.toString.call(t[0]))for(var e=0;e<t.length;e++)mt.push(Xe(t[e])),gt.push(Qe(t[e])),Ke(mt[e]);else mt=[Xe(zt)],gt=[Qe(zt)],Ke(mt[0]);else mt=[[]],gt=[[]];zt=mt[0],De(),ee("last")}function Ze(t,e,n){if(vt=bt=1/0,yt=_t=-1/0,mt=[],"[object Array]"===Object.prototype.toString.call(t[0])){for(var i=0;i<t.length;i++)mt.push(ne(t[i],e,n)),mt[mt.length-1].forEach(Ye);zt=mt[0]}else zt=ne(t,e,n),mt=[zt],zt.forEach(Ye);wt=e,Ct=n}function tn(t,e){e||(e=0);var n,i=gt[e];zt.slice(),i.length&&(i[t].slice(),i[t][0]=null,i[t][1]=null,gt[e]=i,Ke(n=Xe(i)),mt[e]=n,xt>=zt.length&&(xt=zt.length-1)),zt=mt[0]}function en(){d.node().addEventListener("keydown",(function(t){if(!Ft)return!1;if("keydown"===t.type){switch(t.keyCode){case 8:case 46:if(e.dataChange){var n=zt.indexOf(Ft);tn(n),Ft=zt.length?zt[n>0?n-1:0]:null,he()}t.preventDefault(),t.stopPropagation()}t.preventDefault()}}))}function nn(){e.title&&g&&g.text(e.title),an()}function rn(){e.xlabel&&v&&v.text(e.xlabel),an()}function on(){e.ylabel&&y?y.text(e.ylabel):y.style("display","none"),an()}function an(){Xt(),H=parseFloat(s.css("font-size")),e.fontScaleRelativeToParent||s.css("font-size",.5+It.value/6+"em"),H=parseFloat(s.css("font-size")),W=H/2,void 0===d?(U=H,G=H,q=H,Y=H):(U=parseFloat($("svg.graph text.title").css("font-size")),G=parseFloat($("svg.graph text.axis").css("font-size")),q=parseFloat($("svg.graph text.xlabel").css("font-size")),Y=parseFloat($("svg.graph text.ylabel").css("font-size"))),Kt(),Jt(),d3.svg.line().x((function(t,e){return w(zt[e][0])})).y((function(t,e){return C(zt[e][1])})),void 0===d?oe():ae(),e.showButtons&&(P||ie()),e.legendLabels.length>0&&(D||function(){var t,n="black";(D=o.append("ul")).attr("class","legend-layer").style("z-index",3);for(var i=0;i<e.legendLabels.length;i++)e.dataColors.length>i&&(n=e.dataColors[i]),(t=D.append("li")).append("div").attr("class","legend-colorsquare").style("background-color",n),t.append("label").text(e.legendLabels[i])}(),je()),ce()}return At={update:he,repaint:an,reset:function(t,e,n){return arguments.length?qt(t,e,n):qt(),P&&(P.remove(),P=null),an(),an(),ce(),en(),At},redraw:ce,resize:function(t,e){return Xt(t,e),Yt(),an(),ce(),At},notify:function(t){n=t,t?F.text(t):F.text("")},selectionDomain:Le,selectionVisible:Re,selectionListener:function(t){return arguments.length?(Tt=t,At):Tt},selectionEnabled:Ne,hasSelection:function(){return Wt},brushElement:function(){return St},brushControl:function(){return kt},brushListener:function(){return Fe},addPointListener:function(t){jt.push(t)},clearPointListeners:function(){jt.length=0},scale:Xt,updateOrRescale:de,xDomain:function(t){return arguments.length?(e.xmin=t[0],e.xmax=t[1],Zt&&(Zt(),ce()),At):[e.xmin,e.xmax]},yDomain:function(t){return arguments.length?(e.ymin=t[0],e.ymax=t[1],te&&(te(),ce()),At):[e.ymin,e.ymax]},xmin:function(t){return arguments.length?(e.xmin=t,e.xrange=e.xmax-e.xmin,Zt&&(Zt(),ce()),At):e.xmin},xmax:function(t){return arguments.length?(e.xmax=t,e.xrange=e.xmax-e.xmin,Zt&&(Zt(),ce()),At):e.xmax},ymin:function(t){return arguments.length?(e.ymin=t,e.yrange=e.ymax-e.ymin,te&&(te(),ce()),At):e.ymin},ymax:function(t){return arguments.length?(e.ymax=t,e.yrange=e.ymax-e.ymin,te&&(te(),ce()),At):e.ymax},xLabel:function(t){return arguments.length?(e.xlabel=t,rn(),At):e.xlabel},yLabel:function(t){return arguments.length?(e.ylabel=t,on(),At):e.ylabel},title:function(t){return arguments.length?(e.title=t,nn(),At):e.title},width:function(t){return arguments.length?(h.width=t,At):h.width},height:function(t){return arguments.length?(h.height=t,At):h.height},elem:function(t){return arguments.length?(qt(o=d3.select(t)),At):o},numberOfPoints:function(){return!!zt&&zt.length},addAnnotation:function(t){Dt.push(t),ce()},resetAnnotations:function(){Dt.length=0,ce()},autoscale:function(){De(!0)},addPoints:function(t){!function(t){for(var e,n,i,r=0,o=t.length;r<o;r++)null!=t[r]&&(n=mt[r],i=gt[r],null!=n&&null!=i||(n=mt[r]=[],i=gt[r]=[]),e=t[r],n.push(e),i.push(e),Ye(e),qe(n,n.length-1))}(t),ee("last"),de()},replacePoints:function(t,e){!function(t,e){for(var n,i,r,o,a=!1,s=0,l=t.length;s<l;s++)null!=t[s]&&(r=mt[s],o=gt[s],null!=r&&null!=o||(r=mt[s]=[],o=gt[s]=[]),n=o[e],i=t[s],null==n?(r.push(i),o[e]=i,qe(r,r.length-1),Ye(i)):(n[0]=i[0],n[1]=i[1],qe(r),a=!0));a&&(vt=bt=1/0,yt=_t=-1/0,mt.forEach((function(t){t.forEach(Ye)})))}(t,e),ee("last"),de()},addPoint:function(t){zt.push(t),ee("last"),de()},resetPoints:Je,deletePoint:function(t,e){tn(t,e),he()},addSamples:function(t){!function(t){var e,n;if("[object Array]"===Object.prototype.toString.call(t[0])){for(n=0;n<t.length;n++)mt[n]||mt.push([]),zt=mt[n],e=zt.length*wt+Ct,zt.push.apply(zt,ne(t[n],wt,e)),mt[n]=zt,zt.forEach(Ye);zt=mt[0]}else{var i;for(n=0;n<t.length;n++)mt[n]||mt.push([]),e=mt[n].length*wt+Ct,i=[e,t[n]],mt[n].push(i),Ye(i)}}(t),ee("last"),de()},addSample:function(t){var e=[zt.length*wt+Ct,t];zt.push(e),ee("last"),de()},resetSamples:function(t){Ze(t,wt,Ct)}},qt(t,e,n),a&&(an(),an()),At}},{"./axis":1,"./i18n":3}],3:[function(t,e,n){function i(t,n){for(var i=e.exports.translations,r=n.split("."),o=i[t],a=0,s=r[a];s&&"object"==typeof o;)o=o[s],s=r[++a];return o}e.exports.translations=t("../locales/translations.json"),e.exports.lang="en-US",e.exports.fallback="en-US",e.exports.t=function(t){var n=e.exports.lang;return i(n,t)||i(n.split("-")[0],t)||i(n.split("_")[0],t)||i(e.exports.fallback,t)||t}},{"../locales/translations.json":4}],4:[function(t,e,n){e.exports={"en-US":{labels:{autoscale:"Zoom",draw:"Draw",selection:"Select",legend:"Key"},tooltips:{autoscale:"Show all data (autoscale)",draw:"Draw new data points",selection:"Select data for export",legend:"Show/hide the legend"}},it:{labels:{autoscale:"Zoom",draw:"Disegnare",selection:"Selezionare",legend:"Chiave"},tooltips:{autoscale:"Mostra tutti i dati (autoscala)",draw:"Disegnare nuovi punti dati",selection:"Seleziona i dati per l'esportazione",legend:"Mostra / nascondi la leggenda"}},es:{labels:{autoscale:"Zoom",draw:"Graficar",selection:"Elegir",legend:"Leyenda"},tooltips:{autoscale:"Mostrar todos los datos (autoescala)",draw:"Graficar nuevos puntos",selection:"Seleccionar datos para exportar",legend:"Mostrar/Ocultar la leyenda"}},pl:{labels:{autoscale:"Przybliż",draw:"Rysuj",selection:"Zaznacz",legend:"Legenda"},tooltips:{autoscale:"Pokaż cały wykres (autoskalowanie)",draw:"Rysuj nowe punkty",selection:"Zaznacz dane do wyeksportowania",legend:"Pokaż/ukryj legendę"}},ru:{labels:{autoscale:"Масштабировать",draw:"Рисовать",selection:"Выбрать",legend:"Ключ"},tooltips:{autoscale:"Показать все данные (автоматическое масштабированиe)",draw:"Показать новые данные",selection:"Выбрать данные для экспорта",legend:"Показать/скрыть описание"}}}},{}],5:[function(t,e,n){e.exports=t("./lib/graph"),e.exports.i18n=t("./lib/i18n")},{"./lib/graph":2,"./lib/i18n":3}]},{},[5])(5)},23:function(t,e,n){(function(i){var r,o,a;a="object"==typeof self&&self.self===self&&self||"object"==typeof i&&i.global===i&&i,r=[n(5),n(57),e],void 0===(o=function(t,e,n){a.Backbone=function(t,e,n,i){var r=t.Backbone,o=Array.prototype.slice;e.VERSION="1.4.0",e.$=i,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a,s=e.Events={},l=/\s+/,u=function(t,e,i,r,o){var a,s=0;if(i&&"object"==typeof i){void 0!==r&&"context"in o&&void 0===o.context&&(o.context=r);for(a=n.keys(i);s<a.length;s++)e=u(t,e,a[s],i[a[s]],o)}else if(i&&l.test(i))for(a=i.split(l);s<a.length;s++)e=t(e,a[s],r,o);else e=t(e,i,r,o);return e};s.on=function(t,e,n){return this._events=u(c,this._events||{},t,e,{context:n,ctx:this,listening:a}),a&&((this._listeners||(this._listeners={}))[a.id]=a,a.interop=!1),this},s.listenTo=function(t,e,i){if(!t)return this;var r=t._listenId||(t._listenId=n.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),s=a=o[r];s||(this._listenId||(this._listenId=n.uniqueId("l")),s=a=o[r]=new g(this,t));var l=h(t,e,i,this);if(a=void 0,l)throw l;return s.interop&&s.on(e,i),this};var c=function(t,e,n,i){if(n){var r=t[e]||(t[e]=[]),o=i.context,a=i.ctx,s=i.listening;s&&s.count++,r.push({callback:n,context:o,ctx:o||a,listening:s})}return t},h=function(t,e,n,i){try{t.on(e,n,i)}catch(t){return t}};s.off=function(t,e,n){return this._events?(this._events=u(d,this._events,t,e,{context:n,listeners:this._listeners}),this):this},s.stopListening=function(t,e,i){var r=this._listeningTo;if(!r)return this;for(var o=t?[t._listenId]:n.keys(r),a=0;a<o.length;a++){var s=r[o[a]];if(!s)break;s.obj.off(e,i,this),s.interop&&s.off(e,i)}return n.isEmpty(r)&&(this._listeningTo=void 0),this};var d=function(t,e,i,r){if(t){var o,a=r.context,s=r.listeners,l=0;if(e||a||i){for(o=e?[e]:n.keys(t);l<o.length;l++){var u=t[e=o[l]];if(!u)break;for(var c=[],h=0;h<u.length;h++){var d=u[h];if(i&&i!==d.callback&&i!==d.callback._callback||a&&a!==d.context)c.push(d);else{var p=d.listening;p&&p.off(e,i)}}c.length?t[e]=c:delete t[e]}return t}for(o=n.keys(s);l<o.length;l++)s[o[l]].cleanup()}};s.once=function(t,e,n){var i=u(p,{},t,e,this.off.bind(this));return"string"==typeof t&&null==n&&(e=void 0),this.on(i,e,n)},s.listenToOnce=function(t,e,n){var i=u(p,{},e,n,this.stopListening.bind(this,t));return this.listenTo(t,i)};var p=function(t,e,i,r){if(i){var o=t[e]=n.once((function(){r(e,o),i.apply(this,arguments)}));o._callback=i}return t};s.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),i=0;i<e;i++)n[i]=arguments[i+1];return u(f,this._events,t,void 0,n),this};var f=function(t,e,n,i){if(t){var r=t[e],o=t.all;r&&o&&(o=o.slice()),r&&m(r,i),o&&m(o,[e].concat(i))}return t},m=function(t,e){var n,i=-1,r=t.length,o=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}},g=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};g.prototype.on=s.on,g.prototype.off=function(t,e){var n;this.interop?(this._events=u(d,this._events,t,e,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=0===this.count),n&&this.cleanup()},g.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},s.bind=s.on,s.unbind=s.off,n.extend(e,s);var v=e.Model=function(t,e){var i=t||{};e||(e={}),this.preinitialize.apply(this,arguments),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{});var r=n.result(this,"defaults");i=n.defaults(n.extend({},r,i),r),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(v.prototype,s,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!n.iteratee(t,this)(this.attributes)},set:function(t,e,i){if(null==t)return this;var r;if("object"==typeof t?(r=t,i=e):(r={})[t]=e,i||(i={}),!this._validate(r,i))return!1;var o=i.unset,a=i.silent,s=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={});var u=this.attributes,c=this.changed,h=this._previousAttributes;for(var d in r)e=r[d],n.isEqual(u[d],e)||s.push(d),n.isEqual(h[d],e)?delete c[d]:c[d]=e,o?delete u[d]:u[d]=e;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!a){s.length&&(this._pending=i);for(var p=0;p<s.length;p++)this.trigger("change:"+s[p],this,u[s[p]],i)}if(l)return this;if(!a)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&n.clone(this.changed);var e,i=this._changing?this._previousAttributes:this.attributes,r={};for(var o in t){var a=t[o];n.isEqual(i[o],a)||(r[o]=a,e=!0)}return!!e&&r},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=n.extend({parse:!0},t);var e=this,i=t.success;return t.success=function(n){var r=t.parse?e.parse(n,t):n;if(!e.set(r,t))return!1;i&&i.call(t.context,e,n,t),e.trigger("sync",e,n,t)},U(this,t),this.sync("read",this,t)},save:function(t,e,i){var r;null==t||"object"==typeof t?(r=t,i=e):(r={})[t]=e;var o=(i=n.extend({validate:!0,parse:!0},i)).wait;if(r&&!o){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;var a=this,s=i.success,l=this.attributes;i.success=function(t){a.attributes=l;var e=i.parse?a.parse(t,i):t;if(o&&(e=n.extend({},r,e)),e&&!a.set(e,i))return!1;s&&s.call(i.context,a,t,i),a.trigger("sync",a,t,i)},U(this,i),r&&o&&(this.attributes=n.extend({},l,r));var u=this.isNew()?"create":i.patch?"patch":"update";"patch"!==u||i.attrs||(i.attrs=r);var c=this.sync(u,this,i);return this.attributes=l,c},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,r=t.wait,o=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(n){r&&o(),i&&i.call(t.context,e,n,t),e.isNew()||e.trigger("sync",e,n,t)};var a=!1;return this.isNew()?n.defer(t.success):(U(this,t),a=this.sync("delete",this,t)),r||o(),a},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||W();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1)}});var y=e.Collection=function(t,e){e||(e={}),this.preinitialize.apply(this,arguments),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},b={add:!0,remove:!0,merge:!0},_={add:!0,remove:!1},x=function(t,e,n){n=Math.min(Math.max(n,0),t.length);var i,r=Array(t.length-n),o=e.length;for(i=0;i<r.length;i++)r[i]=t[i+n];for(i=0;i<o;i++)t[i+n]=e[i];for(i=0;i<r.length;i++)t[i+o+n]=r[i]};n.extend(y.prototype,s,{model:v,preinitialize:function(){},initialize:function(){},toJSON:function(t){return this.map((function(e){return e.toJSON(t)}))},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,_))},remove:function(t,e){e=n.extend({},e);var i=!n.isArray(t);t=i?[t]:t.slice();var r=this._removeModels(t,e);return!e.silent&&r.length&&(e.changes={added:[],merged:[],removed:r},this.trigger("update",this,e)),i?r[0]:r},set:function(t,e){if(null!=t){(e=n.extend({},b,e)).parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var i=!n.isArray(t);t=i?[t]:t.slice();var r=e.at;null!=r&&(r=+r),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);var o,a,s=[],l=[],u=[],c=[],h={},d=e.add,p=e.merge,f=e.remove,m=!1,g=this.comparator&&null==r&&!1!==e.sort,v=n.isString(this.comparator)?this.comparator:null;for(a=0;a<t.length;a++){o=t[a];var y=this.get(o);if(y){if(p&&o!==y){var _=this._isModel(o)?o.attributes:o;e.parse&&(_=y.parse(_,e)),y.set(_,e),u.push(y),g&&!m&&(m=y.hasChanged(v))}h[y.cid]||(h[y.cid]=!0,s.push(y)),t[a]=y}else d&&(o=t[a]=this._prepareModel(o,e))&&(l.push(o),this._addReference(o,e),h[o.cid]=!0,s.push(o))}if(f){for(a=0;a<this.length;a++)h[(o=this.models[a]).cid]||c.push(o);c.length&&this._removeModels(c,e)}var w=!1,C=!g&&d&&f;if(s.length&&C?(w=this.length!==s.length||n.some(this.models,(function(t,e){return t!==s[e]})),this.models.length=0,x(this.models,s,0),this.length=this.models.length):l.length&&(g&&(m=!0),x(this.models,l,null==r?this.length:r),this.length=this.models.length),m&&this.sort({silent:!0}),!e.silent){for(a=0;a<l.length;a++)null!=r&&(e.index=r+a),(o=l[a]).trigger("add",o,this,e);(m||w)&&this.trigger("sort",this,e),(l.length||c.length||u.length)&&(e.changes={added:l,removed:c,merged:u},this.trigger("update",this,e))}return i?t[0]:t}},reset:function(t,e){e=e?n.clone(e):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var i=e.length;return n.isFunction(e)&&(e=e.bind(this)),1===i||n.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){var e=(t=n.extend({parse:!0},t)).success,i=this;return t.success=function(n){var r=t.reset?"reset":"set";i[r](n,t),e&&e.call(t.context,i,n,t),i.trigger("sync",i,n,t)},U(this,t),this.sync("read",this,t)},create:function(t,e){var i=(e=e?n.clone(e):{}).wait;if(!(t=this._prepareModel(t,e)))return!1;i||this.add(t,e);var r=this,o=e.success;return e.success=function(t,e,n){i&&r.add(t,n),o&&o.call(n.context,t,e,n)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},values:function(){return new C(this,T)},keys:function(){return new C(this,S)},entries:function(){return new C(this,k)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;(e=e?n.clone(e):{}).collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeModels:function(t,e){for(var n=[],i=0;i<t.length;i++){var r=this.get(t[i]);if(r){var o=this.indexOf(r);this.models.splice(o,1),this.length--,delete this._byId[r.cid];var a=this.modelId(r.attributes);null!=a&&delete this._byId[a],e.silent||(e.index=o,r.trigger("remove",r,this,e)),n.push(r),this._removeReference(r,e)}}return n},_isModel:function(t){return t instanceof v},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes);null!=n&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.modelId(t.attributes);null!=n&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if(e){if(("add"===t||"remove"===t)&&n!==this)return;if("destroy"===t&&this.remove(e,i),"change"===t){var r=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=e))}}this.trigger.apply(this,arguments)}});var w="function"==typeof Symbol&&Symbol.iterator;w&&(y.prototype[w]=y.prototype.values);var C=function(t,e){this._collection=t,this._kind=e,this._index=0},T=1,S=2,k=3;w&&(C.prototype[w]=function(){return this}),C.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t,e=this._collection.at(this._index);if(this._index++,this._kind===T)t=e;else{var n=this._collection.modelId(e.attributes);t=this._kind===S?n:[n,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var A=e.View=function(t){this.cid=n.uniqueId("view"),this.preinitialize.apply(this,arguments),n.extend(this,n.pick(t,M)),this._ensureElement(),this.initialize.apply(this,arguments)},E=/^(\S+)\s*(.*)$/,M=["model","collection","el","id","attributes","className","tagName","events"];n.extend(A.prototype,s,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=n.result(this,"events")),!t)return this;for(var e in this.undelegateEvents(),t){var i=t[e];if(n.isFunction(i)||(i=this[i]),i){var r=e.match(E);this.delegate(r[1],r[2],i.bind(this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}});var P=function(t,e,i,r){n.each(i,(function(n,i){e[i]&&(t.prototype[i]=function(t,e,n,i){switch(e){case 1:return function(){return t[n](this[i])};case 2:return function(e){return t[n](this[i],e)};case 3:return function(e,r){return t[n](this[i],D(e,this),r)};case 4:return function(e,r,o){return t[n](this[i],D(e,this),r,o)};default:return function(){var e=o.call(arguments);return e.unshift(this[i]),t[n].apply(t,e)}}}(e,n,i,r))}))},D=function(t,e){return n.isFunction(t)?t:n.isObject(t)&&!e._isModel(t)?O(t):n.isString(t)?function(e){return e.get(t)}:t},O=function(t){var e=n.matches(t);return function(t){return e(t.attributes)}};n.each([[y,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"],[v,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes"]],(function(t){var e=t[0],i=t[1],r=t[2];e.mixin=function(t){var i=n.reduce(n.functions(t),(function(t,e){return t[e]=0,t}),{});P(e,t,i,r)},P(e,n,i,r)})),e.sync=function(t,i,r){var o=I[t];n.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:o,dataType:"json"};if(r.url||(a.url=n.result(i,"url")||W()),null!=r.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",r.emulateJSON&&(a.data._method=o);var s=r.beforeSend;r.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),s)return s.apply(this,arguments)}}"GET"===a.type||r.emulateJSON||(a.processData=!1);var l=r.error;r.error=function(t,e,n){r.textStatus=e,r.errorThrown=n,l&&l.call(r.context,t,e,n)};var u=r.xhr=e.ajax(n.extend(a,r));return i.trigger("request",i,u,r),u};var I={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var L=e.Router=function(t){t||(t={}),this.preinitialize.apply(this,arguments),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},R=/\((.*?)\)/g,N=/(\(\?)?:\w+/g,F=/\*\w+/g,B=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(L.prototype,s,{preinitialize:function(){},initialize:function(){},route:function(t,i,r){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return e.history.route(t,(function(n){var a=o._extractParameters(t,n);!1!==o.execute(r,a,i)&&(o.trigger.apply(o,["route:"+i].concat(a)),o.trigger("route",i,a),e.history.trigger("route",o,i,a))})),this},execute:function(t,e,n){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(B,"\\$&").replace(R,"(?:$1)?").replace(N,(function(t,e){return e?t:"([^/?]+)"})).replace(F,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,(function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null}))}});var z=e.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},j=/^[#\/]|\s+$/g,V=/^\/+|\/+$/g,H=/#.*$/;z.started=!1,n.extend(z.prototype,s,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(j,"")},start:function(t){if(z.started)throw new Error("Backbone.history has already been started");if(z.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(V,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,r=i.insertBefore(this.iframe,i.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var o=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),z.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),n.some(this.handlers,(function(e){if(e.route.test(t))return e.callback(t),!0})))},navigate:function(t,e){if(!z.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var n=this.root;""!==t&&"?"!==t.charAt(0)||(n=n.slice(0,-1)||"/");var i=n+t;t=t.replace(H,"");var r=this.decodeFragment(t);if(this.fragment!==r){if(this.fragment=r,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var o=this.iframe.contentWindow;e.replace||(o.document.open(),o.document.close()),this._updateHash(o.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new z,v.extend=y.extend=L.extend=A.extend=z.extend=function(t,e){var i,r=this;return i=t&&n.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,e),i.prototype=n.create(r.prototype,t),i.prototype.constructor=i,i.__super__=r.prototype,i};var W=function(){throw new Error('A "url" property or function must be specified')},U=function(t,e){var n=e.error;e.error=function(i){n&&n.call(e.context,t,i,e),t.trigger("error",t,i,e)}};return e}(a,n,t,e)}.apply(e,r))||(t.exports=o)}).call(this,n(15))},24:function(t,e,n){t.exports=function(){"use strict";var t=Object.prototype.toString,e=Array.isArray||function(e){return"[object Array]"===t.call(e)};function n(t){return"function"==typeof t}function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(t,e){return null!=t&&"object"==typeof t&&e in t}var o=RegExp.prototype.test,a=/\S/;function s(t){return!function(t,e){return o.call(t,e)}(a,t)}var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},u=/\s*/,c=/\s+/,h=/\s*=/,d=/\s*\}/,p=/#|\^|\/|>|\{|&|=|!/;function f(t){this.string=t,this.tail=t,this.pos=0}function m(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function g(){this.templateCache={_cache:{},set:function(t,e){this._cache[t]=e},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}f.prototype.eos=function(){return""===this.tail},f.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},f.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},m.prototype.push=function(t){return new m(t,this)},m.prototype.lookup=function(t){var e,i,o,a=this.cache;if(a.hasOwnProperty(t))e=a[t];else{for(var s,l,u,c=this,h=!1;c;){if(t.indexOf(".")>0)for(s=c.view,l=t.split("."),u=0;null!=s&&u<l.length;)u===l.length-1&&(h=r(s,l[u])||(i=s,o=l[u],null!=i&&"object"!=typeof i&&i.hasOwnProperty&&i.hasOwnProperty(o))),s=s[l[u++]];else s=c.view[t],h=r(c.view,t);if(h){e=s;break}c=c.parent}a[t]=e}return n(e)&&(e=e.call(this.view)),e},g.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},g.prototype.parse=function(t,n){var r=this.templateCache,o=t+":"+(n||v.tags).join(":"),a=void 0!==r,l=a?r.get(o):void 0;return null==l&&(l=function(t,n){if(!t)return[];var r,o,a,l=!1,m=[],g=[],y=[],b=!1,_=!1,x="",w=0;function C(){if(b&&!_)for(;y.length;)delete g[y.pop()];else y=[];b=!1,_=!1}function T(t){if("string"==typeof t&&(t=t.split(c,2)),!e(t)||2!==t.length)throw new Error("Invalid tags: "+t);r=new RegExp(i(t[0])+"\\s*"),o=new RegExp("\\s*"+i(t[1])),a=new RegExp("\\s*"+i("}"+t[1]))}T(n||v.tags);for(var S,k,A,E,M,P,D=new f(t);!D.eos();){if(S=D.pos,A=D.scanUntil(r))for(var O=0,I=A.length;O<I;++O)s(E=A.charAt(O))?(y.push(g.length),x+=E):(_=!0,l=!0,x+=" "),g.push(["text",E,S,S+1]),S+=1,"\n"===E&&(C(),x="",w=0,l=!1);if(!D.scan(r))break;if(b=!0,k=D.scan(p)||"name",D.scan(u),"="===k?(A=D.scanUntil(h),D.scan(h),D.scanUntil(o)):"{"===k?(A=D.scanUntil(a),D.scan(d),D.scanUntil(o),k="&"):A=D.scanUntil(o),!D.scan(o))throw new Error("Unclosed tag at "+D.pos);if(M=">"==k?[k,A,S,D.pos,x,w,l]:[k,A,S,D.pos],w++,g.push(M),"#"===k||"^"===k)m.push(M);else if("/"===k){if(!(P=m.pop()))throw new Error('Unopened section "'+A+'" at '+S);if(P[1]!==A)throw new Error('Unclosed section "'+P[1]+'" at '+S)}else"name"===k||"{"===k||"&"===k?_=!0:"="===k&&T(A)}if(C(),P=m.pop())throw new Error('Unclosed section "'+P[1]+'" at '+D.pos);return function(t){for(var e,n=[],i=n,r=[],o=0,a=t.length;o<a;++o)switch((e=t[o])[0]){case"#":case"^":i.push(e),r.push(e),i=e[4]=[];break;case"/":r.pop()[5]=e[2],i=r.length>0?r[r.length-1][4]:n;break;default:i.push(e)}return n}(function(t){for(var e,n,i=[],r=0,o=t.length;r<o;++r)(e=t[r])&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(i.push(e),n=e));return i}(g))}(t,n),a&&r.set(o,l)),l},g.prototype.render=function(t,e,n,i){var r=this.parse(t,i),o=e instanceof m?e:new m(e,void 0);return this.renderTokens(r,o,n,t,i)},g.prototype.renderTokens=function(t,e,n,i,r){for(var o,a,s,l="",u=0,c=t.length;u<c;++u)s=void 0,"#"===(a=(o=t[u])[0])?s=this.renderSection(o,e,n,i):"^"===a?s=this.renderInverted(o,e,n,i):">"===a?s=this.renderPartial(o,e,n,r):"&"===a?s=this.unescapedValue(o,e):"name"===a?s=this.escapedValue(o,e):"text"===a&&(s=this.rawValue(o)),void 0!==s&&(l+=s);return l},g.prototype.renderSection=function(t,i,r,o){var a=this,s="",l=i.lookup(t[1]);if(l){if(e(l))for(var u=0,c=l.length;u<c;++u)s+=this.renderTokens(t[4],i.push(l[u]),r,o);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(t[4],i.push(l),r,o);else if(n(l)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(i.view,o.slice(t[3],t[5]),(function(t){return a.render(t,i,r)})))&&(s+=l)}else s+=this.renderTokens(t[4],i,r,o);return s}},g.prototype.renderInverted=function(t,n,i,r){var o=n.lookup(t[1]);if(!o||e(o)&&0===o.length)return this.renderTokens(t[4],n,i,r)},g.prototype.indentPartial=function(t,e,n){for(var i=e.replace(/[^ \t]/g,""),r=t.split("\n"),o=0;o<r.length;o++)r[o].length&&(o>0||!n)&&(r[o]=i+r[o]);return r.join("\n")},g.prototype.renderPartial=function(t,e,i,r){if(i){var o=n(i)?i(t[1]):i[t[1]];if(null!=o){var a=t[6],s=t[5],l=t[4],u=o;return 0==s&&l&&(u=this.indentPartial(o,l,a)),this.renderTokens(this.parse(u,r),e,i,u)}}},g.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return n},g.prototype.escapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return v.escape(n)},g.prototype.rawValue=function(t){return t[1]};var v={name:"mustache.js",version:"4.0.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){y.templateCache=t},get templateCache(){return y.templateCache}},y=new g;return v.clearCache=function(){return y.clearCache()},v.parse=function(t,e){return y.parse(t,e)},v.render=function(t,n,i,r){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+(e(o=t)?"array":typeof o)+'" was given as the first argument for mustache#render(template, view, partials)');var o;return y.render(t,n,i,r)},v.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,(function(t){return l[t]}))},v.Scanner=f,v.Context=m,v.Writer=g,v}()},26:function(t,e,n){"use strict";e.a={repo:{branch:"1.17.2",commit:{sha:"a0b4ec3d105e87d0beb4a0677b134429b02c22e8",short_sha:"a0b4ec3",url:"https://github.com/concord-consortium/lab/commit/a0b4ec3",author:"Chris Hart",email:"chart@concord.org",date:"2020-07-09 15:56:57 -0400",message:"Update version"},last_tag:"1.17.2",dirty:!1}}},27:function(t,e,n){t.exports={ParentEndpoint:n(118),getIFrameEndpoint:n(119),structuredClone:n(80),IframePhoneRpcEndpoint:n(203)}},28:function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var l,u=[],c=!1,h=-1;function d(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&p())}function p(){if(!c){var t=s(d);c=!0;for(var e=u.length;e;){for(l=u,u=[];++h<e;)l&&l[h].run();h=-1,e=u.length}l=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new f(t,e)),1!==u.length||c||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},3:function(t,e,n){"use strict";var i,r,o=n(12),a=n.n(o),s=a.a.unit,l=a.a.ratio,u=a.a.convert,c={ELEMENTARY_CHARGE:{value:1,unit:s.ELEMENTARY_CHARGE},ATOMIC_MASS:{value:1,unit:s.DALTON},BOLTZMANN_CONSTANT:{value:1380658e-29,unit:s.JOULES_PER_KELVIN},AVAGADRO_CONSTANT:{value:l(s.DALTON,{per:s.GRAM}),unit:s.INVERSE_MOLE},PERMITTIVITY_OF_FREE_SPACE:{value:8854187e-18,unit:s.FARADS_PER_METER}};c.COULOMB_CONSTANT={value:1/(4*Math.PI*c.PERMITTIVITY_OF_FREE_SPACE.value),unit:s.METERS_PER_FARAD};var h={};for(i in c)c.hasOwnProperty(i)&&(r=c[i],h[i]=function(t){return{as:function(e){return a.a.convert(t.value,{from:t.unit,to:e})}}}(r));h.unit=s,h.ratio=l,h.convert=u,e.a=h},33:function(t,e){$.fn.measure=function(t,e,n){var i,r,o;return(i=$(this).clone(!1)).css({visibility:"hidden",position:"absolute"}),i.appendTo(n),r=e?i.find(e):i,o=t.apply(r),i.remove(),o},$.fn.truncate=function(t){var e,n,i=$(this),r=$("<span>");if(r.text(i.text()),r.css({"font-size":i.css("font-size"),"font-weight":i.css("font-weight"),"white-space":"nowrap",visibility:"hidden"}),r.appendTo(i.parent()),(e=r.width())>t){for(n=r.text()+"...",r.text(n);e>t&&n.length>3;)n=r.text().slice(0,-4)+"...",r.text(n),e=r.width();i.attr("title",i.text()),i.text(n)}r.remove()},$.fn.alterClass=function(t,e){if(-1===t.indexOf("*"))return this.removeClass(t),e?this.addClass(e):this;var n=new RegExp("\\s"+t.replace(/\*/g,"[A-Za-z0-9-_]+").split(" ").join("\\s|\\s")+"\\s","g");return this.each((function(t,e){for(var i=" "+e.className+" ";n.test(i);)i=i.replace(n," ");e.className=$.trim(i)})),e?this.addClass(e):this},$.event.special.destroyed={remove:function(t){t.handler&&t.handler()}}},34:function(t,e,n){"use strict";var i=n(23),r=n.n(i).a.Model.extend({defaults:{value:0,secondValue:null,min:0,max:10,barWidth:"2em",height:"20em",title:"",titleOn:"right",barColor:"#e23c34",fillColor:"white",labels:10,units:"",gridLines:10,labelFormat:"0.1f"}});e.a=r},35:function(t,e,n){"use strict";n(33);var i=n(23),r=0,o=function(t){return t.node().getBBox().width},a=n.n(i).a.View.extend({tagName:"div",className:"bar-graph",initialize:function(){this.uid=r++,this.$topArea=$('<div class="top-area">').appendTo(this.$el),this.vis=d3.select(this.el).append("svg"),this.defs=this.vis.append("defs"),this.axisContainer=this.vis.append("g"),this.fill=this.vis.append("rect"),this.bar=this.vis.append("rect"),this.gridContainer=this.vis.append("g"),this.trianglePos=this.vis.append("g"),this.traingle=this.trianglePos.append("polygon"),this.titleContainer=this.vis.append("g"),this.yScale=d3.scale.linear(),this.heightScale=d3.scale.linear(),this.yAxis=d3.svg.axis(),this.scale=null,this.barWidth=null,this.$bottomArea=$('<div class="bottom-area">').appendTo(this.$el),this.model.on("change",this.modelChanged,this)},render:function(){var t,e,n,i=this.model.toJSON(),r=parseFloat(this.$el.css("font-size")),a=this.scale=function(t){var e=t/16;return function(t){return t*e}}(r),s=i.labels>0||i.labels.length>0,l=a(s?8:3),u=a(s?8:3),c=0;this.$el.outerHeight(i.height),this._setupHorizontalTitle(),this.svgHeight=this.$el.height()-this.$topArea.height()-this.$bottomArea.height(),this.vis.attr({width:600,height:this.svgHeight}),this.yScale.domain([i.min,i.max]).range([this.svgHeight-l,u]).clamp(!0),this.heightScale.domain([i.min,i.max]).range([0,this.svgHeight-l-u]).clamp(!0),this.axisContainer.selectAll("*").remove(),s&&(this.yAxis.scale(this.yScale).tickValues(null).tickPadding(0).tickSize(0,0,0).orient("left"),"number"==typeof i.labels?this.yAxis.ticks(i.labels).tickFormat((t=i.labelFormat,e=i.units,n=d3.format(t),function(t){return n(t)+" "+e})):function(t,e){var n,i,r=[],o={};for(n=0,i=e.length;n<i;n++)r[n]=e[n].value,o[r[n]]=e[n].label;t.tickValues(r).tickFormat((function(t){return o[t]}))}(this.yAxis,i.labels),this.axisContainer.call(this.yAxis),c+=o(this.axisContainer),this.axisContainer.attr("transform","translate("+c+")"),c+=a(5)),this.fill.attr({width:i.barWidth,height:this.heightScale(i.max),x:c,y:this.yScale(i.max),rx:"0.5em",ry:"0.5em",fill:this._getFillGradient(i.fillColor)}),this.bar.attr({width:i.barWidth,x:c,rx:"0.5em",ry:"0.5em",fill:this._getBarGradient(i.barColor)}),this.barWidth=o(this.fill),this.traingle.classed("triangle",!0).attr({points:"15,-7 15,7 1,0",transform:"translate("+c+") scale("+a(1)+")"}),this._setupGrid(c),c+=this.barWidth,c=this._setupTitle(c),this.vis.attr("width",c/r+"em"),this.$el.css("min-width",c/r+"em"),this.$el.css("min-width",c/r+.8+"em"),this.update()},update:function(){var t=this.model.get("value"),e=this.model.get("secondValue");this.bar.attr("height",this.heightScale(t)).attr("y",this.yScale(t)),null!=e?(this.traingle.classed("hidden",!1),this.trianglePos.attr("transform","translate(0,"+this.yScale(e)+")")):this.traingle.classed("hidden",!0)},modelChanged:function(){var t,e,n,i=this.model.changedAttributes(),r=0;for(n in i)if(i.hasOwnProperty(n)&&++r>2)return void this.render();t=void 0!==i.value,e=void 0!==i.secondValue,1===r&&(t||e)||2===r&&t&&e?this.update():this.render()},_getBarGradient:function(t){var e="bar-gradient-"+this.uid,n=this.defs.select("#"+e);return t=d3.rgb(t),n.empty()?n=this.defs.append("linearGradient").attr("id",e).attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%"):n.selectAll("stop").remove(),n.append("stop").attr("stop-color",t.brighter(2).toString()).attr("offset","0%"),n.append("stop").attr("stop-color",t.toString()).attr("offset","100%"),"url(#"+e+")"},_getFillGradient:function(t){var e="fill-gradient-"+this.uid,n=this.defs.select("#"+e);return n.empty()?n=this.defs.append("linearGradient").attr("id",e).attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%"):n.selectAll("stop").remove(),n.append("stop").attr("stop-color",t).attr("offset","0%"),n.append("stop").attr("stop-color",t).attr("stop-opacity",.5).attr("offset","15%"),n.append("stop").attr("stop-color",t).attr("stop-opacity",.4).attr("offset","100%"),"url(#"+e+")"},_setupGrid:function(t){var e=this.yScale.ticks(this.model.get("gridLines")),n=this.yScale,i=this.barWidth;return e.pop(),e.shift(),this.grid=this.gridContainer.selectAll(".grid-line").data(e,String),this.grid.enter().append("path").attr("class","grid-line"),this.grid.exit().remove(),this.grid.attr("d",(function(e){return"M "+t+" "+Math.round(n(e))+" h "+i})),t},_setupTitle:function(t){var e,n,i,r,o=this.model.get("title"),a=this;return o&&"right"===this.model.get("titleOn")&&(t+=this.scale(10),e=$.isArray(o),n=e?o.length:1,(i=this.titleContainer.selectAll(".title").data(e?o:[o])).exit().remove(),(r=i.enter().append("g").attr("class","title")).append("title"),r.append("text"),i.each((function(t,e){var i=d3.select(this);i.select("title").text(t),i.select("text").text(a._processTitle(t)).attr("dy",-(n-e-1)+"em")})),this.titleContainer.attr("transform","translate("+t+", "+this.svgHeight/2+") rotate(90)"),t+=parseFloat($(i.node()).css("font-size"))*n),t},_setupHorizontalTitle:function(){var t,e=this.model.get("title"),n=this.model.get("titleOn");this.$topArea.empty(),this.$bottomArea.empty(),e&&0!==e.length&&"right"!==n&&(e=$.isArray(e)?e:[e],"top"===n?t=this.$topArea:"bottom"===n&&(t=this.$bottomArea),e.forEach((function(e){t.append('<p class="title">'+e+"</p>")})))},_processTitle:function(t){var e,n=$('<span class="title">'+t+"</span>").appendTo(this.$el);return n.truncate(this.svgHeight),e=n.text(),n.remove(),e}});e.a=a},36:function(t,e){e.AIR_THERMAL_CONDUCTIVITY=.025,e.AIR_SPECIFIC_HEAT=1012,e.AIR_DENSITY=1.204,e.AIR_VISCOSITY=1568e-8,e.STEFAN_CONSTANT=5.67e-8},37:function(t,e){(function(e){t.exports=e}).call(this,{})},4:function(t,e,n){"use strict";e.a={sharing:!0,logging:!1,tracing:!1,homeForSharing:"",homeEmbeddablePath:"/embeddable.html",rootUrl:"lab",modelsRootUrl:"",utmCampaign:null,versionedHome:null}},400:function(t,e,n){"use strict";n.r(e);n(190),n(191),n(192),n(193),n(194);var i=n(26),r=n(4),o=n(78),a=n.n(o),s=n(0),l=n(183),u=n.n(l),c=n(5),h=n.n(c),d=n(10),p=n(1);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),i.forEach((function(e){m(t,e,n[e])}))}return t}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function b(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),t}function _(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?_(t):e}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function T(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}function S(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function k(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var A={type:"logger",log:function(t){this.output("log",t)},warn:function(t){this.output("warn",t)},error:function(t){this.output("error",t)},output:function(t,e){var n;console&&console[t]&&(n=console)[t].apply(n,S(e))}},E=new(function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,t),this.init(e,n)}return b(t,[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||A,this.options=e,this.debug=e.debug}},{key:"setDebug",value:function(t){this.debug=t}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}},{key:"deprecate",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(t,e,n,i){return i&&!this.debug?null:("string"==typeof t[0]&&(t[0]="".concat(n).concat(this.prefix," ").concat(t[0])),this.logger[e](t))}},{key:"create",value:function(e){return new t(this.logger,g({},{prefix:"".concat(this.prefix,":").concat(e,":")},this.options))}}]),t}()),M=function(){function t(){v(this,t),this.observers={}}return b(t,[{key:"on",value:function(t,e){var n=this;return t.split(" ").forEach((function(t){n.observers[t]=n.observers[t]||[],n.observers[t].push(e)})),this}},{key:"off",value:function(t,e){this.observers[t]&&(e?this.observers[t]=this.observers[t].filter((function(t){return t!==e})):delete this.observers[t])}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if(this.observers[t]){var r=[].concat(this.observers[t]);r.forEach((function(t){t.apply(void 0,n)}))}if(this.observers["*"]){var o=[].concat(this.observers["*"]);o.forEach((function(e){e.apply(e,[t].concat(n))}))}}}]),t}();function P(){var t,e,n=new Promise((function(n,i){t=n,e=i}));return n.resolve=t,n.reject=e,n}function D(t){return null==t?"":""+t}function O(t,e,n){t.forEach((function(t){e[t]&&(n[t]=e[t])}))}function I(t,e,n){function i(t){return t&&t.indexOf("###")>-1?t.replace(/###/g,"."):t}function r(){return!t||"string"==typeof t}for(var o="string"!=typeof e?[].concat(e):e.split(".");o.length>1;){if(r())return{};var a=i(o.shift());!t[a]&&n&&(t[a]=new n),t=t[a]}return r()?{}:{obj:t,k:i(o.shift())}}function L(t,e,n){var i=I(t,e,Object);i.obj[i.k]=n}function R(t,e){var n=I(t,e),i=n.obj,r=n.k;if(i)return i[r]}function N(t,e,n){var i=R(t,n);return void 0!==i?i:R(e,n)}function F(t,e,n){for(var i in e)i in t?"string"==typeof t[i]||t[i]instanceof String||"string"==typeof e[i]||e[i]instanceof String?n&&(t[i]=e[i]):F(t[i],e[i],n):t[i]=e[i];return t}function B(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function j(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,(function(t){return z[t]})):t}var V=function(t){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return v(this,e),n=x(this,w(e).call(this)),M.call(_(n)),n.data=t||{},n.options=i,void 0===n.options.keySeparator&&(n.options.keySeparator="."),n}return T(e,t),b(e,[{key:"addNamespaces",value:function(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}},{key:"removeNamespaces",value:function(t){var e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}},{key:"getResource",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,o=[t,e];return n&&"string"!=typeof n&&(o=o.concat(n)),n&&"string"==typeof n&&(o=o.concat(r?n.split(r):n)),t.indexOf(".")>-1&&(o=t.split(".")),R(this.data,o)}},{key:"addResource",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},o=this.options.keySeparator;void 0===o&&(o=".");var a=[t,e];n&&(a=a.concat(o?n.split(o):n)),t.indexOf(".")>-1&&(i=e,e=(a=t.split("."))[1]),this.addNamespaces(e),L(this.data,a,i),r.silent||this.emit("added",t,e,n,i)}},{key:"addResources",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var r in n)"string"!=typeof n[r]&&"[object Array]"!==Object.prototype.toString.apply(n[r])||this.addResource(t,e,r,n[r],{silent:!0});i.silent||this.emit("added",t,e,n)}},{key:"addResourceBundle",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},a=[t,e];t.indexOf(".")>-1&&(i=n,n=e,e=(a=t.split("."))[1]),this.addNamespaces(e);var s=R(this.data,a)||{};i?F(s,n,r):s=g({},s,n),L(this.data,a,s),o.silent||this.emit("added",t,e,n)}},{key:"removeResourceBundle",value:function(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}},{key:"hasResourceBundle",value:function(t,e){return void 0!==this.getResource(t,e)}},{key:"getResourceBundle",value:function(t,e){return e||(e=this.options.defaultNS),"v1"===this.options.compatibilityAPI?g({},{},this.getResource(t,e)):this.getResource(t,e)}},{key:"getDataByLanguage",value:function(t){return this.data[t]}},{key:"toJSON",value:function(){return this.data}}]),e}(M),H={processors:{},addPostProcessor:function(t){this.processors[t.name]=t},handle:function(t,e,n,i,r){var o=this;return t.forEach((function(t){o.processors[t]&&(e=o.processors[t].process(e,n,i,r))})),e}},W={},U=function(t){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v(this,e),n=x(this,w(e).call(this)),M.call(_(n)),O(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,_(n)),n.options=i,void 0===n.options.keySeparator&&(n.options.keySeparator="."),n.logger=E.create("translator"),n}return T(e,t),b(e,[{key:"changeLanguage",value:function(t){t&&(this.language=t)}},{key:"exists",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},n=this.resolve(t,e);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(t,e){var n=e.nsSeparator||this.options.nsSeparator;void 0===n&&(n=":");var i=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,r=e.ns||this.options.defaultNS;if(n&&t.indexOf(n)>-1){var o=t.split(n);(n!==i||n===i&&this.options.ns.indexOf(o[0])>-1)&&(r=o.shift()),t=o.join(i)}return"string"==typeof r&&(r=[r]),{key:t,namespaces:r}}},{key:"translate",value:function(t,e){var n=this;if("object"!==f(e)&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),e||(e={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);var i=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,r=this.extractFromKey(t[t.length-1],e),o=r.key,a=r.namespaces,s=a[a.length-1],l=e.lng||this.language,u=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(l&&"cimode"===l.toLowerCase()){if(u){var c=e.nsSeparator||this.options.nsSeparator;return s+c+o}return o}var h=this.resolve(t,e),d=h&&h.res,p=h&&h.usedKey||o,m=h&&h.exactUsedKey||o,v=Object.prototype.toString.apply(d),y=["[object Number]","[object Function]","[object RegExp]"],b=void 0!==e.joinArrays?e.joinArrays:this.options.joinArrays,_=!this.i18nFormat||this.i18nFormat.handleAsObject,x="string"!=typeof d&&"boolean"!=typeof d&&"number"!=typeof d;if(_&&d&&x&&y.indexOf(v)<0&&("string"!=typeof b||"[object Array]"!==v)){if(!e.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(p,d,e):"key '".concat(o," (").concat(this.language,")' returned an object instead of string.");if(i){var w="[object Array]"===v,C=w?[]:{},T=w?m:p;for(var S in d)if(Object.prototype.hasOwnProperty.call(d,S)){var k="".concat(T).concat(i).concat(S);C[S]=this.translate(k,g({},e,{joinArrays:!1,ns:a})),C[S]===k&&(C[S]=d[S])}d=C}}else if(_&&"string"==typeof b&&"[object Array]"===v)(d=d.join(b))&&(d=this.extendTranslation(d,t,e));else{var A=!1,E=!1;if(!this.isValidLookup(d)&&void 0!==e.defaultValue){if(A=!0,void 0!==e.count){var M=this.pluralResolver.getSuffix(l,e.count);d=e["defaultValue".concat(M)]}d||(d=e.defaultValue)}this.isValidLookup(d)||(E=!0,d=o);var P=e.defaultValue&&e.defaultValue!==d&&this.options.updateMissing;if(E||A||P){this.logger.log(P?"updateKey":"missingKey",l,s,o,P?e.defaultValue:d);var D=[],O=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if("fallback"===this.options.saveMissingTo&&O&&O[0])for(var I=0;I<O.length;I++)D.push(O[I]);else"all"===this.options.saveMissingTo?D=this.languageUtils.toResolveHierarchy(e.lng||this.language):D.push(e.lng||this.language);var L=function(t,i){n.options.missingKeyHandler?n.options.missingKeyHandler(t,s,i,P?e.defaultValue:d,P,e):n.backendConnector&&n.backendConnector.saveMissing&&n.backendConnector.saveMissing(t,s,i,P?e.defaultValue:d,P,e),n.emit("missingKey",t,s,i,d)};if(this.options.saveMissing){var R=void 0!==e.count&&"string"!=typeof e.count;this.options.saveMissingPlurals&&R?D.forEach((function(t){n.pluralResolver.getPluralFormsOfKey(t,o).forEach((function(e){return L([t],e)}))})):L(D,o)}}d=this.extendTranslation(d,t,e,h),E&&d===o&&this.options.appendNamespaceToMissingKey&&(d="".concat(s,":").concat(o)),E&&this.options.parseMissingKeyHandler&&(d=this.options.parseMissingKeyHandler(d))}return d}},{key:"extendTranslation",value:function(t,e,n,i){var r=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,n,i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(g({},n,{interpolation:g({},this.options.interpolation,n.interpolation)}));var o=n.replace&&"string"!=typeof n.replace?n.replace:n;this.options.interpolation.defaultVariables&&(o=g({},this.options.interpolation.defaultVariables,o)),t=this.interpolator.interpolate(t,o,n.lng||this.language,n),!1!==n.nest&&(t=this.interpolator.nest(t,(function(){return r.translate.apply(r,arguments)}),n)),n.interpolation&&this.interpolator.reset()}var a=n.postProcess||this.options.postProcess,s="string"==typeof a?[a]:a;return null!=t&&s&&s.length&&!1!==n.applyPostProcessor&&(t=H.handle(s,t,e,this.options&&this.options.postProcessPassResolved?g({i18nResolved:i},n):n,this)),t}},{key:"resolve",value:function(t){var e,n,i,r,o,a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof t&&(t=[t]),t.forEach((function(t){if(!a.isValidLookup(e)){var l=a.extractFromKey(t,s),u=l.key;n=u;var c=l.namespaces;a.options.fallbackNS&&(c=c.concat(a.options.fallbackNS));var h=void 0!==s.count&&"string"!=typeof s.count,d=void 0!==s.context&&"string"==typeof s.context&&""!==s.context,p=s.lngs?s.lngs:a.languageUtils.toResolveHierarchy(s.lng||a.language,s.fallbackLng);c.forEach((function(t){a.isValidLookup(e)||(o=t,!W["".concat(p[0],"-").concat(t)]&&a.utils&&a.utils.hasLoadedNamespace&&!a.utils.hasLoadedNamespace(o)&&(W["".concat(p[0],"-").concat(t)]=!0,a.logger.warn('key "'.concat(n,'" for namespace "').concat(o,'" for languages "').concat(p.join(", "),"\" won't get resolved as namespace was not yet loaded"),"This means something IS WRONG in your application setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach((function(n){if(!a.isValidLookup(e)){r=n;var o,l,c=u,p=[c];if(a.i18nFormat&&a.i18nFormat.addLookupKeys)a.i18nFormat.addLookupKeys(p,u,n,t,s);else h&&(o=a.pluralResolver.getSuffix(n,s.count)),h&&d&&p.push(c+o),d&&p.push(c+="".concat(a.options.contextSeparator).concat(s.context)),h&&p.push(c+=o);for(;l=p.pop();)a.isValidLookup(e)||(i=l,e=a.getResource(n,t,l,s))}})))}))}})),{res:e,usedKey:n,exactUsedKey:i,usedLng:r,usedNS:o}}},{key:"isValidLookup",value:function(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}},{key:"getResource",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,e,n,i):this.resourceStore.getResource(t,e,n,i)}}]),e}(M);function G(t){return t.charAt(0).toUpperCase()+t.slice(1)}var q=function(){function t(e){v(this,t),this.options=e,this.whitelist=this.options.whitelist||!1,this.logger=E.create("languageUtils")}return b(t,[{key:"getScriptPartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return null;var e=t.split("-");return 2===e.length?null:(e.pop(),this.formatLanguageCode(e.join("-")))}},{key:"getLanguagePartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return t;var e=t.split("-");return this.formatLanguageCode(e[0])}},{key:"formatLanguageCode",value:function(t){if("string"==typeof t&&t.indexOf("-")>-1){var e=["hans","hant","latn","cyrl","cans","mong","arab"],n=t.split("-");return this.options.lowerCaseLng?n=n.map((function(t){return t.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=G(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=G(n[1].toLowerCase())),e.indexOf(n[2].toLowerCase())>-1&&(n[2]=G(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}},{key:"isWhitelisted",value:function(t){return("languageOnly"===this.options.load||this.options.nonExplicitWhitelist)&&(t=this.getLanguagePartFromCode(t)),!this.whitelist||!this.whitelist.length||this.whitelist.indexOf(t)>-1}},{key:"getFallbackCodes",value:function(t,e){if(!t)return[];if("string"==typeof t&&(t=[t]),"[object Array]"===Object.prototype.toString.apply(t))return t;if(!e)return t.default||[];var n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t.default),n||[]}},{key:"toResolveHierarchy",value:function(t,e){var n=this,i=this.getFallbackCodes(e||this.options.fallbackLng||[],t),r=[],o=function(t){t&&(n.isWhitelisted(t)?r.push(t):n.logger.warn("rejecting non-whitelisted language code: ".concat(t)))};return"string"==typeof t&&t.indexOf("-")>-1?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(t))):"string"==typeof t&&o(this.formatLanguageCode(t)),i.forEach((function(t){r.indexOf(t)<0&&o(n.formatLanguageCode(t))})),r}}]),t}(),Y=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he"],nr:[1,2,20,21],fc:22}],X={1:function(t){return Number(t>1)},2:function(t){return Number(1!=t)},3:function(t){return 0},4:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},5:function(t){return Number(0===t?0:1==t?1:2==t?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5)},6:function(t){return Number(1==t?0:t>=2&&t<=4?1:2)},7:function(t){return Number(1==t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(t>=2)},10:function(t){return Number(1==t?0:2==t?1:t<7?2:t<11?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:t>2&&t<20?2:3)},12:function(t){return Number(t%10!=1||t%100==11)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2)},16:function(t){return Number(t%10==1&&t%100!=11?0:0!==t?1:2)},17:function(t){return Number(1==t||t%10==1?0:1)},18:function(t){return Number(0==t?0:1==t?1:2)},19:function(t){return Number(1==t?0:0===t||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3)},20:function(t){return Number(1==t?0:0===t||t%100>0&&t%100<20?1:2)},21:function(t){return Number(t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0)},22:function(t){return Number(1===t?0:2===t?1:(t<0||t>10)&&t%10==0?2:3)}};function Q(){var t={};return Y.forEach((function(e){e.lngs.forEach((function(n){t[n]={numbers:e.nr,plurals:X[e.fc]}}))})),t}var K=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,t),this.languageUtils=e,this.options=n,this.logger=E.create("pluralResolver"),this.rules=Q()}return b(t,[{key:"addRule",value:function(t,e){this.rules[t]=e}},{key:"getRule",value:function(t){return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}},{key:"needsPlural",value:function(t){var e=this.getRule(t);return e&&e.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(t,e){var n=this,i=[],r=this.getRule(t);return r?(r.numbers.forEach((function(r){var o=n.getSuffix(t,r);i.push("".concat(e).concat(o))})),i):i}},{key:"getSuffix",value:function(t,e){var n=this,i=this.getRule(t);if(i){var r=i.noAbs?i.plurals(e):i.plurals(Math.abs(e)),o=i.numbers[r];this.options.simplifyPluralSuffix&&2===i.numbers.length&&1===i.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var a=function(){return n.options.prepend&&o.toString()?n.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):a():"v2"===this.options.compatibilityJSON?a():this.options.simplifyPluralSuffix&&2===i.numbers.length&&1===i.numbers[0]?a():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}return this.logger.warn("no plural rule found for: ".concat(t)),""}}]),t}(),J=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,t),this.logger=E.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||function(t){return t},this.init(e)}return b(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});var e=t.interpolation;this.escape=void 0!==e.escape?e.escape:j,this.escapeValue=void 0===e.escapeValue||e.escapeValue,this.useRawValueToEscape=void 0!==e.useRawValueToEscape&&e.useRawValueToEscape,this.prefix=e.prefix?B(e.prefix):e.prefixEscaped||"{{",this.suffix=e.suffix?B(e.suffix):e.suffixEscaped||"}}",this.formatSeparator=e.formatSeparator?e.formatSeparator:e.formatSeparator||",",this.unescapePrefix=e.unescapeSuffix?"":e.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":e.unescapeSuffix||"",this.nestingPrefix=e.nestingPrefix?B(e.nestingPrefix):e.nestingPrefixEscaped||B("$t("),this.nestingSuffix=e.nestingSuffix?B(e.nestingSuffix):e.nestingSuffixEscaped||B(")"),this.nestingOptionsSeparator=e.nestingOptionsSeparator?e.nestingOptionsSeparator:e.nestingOptionsSeparator||",",this.maxReplaces=e.maxReplaces?e.maxReplaces:1e3,this.alwaysFormat=void 0!==e.alwaysFormat&&e.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var t="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(t,"g");var e="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(e,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(t,e,n,i){var r,o,a,s=this,l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function u(t){return t.replace(/\$/g,"$$$$")}var c=function(t){if(t.indexOf(s.formatSeparator)<0){var r=N(e,l,t);return s.alwaysFormat?s.format(r,void 0,n):r}var o=t.split(s.formatSeparator),a=o.shift().trim(),u=o.join(s.formatSeparator).trim();return s.format(N(e,l,a),u,n,i)};this.resetRegExp();var h=i&&i.missingInterpolationHandler||this.options.missingInterpolationHandler;for(a=0;r=this.regexpUnescape.exec(t);){if(void 0===(o=c(r[1].trim())))if("function"==typeof h){var d=h(t,r,i);o="string"==typeof d?d:""}else this.logger.warn("missed to pass in variable ".concat(r[1]," for interpolating ").concat(t)),o="";else"string"==typeof o||this.useRawValueToEscape||(o=D(o));if(t=t.replace(r[0],u(o)),this.regexpUnescape.lastIndex=0,++a>=this.maxReplaces)break}for(a=0;r=this.regexp.exec(t);){if(void 0===(o=c(r[1].trim())))if("function"==typeof h){var p=h(t,r,i);o="string"==typeof p?p:""}else this.logger.warn("missed to pass in variable ".concat(r[1]," for interpolating ").concat(t)),o="";else"string"==typeof o||this.useRawValueToEscape||(o=D(o));if(o=this.escapeValue?u(this.escape(o)):u(o),t=t.replace(r[0],o),this.regexp.lastIndex=0,++a>=this.maxReplaces)break}return t}},{key:"nest",value:function(t,e){var n,i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=g({},r);function a(t,e){var n=this.nestingOptionsSeparator;if(t.indexOf(n)<0)return t;var i=t.split(n),r=i.pop();t=i.join(n),r=(r=this.interpolate(r,o)).replace(/'/g,'"');try{o=JSON.parse(r),e&&(o=g({},e,o))}catch(e){return this.logger.warn("failed parsing options string in nesting for key ".concat(t),e),"".concat(t).concat(n).concat(r)}return delete o.defaultValue,t}for(o.applyPostProcessor=!1,delete o.defaultValue;n=this.nestingRegexp.exec(t);){if((i=e(a.call(this,n[1].trim(),o),o))&&n[0]===t&&"string"!=typeof i)return i;"string"!=typeof i&&(i=D(i)),i||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(t)),i=""),t=t.replace(n[0],i),this.regexp.lastIndex=0}return t}}]),t}();var Z=function(t){function e(t,n,i){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return v(this,e),r=x(this,w(e).call(this)),M.call(_(r)),r.backend=t,r.store=n,r.services=i,r.languageUtils=i.languageUtils,r.options=o,r.logger=E.create("backendConnector"),r.state={},r.queue=[],r.backend&&r.backend.init&&r.backend.init(i,o.backend,o),r}return T(e,t),b(e,[{key:"queueLoad",value:function(t,e,n,i){var r=this,o=[],a=[],s=[],l=[];return t.forEach((function(t){var i=!0;e.forEach((function(e){var s="".concat(t,"|").concat(e);!n.reload&&r.store.hasResourceBundle(t,e)?r.state[s]=2:r.state[s]<0||(1===r.state[s]?a.indexOf(s)<0&&a.push(s):(r.state[s]=1,i=!1,a.indexOf(s)<0&&a.push(s),o.indexOf(s)<0&&o.push(s),l.indexOf(e)<0&&l.push(e)))})),i||s.push(t)})),(o.length||a.length)&&this.queue.push({pending:a,loaded:{},errors:[],callback:i}),{toLoad:o,pending:a,toLoadLanguages:s,toLoadNamespaces:l}}},{key:"loaded",value:function(t,e,n){var i=k(t.split("|"),2),r=i[0],o=i[1];e&&this.emit("failedLoading",r,o,e),n&&this.store.addResourceBundle(r,o,n),this.state[t]=e?-1:2;var a={};this.queue.forEach((function(n){var i,s,l,u,c,h;i=n.loaded,s=o,u=I(i,[r],Object),c=u.obj,h=u.k,c[h]=c[h]||[],l&&(c[h]=c[h].concat(s)),l||c[h].push(s),function(t,e){for(var n=t.indexOf(e);-1!==n;)t.splice(n,1),n=t.indexOf(e)}(n.pending,t),e&&n.errors.push(e),0!==n.pending.length||n.done||(Object.keys(n.loaded).forEach((function(t){a[t]||(a[t]=[]),n.loaded[t].length&&n.loaded[t].forEach((function(e){a[t].indexOf(e)<0&&a[t].push(e)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((function(t){return!t.done}))}},{key:"read",value:function(t,e,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:250,a=arguments.length>5?arguments[5]:void 0;return t.length?this.backend[n](t,e,(function(s,l){s&&l&&r<5?setTimeout((function(){i.read.call(i,t,e,n,r+1,2*o,a)}),o):a(s,l)})):a(null,{})}},{key:"prepareLoading",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();"string"==typeof t&&(t=this.languageUtils.toResolveHierarchy(t)),"string"==typeof e&&(e=[e]);var o=this.queueLoad(t,e,i,r);if(!o.toLoad.length)return o.pending.length||r(),null;o.toLoad.forEach((function(t){n.loadOne(t)}))}},{key:"load",value:function(t,e,n){this.prepareLoading(t,e,{},n)}},{key:"reload",value:function(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}},{key:"loadOne",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=t.split("|"),r=k(i,2),o=r[0],a=r[1];this.read(o,a,"read",void 0,void 0,(function(i,r){i&&e.logger.warn("".concat(n,"loading namespace ").concat(a," for language ").concat(o," failed"),i),!i&&r&&e.logger.log("".concat(n,"loaded namespace ").concat(a," for language ").concat(o),r),e.loaded(t,i,r)}))}},{key:"saveMissing",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)?this.logger.warn('did not save key "'.concat(n,'" for namespace "').concat(e,'" as the namespace was not yet loaded'),"This means something IS WRONG in your application setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(t,e,n,i,null,g({},o,{isUpdate:r})),t&&t[0]&&this.store.addResource(t[0],e,n,i))}}]),e}(M);function tt(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){var e={};if("object"===f(t[1])&&(e=t[1]),"string"==typeof t[1]&&(e.defaultValue=t[1]),"string"==typeof t[2]&&(e.tDescription=t[2]),"object"===f(t[2])||"object"===f(t[3])){var n=t[3]||t[2];Object.keys(n).forEach((function(t){e[t]=n[t]}))}return e},interpolation:{escapeValue:!0,format:function(t,e,n,i){return t},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3}}}function et(t){return"string"==typeof t.ns&&(t.ns=[t.ns]),"string"==typeof t.fallbackLng&&(t.fallbackLng=[t.fallbackLng]),"string"==typeof t.fallbackNS&&(t.fallbackNS=[t.fallbackNS]),t.whitelist&&t.whitelist.indexOf("cimode")<0&&(t.whitelist=t.whitelist.concat(["cimode"])),t}function nt(){}var it=new(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;if(v(this,e),t=x(this,w(e).call(this)),M.call(_(t)),t.options=et(n),t.services={},t.logger=E,t.modules={external:[]},i&&!t.isInitialized&&!n.isClone){if(!t.options.initImmediate)return t.init(n,i),x(t,_(t));setTimeout((function(){t.init(n,i)}),0)}return t}return T(e,t),b(e,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;function i(t){return t?"function"==typeof t?new t:t:null}if("function"==typeof e&&(n=e,e={}),this.options=g({},tt(),this.options,et(e)),this.format=this.options.interpolation.format,n||(n=nt),!this.options.isClone){this.modules.logger?E.init(i(this.modules.logger),this.options):E.init(null,this.options);var r=new q(this.options);this.store=new V(this.options.resources,this.options);var o=this.services;o.logger=E,o.resourceStore=this.store,o.languageUtils=r,o.pluralResolver=new K(r,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),o.interpolator=new J(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new Z(i(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",(function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t.emit.apply(t,[e].concat(i))})),this.modules.languageDetector&&(o.languageDetector=i(this.modules.languageDetector),o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=i(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new U(this.services,this.options),this.translator.on("*",(function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t.emit.apply(t,[e].concat(i))})),this.modules.external.forEach((function(e){e.init&&e.init(t)}))}this.modules.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var a=["getResource","addResource","addResources","addResourceBundle","removeResourceBundle","hasResourceBundle","getResourceBundle","getDataByLanguage"];a.forEach((function(e){t[e]=function(){var n;return(n=t.store)[e].apply(n,arguments)}}));var s=P(),l=function(){t.changeLanguage(t.options.lng,(function(e,i){t.isInitialized=!0,t.logger.log("initialized",t.options),t.emit("initialized",t.options),s.resolve(i),n(e,i)}))};return this.options.resources||!this.options.initImmediate?l():setTimeout(l,0),s}},{key:"loadResources",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt,i=n,r="string"==typeof t?t:this.language;if("function"==typeof t&&(i=t),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase())return i();var o=[],a=function(t){t&&e.services.languageUtils.toResolveHierarchy(t).forEach((function(t){o.indexOf(t)<0&&o.push(t)}))};if(r)a(r);else{var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.forEach((function(t){return a(t)}))}this.options.preload&&this.options.preload.forEach((function(t){return a(t)})),this.services.backendConnector.load(o,this.options.ns,i)}else i(null)}},{key:"reloadResources",value:function(t,e,n){var i=P();return t||(t=this.languages),e||(e=this.options.ns),n||(n=nt),this.services.backendConnector.reload(t,e,(function(t){i.resolve(),n(t)})),i}},{key:"use",value:function(t){return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&H.addPostProcessor(t),"3rdParty"===t.type&&this.modules.external.push(t),this}},{key:"changeLanguage",value:function(t,e){var n=this;this.isLanguageChangingTo=t;var i=P();this.emit("languageChanging",t);var r=function(t){t&&(n.language||(n.language=t,n.languages=n.services.languageUtils.toResolveHierarchy(t)),n.translator.language||n.translator.changeLanguage(t),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(t)),n.loadResources(t,(function(r){!function(t,r){r?(n.language=r,n.languages=n.services.languageUtils.toResolveHierarchy(r),n.translator.changeLanguage(r),n.isLanguageChangingTo=void 0,n.emit("languageChanged",r),n.logger.log("languageChanged",r)):n.isLanguageChangingTo=void 0,i.resolve((function(){return n.t.apply(n,arguments)})),e&&e(t,(function(){return n.t.apply(n,arguments)}))}(r,t)}))};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(r):r(t):r(this.services.languageDetector.detect()),i}},{key:"getFixedT",value:function(t,e){var n=this,i=function t(e,i){var r;if("object"!==f(i)){for(var o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];r=n.options.overloadTranslationOptionHandler([e,i].concat(a))}else r=g({},i);return r.lng=r.lng||t.lng,r.lngs=r.lngs||t.lngs,r.ns=r.ns||t.ns,n.t(e,r)};return"string"==typeof t?i.lng=t:i.lngs=t,i.ns=e,i}},{key:"t",value:function(){var t;return this.translator&&(t=this.translator).translate.apply(t,arguments)}},{key:"exists",value:function(){var t;return this.translator&&(t=this.translator).exists.apply(t,arguments)}},{key:"setDefaultNamespace",value:function(t){this.options.defaultNS=t}},{key:"hasLoadedNamespace",value:function(t){var e=this;if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var n=this.languages[0],i=!!this.options&&this.options.fallbackLng,r=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;var o=function(t,n){var i=e.services.backendConnector.state["".concat(t,"|").concat(n)];return-1===i||2===i};return!!this.hasResourceBundle(n,t)||(!this.services.backendConnector.backend||!(!o(n,t)||i&&!o(r,t)))}},{key:"loadNamespaces",value:function(t,e){var n=this,i=P();return this.options.ns?("string"==typeof t&&(t=[t]),t.forEach((function(t){n.options.ns.indexOf(t)<0&&n.options.ns.push(t)})),this.loadResources((function(t){i.resolve(),e&&e(t)})),i):(e&&e(),Promise.resolve())}},{key:"loadLanguages",value:function(t,e){var n=P();"string"==typeof t&&(t=[t]);var i=this.options.preload||[],r=t.filter((function(t){return i.indexOf(t)<0}));return r.length?(this.options.preload=i.concat(r),this.loadResources((function(t){n.resolve(),e&&e(t)})),n):(e&&e(),Promise.resolve())}},{key:"dir",value:function(t){if(t||(t=this.languages&&this.languages.length>0?this.languages[0]:this.language),!t)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(t))>=0?"rtl":"ltr"}},{key:"createInstance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new e(t,n)}},{key:"cloneInstance",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt,r=g({},this.options,n,{isClone:!0}),o=new e(r),a=["store","services","language"];return a.forEach((function(e){o[e]=t[e]})),o.translator=new U(o.services,o.options),o.translator.on("*",(function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];o.emit.apply(o,[t].concat(n))})),o.init(r,i),o.translator.options=o.options,o}}]),e}(M)),rt=n(22),ot=n.n(rt),at=n(184);var st={interactive:{title:{required:!0},publicationStatus:{defaultValue:"public"},labEnvironment:{defaultValue:"production"},i18nMetadata:{defaultValue:""},lang:{defaultValue:"en-US"},theme:{defaultValue:""},showTopBar:{defaultValue:!0},showBottomBar:{defaultValue:!0},credits:{defaultValue:""},padding:{defaultValue:10},subtitle:{defaultValue:""},about:{defaultValue:""},category:{defaultValue:""},subCategory:{defaultValue:""},screenshot:{defaultValue:""},importedFrom:{},aspectRatio:{defaultValue:1.3},fontScale:{defaultValue:1},randomSeed:{required:!1},helpOnLoad:{defaultValue:!1},aboutOnLoad:{defaultValue:!1},models:{required:!0},parameters:{defaultValue:[]},dataSets:{defaultValue:[]},propertiesToRetain:{defaultValue:[]},outputs:{defaultValue:[]},filteredOutputs:{defaultValue:[]},experiment:{required:!1},exports:{required:!1},logging:{required:!1},components:{defaultValue:[]},layout:{defaultValue:{}},template:{defaultValue:"simple"},helpTips:{defaultValue:[]}},model:{type:{required:!0},id:{required:!0},url:{conflictsWith:["model"]},importedFrom:{},model:{conflictsWith:["url"]},onLoad:{},viewOptions:{},modelOptions:{},parameters:{},outputs:{},filteredOutputs:{}},parameter:{name:{required:!0},initialValue:{required:!0},onChange:{},label:{},unitType:{},unitName:{},unitPluralName:{},unitAbbreviation:{}},output:{name:{required:!0},value:{required:!0},label:{},unitType:{},unitName:{},unitPluralName:{},unitAbbreviation:{}},dataSet:{name:{required:!0},properties:{defaultValue:[]},serializableProperties:{defaultValue:"all"},streamDataFromModel:{defaultValue:!0},clearOnModelReset:{defaultValue:!0},initialData:{}},filteredOutput:{name:{required:!0},property:{required:!0},type:{defaultValue:"RunningAverage"},period:{defaultValue:2500},label:{},unitType:{},unitName:{},unitPluralName:{},unitAbbreviation:{}},exports:{selectionComponents:{required:!1,defaultValue:[]},perRun:{required:!1,defaultValue:[]},perTick:{required:!0}},logging:{enabled:{defaultValue:!0},properties:{defaultValue:"boundToComponents"},components:{defaultValue:"all"}},experiment:{timeSeries:{required:!0},parameters:{required:!0,defaultValue:[]},destinations:{required:!0,defaultValue:[]},stateButtons:{required:!0,startRun:{required:!0,defaultValue:"start-run"},stopRun:{required:!0,defaultValue:"stop-run"},saveRun:{required:!0,defaultValue:"save-run"},nextRun:{required:!0,defaultValue:"next-run"},clearAll:{required:!0,defaultValue:"clear-all"}},onReset:{},savedRuns:{defaultValue:[]}},experimentTimeSeries:{time:{defaultValue:"displayTime"},properties:{required:!0,defaultValue:[]}},experimentParameter:{inputs:{required:!0,defaultValue:[]},outputs:{required:!0,defaultValue:[]}},experimentDestination:{type:{required:!0},componentIds:{required:!0,defaultValue:[]},properties:{required:!0,defaultValue:[]}},experimentSavedRun:{timeStamp:{required:!0},timeSeries:{required:!0,defaultValue:[]},parameters:{required:!0,defaultValue:[]}},playback:{id:{required:!0},type:{required:!0},stepping:{defaultValue:!0}},text:{id:{required:!0},type:{required:!0},onClick:{},text:{defaultValue:""},width:{defaultValue:"auto"},height:{defaultValue:"auto"},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},image:{id:{required:!0},type:{required:!0},src:{defaultValue:""},urlRelativeTo:{defaultValue:"model"},width:{defaultValue:"auto"},height:{defaultValue:"auto"},onClick:{},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},div:{id:{required:!0},type:{required:!0},content:{conflictsWith:["url"]},url:{conflictsWith:["content"]},width:{defaultValue:"auto"},height:{defaultValue:"auto"},onClick:{},classes:{defaultValue:[]},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},button:{id:{required:!0},type:{required:!0},action:{required:!0},text:{defaultValue:""},width:{defaultValue:""},height:{defaultValue:""},disabled:{defaultValue:!1},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},checkbox:{id:{required:!0},type:{required:!0},text:{defaultValue:""},textOn:{defaultValue:"right"},width:{defaultValue:"auto"},height:{defaultValue:"auto"},property:{conflictsWith:["initialValue","action"]},retainProperty:{defaultValue:!0},action:{conflictsWith:["property"]},initialValue:{conflictsWith:["property"]},disabled:{defaultValue:!1},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},slider:{id:{required:!0},type:{required:!0},min:{required:!0},max:{required:!0},steps:{required:!0},title:{defaultValue:""},titlePosition:{defaultValue:"top"},fillColor:{},fillToValue:{},labels:{defaultValue:[]},width:{defaultValue:"auto"},height:{defaultValue:"auto"},displayValue:{},property:{conflictsWith:["initialValue","action"]},retainProperty:{defaultValue:!0},action:{conflictsWith:["property"]},initialValue:{conflictsWith:["property"]},disabled:{defaultValue:!1},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},pulldown:{id:{required:!0},type:{required:!0},label:{defaultValue:""},labelOn:{defaultValue:"top"},options:{defaultValue:[]},property:{},retainProperty:{defaultValue:!0},disabled:{defaultValue:!1},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},pulldownOption:{text:{defaultValue:""},action:{conflictsWith:["value"]},value:{conflictsWith:["action"]},selected:{conflictsWith:["value"]},disabled:{}},radio:{id:{required:!0},type:{required:!0},style:{defaultValue:"radio"},orientation:{defaultValue:"vertical"},label:{defaultValue:""},labelOn:{defaultValue:"top"},options:{defaultValue:[]},property:{},retainProperty:{defaultValue:!0},disabled:{defaultValue:!1},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},radioOption:{text:{defaultValue:""},action:{conflictsWith:["value"]},value:{conflictsWith:["action"]},selected:{conflictsWith:["value"]},disabled:{}},numericOutput:{id:{required:!0},type:{required:!0},property:{required:!0},label:{defaultValue:""},units:{defaultValue:""},orientation:{defaultValue:"horizontal"},width:{defaultValue:"auto"},height:{defaultValue:"auto"},displayValue:{},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},thermometer:{id:{required:!0},type:{required:!0},min:{required:!0},max:{required:!0},width:{defaultValue:"2.5em"},height:{defaultValue:"100%"},labelIsReading:{defaultValue:!1},reading:{defaultValue:{units:"K",offset:0,scale:1,digits:0}},labels:{defaultValue:[]}},joystick:{id:{required:!0},type:{required:!0},title:{defaultValue:""},labels:{defaultValue:{n:"N",e:"E",s:"S",w:"W"}},scale:{defaultValue:1},width:{defaultValue:"auto"},height:{defaultValue:"auto"},displayValue:{},property:{conflictsWith:["initialValue","action"]},retainProperty:{defaultValue:!0},action:{conflictsWith:["property"]},initialValue:{conflictsWith:["property"]},disabled:{defaultValue:!1},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},colorIndicator:{id:{required:!0},type:{required:!0},title:{defaultValue:""},colorValue:{required:!0},width:{defaultValue:"auto"},height:{defaultValue:"auto"},property:{required:!0},retainProperty:{defaultValue:!0},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},spectrometer:{id:{required:!0},type:{required:!0},upperBound:{defaultValue:15},lowerBound:{defaultValue:2},ticks:{defaultValue:10},clearOnModelLoad:{defaultValue:!0},width:{defaultValue:"12em"},height:{defaultValue:"3em"},border:{defaultValue:"none"},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},table:{id:{required:!0},type:{required:!0},title:{defaultValue:null},dataSet:{conflictsWith:["tableData","clearOnModelReset","streamDataFromModel"]},tableData:{conflictsWith:["dataSet"]},clearOnModelReset:{conflictsWith:["dataSet"]},streamDataFromModel:{conflictsWith:["dataSet"]},addNewRows:{defaultValue:!0},visibleRows:{defaultValue:4},showBlankRow:{defaultValue:!1},indexColumn:{defaultValue:!0},propertyColumns:{defaultValue:[]},headerData:{defaultValue:[]},width:{defaultValue:"auto"},height:{defaultValue:"100%"},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},graph:{id:{required:!0},type:{required:!0},dataSet:{conflictsWith:["dataPoints","clearOnModelReset","streamDataFromModel"]},dataPoints:{conflictsWith:["dataSet"]},clearOnModelReset:{conflictsWith:["dataSet"]},streamDataFromModel:{conflictsWith:["dataSet"]},resetAxesOnReset:{defaultValue:!0},enableAutoScaleButton:{defaultValue:!0},enableAxisScaling:{defaultValue:!0},enableZooming:{defaultValue:!0},autoScaleX:{defaultValue:!0},autoScaleY:{defaultValue:!0},enableSelectionButton:{defaultValue:!1},clearSelectionOnLeavingSelectMode:{defaultValue:!1},enableDrawButton:{defaultValue:!1},drawProperty:{defaultValue:null},markAllDataPoints:{defaultValue:!1},showRulersOnSelection:{defaultValue:!1},fontScaleRelativeToParent:{defaultValue:!0},hideAxisValues:{defaultValue:!1},properties:{defaultValue:[]},xProperty:{defaultValue:"displayTime"},title:{defaultValue:"Graph"},titlePosition:{defaultValue:"center"},buttonsStyle:{defaultValue:"icons"},buttonsLayout:{defaultValue:"vertical"},lineWidth:{defaultValue:2},width:{defaultValue:"100%"},height:{defaultValue:"100%"},xlabel:{defaultValue:"auto"},xmin:{defaultValue:0},xmax:{defaultValue:20},ylabel:{defaultValue:"auto"},ymin:{defaultValue:0},ymax:{defaultValue:10},xTickCount:{defaultValue:10},yTickCount:{defaultValue:10},xscaleExponent:{defaultValue:.5},yscaleExponent:{defaultValue:.5},xFormatter:{defaultValue:".2r"},yFormatter:{defaultValue:".2r"},lines:{defaultValue:!0},bars:{defaultValue:!1},tooltip:{defaultValue:""},dataColors:{defaultValue:["#a00000","#2ca000","#2c00a0"]},legendLabels:{defaultValue:[]},legendVisible:{defaultValue:!1},syncXAxis:{defaultValue:!1},syncYAxis:{defaultValue:!1},helpIcon:{defaultValue:!1}},barGraph:{id:{required:!0},type:{required:!0},property:{required:!0},secondProperty:{conflictsWith:["averagePeriod"]},min:{defaultValue:0},max:{defaultValue:10},title:{defaultValue:""},titleOn:{defaultValue:"right"},labels:{defaultValue:5},units:{defaultValue:!1},gridLines:{defaultValue:10},labelFormat:{defaultValue:"0.1f"},averagePeriod:{conflictsWith:["secondProperty"]},barWidth:{defaultValue:"2em"},height:{defaultValue:"100%"},barColor:{defaultValue:"#e23c34"},fillColor:{defaultValue:"#fff"},tooltip:{defaultValue:""},helpIcon:{defaultValue:!1}},helpTip:{component:{defaultValue:""},text:{defaultValue:""},showcase:{defaultValue:!0}}},lt=function(t){return r.a.rootUrl+"/resources/"+t};function ut(t){var e=t.split("-");return lt("flags/"+e[e.length-1].toLowerCase()+".png")}var ct=function(t,e){var n=e.interactive.i18nMetadata;if(n){var i=$.get(n).done((function(n){"string"==typeof n&&(n=JSON.parse(n)),function(t,e,n,i){var r={};if(Object.keys(e).forEach((function(t){t!==n&&(r[t]={name:t,className:"lang-"+t})})),0===Object.keys(r).length)return;$(t).on("click",(function(){$(t).contextMenu()})),$.contextMenu("destroy",t),$.contextMenu({selector:t,appendTo:".lab-responsive-content",className:"lang-menu",trigger:"none",zIndex:1e3,determinePosition:function(t){t.css("display","block").position({my:"right top",at:"right bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none")},callback:function(t){i.requestInteractiveAt(e[t])},items:r}),Object.keys(r).forEach((function(t){$(".context-menu-item.lang-"+t).css("background-image",'url("'+ut(t)+'")')}))}(t,n,e.interactive.lang,e)})),r=new $.Deferred;e.on("interactiveRendered.i18nHelper",(function(){r.resolve()})),$.when(i,r).done((function(){!function(t,e){var n=$(t);n.addClass("lang-icon"),n.css("background-image",'url("'+ut(e)+'")')}(t,e.interactive.lang)}))}};function ht(t){this._nameSpace=t,this.registeredListeners=[],this._nameSpaced=function(t){return t+"."+this._nameSpace}}ht.prototype.listen=function(t,e,n){var i=this._nameSpaced(e),r={speaker:t,eventName:i};t.on(i,n),this.registeredListeners.push(r)},ht.prototype.remove=function(t){!function(t){return"function"!=typeof t.off}(t)?t.speaker.off(t.eventName):t.speaker.on(t.eventName,null)},ht.prototype.removeAll=function(){for(;this.registeredListeners.length>0;)this.remove(this.registeredListeners.pop())};var dt=ht;function pt(t){return[].slice.call(t)}function ft(){var t,e,n,i=!1,r=d3.set();function o(i){var r,o;for(n=i,e=d3.dispatch.apply(null,n),r=0,o=n.length;r<o;r++)t[n[r]]=a(n[r])}function a(t){return function(){i?r.add(t):e[t].apply(e,arguments)}}function s(t){return function(){e[t].apply(e,arguments)}}return t={on:s("on"),mixInto:function(e){e.on=t.on,e.suppressEvents=t.suppressEvents},addEventTypes:function(){arguments.length&&o(n.concat(pt(arguments)))},startBatch:function(){i=!0},endBatch:function(){i=!1,t.flush()},flush:function(){r.forEach((function(t){e[t]()})),r=d3.set()},suppressEvents:function(t){i=!0,t(),i=!1,r=d3.set()}},o(pt(arguments)),t}var mt=0;function gt(t,e,n){for(var i in this.interactivesController=e,this._model=e.getModel(),this.namespace="dataSet"+ ++mt,this.component=p.a.validateCompleteness(st.dataSet,t),this.name=this.component.name,this.properties=this.component.properties||[],this.streamDataFromModel=this.component.streamDataFromModel,this.clearOnModelReset=this.component.clearOnModelReset,this.initialData=this.component.initialData?$.extend(!0,{},this.component.initialData):null,this._data={},this._modelProperties=[],this._listeningPool=new dt(this.namespace),this._dispatch=new ft,gt.Events)this._dispatch.addEventTypes(gt.Events[i]);this._dispatch.mixInto(this),this.resetData(),this.interactivesController.addDataSet(this,n)}gt.Events={SAMPLE_ADDED:"sampleAdded",SAMPLE_CHANGED:"sampleChanged",SAMPLE_REMOVED:"sampleRemoved",DATA_TRUNCATED:"dataTruncated",DATA_RESET:"dataReset",SELECTION_CHANGED:"selectionChanged",LABELS_CHANGED:"labelsChanged"},gt.prototype._setupEmptyData=function(){var t=this;this.properties.forEach((function(e){t._data[e]=[]}))},gt.prototype._inNewModelTerritory=function(){return this._model.stepCounter()<this.maxLength(this._modelProperties)},gt.prototype._addListeners=function(){var t=this._listeningPool,e=this.interactivesController.getModel(),n=this,i=function(){n._trigger(gt.Events.SELECTION_CHANGED,e.stepCounter())};t.removeAll(),this.streamDataFromModel&&(t.listen(e,"tick",(function(){n.appendDataPoint(),i()})),t.listen(e,"play",(function(){n._inNewModelTerritory()&&n.removeModelDataAfterStepPointer()})),t.listen(e,"stepBack",i),t.listen(e,"stepForward",i),t.listen(e,"seek",i),t.listen(e,"invalidation",(function(){n.removeModelDataAfterStepPointer()}))),t.listen(e,"reset",(function(){n.clearOnModelReset&&n.resetData(),n.streamDataFromModel&&n.appendDataPoint()})),this.properties.forEach((function(t){n._model.addPropertyDescriptionObserver(t,(function(){n._trigger(gt.Events.LABELS_CHANGED,n.getLabels())}))}))},gt.prototype._getModelProperty=function(t){return this._model.get(t)},gt.prototype._trigger=function(t,e){this._dispatch[t]({data:e})},gt.prototype._getPropertyLabel=function(t){if(!this._model.hasProperty(t))return"";var e=this._model.getPropertyDescription(t);return e.getLabel()+" ("+e.getUnitAbbreviation()+")"},gt.prototype._resetProperty=function(t,e){var n=[];e&&e[t]?n=e[t]:this.initialData[t]&&(n=this.initialData[t]),this._data[t]=n.slice(0)},gt.prototype.getData=function(){return this._data},gt.prototype.maxLength=function(t){var e=-1/0,n=this;return t.forEach((function(t){e<n._data[t].length&&(e=n._data[t].length)})),e},gt.prototype.minLength=function(t){var e=1/0,n=this;return t.forEach((function(t){e>n._data[t].length&&(e=n._data[t].length)})),e},gt.prototype.dataPointIndex=function(t){for(var e,n,i=Object.keys(t),r=this.minLength(i),o=i.length,a=0;a<r;a++){e=!0;for(var s=0;s<o;s++)if(n=i[s],this._data[n][a]!==t[n]){e=!1;break}if(e)return a}return-1},gt.prototype.resetData=function(){this._setupEmptyData(),this.initialData&&$.extend(!0,this._data,this.initialData),this._trigger(gt.Events.DATA_RESET,this._data)},gt.prototype.clearData=function(){this._setupEmptyData(),this._trigger(gt.Events.DATA_RESET,this._data)},gt.prototype.resetProperties=function(t){var e;for(e=0;e<t.length;e++)this._resetProperty(t[e]);this._trigger(gt.Events.DATA_RESET,this._data)},gt.prototype.appendDataPoint=function(t,e){t||(t=this._modelProperties);var n={},i=this;t.forEach((function(t){var r=e&&void 0!==e[t]?e[t]:i._getModelProperty(t);void 0!==r&&(n[t]=r,i._data[t].push(r))})),this._trigger(gt.Events.SAMPLE_ADDED,n)},gt.prototype.removeDataPoint=function(t,e){var n=this;t.forEach((function(t){n._data[t][e]=null})),this._trigger(gt.Events.SAMPLE_REMOVED,{props:t,index:e})},gt.prototype.removeModelDataAfterStepPointer=function(){var t=this._model.stepCounter(),e=this;t<0&&(t=0),this._modelProperties.forEach((function(n){e._data[n].length>t&&(e._data[n].length=t)})),this._trigger(gt.Events.DATA_TRUNCATED,this._data),e.appendDataPoint()},gt.prototype.editDataPoint=function(t,e,n){this._data[e][t]=n;var i=this,r={};this.properties.forEach((function(e){r[e]=i._data[e][t]})),this._trigger(gt.Events.SAMPLE_CHANGED,{index:t,property:e,value:n,dataPoint:r})},gt.prototype.getPropertyValue=function(t,e){return this._data[e][t]},gt.prototype.getLabels=function(){var t={},e=this;return this.properties.forEach((function(n){t[n]=e._getPropertyLabel(n)})),t},gt.prototype.modelLoadedCallback=function(){this._model=this.interactivesController.getModel(),this._addListeners(),this._modelProperties=[];var t=this;this.properties.forEach((function(e){t._model.hasProperty(e)&&t._modelProperties.push(e)})),this.clearOnModelReset&&this.resetData(),this.streamDataFromModel&&this.appendDataPoint()},gt.prototype.serialize=function(){var t=$.extend(!0,{},this.component);return t.initialData=this.serializeData(),t},gt.prototype.serializeData=function(){if("none"===this.component.serializableProperties)return{};var t="all"===this.component.serializableProperties?this.properties:this.component.serializableProperties,e={},n=this;return t.forEach((function(t){e[t]=$.extend(!0,[],n._data[t])})),e},gt.prototype.handleExternalEvent=function(t,e){switch(t){case gt.Events.SAMPLE_ADDED:this.appendDataPoint(Object.keys(e),e);break;case gt.Events.SAMPLE_CHANGED:this.editDataPoint(e.index,e.property,e.newValue);break;case gt.Events.SAMPLE_REMOVED:this.removeDataPoint(e.props,e.index);break;case gt.Events.DATA_TRUNCATED:break;case gt.Events.DATA_RESET:var n=this;Object.keys(e).forEach((function(t){n._resetProperty(t,e)})),this._trigger(gt.Events.DATA_RESET,this._data);break;case gt.Events.SELECTION_CHANGED:case gt.Events.LABELS_CHANGED:}};var vt=gt,yt=n(34),bt=n(35);function _t(t,e,n){if(e.helpIcon){var i=$('<i class="icon-question-sign lab-help-icon lab-component-help-icon"></i>');i.on("click",(function(){n.isActive()||n.showSingle(e.id)})),i.appendTo(t.getViewContainer())}}var xt={min:"min",max:"max",title:"title",titleOn:"titleOn",barColor:"barColor",fillColor:"fillColor",labels:"labels",gridLines:"gridLines",labelFormat:"labelFormat",units:"units"};var wt={title:"title",titlePosition:"titlePosition",buttonsStyle:"buttonsStyle",buttonsLayout:"buttonsLayout",enableAutoScaleButton:"enableAutoScaleButton",enableAxisScaling:"enableAxisScaling",enableZooming:"enableZooming",autoScaleX:"autoScaleX",autoScaleY:"autoScaleY",enableSelectionButton:"enableSelectionButton",clearSelectionOnLeavingSelectMode:"clearSelectionOnLeavingSelectMode",enableDrawButton:"enableDrawButton",drawIndex:"drawIndex",dataPoints:"dataPoints",markAllDataPoints:"markAllDataPoints",showRulersOnSelection:"showRulersOnSelection",fontScaleRelativeToParent:"fontScaleRelativeToParent",hideAxisValues:"hideAxisValues",xlabel:"xlabel",xmin:"xmin",xmax:"xmax",ylabel:"ylabel",ymin:"ymin",ymax:"ymax",lineWidth:"lineWidth",xTickCount:"xTickCount",yTickCount:"yTickCount",xscaleExponent:"xscaleExponent",yscaleExponent:"yscaleExponent",xFormatter:"xFormatter",yFormatter:"yFormatter",lines:"lines",bars:"bars",dataColors:"dataColors",legendLabels:"legendLabels",legendVisible:"legendVisible"},Ct=0;var Tt=n(27),St=n.n(Tt);function kt(t){if(!1===t.success)throw new Error("CODAP error: "+t.values.error)}var At={isCodapPresent:!1,init:function(t){this.codapPhone||(this.frameConfig=t,this.codapPhone=new St.a.IframePhoneRpcEndpoint(this.notificationHandler.bind(this),"data-interactive",window.parent))},isEmbeddedInCODAP:function(){return this.isCodapPresent},canExportData:function(){return this.isCodapPresent},notificationHandler:function(t,e){var n=t.action,i=t.resource,r={success:!0};t&&"codap-present"===t.message?(this.isCodapPresent=!0,this.initInteractiveFrame(),this.codapDidConnect()):"get"===n&&"interactiveState"===i&&(r.values={version:1}),e(r)},initInteractiveFrame:function(){this.doCommand({action:"get",resource:"interactiveFrame"},function(t){kt(t);var e=t.values,n={name:this.frameConfig.title,title:this.frameConfig.title,preventDataContextReorg:!1};e.savedState||(n.dimensions={width:640,height:640/this.frameConfig.aspectRatio}),this.doCommand({action:"update",resource:"interactiveFrame",values:n},kt)}.bind(this))},doCommand:function(t,e){this.codapPhone.call(t,e)},exportData:function(t,e,n,i,r){n=n||[],(t=t.slice()).unshift({name:"Run",type:"nominal"});var o,a,s=function(t){return{dataContextName:t.t("codap.dataContextName"),parentTable:{singleCase:t.t("codap.parentTable.singleCase"),pluralCase:t.t("codap.parentTable.pluralCase"),singleCaseWithArticle:t.t("codap.parentTable.singleCaseWithArticle"),setOfCases:t.t("codap.parentTable.setOfCases"),setOfCasesWithArticle:t.t("codap.parentTable.setOfCasesWithArticle")},childTable:{singleCase:t.t("codap.childTable.singleCase"),pluralCase:t.t("codap.childTable.pluralCase"),singleCaseWithArticle:t.t("codap.childTable.singleCaseWithArticle"),setOfCases:t.t("codap.childTable.setOfCases"),setOfCasesWithArticle:t.t("codap.childTable.setOfCasesWithArticle")},singleTable:{singleCase:t.t("codap.singleTable.singleCase"),pluralCase:t.t("codap.singleTable.pluralCase"),singleCaseWithArticle:t.t("codap.singleTable.singleCaseWithArticle"),setOfCases:t.t("codap.singleTable.setOfCases"),setOfCasesWithArticle:t.t("codap.singleTable.setOfCasesWithArticle")}}}(r),l=n.length>0;l?(o=s.parentTable.pluralCase,a=s.childTable.pluralCase):o=s.singleTable.pluralCase;var u=function(r){(e=e.slice()).unshift(r),function(t,e){for(var n=[],i=0,r=t.length;i<r;i+=e)n.push(t.slice(i,i+e));return n}((l?i:["this_value_is_ignored"]).map((function(i){var r={};return t.forEach((function(t,n){r[t.name]=e[n]})),n.forEach((function(t,e){r[t.name]=i[e]})),r})),100).forEach(function(t,e){this.doCommand({action:"create",resource:"dataContext.item",values:t},function(t){kt(t),0===e&&this.openTable()}.bind(this))}.bind(this))}.bind(this),c=function(){var e=[{name:o,attrs:t,labels:l?s.parentTable:s.singleTable,collapseChildren:!0}];l&&e.push({name:a,attrs:n,parent:o,labels:s.childTable}),this.doCommand({action:"create",resource:"dataContext",values:{title:s.dataContextName,collections:e}},(function(t){kt(t),u(1)}))}.bind(this);(function(){this.doCommand({action:"get",resource:"dataContext"},function(t){t.success?this.doCommand({action:"get",resource:"collection["+o+"].allCases"},function(t){kt(t);var e=t.values.cases.length,n=e>0?t.values.cases[e-1].case.values.Run:0;u(n+1)}.bind(this)):c()}.bind(this))}).bind(this)()},openTable:function(){this.doCommand({action:"create",resource:"component",values:{type:"caseTable"}},kt)},logAction:function(t){this.doCommand({action:"notify",resource:"logMessage",values:{formatStr:t}})}},Et={autoOpen:!1,dialogClass:"interactive-dialog",width:"80%"};function Mt(t,e){var n=t.title||"",i=t.id||"";this.$element=$('<div id="'+i+'" title="'+n+'">'),t=$.extend({closeText:e.t("dialog.close_tooltip")},Et,t),this.$element.dialog(t),this._eventNamePrefix=t.dialogClass.split("-").map((function(t){return t[0].toUpperCase()+t.slice(1)})).join("")}Mt.prototype.open=function(){this.$content.css("max-height",.5*$(window).height()+"px"),this.$element.dialog("open")},Mt.prototype.close=function(){this.$element.dialog("close")},Mt.prototype.set=function(t,e){this.$element.dialog("option",t,e)},Mt.prototype.setContent=function(t){this.$content=$("<div>").append(t),this.$element.empty(),this.$element.append('<input type="hidden" autofocus="autofocus" />'),this.$element.append(this.$content)},Mt.prototype.enableLogging=function(t){var e=null,n=this._eventNamePrefix;this.$element.off(".logging"),this.$element.on("dialogopen.logging",(function(){t(n+"Opened"),e=Date.now()})),this.$element.on("dialogclose.logging",(function(){t(n+"Closed",{wasOpenFor:(Date.now()-e)/1e3})}))};var Pt=Mt;function Dt(t){var e,n,i,r,o,a,s,l,u=new ft,c=!1,h=!1,d=!1,p=!0,f=!1;function m(){var t,e,n=[];for(t=0,e=i.length;t<e;t++)n.push(s.get(i[t]));return n}function g(){o=[m()]}function v(){o.push(m()),d=!0}function y(){o.length=s.stepCounter()+1}function b(e,n){var i;if(n){i={};for(var r=0;r<n.labels.length;r++)i[n.labels[r]]=n.values[r]}t.logAction(e,i)}function _(e){var n,i,r,o,a;n="Discard data?",i="<p>Pressing New Run without pressing Analyze Data will discard the current data. Set up a new run without saving the data first?</p><input type='checkbox' id='dont-ask' name='dont-ask'></input><label for='dont-ask'>Don't show this message again</label>",r=[{id:"button-cancel",text:"Go back",click:function(){p=!$("#dont-ask").is(":checked"),$(this).remove(),e.cancel()}},{id:"button-reset",text:"Discard the data",click:function(){b("DiscardedData",C()),p=!$("#dont-ask").is(":checked"),$(this).remove(),e.proceed()}}],o=t.i18n,(a=new Pt({width:"60%",modal:!0,id:"exporter-modal-alert",title:n,buttons:r},o)).setContent(i),a.open()}function x(t,e){return!!(t===s&&Dt.canExportData()&&p&&c&&d)&&(_(e),!0)}function w(r,p){function f(){function r(t){return Object.prototype.hasOwnProperty.call(s.properties,t)}s=t.getModel(),n=(e.perRun||[]).filter(r),null==e.perTick||0===e.perTick.length?(c=!1,i=[]):(c=!0,i=["displayTime"].concat(e.perTick.filter(r))),g(),s.on("tick.exportController",v),s.on("reset.exportController",g),s.on("play.exportController",(function(){y(),l||(l=C()),o[s.stepCounter()]=m()})),s.on("invalidation.exportController",y),"new-run"===p&&b("SetUpNewRun"),l=null,d=!1,a.canExportData()&&(h=!0,u.modelCanExportData())}h=!1,a.canExportData()?f():a.on("canExportData.export-controller",f)}function C(){for(var t={labels:[],values:[]},e=0;e<n.length;e++)t.labels[e]=T(n[e]),t.values[e]=s.get(n[e]);return t}function T(t){var e=s.getPropertyDescription(t),n=e&&e.getLabel(),i=e&&e.getUnitAbbreviation(),r="";return n&&n.length>0?r+=n:r+=t,i&&i.length>0&&(r+=" (",r+=i,r+=")"),r}function S(t){var e=s.getPropertyDescription(t),n=e&&e.getLabel(),i=e&&e.getUnitAbbreviation();return{name:n&&n.length>0?n:t,unit:i&&i.length>0?i:void 0}}return a={canExportData:function(){return Dt.canExportData()},modelCanExportData:function(){return h},dataAreAvailableForExport:function(){return!c||s.properties.hasPlayed&&s.isStopped()&&d},isUnexportedDataPresent:function(){return d},init:function(t){r=((e=t).selectionComponents||[]).slice(),f=!0},selectedData:function(){var e,n,i,a=1/0,s=-1/0;if(!f)throw new Error("ExportController: selectData() was called before controller was initialized.");for(e=0;e<r.length;e++)(n=t.getComponent(r[e]))&&n.selectionDomain&&null!==(i=n.selectionDomain())&&2===i.length&&(a>i[0]&&(a=i[0]),s<i[1]&&(s=i[1]));return a<1/0||s>-1/0?o.filter((function(t){return t[0]>a&&t[0]<s})):o},exportData:function(){var e,r,o=[],a=[],u=[];if(!f)throw new Error("ExportController: exportData() was called before controller was initialized.");for(b("ExportedModel",C()),(e=function(){if(!l)return!1;var t=C(),e={values:[],labels:[]},n=!1;return t.values.forEach((function(i,r){var o=l.values[r],a=t.labels[r],s=o!==i;e.labels.push(a+" changed?"),e.values.push(s),n=n||s,e.labels.push(a+" (start of run)"),e.values.push(o),e.labels.push(a+" (sent to CODAP)"),e.values.push(i)})),!!n&&e}())&&b("ParameterChangeBetweenStartAndExport",e),r=0;r<n.length;r++)o[r]=S(n[r]),a[r]=s.get(n[r]);for(r=0;r<i.length;r++)u[r]=S(i[r]);At.exportData(o,a,u,this.selectedData(),t.i18n),d=!1}},At.init({title:t.get("title"),aspectRatio:t.get("aspectRatio")}),u.mixInto(a),u.addEventTypes("canExportData","modelCanExportData"),At.codapDidConnect=function(){Dt.canExportData()&&u.canExportData()},t.on("modelLoaded.exportController",(function(t){w(0,t)})),t.on("modelReset.exportController",(function(t){w(0,t)})),t.on("willResetModel",x),a}Dt.canExportData=function(){return At.canExportData()};var Ot=Dt;function It(t){var e=t.config;this.enabled=e.enabled,this._properties="boundToComponents"===e.properties?t.boundProperties:e.properties,this._interactivesController=t.interactivesController,this._model=null,this._phone=St.a.getIFrameEndpoint(),this._phone.initialize(),At.init(),this._interactivesController.on("modelLoaded.logController",this._modelLoadedHandler.bind(this)),this._interactivesController.on("interactiveWillReload.logController",this._interactiveWillReloadHandler.bind(this)),this._setupComponents(t.componentByID,e.components),this._enableLoggingIn(t.additionalComponents)}It.prototype.logAction=function(t,e){this.enabled&&(At.isEmbeddedInCODAP()?this._logToCODAP(t,e):this._genericLog(t,e))},It.prototype._genericLog=function(t,e){this._phone.post("log",{action:t,data:e})},It.prototype._logToCODAP=function(t,e){var n=t;e&&(n+=": "+JSON.stringify(e)),At.logAction(n)},It.prototype._setupComponents=function(t,e){if("none"!==e&&e!==[]){"all"===e&&(e=Object.keys(t));var n=[];e.forEach((function(e){n.push(t[e])})),this._enableLoggingIn(n)}},It.prototype._enableLoggingIn=function(t){var e=this.logAction.bind(this);t.forEach((function(t){t&&t.enableLogging&&t.enableLogging(e)}))},It.prototype._interactiveWillReloadHandler=function(){this.logAction("ReloadedInteractive",this._getProperties())},It.prototype._modelLoadedHandler=function(t){this._model=this._interactivesController.getModel(),this._model.on("log.logController",function(t,e){this.logAction(t,e)}.bind(this)),this._model.on("play.logController",function(){this.logAction("StartedModel",this._getProperties())}.bind(this)),this._model.on("stop.logController",function(){this.logAction("StoppedModel",this._getProperties())}.bind(this)),this._model.on("willReset.logController",function(){this.logAction("ReloadedModel",this._getProperties())}.bind(this))},It.prototype._getProperties=function(){var t=this._model,e={};return this._properties.forEach((function(n){var i,r,o,a,s;e[(i=n,r=t.getPropertyDescription(i),o=r&&r.getLabel(),a=r&&r.getUnitAbbreviation(),s="",o&&o.length>0?s+=o:s+=i,a&&a.length>0&&(s+=" ("+a+")"),s)]=t.get(n)})),e};var Lt=It;function Rt(t){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Nt=0,Ft={};function Bt(t){return function(){throw new ReferenceError(t+" is not defined")}}function zt(){var t,e,n,i,r=Object.getOwnPropertyNames(window);for(e=0,n=r.length;e<n;e++)t=r[e],Ft.hasOwnProperty(t)||(i=Bt(t),Object.defineProperty(Ft,t,{set:i,get:i}))}function jt(t,e){function n(t){e.on("reset.common-scripting-api-"+Nt++,t)}var i={api:function(){function i(t){return Math.floor(Math.random()*t)}function r(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function o(t,e,n){"undefined"!=typeof _gaq&&(t||(t="Interactive"),_gaq.push(["_trackEvent",t,e,n]))}return{isInteger:function(t){return"number"==typeof t&&parseFloat(t)===parseInt(t,10)},isArray:function(t){return"object"===Rt(t)&&t.slice===Array.prototype.slice},randomInteger:i,randomFloat:function(t){return t?Math.random()*t:Math.random()},swapElementsOfArray:r,choose:function(t,e){var n,o=[];for(n=0;n<e;n++)o[n]=n;for(n=0;n<t;n++)r(o,n,n+i(e-n));return o.length=t,o},deg2rad:Math.PI/180,rad2deg:180/Math.PI,trackEvent:o,format:d3.format,get:function(){return e.get.apply(e,arguments)},set:function(){return e.set.apply(e,arguments)},freeze:function(){return e.freeze.apply(e,arguments)},unfreeze:function(){return e.unfreeze.apply(e,arguments)},logAction:function(e,n){t.logAction(e,n)},loadModel:function(n,i){e.stop(),t.loadModel(n,null,i)},getLoadedModelId:function(){return t.getLoadedModelId()},onPropertyChange:function(t,n){e.addPropertiesListener([t],(function(){n(e.get(t))}))},callAt:function(t,i){function r(){e.properties.time>=t&&(i(),e.removeObserver("time",r))}function o(){e.addObserver("time",r)}n(o),this.onStart((function(){e.properties.time<t&&o()})),o()},callEvery:function(t,i){var r=0;e.addObserver("time",(function(){for(;e.properties.time-r>=t;)i(),r+=t})),n((function(){r=0})),this.onStart((function(){for(;r>e.properties.time;)r-=t}))},onClick:function(e,n){t.modelController.modelContainer.setClickHandler("."+e,n)},onDrag:function(e,n){t.modelController.modelContainer.setDragHandler(e,n)},onSelect:function(e){t.modelController.modelContainer.setSelectHandler(e)},setComponentDisabled:function(e,n){t.getComponent(e).setDisabled(n)},clearDataSet:function(e){t.getDataSet(e).clearData()},resetDataSet:function(e){t.getDataSet(e).resetData()},resetDataSetProperties:function(e,n){t.getDataSet(e).resetProperties(n)},appendDataPropertiesToComponent:function(e){var n=t.getComponent(e);void 0!==n&&n.appendDataPropertiesToComponent()},setComponentAttributes:function(e,n){var i=t.getComponent(e);if(!i)throw new Error("Component "+e+" not found.");if("function"!=typeof i.setAttributes)throw new Error("Component "+e+" does not support dynamic attributes change.");i.setAttributes(n)},syncAxisRangesToPropertyRanges:function(e){var n=t.getComponent(e);if(!n)throw new Error("Component "+e+" not found.");if(!n.syncAxisRangesToPropertyRanges)throw new Error("Component "+e+" does not support syncAxisRangesToPropertyRanges.");n.syncAxisRangesToPropertyRanges()},scrollXAxisToZero:function(e){var n=t.getComponent(e);if(!n)throw new Error("Component "+e+" not found.");if(!n.scrollXAxisToZero)throw new Error("Component "+e+" does not support scrollXAxisToZero.");n.scrollXAxisToZero()},resetGraphSelection:function(e){var n=t.getComponent(e);if(!n)throw new Error("Component "+e+" not found.");if(!n.selectionDomain)throw new Error("Component "+e+" does not support selectionDomain.");if(!n.selectionEnabled)throw new Error("Component "+e+" does not support selectionEnabled.");n.selectionDomain(null),n.selectionEnabled(!1)},addAnnotation:function(e,n){var i=t.getComponent(e);if(!i)throw new Error("Component "+e+" not found.");if(!i.addAnnotation)throw new Error("Component "+e+" does not support addAnnotation.");i.addAnnotation(n)},resetAnnotations:function(e){var n=t.getComponent(e);if(!n)throw new Error("Component "+e+" not found.");if(!n.resetAnnotations)throw new Error("Component "+e+" does not support resetAnnotations.");n.resetAnnotations()},start:function(){e.start(),o("Interactive","Start","Starting interactive: "+t.get("title"))},onStart:function(t){e.on("play.custom-script"+Nt++,t)},stop:function(){e.stop()},onStop:function(t){e.on("stop.custom-script",t)},reloadModel:function(e){t.reloadModel(e)},reloadInteractive:function(){t.reloadInteractive()},stepForward:function(){e.stepForward(),e.isNewStep()||t.updateModelView()},stepBack:function(){e.stepBack(),t.updateModelView()},tick:function(){e.tick()},isStopped:function(){return e.isStopped()},getTime:function(){return e.get("time")},getFPS:function(){return e.getFPS()},getSimulationProgressRate:function(){return e.getSimulationProgressRate()},startPerformanceTuning:function(){e.performanceOptimizer.enable()},repaint:function(){t.repaintModelView()},canExportData:function(){var e=t.exportController;return e&&e.canExportData()||!1},isUnexportedDataPresent:function(){var e=t.exportController;return e&&e.isUnexportedDataPresent()||!1},dataAreAvailableForExport:function(){var e=t.exportController;return e&&e.dataAreAvailableForExport()||!1},exportData:function(){var e=t.exportController;if(!e||!e.canExportData())throw new Error("No exports have been specified.");e.exportData()},getCardinalDirection:function(t,e){var n=["",""];return t>Math.PI/8&&t<7*Math.PI/8?n[0]=e?"S":"N":t>9*Math.PI/8&&t<15*Math.PI/8&&(n[0]=e?"N":"S"),t<3*Math.PI/8||t>13*Math.PI/8?n[1]=e?"W":"E":t>5*Math.PI/8&&t<11*Math.PI/8&&(n[1]=e?"E":"W"),n.join("")},getCompassDirection:function(t,e){var n=360-180*(t=(t+3*Math.PI/2)%(2*Math.PI))/Math.PI;return e?(180+n)%360:n},Math:Math,Infinity:1/0,isFinite:isFinite,NaN:NaN,isNaN:isNaN,undefined:void 0,alert:d.a,setTimeout:function(t){if(!t||t.constructor!==Function)throw new TypeError("Must pass a Function instance to Lab's setTimeout.");var e=Array.prototype.slice.apply(arguments);return e[0]=t.bind(void 0),window.setTimeout.apply(window,e)},setInterval:function(t){if(!t||t.constructor!==Function)throw new TypeError("Must pass a Function instance to Lab's setInterval.");var e=Array.prototype.slice.apply(arguments);return e[0]=t.bind(void 0),window.setInterval.apply(window,e)},clearTimeout:window.clearTimeout,clearInterval:window.clearInterval,console:null!==window.console?window.console:{log:function(){},error:function(){},warn:function(){},dir:function(){}}}}(),get model(){return e},get intController(){return t},bindModel:function(t){e=t},freeze:function(){Object.freeze(this.api)},extend:function(t){$.extend(this.api,new t(this))},exposeScriptingAPI:function(){window.script=this.api,window.script.run=function(t,e){var n,r=[],o=[];for(n in e)e.hasOwnProperty(n)&&(r.push(n),o.push(e[n]));return i.makeFunctionInScriptContext.apply(null,r.concat(t)).apply(null,o)}},makeFunctionInScriptContext:function(){var t,e,n,r=Array.prototype.slice.call(arguments,0,arguments.length-1),o=arguments[arguments.length-1];"string"!=typeof o&&(o=o.join("      \n")),t="with (shadowedGlobals) {\n  with (scriptingAPI) {\n    return function("+r.join(",")+") {\n      'use strict';\n      "+o+"\n    };\n  }\n}";try{e=new Function("shadowedGlobals","scriptingAPI",t),n=e(Ft,i.api)}catch(t){return Object(d.a)('Error compiling script: "'+t.toString()+'"\nScript:\n\n'+o),function(){throw new Error("Cannot run a script that could not be compiled")}}return function(){zt();try{return n.apply(null,Array.prototype.slice.call(arguments))}catch(t){Object(d.a)('Error running script: "'+t.toString()+'"\nScript:\n\n'+o)}}}};return i}function Vt(t,e){function n(){}n.prototype=e.prototype,t.prototype=new n,t.superClass=e.prototype,t.prototype.constructor=t}var Ht=function(t){t.hasClass("lab-disabled")||(t.addClass("lab-disabled"),t.append('<div class="lab-disabled-overlay"/>'))},Wt=function(t){t.removeClass("lab-disabled"),t.find(".lab-disabled-overlay").remove()},Ut=Wt,$t=Ht;function Gt(t,e){t.setDisabled=function(t){var e=this.getViewContainer();t?($t(e),this.isDisabled=!0):(Ut(e),this.isDisabled=!1)},t.isDisabled=!1,e&&t.setDisabled(e.disabled)}function qt(t,e,n){this._interactivesController=n,this._scriptingAPI=this._interactivesController.getScriptingAPI(),this._model=this._interactivesController.getModel(),this.component=p.a.validateCompleteness(st[t],e),this.$element=$("<div>").attr("id",e.id).addClass("component"),this.component.width&&this.$element.css("width",this.component.width),this.component.height&&this.$element.css("height",this.component.height),this.component.disabled&&this.setDisabled(this.component.disabled),this._optionallyAddOnClickHandlers(),this.component.classes&&this.component.classes.length&&this.$element.addClass(this.component.classes.join(" ")),this.component.tooltip&&this.$element.attr("title",this.component.tooltip),_t(this,this.component,this._interactivesController.helpSystem)}qt.prototype._modelLoadedCallback=function(){this._scriptingAPI=this._interactivesController.getScriptingAPI(),this._model=this._interactivesController.getModel(),this._optionallyAddOnClickHandlers()},qt.prototype._updateClickHandler=function(t){this._actionClickFunction="function"!=typeof t?this._scriptingAPI.makeFunctionInScriptContext(t):t;var e=this;this._onClick(this._nameSpace,(function(){e._actionClickFunction()})),this.$element.addClass("clickable")},qt.prototype._optionallyAddOnClickHandlers=function(){void 0!==this.component.onClick&&this._updateClickHandler(this.component.onClick),void 0!==this.component.action&&this._updateClickHandler(this.component.action)},qt.prototype.setAction=function(t){"function"!=typeof script&&(this.component.action=t),this._updateClickHandler(t)},qt.prototype.setOnClick=function(t){void 0!==this.component.onClick&&(this.component.onClick=t,this._updateClickHandler(this.component.onClick))},qt.prototype.enableLogging=function(t){var e=this.component;if(void 0!==e.onClick||void 0!==e.action){var n=e.type[0].toUpperCase()+e.type.slice(1)+"Clicked",i={id:e.id};this._onClick(this._nameSpace+"logging",(function(){i.label=e.label||e.text||e.title,t(n,i)}))}},qt.prototype.getViewContainer=function(){return this.$element},qt.prototype.serialize=function(){return this.component},qt.prototype._onClick=function(t,e){this.$element.off("click."+t),this.$element.on("click."+t,this._clickTargetSelector||null,e)},Gt(qt.prototype);var Yt=qt,Xt=0;function Qt(t,e){this._actionClickFunction=function(){},this._nameSpace="button"+ ++Xt,this._clickTargetSelector="button",Yt.call(this,"button",t,e),this.$element.addClass("interactive-button"),this.button=$("<button>").html(t.text).appendTo(this.$element),this.setAttributes=function(t){t.text&&void 0!==t.text&&(this.component.text=t.text,this.button.html(t.text))}}Vt(Qt,Yt),Qt.prototype.modelLoadedCallback=function(){Qt.superClass._modelLoadedCallback.call(this)};var Kt=Qt;function Jt(t,e){var n,i,r,o,a,s,l,u,c,h;function d(){m(c.get(n))}function f(){var t=c.getPropertyDescription(n);u.setDisabled(t.getFrozen())}function m(t){t?(o.prop("checked",!0),a.addClass("checked")):(o.prop("checked",!1),a.removeClass("checked"))}function g(t){t.preventDefault(),o.prop("checked")?m(!1):m(!0),o.trigger("change")}return c=e.getModel(),h=e.getScriptingAPI(),t=p.a.validateCompleteness(st.checkbox,t),n=t.property,i=t.action,r=t.initialValue,(s=$("<label>").append("<span>"+t.text+"</span>")).attr("for",t.id),o=$('<input type="checkbox">').attr("id",t.id),e&&o.attr("tabindex",e.getNextTabIndex()),a=$('<div class="fakeCheckable">'),o.css("display","none"),(l="left"===t.textOn?$("<div>").append(s).append(o).append(a.addClass("right")):$("<div>").append(o).append(a).append(s)).addClass("interactive-checkbox"),l.addClass("component"),a.on("click",g),s.on("click",g),l.css({width:t.width,height:t.height}),i&&(i=h.makeFunctionInScriptContext("value",i)),o.on("change",(function(){var t,e=!1;$(this).is(":checked")&&(e=!0),void 0!==n&&((t={})[n]=e,c.set(t)),void 0!==i&&i(e)})),t.tooltip&&l.attr("title",t.tooltip),void 0!==r&&m(r),Gt(u={modelLoadedCallback:function(){c&&void 0!==n&&(c.removeObserver(n,d),c.removePropertyDescriptionObserver(n,f)),c=e.getModel(),h=e.getScriptingAPI(),void 0!==n&&(c.addPropertiesListener([n],d),c.addPropertyDescriptionObserver(n,f),d())},enableLogging:function(e){o.off("change.logging"),o.on("change.logging",(function(){var i={id:t.id,label:t.text,value:$(this).is(":checked")};n&&(i.property=n),e("CheckboxChanged",i)}))},getViewContainer:function(){return l},serialize:function(){var e=$.extend(!0,{},t);return void 0===n&&(e.initialValue=!!o.is(":checked")),e}},t),_t(u,t,e.helpSystem),u}var Zt=n(185);function te(t){var e="";return $.isArray(t)||(t=[t]),t.forEach((function(t){e+=t+"\n"})),('<div class="markdown-typography">'+Zt.markdown.toHTML(e)+"</div>").replace(/<a(.*?)>/g,'<a$1 class="opens-in-new-window" target="blank">')}function ee(t,e){Yt.call(this,"text",t,e),this.$element.addClass("interactive-text"),this.$element.append(te(this.component.text))}Vt(ee,Yt),ee.prototype.modelLoadedCallback=function(){ee.superClass._modelLoadedCallback.call(this)};var ne=ee,ie=/^https?:\/\//i;function re(t,e){Yt.call(this,"image",t,e),this._controller=e,this._$img=$("<img>"),this._externalUrl=ie.test(this.component.src),this._externalUrl&&this._$img.attr("src",this.component.src),"auto"!==this.component.width&&this._$img.css("width","100%"),"auto"!==this.component.height&&this._$img.css("height","100%"),this._$img.appendTo(this.$element)}Vt(re,Yt),re.prototype.modelLoadedCallback=function(){var t,e;if(!this._externalUrl){switch(t=this.component.src,this.component.urlRelativeTo){case"page":e="";break;case"model":default:e=this._controller.modelController.modelUrl||""}e=e.slice(0,e.lastIndexOf("/")+1),t=r.a.modelsRootUrl+e+t,this._$img.attr("src",t)}};var oe=re;function ae(t){var e,n,i,r=t.id,o=t.options,a=t.label,s=t.labelOn,l=t.onChange;function u(){var t;e?e=!1:(t=$(this).prop("selectedIndex"),l(o[t],t))}return{update:function(t){e=!0,n.data("selectBox-selectBoxIt").selectOption(t.toString().trim())},render:function(t){var e,l,c,h,d,p=[];function f(e){return e/parseFloat(t.css("font-size"))}function m(){return this.width()}return n=$("<select>"),o.forEach((function(t){e=$("<option>").html(t.text),p.push(e),t.disabled&&e.prop("disabled",t.disabled),t.selected&&e.prop("selected",t.selected),void 0!==t.value&&e.prop("value",t.value),n.append(e)})),n.change(u),i=$("<div>").attr("id",r),a&&((l=$("<span>").text(a)).addClass("label"),l.addClass("top"===s?"on-top":"on-left"),i.append(l)),i.append(n),n.selectBoxIt(),i.find(".selectboxit").css("width","auto"),h=(c=f(i.measure(m,"ul",t)))+"em",d=c+f(i.measure(m,".selectboxit-arrow-container",t))+.3+"em",i.find(".selectboxit").css("width",d),i.find(".selectboxit-text").css("max-width",h),i.find(".selectboxit-container select").css({width:d,height:"100%"}),i},get $element(){return i},refresh:function(){n.data("selectBox-selectBoxIt").refresh()},destroy:function(){n.data("selectBox-selectBoxIt").destroy(),i.remove()}}}var se=n(33),le=n.n(se);function ue(t,e){var n={clone:function(){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=s.a.clone(t[e]));return n}};return(e=e||{}).padArraysWithZeroes?n.restore=function(e){var n,i,r,o;for(n in t)if(t.hasOwnProperty(n))for(i=t[n],s.a.copy(e[n],i),r=e[n].length,o=i.length;r<o;r++)i[r]=0}:n.restore=function(e){var n;for(n in t)t.hasOwnProperty(n)&&s.a.copy(e[n],t[n])},n}le.a;var ce=n(3),he=function(t,e){var n,i;if(Array.isArray(t))for(n=0,i=t.length;n<i;n++)s.a.isArray(t[n])&&(t[n]=s.a.extend(t[n],e));else for(n in t)t.hasOwnProperty(n)&&s.a.isArray(t[n])&&(t[n]=s.a.extend(t[n],e))},de=function(){if("undefined"==typeof navigator)return!0;var t=navigator.userAgent.match(/ AppleWebKit\/([0123456789.+]+) \(KHTML, like Gecko\) Version\/([0123456789.]+) (Safari)\/([0123456789.]+)/);return!t||!t[3]}(),pe=s.a.typed&&de,fe={floatType:pe?"Float64Array":"regular",int32Type:pe?"Int32Array":"regular",int16Type:pe?"Int16Array":"regular",int8Type:pe?"Int8Array":"regular",uint16Type:pe?"Uint16Array":"regular",uint8Type:pe?"Uint8Array":"regular"},me=n(2),ge=ce.a.convert(.2,{from:ce.a.unit.EV,to:ce.a.unit.MW_ENERGY_UNIT}),ve=ce.a.convert(.05,{from:ce.a.unit.EV,to:ce.a.unit.MW_ENERGY_UNIT}),ye=2*Math.PI;function be(t,e){var n,i,r,o,a,l,u,c,h,d,f,m,g,v=p.a.validateCompleteness(me.a.quantumDynamics,e),y=new ft("photonAbsorbed"),b=v.elementEnergyLevels,_=v.radiationlessEmissionProbability,x=v.lightSource,w=t.getDimensions(),C=[],T=0,S=[],k=0,A=function(t,e){if(Math.random()<0)return 2;var n=E(t,e);if(!1!==n&&n>0){F(t);var i=n/ge;return y.photonAbsorbed(i),1}},E=function(t,e){if(b){var n,o,s=b[r.element[e]],l=r.excitation[e],u=s[l],c=a.angularFrequency[t]*ge;for(n=l+1,o=s.length;n<o;n++)if(Math.abs(s[n]-u-c)<ve)return r.excitation[e]=n,C[e]=i,s[n]-u;return!1}},M=function(t,e){var n,i;return l=t,u=e,i=Math.random()<.5?l:u,(n=P(i))||(n=P(l+u-i)),n},P=function(t){var e,n,o,a,s,l,u,c,h=b[r.element[t]];if(h){for(D(),o=O(),n=h[e=r.excitation[t]],u=e+1,c=h.length;u<c&&!(o<h[u]-n);u++)a=u;return!!a&&(a-=e,s=Math.ceil(Math.random()*a)+e,r.excitation[t]=s,C[t]=i,l=h[s]-n,I(l),!0)}},D=function(){var t=r.x[u]-r.x[l],e=r.y[u]-r.y[l],n=1/Math.sqrt(t*t+e*e);m=t*n,g=e*n,c=r.vx[l]*m+r.vy[l]*g,d=r.vy[l]*m-r.vx[l]*g,h=r.vx[u]*m+r.vy[u]*g,f=r.vy[u]*m-r.vx[u]*g},O=function(){var t=h-c,e=r.mass[l],n=r.mass[u];return.5*t*t*e*n/(e+n)},I=function(t){var e=r.mass[l],n=r.mass[u],i=e*c*c+n*h*h-t,o=e*c+n*h,a=(o-Math.sqrt(n/e*(i*(e+n)-o*o)))/(e+n),s=(o+Math.sqrt(e/n*(i*(e+n)-o*o)))/(e+n);r.vx[l]=a*m-d*g,r.vy[l]=a*g+d*m,r.vx[u]=s*m-f*g,r.vy[u]=s*g+f*m},L=function(t,e){var n,i=r.excitation[t],o=r.excitation[e];if(l=t,u=e,!i&&!o)return!1;if(i)if(o){if(n=Math.random()<.5?l:u,!R(n)&&!R(n=l+u-n))return!1}else{if(!R(l))return!1;n=l}else{if(!R(u))return!1;n=u}return N(n),!0},R=function(t){if(i>C[t]+200)return!0},N=function(t){var e=b[r.element[t]],n=r.excitation[t],i=Math.floor(Math.random()*n),o=e[i]-e[n];r.excitation[t]=i,Math.random()<_?(D(),I(o)):z(t,-o)},F=function(t){k--,a.x[t]=a.y[t]=a.vx[t]=a.vy[t]=a.angularFrequency[t]=0},B=function(t,e,n,i){var r=.002*Math.cos(n),o=.002*Math.sin(n),s=i/ge,l=function(){var t,e=a.x.length;if(k+1>e)return he(a,e+10),e;for(t=0;t<e;t++)if(!a.vx[t]&&!a.vy[t])return t}();k++,a.id[l]=T++,a.x[l]=t,a.y[l]=e,a.vx[l]=r,a.vy[l]=o,a.angularFrequency[l]=s},z=function(t,e){var n=Math.random()*ye-Math.PI,i=Math.cos(n),a=Math.sin(n),s=o.sigma[r.element[t]],l=r.x[t]+.51*s*i,u=r.y[t]+.51*s*a;B(l,u,n,e)},j=function(t,e){if(0!==r.excitation[t]&&!(Math.random()>.005*e)){var n,i,o,a=Math.random(),s=Math.random(),l=r.excitation[t],u=1/l;for(o=0;o<l;o++)if(o*u<=a&&a<(o+1)*u&&_<s)return i=(n=b[r.element[t]])[l]-n[o],r.excitation[t]=o,void z(t,i)}},V=function(){var t,e,n,i,r,o,a,s,l,u=w[0],c=w[1],h=w[2]-u,d=w[3]-c,p=(l=x.angleOfIncidence,(l%=ye)<0||l>ye?Math.abs(ye-Math.abs(l)):l),f=x.numberOfBeams,m=function(){return(x.monochromatic?x.frequency:2.5+12*Math.random())*ge};if(0==p)for(t=d/(f+1),s=1;s<=f;s++)B(u,c+t*s,p,m());else if(p.toFixed(4)==(Math.PI/2).toFixed(4))for(t=h/(f+1),s=1;s<=f;s++)B(u+t*s,c,p,m());else if(p.toFixed(4)==Math.PI.toFixed(4))for(t=d/(f+1),s=1;s<=f;s++)B(u+h,c+t*s,p,m());else if(p.toFixed(4)==(3*Math.PI/2).toFixed(4))for(t=h/(f+1),s=1;s<=f;s++)B(u+t*s,c+d,p,m());else if(i=(t=((e=Math.abs(Math.sin(p)))*d<(n=Math.abs(Math.cos(p)))*h?d/n:h/e)/f)/e,r=t/n,o=Math.floor(h/i),a=Math.floor(d/r),p>=0&&p<.5*Math.PI){for(s=1;s<=o;s++)B(u+i*s,c,p,m());for(s=0;s<=a;s++)B(u,c+d-r*s,p,m())}else if(p>=3*Math.PI/2){for(s=1;s<=o;s++)B(u+i*s,c+d,p,m());for(s=0;s<=a;s++)B(u,c+r*s,p,m())}else if(p<Math.PI&&p>=.5*Math.PI){for(s=0;s<=o;s++)B(u+h-i*s,c,p,m());for(s=1;s<=a;s++)B(u+h,c+d-r*s,p,m())}else if(p>=Math.PI&&p<3*Math.PI/2){for(s=0;s<=o;s++)B(u+h-i*s,c+d,p,m());for(s=1;s<=a;s++)B(u+h,c+r*s,p,m())}};return n={initialize:function(t){var e;r=t.atoms,o=t.elements,e=r.x.length,r.excitation=s.a.create(e,0,fe.int8Type),function(t){var e=0;t.x&&(e=10*Math.ceil(t.x.length/10)),a={id:s.a.create(e,0,fe.uint16Type),x:s.a.create(e,0,fe.floatType),y:s.a.create(e,0,fe.floatType),vx:s.a.create(e,0,fe.floatType),vy:s.a.create(e,0,fe.floatType),angularFrequency:s.a.create(e,0,fe.floatType)}}(v.photons),function(t){if(t&&t.x){["x","y","vx","vy","angularFrequency"].forEach((function(e){s.a.copy(t[e],a[e])}));for(var e=0;e<a.x.length;e++)(a.vx[e]||a.vy[e])&&(k++,a.id[e]=T++)}}(v.photons)},performActionWithinIntegrationLoop:function(e,n,s){i=s,function(t){var e,n,i,r;for(e=0,n=a.x.length;e<n;e++)(a.vx[e]||a.vy[e])&&(i=a.x[e]+=a.vx[e]*t,r=a.y[e]+=a.vy[e]*t,(i<w[0]||i>w[2]||r<w[1]||r>w[3])&&F(e))}(n),function(){var e,n,i,o,s,l,u,c,h=t.getNumberOfAtoms();for(e=0,n=a.x.length;e<n;e++)if(a.vx[e]||a.vy[e])for(i=a.x[e],o=a.y[e],s=0;s<h&&!((u=r.x[s]-i)*u+(c=r.y[s]-o)*c<(l=r.radius[s])*l&&1===A(e,s));s++);}(),function(e){var n,i,a,s,l,u,c,h,d,p,f,m,g,v,y,_=t.getNumberOfAtoms(),x=e.getList(),w=[];if(b){for(n=0;n<_;n++)for(d=r.x[n],p=r.y[n],a=e.getStartIdxFor(n),s=e.getEndIdxFor(n);a<s;a++)i=x[a],l=r.element[n],u=r.element[i],c=b[l],h=b[u],(c.length||h.length)&&((f=d-r.x[i])*f+(m=p-r.y[i])*m>=(g=.55*(o.sigma[l]+o.sigma[u]))*g||(w[n]=i,S[n]!==i&&((v=M(n,i))||(y=L(n,i)),(v||y)&&(S[n]=i,S[i]=n))));for(n=0,s=S.length;n<s;n++)i=S[n],isNaN(i)||w[n]!==i&&w[i]!==n&&(delete S[n],delete S[i])}}(e),function(e){if(b)for(var n=0,i=t.getNumberOfAtoms();n<i;n++)j(n,e)}(n),x.on&&s%x.radiationPeriod<n&&V()},turnOnLightSource:function(){x.on=!0},turnOffLightSource:function(){x.on=!1},setLightSourceAngle:function(t){x.angleOfIncidence=t},setLightSourceFrequency:function(t){x.frequency=t},setLightSourcePeriod:function(t){x.radiationPeriod=t},setLightSourceNumber:function(t){x.numberOfBeams=t},getPhotons:function(){return a},getNumPhotons:function(){return k},getViewPhotons:function(){var t=[],e=[];function n(t,e){var n=t.vx[e],i=t.vy[e],r=-180*Math.atan2(i,n)/Math.PI;return{id:t.id[e],x:t.x[e],y:t.y[e],vx:n,vy:i,angle:r,angularFrequency:t.angularFrequency[e]}}return function(){var i,r,o,a=this.getPhotons(),s=0;for(t.length=this.getNumPhotons(),e.length=a.x.length,i=0,r=a.x.length;i<r;i++)a.vx[i]||a.vy[i]?((o=e[i])&&o.id===a.id[i]?(o.x=a.x[i],o.y=a.y[i]):(o=n(a,i),e[i]=o),t[s++]=o):e[i]=null;return t}}(),getElementEnergyLevels:function(){return b},getRadiationlessEmissionProbability:function(){return _},getLightSource:function(){if(x)return x},getState:function(){return[new ue(a,{padArraysWithZeroes:!0}),{clone:function(){return{numPhotons:k}},restore:function(t){k=t.numPhotons}}]}},y.mixInto(n),n}be.INFRARED=2.5,be.ULTRAVIOLET=14.5;var _e=be,xe=_e.INFRARED,we=_e.ULTRAVIOLET;function Ce(t,e){Yt.call(this,"spectrometer",t,e),this.$element.addClass("interactive-spectrometer").css("border",this.component.border),this.lowerBound=this.component.lowerBound,this.upperBound=this.component.upperBound,this._existingPhotonMarks={},this.renderBackground(),this.renderTickMarks(),this.$photonMarksContainer=$("<div>").appendTo(this.$element)}Vt(Ce,Yt),Ce.prototype.modelLoadedCallback=function(){Ce.superClass._modelLoadedCallback.call(this),this._model.onPhotonAbsorbed(this.onPhotonAbsorbed.bind(this)),this.component.clearOnModelLoad&&this.$photonMarksContainer.empty()},Ce.prototype.renderBackground=function(){var t=(xe-this.lowerBound)/(this.upperBound-this.lowerBound)*100,e=(we-xe)/(this.upperBound-this.lowerBound)*100;$("<img>").addClass("spectrometer-bg").attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASkAAAABCAYAAACCEVhtAAAAmUlEQVQ4T8WUwQ6DIBBEn1Wr+P/fCnjCbGuTLe4GbphMnH0ZhkiIUymlMOo5T0jpXzk/mWQ097zusnpihBXYgP1+i38rL/NPHteZVl72mYBXp3qzjdwJpErZYJLR3PO6y+qJnzskhxEqyQHUTGbNPa/XWT0HDPjQhe81EmnfM3vrWnzeYAmVdoNJRvPbrwFmI+/yY9RP4bnvBfEAd/7c+ytNAAAAAElFTkSuQmCC").css("left",t+"%").css("width",e+"%").appendTo(this.$element)},Ce.prototype.renderTickMarks=function(){if(this.component.ticks&&!(this.component.ticks<2))for(var t=$("<div>").appendTo(this.$element),e=100/this.component.ticks,n=1;n<this.component.ticks;n++)$('<div class="tick-mark">').css("left",n*e+"%").appendTo(t)},Ce.prototype.onPhotonAbsorbed=function(t){if(!(t>this.upperBound||t<this.lowerBound)){var e=(t-this.lowerBound)/(this.upperBound-this.lowerBound)*100;this.photonMarkExists(e)||this.addPhotonMark(e)}},Ce.prototype.photonMarkExists=function(t){return!!this._existingPhotonMarks[t.toFixed(2)]},Ce.prototype.addPhotonMark=function(t){$('<div class="photon-mark">').css("left",t+"%").appendTo(this.$photonMarksContainer),this._existingPhotonMarks[t.toFixed(2)]=!0};var Te=Ce,Se={weight:"normal",timeout:3e3,interval:250,onchange:null},ke={},Ae={};function Ee(t){var e=document.createElement("canvas"),n=e.getContext("2d");return e.width=22.5,e.height=22.5,n.font=t,n.fillText("A",0,22.5),e.toDataURL()}function Me(t){window.clearInterval(Ae[t].pollingInterval),delete Ae[t]}function Pe(t){var e={};Object.keys(t).concat(Object.keys(Se)).forEach((function(n){e[n]=null!=t[n]?t[n]:Se[n]}));var n=e.font.split(",");if(n.length>1){var i=!1;return n.forEach((function(t){e.font=t.trim(),Pe(e)&&(i=!0)})),i}var r=e.weight+" 15px "+e.font;return!ke[r]&&(Ae[r]||(Ae[r]={bitmap:null,pollingInterval:null,changeCallbacks:[]}),e.onchange&&Ae[r].changeCallbacks.push(e.onchange),Ae[r].pollingInterval||(Ae[r].pollingInterval=window.setInterval(function(t,e,n){return Ae[t].bitmap=Ee(t),function(){if(Ee(t)!==Ae[t].bitmap)return Ae[t].changeCallbacks.forEach((function(t){t()})),ke[t]=!0,void Me(t);Date.now()-e>n&&Me(t)}}(r,Date.now(),e.timeout),e.interval)),!0)}function De(t){var e,n,i,r,o,a,s,l,u,c,h,d,p,f,m,g=t.id,v=t.label,y=t.unit,b=0;function _(t){var e;h=t,d=r.height(),l.width(h),l.height(d),p=2*h,f=2*d,l.attr("width",p),l.attr("height",f),e=2*parseInt(r.css("font-size"),10),c.font=[r.css("font-style"),r.css("font-variant"),r.css("font-weight"),e+"px/"+r.css("line-height"),r.css("font-family")].join(" "),c.fillStyle=r.css("color"),c.textAlign="right",c.textBaseline="middle",u=f/2}function x(){var t=i.position();l.css({left:t.left+parseInt(r.css("padding-left"),10)+r.width()-h,top:t.top+parseInt(i.css("padding-top"),10)})}return m={update:function(t){a=t=null==t?"":""+t;var e=!1;b=Math.round(c.measureText(t).width/2),h<b&&(_(2*b),e=!0),Math.abs(r.width()-b)>5&&b>s&&(r.width(b),e=!0),e&&x(),c.clearRect(0,0,p,f),c.fillText(t,p,u)},updateLabel:function(t){n.html(t)},updateUnits:function(t){o.html(t)},hideUnits:function(){o.css("opacity",0)},showUnits:function(){o.css("opacity",1)},render:function(){return l=$("<canvas>").css("position","absolute"),c=l[0].getContext("2d"),e=$('<div class="numeric-output">'),n=$('<span class="label"></span>'),i=$('<span class="output"></span>'),r=$('<span class="value"> - </span>').css("opacity",0),o=$('<span class="units"></span>'),v&&n.html(v),y&&o.html(y),e.attr("id",g).append(n).append(i.append(l).append(r).append(o)),e},resize:function(){s=parseInt(r.css("min-width"),10)-parseInt(r.css("padding-left"),10)-parseInt(r.css("padding-right"),10),_(2*b),m.update(a),x(),Pe({font:c.font,onchange:function(){m.resize()}})}}}function Oe(t,e){var n,i,r,o,a,s,l,u,c,h=t.id,d=t.columns,p=t.formatters,f=(t.visibleRows,t.showBlankRow),m=t.title,g=t.width,v=t.height,y=t.tooltip,b=t.klasses||[],_=[];function x(){var t,e;for(l.find("th").remove("th"),t=0;t<d.length;t++)(e=$("<th>")).text(d[t].name),e.click(C),l.append(e)}function w(t,e,n){null!=e?"string"==typeof e?t.text(e):"number"==typeof e&&t.text(p[n](e)):t.html("&nbsp;")}function C(t){var e,n=$(this);P(),e="asc",n.hasClass("asc")?(n.removeClass("asc"),n.addClass("desc"),e="desc"):n.hasClass("desc")?(n.removeClass("desc"),n.addClass("asc"),e="asc"):(n.addClass("desc"),e="desc"),n.siblings().removeClass("sorted"),(c=u.find("tr")).tsort("td:eq("+n.index()+")",{sortFunction:function(t,n){var i=Math.abs(parseFloat(t.s)),r=Math.abs(parseFloat(n.s));return"asc"===e?i===r?0:i>r?1:-1:i===r?0:i<r?1:-1}}),n.addClass("sorted"),D(),t.preventDefault()}function T(){i=s.find("tr:first th").map((function(){return $(this).outerWidth()})),u.find("tr:first td").each((function(t){$(this).outerWidth(i[t])}))}function S(t){return $(u.find("tr")).filter((function(){return $(this).data("index")===t}))}function k(t){var e;if(-1===_.indexOf(t))return _.push(t),(e=S(t)).addClass("selected"),e}function A(){var t,e,n,i;for(n=(e=function(){var t,e,n=[];for(t=0;t<_.length;t++)e=_[t],n.push([e,S(e).index()]);return n.sort((function(t,e){return t[1]-e[1]}))}())[0],i=e[e.length-1],c=u.find("tr"),t=n[1];t<=i[1];t++)k($(c[t]).data("index"))}function E(){var t;for(t=0;t<_.length;t++)S(_[t]).removeClass("selected");_=[]}function M(t,e){var n,i,r,o;for(r=$('<tr class="data">'),$(r).data("index",e),n=0;n<d.length;n++)o=$("<td>"),$(o).data("index",n),i=t[n],o.data("datum",i),w(o,i,n),r.append(o);u.append(r),u.find("tr").length<2&&T()}function P(){u.find(".blank").remove()}function D(){if(P(),f){var t,e,n,i=u.find("tr").length;for(e=$('<tr class="data blank">'),$(e).data("index",i),t=0;t<d.length;t++)n=$("<td>"),$(n).data("index",t),n.html("&nbsp;"),e.append(n);u.append(e),u.find("tr").length<2&&T()}}function O(){u.scrollTop(99999999)}function I(){u.position(),u.height()}function L(){u.find("input").each((function(){var t=$(this).parent(),n=t.parent().data("index"),i=t.data("index"),r=$(this).val();!isNaN(parseFloat(r))&&isFinite(r)&&(r=parseFloat(r)),e.addDataToCell(n,i,r),t.empty().html(r)})),T(),I()}return n={render:function(){var t,n;for(r=$("<div>"),a=$("<table>"),u=$("<tbody>"),l=$('<tr class="header">'),s=$("<thead>").append(l),a.append(s).append(u),x(),o=$("<div>").addClass("table-wrapper").append(a),r.attr("id",h),m&&(n=$("<div>").addClass("title").text(m),r.append(n)),r.append(o),t=0;t<b.length;t++)r.addClass(b[t]);return y&&r.attr("title",y),g&&r.css("width",g),v&&r.css("height",v),u.delegate("tr","click",(function(t){var e=$(t.currentTarget).data("index");t.shiftKey||t.metaKey||E(),k(e),t.shiftKey&&A()})),u.delegate("td","click",(function(t){var n=$(t.currentTarget);!function t(n,i){var r,o,a,s=$(S(n).find("td")[i]),l=u.find("input");s&&d[i].editable&&!s.find("input").length&&(l.length&&L(),r=e.getDataInCell(n,i),o=$('<input class="editor-text">').val(r),s.empty().append(o),T(),o.bind("keydown",(function(e){var r=e.keyCode?e.keyCode:e.which;if(13===r)L();else if(9===r)for(L(),a=i;++a<d.length;)if(d[a].editable){t(n,a);break}e.stopPropagation()})),o.on("blur",L),setTimeout((function(){o.focus()}),0))}(n.parent().data("index"),n.data("index"))})),I(),r},resize:function(){var t;a.height(o.height()),t=a.height()-s.outerHeight(!0),u.height(t-6),T(),I()},clear:function(){u.find(".data").remove()},appendDataRow:function(t,e){M(t,e),D(),O()},appendDataRows:function(t,e){var n=e;t.forEach((function(t){M(t,n++)})),D(),O()},removeDataRows:function(t){u.find("tr").filter((function(){return $(this).data("index")>=t})).remove(),D()},replaceDataRow:function(t,e){var i;if(0!==u.find("tr").length){var r,o,a=$(u.find("tr")).filter((function(){return $(this).data("index")===e})),s=$(a).find("td"),l=s.length;for(o=0;o<t.length;o++)o<l&&(r=$(s[o]),i=t[o],r.data("datum",i),w(r,i,o))}else n.appendDataRow(t,e)},removeSelection:function(t){var e=_.indexOf(t);if(-1!==e)return _.splice(e,1),S(t).removeClass("selected")},addSelection:k,clearSelection:E,updateTable:function(t){d=t.columns||d,p=t.formatters||p,x(),u.find("td").html((function(){var t=$(this),e=t.data("datum"),n=t.data("index");w(t,e,n)})),T(),I()}}}var Ie=0;var Le={"Windows NT 6.2":"Windows 8","Windows NT 6.1":"Windows 7","Windows NT 6.0":"Windows Vista","Windows NT 5.2":"Windows Server 2003; Windows XP x64 Edition","Windows NT 5.1":"Windows XP","Windows NT 5.01":"Windows 2000, Service Pack 1 (SP1)","Windows NT 5.0":"Windows 2000","Windows NT 4.0":"Microsoft Windows NT 4.0"};function Re(){var t=navigator.userAgent.match(/\(([^)]+)\).*/);if(!t)return"na";var e=t[1],n=e.split("; ");if("Macintosh"===n[0])return n[1];if(n[0].match(/^Windows/)){var i=navigator.userAgent.match(/\(.*?(Windows NT.+?)[;)]/),r="";return e.match(/WOW64/)?r="64/32":e.match(/Win64; IA64/)?r="64":e.match(/Win64; x64/)&&(r="64"),Le[i[1]]+"/"+r}return n[0].match(/^X11/)?n.join("/"):"na"}var Ne,Fe={isMobile:function(t){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|android|playbook|silk|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}(navigator.userAgent||navigator.vendor||window.opera),what_browser:function(){var t;if((t=navigator.userAgent.match(/.+?(Android) ([0123456789.]+).*?; (.+?)\).+? Chrome\/([0123456789.]+)/))&&t[1])return{browser:"Chrome for Android",version:t[4],oscpu:t[1]+"/"+t[2]+"/"+t[3]};if((t=navigator.userAgent.match(/ (Chrome)\/(.*?) /))&&t[1])return{browser:t[1],version:t[2],oscpu:Re()};if((t=navigator.userAgent.match(/ (Firefox)\/([0123456789ab.]+)/))&&t[1]){var e=navigator.buildID,n="";return e&&e.length>=8&&(n="("+e.slice(0,4)+"-"+e.slice(4,6)+"-"+e.slice(6,8)+")"),{browser:t[1],version:t[2]+" "+n,oscpu:Re()}}if((t=navigator.userAgent.match(/.+?(Android.+?\)).+? Firefox\/([0123456789.]+)/))&&t[1])return{browser:"Firefox",version:t[2],oscpu:t[1]};if((t=navigator.userAgent.match(/.+?(Android) ([0123456789ab.]+).*?; (.+?)\)/))&&t[1])return{browser:"Android",version:t[2],oscpu:t[1]+"/"+t[2]+"/"+t[3]};if((t=navigator.userAgent.match(/ AppleWebKit\/([0123456789.+]+) \(KHTML, like Gecko\) Version\/([0123456789.]+) (Safari)\/([0123456789.]+)/))&&t[3])return{browser:t[3],version:t[2]+"/"+t[1],oscpu:Re()};if((t=navigator.userAgent.match(/ (MSIE) ([0123456789.]+);/))&&t[1]){var i=navigator.userAgent.match(/\(.*?(Windows.+?); (.+?)[;)].*/);return{browser:t[1],version:t[2],oscpu:Le[i[1]]+"/"+navigator.cpuClass+"/"+navigator.platform}}return(t=navigator.userAgent.match(/^(Opera)\/.+? Version\/([0123456789.]+)$/))&&t[1]?{browser:t[1],version:t[2],oscpu:Re()}:(t=navigator.userAgent.match(/.+?\((iPhone); CPU.+?OS .+?Version\/([0123456789._]+)/))&&t[1]?{browser:"Mobile Safari",version:t[2],oscpu:t[1]+"/iOS/"+t[2]}:(t=navigator.userAgent.match(/.+?\((iPad); CPU.+?OS .+?Version\/([0123456789._]+)/))&&t[1]?{browser:"Mobile Safari",version:t[2],oscpu:t[1]+"/iOS/"+t[2]}:(t=navigator.userAgent.match(/.+?\((iPod); CPU (iPhone.+?) like.+?Version\/([0123456789ab._]+)/))&&t[1]?{browser:"Mobile Safari",version:t[3],oscpu:t[1]+"/iOS/"+t[2]}:{browser:"",version:navigator.appVersion,oscpu:""}}},Be=Fe.what_browser,ze=Fe.isMobile,je=Fe.what_browser();function Ve(t,e,n){var i,r,o,a,s=0,l=0,u={},c=t.getElementsByTagName("tr");function h(e){t.getElementsByTagName("tr")[0].appendChild(document.createElement("th")).innerHTML=e,u[e]=l++}function d(e){e=e||0;var n,i=t.appendChild(document.createElement("tr"));for(n=0;n<e;n++)i.appendChild(document.createElement("td"));return i}function p(t,e,n){var r;r=(n=n||i).getElementsByTagName("td")[u[t]],"string"==typeof e&&"<"===e.slice(0,1)?r.innerHTML=e:r.textContent=e}if(t.style.display="",0===c.length){for(d(),h("browser"),h("version"),h("cpu/os"),h("date"),h("commit"),h("branch"),s=0;s<e.length;s++)h(e[s].name);(Ne=d(l)).className="average"}else for(s=0,a=(o=c[0].getElementsByTagName("th")).length;s<a;s++)u[o[s].innerHTML]=l++;for((i=d(l)).className="sample",s=0;s<6;s++)p((r=n[s])[0],r[1]),p(r[0],r[1],Ne);for(s=6;s<n.length;s++)p((r=n[s])[0],r[1]);!function(){var t,n,i,r,o,a,s,l=c.length,h=Ne.getElementsByTagName("td"),d=d3.format("5.1f"),p=d3.format("f");function f(t){return Math.floor(t)===t}for(t=0;t<e.length;t++)if(i=e[t],o=u[i.name],!1===i.numeric)r=c[2].getElementsByTagName("td")[o],h[o].innerHTML=r.innerHTML;else{for(a=0,n=2;n<l;n++)a+=+(r=c[n].getElementsByTagName("td")[o]).textContent;s=a/(l-2),s=i.formatter?i.formatter(s):f(s)?p(a/(l-2)):d(a/(l-2)),h[o].textContent=s}}()}function He(t,e,n,i){var r,o=t.slice(),a=[],s=Be(),l=d3.time.format("%Y-%m-%d %H:%M");return a.push(["browser",s.browser]),a.push(["version",s.version]),a.push(["cpu/os",s.oscpu]),a.push(["date",l(new Date)]),r="<a href='"+Lab.version.repo.commit.url+"' class='opens-in-new-window' target='_blank'>"+Lab.version.repo.commit.short_sha+"</a>",Lab.version.repo.dirty&&(r+=" <i>dirty</i>"),a.push(["commit",r]),a.push(["branch",Lab.version.repo.branch]),n&&n(),function t(n){function r(r){n.formatter?a.push([n.name,n.formatter(r)]):a.push([n.name,r]),o.length>0?t(o.shift()):(i&&i(),e&&e(a))}n.run(r)}(o.shift()),a}var We={get browser(){return je},what_browser:function(){return je=Be()},get isMobile(){return ze},run:function(t,e,n,i,r){!function(t,e,n,i,r){He(t,(function(i){Ve(e,t,i),n(i)}),i,r)}(t,e,n,i,r)},bench:function(t,e,n,i){return He(t,e,n,i)},renderToTable:function(t,e,n){Ve(t,e,n)}},Ue=function(){if(r.a.versionedHome&&i.a.repo.last_tag)return r.a.versionedHome(i.a.repo.last_tag);var t,e,n,o=window.location.host,a=window.location.pathname,s=window.location.search,l=window.location.protocol;return e="show_data_warning",n="true",l+"//"+o+a+(s=(t=s).length>0?t+"&"+e+"="+n:"?"+e+"="+n)},$e=function(t){var e,n=St.a.getIFrameEndpoint();function i(t){n.post("propertyValue",{name:t,value:e.get(t)})}n.addListener("setFocus",(function(){var e=t.modelController.modelContainer;e&&e.setFocus&&e.setFocus()})),n.addListener("getLearnerUrl",(function(){n.post("setLearnerUrl",Ue())})),n.addListener("loadInteractive",(function(e){t&&t.loadInteractive&&t.loadInteractive(e)})),n.addListener("loadModel",(function(e){t&&t.loadModel&&t.loadModel(e.modelId,e.modelObject)})),n.addListener("getModelState",(function(){t&&t.modelController&&n.post("modelState",t.modelController.state())})),n.addListener("getInteractiveState",(function(){t&&t.modelController&&n.post("interactiveState",t.serialize())})),n.addListener("runBenchmarks",(function(){var e,i;t&&t.modelController&&(e=t.modelController,i=t.benchmarks.concat(e.benchmarks),We.bench(i,(function(t){console.log(t),n.post("returnBenchmarks",{results:t,benchmarks:i})})))})),n.addListener("listenForDispatchEvent",(function(t){var i=t.eventName,r=t.properties,o={},a=0,s=null;e.on(i,(function(){if(r)for(a=0;a<r.length;a++)s=r[a],o[s]=e.get(s);n.post(i,o)}))}));var r=!0;return n.addListener("listenForDatasetEvent",(function(e){var i=e.eventName,o=e.datasetName,a=t.getDataSet(o);a&&(console.log("registering listener on "+o+": "+i),a.on(i,(function(t){r&&n.post(o+"-"+i,t)})))})),n.addListener("sendDatasetEvent",(function(e){var n=e.eventName,i=e.datasetName,o=e.data,a=t.getDataSet(i);a&&(r=!1,a.handleExternalEvent(n,o),r=!0)})),n.addListener("removeListenerForDispatchEvent",(function(t){e.on(t,null)})),n.addListener("getDataset",(function(e){var i;i=e,n.post("dataset",{name:i,value:t.getDataSet(i).serialize()})})),n.addListener("get",(function(t){i(t)})),n.addListener("observe",(function(t){e.addPropertiesListener(t,(function(){i(t)})),i(t)})),n.addListener("set",(function(t){e.set(t.name,t.value)})),n.addListener("tick",(function(t){e.tick(Number(t))})),n.addListener("play",(function(){e.start()})),n.addListener("stop",(function(){e.stop()})),n.addListener("reloadModel",(function(){t.reloadModel()})),n.addListener("reloadInteractive",(function(){t.reloadInteractive()})),n.initialize(),t.on("modelLoaded.parentMessageAPI",(function(){n.post("modelLoaded")})),{bindModel:function(t){e=t}}},Ge=n(24),qe=n.n(Ge);function Ye(t){t.attr("disabled",!0).addClass("lab-disabled").css("cursor","default")}function Xe(t,e){t?function(t){t.attr("disabled",!1).removeClass("lab-disabled").css("cursor","pointer")}(e):Ye(e)}function Qe(t,e){Xe(!t,e)}function Ke(t,e){Yt.call(this,"playback",t,e),this.$element.addClass("interactive-playback"),this._modelStopped=!0,this._modelPlayable=!0,this._modelHasPlayed=!1,this._dataAreAvailableForExport=!1,this._timeDesc=null,this._model=null,this._scriptingAPI=null,this._interactivesController=e,this._fontSpec="2em "+e.fontFamily,Pe({font:e.fontFamily,onchange:this._updateClockVisibility.bind(this)})}le.a,Vt(Ke,Yt);var Je={video:{createControls:function(){var t=this._scriptingAPI,e=this._interactivesController.i18n;this.$element.empty(),this.$element.removeClass("text").addClass("video"),this._$reset=$('<button class="reset"><i class="icon-step-backward"></i></button>').appendTo(this.$element),this._$playPause=$('<button class="play-pause"><i class="icon-play"></i><i class="icon-pause"></i></button>').appendTo(this.$element),this._$timeDisplay=$('<span class="time-display">').appendTo(this._$playPause),this._$timeCanvas=$("<canvas>").appendTo(this._$timeDisplay),this._timeCtx=this._$timeCanvas[0].getContext("2d"),this._$stepBackward=$('<button class="step"><i class="icon-backward"></i></button>').insertBefore(this._$playPause),this._$stepForward=$('<button class="step"><i class="icon-forward"></i></button>').insertAfter(this._$playPause),this._$reset.after('<div class="spacer reset">'),this._$stepBackward.after('<div class="spacer step">'),this._$stepForward.before('<div class="spacer step">'),this._$reset.on("click",t.reloadModel),this._$playPause.on("click",function(){this._modelStopped?this._modelPlayable&&t.start():t.stop()}.bind(this)),this._$stepBackward.on("click",t.stepBack),this._$stepForward.on("click",t.stepForward),this._$playPause.attr("title",e.t("banner.video_play_pause_tooltip")),this._$reset.attr("title",e.t("banner.video_reset_tooltip")),this._$stepBackward.attr("title",e.t("banner.video_step_back_tooltip")),this._$stepForward.attr("title",e.t("banner.video_step_forward_tooltip"))},updateButtonStates:function(t,e){var n=!t;this._$playPause.toggleClass("playing",n),Qe(t&&!e,this._$playPause)},updateControlButtonChoices:function(t){var e;t?"play"===t?(this.$element.find(".play-pause").removeClass("hidden"),this.$element.find(".spacer, .step, .reset").addClass("hidden")):"reset"===t?(this.$element.find(".reset").removeClass("hidden"),this.$element.find(".spacer, .play-pause, .step").addClass("hidden")):"play_reset"===t?(this.$element.find(".spacer, .play-pause, .reset").removeClass("hidden"),this.$element.find(".step").addClass("hidden")):"play_reset_step"===t&&this.$element.find(".spacer, .step, .reset, .play-pause").removeClass("hidden"):this.$element.find(".step, .reset, .play-pause").addClass("hidden"),(e=this.$element.find("button")).removeClass("first"),e.removeClass("last"),(e=e.not(".hidden")).first().addClass("first"),e.last().addClass("last")},setClockVisibility:function(t){t?(this._$playPause.addClass("with-clock"),this._timeDesc=this._model.getPropertyDescription("displayTime"),this._timeChanged()):this._$playPause.removeClass("with-clock")},setClockValue:function(t){this._timeCtx.clearRect(0,0,this._canvWidth,this._canvHeigth),this._timeCtx.fillText(this._timeDesc.format(t),this._canvWidth,.85*this._canvHeigth)}},text:{createControls:function(){var t=this._scriptingAPI,e=this._interactivesController.i18n;this.$element.empty(),this.$element.removeClass("video").addClass("text"),this._$start=$('<button class="start">').text(e.t("banner.text_start")).appendTo(this.$element),this._$stop=$('<button class="stop">').text(e.t("banner.text_stop")).appendTo(this.$element),this._$reset=$('<button class="reset">').text(e.t("banner.text_reset")).appendTo(this.$element),this._$reset.on("click",t.reloadModel),this._$start.on("click",t.start),this._$stop.on("click",t.stop),this._$start.attr("title",e.t("banner.text_start_tooltip")),this._$stop.attr("title",e.t("banner.text_stop_tooltip")),this._$reset.attr("title",e.t("banner.text_reset_tooltip"))},updateButtonStates:function(t,e){Qe(t,this._$stop),Xe(e,this._$start)},updateControlButtonChoices:function(t){if(t)if("play"===t)this.$element.find(".start, .stop").removeClass("hidden"),this.$element.find(".reset").addClass("hidden");else if("reset"===t)this.$element.find(".reset").removeClass("hidden"),this.$element.find(".start, .stop").addClass("hidden");else{if("play_reset"!==t)throw new Error('controlButtons option "'+t+'" is not understood or is not compatible with controlButtonStyle "text"');this.$element.find(".start, .stop, .reset").removeClass("hidden")}else this.$element.find(".reset, .start, .stop").addClass("hidden")},setClockVisibility:function(){},setClockValue:function(){}},codap:{createControls:function(){var t=this._scriptingAPI,e=this._interactivesController.i18n;this.$element.removeClass("video").addClass("text wide"),this.$element.empty(),this._$start=$('<button class="start">').text(e.t("banner.text_start")).attr("title",e.t("banner.text_start_tooltip")).appendTo(this.$element),this._$stop=$('<button class="stop">').text(e.t("banner.text_stop")).attr("title",e.t("banner.text_start_tooltip")).appendTo(this.$element),this._$analyzeData=$('<button class="analyze-data">').text(e.t("banner.text_analyze_data")).attr("title",e.t("banner.text_analyze_data_tooltip")).appendTo(this.$element),this._$newRun=$('<button class="new-run">').text(e.t("banner.text_new_run")).attr("title",e.t("banner.text_new_run_tooltip")).appendTo(this.$element),this._$start.on("click",t.start),this._$stop.on("click",t.stop),this._$analyzeData.on("click",(function(){t.exportData(),this._dataAreAvailableForExport=t.dataAreAvailableForExport(),this._dataAreAvailableForExport||Ye($(this))})),this._$newRun.on("click",(function(){t.reloadModel({cause:"new-run"})}))},updateButtonStates:function(t,e,n,i){Qe(n,this._$start),Qe(t,this._$stop),Xe(n&&t,this._$newRun),Xe(i,this._$analyzeData)},updateControlButtonChoices:function(t){t&&t.indexOf("play")>=0?(this._$start.show(),this._$stop.show(),t.indexOf("reset")>=0?this._$newRun.show():this._$newRun.hide()):(this._$start.hide(),this._$stop.hide(),this._$newRun.hide())},setClockVisibility:function(){},setClockValue:function(){}}};Ke.prototype._createControls=function(){this._controlButtonMethods.createControls.apply(this,arguments),this._updateButtonStates(),this._fitButtons()},Ke.prototype._updateButtonStates=function(){this._controlButtonMethods.updateButtonStates.call(this,this._modelStopped,this._modelPlayable,this._modelHasPlayed,this._dataAreAvailableForExport)},Ke.prototype._updateControlButtonChoices=function(){this._controlButtonMethods.updateControlButtonChoices.apply(this,arguments),this._fitButtons()},Ke.prototype._setClockVisibility=function(){this._controlButtonMethods.setClockVisibility.apply(this,arguments)},Ke.prototype._setClockValue=function(){this._controlButtonMethods.setClockValue.apply(this,arguments)},Ke.prototype._updateCachedSimulationState=function(){var t=this._model.isStopped(),e=!1!==this._model.properties.isPlayable,n=this._model.properties.hasPlayed,i=this._scriptingAPI.dataAreAvailableForExport();return(t!==this._modelStopped||e!==this._modelPlayable||n!==this._modelHasPlayed||i!==this._dataAreAvailableForExport)&&(this._modelStopped=t,this._modelPlayable=e,this._modelHasPlayed=n,this._dataAreAvailableForExport=i,!0)},Ke.prototype._simulationStateChanged=function(){this._updateCachedSimulationState()&&this._updateButtonStates()},Ke.prototype._timeChanged=function(){this._model.properties.showClock&&this._setClockValue(this._model.properties.displayTime)},Ke.prototype._useDurationChanged=function(){this._useDuration!==this._model.properties.actualUseDuration&&(this._useDuration=this._model.properties.actualUseDuration,this._updateDurationControl())},Ke.prototype._updateDurationControl=function(){var t=this._model,e=this._useDuration,n=t.properties.durationOptions,i=t.properties.actualDuration,r=[];this.durationControl&&(this.durationControl.destroy(),this.durationControl=null),e&&n.length>0&&(n.forEach((function(e){i<e&&(0===r.length||i>r[r.length-1].value)&&r.push({value:i,text:t.formatTime(i),selected:!0}),r.push({value:e,text:t.formatTime(e),selected:e===i})})),this.durationControl=new ae({id:"duration-control",options:r,onChange:function(t){this._model.properties.requestedDuration=t.value}.bind(this)}),this.durationControl.render(this.$element.parent()),this.durationControl.$element.addClass("duration-control interactive-pulldown component component-spacing"),this.$element.parent().append(this.durationControl.$element)),this._fitButtons()},Ke.prototype._controlButtonChoicesChanged=function(){this._updateControlButtonChoices(this._model.properties.controlButtons)},Ke.prototype._controlButtonStyleChanged=function(){var t=this._model.properties.controlButtonStyle||"video";if(this.controlButtonStyle!==t){if(this.controlButtonStyle=t,this.$element.empty(),!Je[t])throw new Error('Unknown controlButtonStyle "'+t+'"');this._controlButtonMethods=Je[t],this._updateCachedSimulationState(),this._createControls(),this._controlButtonChoicesChanged()}},Ke.prototype._updateClockVisibility=function(){this._setClockVisibility(this._model.properties.showClock)},Ke.prototype._fitButtons=function(){var t,e,n=this.$element.parent().width(),i=this.durationControl&&this.durationControl.$element;this.$element.css("left","");var r=this.$element.measure((function(){return i&&this.prepend(i.clone()),this.removeClass("scrunched-buttons"),this.width()}),null,$("#bottom-bar"));if(this.$element.parent().css("fontSize",""),r<n?this.$element.removeClass("scrunched-buttons"):(t=n/r,e=parseFloat(this.$element.parent().css("font-size"))*t<10?"10px":t+"em",this.$element.parent().css("fontSize",e),this.$element.removeClass("scrunched-buttons"),this.$element.width()-10>=n&&this.$element.addClass("scrunched-buttons")),i){var o=this.$element.find("button:visible").first();if(o.length>0){var a=o.offset().left-parseFloat(o.css("padding-left"))-parseFloat(o.css("margin-left")),s=i.offset().left+i.outerWidth(!0);a<s&&this.$element.css("left",s-a+"px")}}},Ke.prototype._fitButtonsOnResize=function(){this._debouncedFitButtons||(this._debouncedFitButtons=h.a.debounce(this._fitButtons.bind(this),200)),this.$element.parent().css("fontSize",this.$element.parent().css("fontSize")),this._debouncedFitButtons()},Ke.prototype.modelLoadedCallback=function(){this._model=this._interactivesController.getModel(),this._scriptingAPI=this._interactivesController.getScriptingAPI().api;var t=this._simulationStateChanged.bind(this);this._model.on("play."+this.component.id,t),this._model.on("stop."+this.component.id,t),this._model.addObserver("isPlayable",t),this._model.addObserver("showClock",this._updateClockVisibility.bind(this)),this._model.addObserver("displayTime",this._timeChanged.bind(this)),this._model.addObserver("actualUseDuration",this._useDurationChanged.bind(this)),this._model.addObserver("controlButtons",this._controlButtonChoicesChanged.bind(this)),this._model.addObserver("controlButtonStyle",this._controlButtonStyleChanged.bind(this)),this._useDuration=null,this._useDurationChanged(),this._controlButtonStyleChanged(),this._controlButtonChoicesChanged(),this._simulationStateChanged(),this._updateClockVisibility()},Ke.prototype.resize=function(){this._fitButtonsOnResize(),this._$timeCanvas&&(this._canvWidth=2*this._$timeCanvas.width(),this._canvHeigth=2*this._$timeCanvas.height(),this._$timeCanvas.attr("width",this._canvWidth),this._$timeCanvas.attr("height",this._canvHeigth),this._timeCtx.font=this._fontSpec,this._timeCtx.fillStyle="#939598",this._timeCtx.textAlign="right",this._updateClockVisibility())};var Ze=Ke;function tn(t,e,n){Yt.call(this,"div",t,e,n);var i=t.content,r=this;t.url?("auto"!==t.width&&"auto"!==t.height||Object(d.a)("This interactive has a remote div component.\nThe width and/or height is not set.\nPlease set both the width and height."),$.ajax(t.url,{dataType:"html",complete:function(t){r.$element.append(t.responseText)}})):(i&&i.join&&(i=i.join("\n")),this.$element.append(i))}Vt(tn,Yt);var en=tn,nn=["center bottom","left center","center top","right center"],rn=["center top-5","right+5 center","center bottom+5","left-5 center"];function on(t,e){var n,i,r,o=new ft("start","stop"),a=!1,s=-1,l=[];function u(){var n,r,o,a=t[s];a&&(i.focus(),i.html(te(a.text)),a.component?(n=function(t){var n;"model"===t?n=$("#model-container"):"string"==typeof t?n=$("#"+t).closest(".component"):(n=$(t.map((function(t){return"#"+t})).join(", ")).closest(".component"),s=[],l=[],u=[],c=[],n.each((function(){var t=$(this),n=t.offset(),i=e.offset();s.push(n.left-i.left),l.push(n.left-i.left+t.width()),u.push(n.top-i.top),c.push(n.top-i.top+t.height())})),i=Math.min.apply(null,s),r=Math.max.apply(null,l),o=Math.min.apply(null,u),a=Math.max.apply(null,c),n=$("<div>").data("lab-is-bounding-box",!0).css({position:"absolute",left:i,top:o,width:r-i,height:a-o}).appendTo(e));var i,r,o,a,s,l,u,c;return n}(a.component),r=n.outerHeight()+10,o=parseFloat(i.css("font-size")),i.position({of:n,collision:"flipfit flipfit",within:e,my:"left-"+4*o+" top+"+o,at:"right bottom",using:function(t,e){var n,i,r=e.element.left,o=e.element.width,a=e.target.left,s=e.target.width;$(this).css(t),n=$("<div>").addClass("lab-help-arrow").addClass(e.vertical).appendTo(this),a>r&&(i=a-r+s/2,i=Math.max(.1*o,Math.min(.9*o,i)),n.css("left",i))}}),l.forEach((function(t,e){1!==e&&3!==e||t.css("height",r),t.position({of:n,collision:"none none",my:nn[e],at:rn[e]})})),n.data("lab-is-bounding-box")&&n.remove()):(i.position({of:e,collision:"flipfit flipfit",within:e,my:"center center",at:"center center"}),l.forEach((function(t,n){t.position({of:e,collision:"none none",my:n?"left top":"center center",at:n?"right bottom":"center center"})}))))}return n={start:function(t,c){if(a)n.stop();else{for(var h=0;h<4;h++)l.push($('<div class="lab-help-overlay lab-help-next"></div>').appendTo(e));i=$('<div class="lab-help-tip lab-help-next" tabindex="-1"></div>').appendTo(e),c?(r=$('<div class="lab-help-instructions"><span class="lab-help-next">Click overlay to hide help tip</span></div>').appendTo(e),e.on("click.lab-help-next",".lab-help-next",n.stop)):(r=$('<div class="lab-help-instructions"><span class="lab-help-prev btn"><</span><span class="lab-help-next">Click overlay to see next help tip</span><span class="lab-help-next btn">></span></div>').appendTo(e),e.on("click.lab-help-next",".lab-help-next",n.next),e.on("click.lab-help-prev",".lab-help-prev",n.prev),i.on("keydown.lab-help",(function(t){switch(t.keycode||t.which){case 37:n.prev();break;case 39:n.next()}t.preventDefault(),t.stopPropagation()}))),a=!0,s=null!=t?t:0,c?u():(s--,n.next()),o.start()}},showSingle:function(e){for(var i=0;i<t.length;i++){var r=t[i].component;if("string"==typeof r&&r===e||-1!==r.indexOf(e))return void n.start(i,!0)}},stop:function(){i.remove(),r.remove(),l.forEach((function(t){t.remove()})),l.length=0,e.off("click.lab-help-next",".lab-help-next"),e.off("click.lab-help-prev",".lab-help-prev"),a=!1,o.stop()},next:function(){for(s++;s<t.length&&!t[s].showcase;)s++;s>=t.length?n.stop():u()},prev:function(){for(s--;!s>=0&&t[s].showcase;)s--;s<0?n.stop():u()},isActive:function(){return a},hasShowcase:function(){return t.filter((function(t){return t.showcase})).length>0},enableLogging:function(t){var e=null;o.on(".logging",null),o.on("start.logging",(function(){t("HelpTipsOpened"),e=Date.now()})),o.on("stop.logging",(function(){t("HelpTipsClosed",{wasOpenFor:(Date.now()-e)/1e3})}))}},o.mixInto(n),n}var an=0,sn=function(){if(We.isMobile)return!1;var t=We.browser.browser,e=parseInt(We.browser.version,10);return!("Safari"===t&&e<7)}();var ln=function(t){if(sn){var e=null,n=null,i=null,r=!1;t.tooltip({show:!1,hide:!1,open:function(a,s){var l,u,c,h,d=3*Math.min(500,Date.now()-an);null!==e&&o(),e=s.tooltip,l=a.originalEvent.target,u=t.css("font-size"),c=.35*+parseFloat(u),h=$(l).closest("[title], [aria-describedby]"),e.css("font-size",u),e.is(":visible")||e.show(),e.position({of:h,collision:"flipfit flipfit",within:t,my:"center top+"+c,at:"center bottom",using:function(t,e){$(this).css(t),$("<div>").addClass("ui-tooltip-arrow").addClass(e.vertical).addClass(e.horizontal).appendTo(this)}}),e.hide(),n=setTimeout((function(){e.fadeIn(),r=!0}),d),i=setTimeout((function(){e.fadeOut()}),d+5e3)},close:function(t,n){e&&n.tooltip[0]===e[0]&&(r&&(an=Date.now()),o())}})}function o(){e&&e.hide(),clearInterval(n),clearInterval(i),r=!1,e=null}},un=function(t,e,n,i,r,o){if(!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t))return!1;var a="";if(n)switch(n.constructor){case Number:a=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:a="; expires="+n;break;case Date:a="; expires="+n.toGMTString()}return document.cookie=escape(t)+"="+escape(e)+a+(r?"; domain="+r:"")+(i?"; path="+i:"")+(o?"; secure":""),!0},cn=function(t){return new RegExp("(?:^|;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},hn=n(56),dn=n.n(hn);function pn(t,e,n,i,o){var a={},s=[],l={},u=t.i18n;function c(e,n){var i;"text"===e.type?i=ne:"image"===e.type?i=oe:"div"===e.type?i=en:"playback"===e.type&&(i=Ze),a[e.id]=new i(e,t),s.push(n),l[n.id]=[e.id]}return e.showTopBar&&(s.push({id:"top-bar",top:"0",left:"0",height:"1.5em","padding-top":"0.15em","padding-bottom":"0.15em",width:"container.width",aboveOthers:!0}),e.i18nMetadata&&c({type:"div",id:"lang-icon",width:"1.8em",height:"1.35em",tooltip:u.t("banner.lang_tooltip")},{id:"banner-lang",top:"0",height:"1.5em",right:"container.right","padding-top":"0.15em","padding-bottom":"0.15em","padding-left":"0.75em","padding-right":"0.25em",aboveOthers:!0}),c({type:"text",id:"about-link",text:u.t("banner.about"),onClick:function(){i.open()},tooltip:u.t("banner.about_tooltip")},{id:"banner-right",fontScale:1.5*.65,top:"0",height:"1.5em","padding-top":"0.15em","padding-bottom":"0.15em",right:e.i18nMetadata?"banner-lang.left":"interactive.right","padding-left":"1em","padding-right":"0.75em",align:"right",aboveOthers:!0}),r.a.sharing&&c({type:"text",id:"share-link",text:t.i18n.t("banner.share"),onClick:function(){o.open()},tooltip:u.t("banner.share_tooltip")},{id:"banner-middle",fontScale:1.5*.65,top:"0",height:"1.5em","padding-top":"0.15em","padding-bottom":"0.15em",right:"banner-right.left","padding-right":"1em",align:"right",aboveOthers:!0}),c({type:"div",id:"interactive-reload-icon",content:'<i class="icon-repeat"></i>',onClick:function(){t.reloadInteractive()},tooltip:u.t("banner.reload_tooltip")},{id:"banner-reload",fontScale:1.5*.65,top:"0",height:"1.5em","padding-top":"0.15em","padding-bottom":"0.15em",left:"0.7em","padding-right":"1em",align:"left",aboveOthers:!0}),t.helpSystem&&t.helpSystem.hasShowcase()&&(c({type:"div",id:"main-help-icon",content:'<i class="icon-question-sign lab-help-icon"></i>',onClick:function(){t.helpSystem.isActive()?t.helpSystem.stop():t.helpSystem.start()},tooltip:u.t("banner.help_tooltip")},{id:"banner-help",fontScale:1.5*.65,top:"0",height:"1.5em","padding-top":"0.15em","padding-bottom":"0.15em",left:"banner-reload.right","padding-right":"1em",align:"left",aboveOthers:!0}),t.helpSystem.on("start.icon",(function(){var t=$("#main-help-icon .lab-help-icon");t.addClass("icon-remove-sign active"),t.removeClass("icon-question-sign")})),t.helpSystem.on("stop.icon",(function(){var t=$("#main-help-icon .lab-help-icon");t.addClass("icon-question-sign"),t.removeClass("icon-remove-sign active")})))),e.showBottomBar&&(s.push({id:"bottom-bar",bottom:"container.height",left:"0",width:"container.width",height:"2.5em",belowOthers:!0}),c({type:"div",id:"credits-link",height:"2.5em",width:"8.1em",classes:["credits"],tooltip:u.t("banner.credits_tooltip"),onClick:function(){n.open()}},{id:"banner-bottom-left",bottom:"container.height",left:"0","padding-left":"0.3em",align:"left",belowOthers:!0}),dn.a.enabled&&c({type:"div",id:"fullsize-link",height:"2.5em",width:"2.5em",classes:["fullscreen"],tooltip:u.t("banner.fullscreen_tooltip"),onClick:function(){dn.a.isFullscreen?dn.a.exit():(dn.a.request(document.body),t.logAction("FullScreenStarted"))}},{id:"banner-bottom-right",bottom:"container.height",right:"container.width",align:"left","padding-left":"1em",belowOthers:!0}),function(){for(var t=0;t<e.components.length;t++)if("playback"===e.components[t].type)return!0;return!1}()||c({type:"playback",id:"playback"},{id:"interactive-playback-container",bottom:"container.height",height:"banner-bottom-left.height",left:"banner-bottom-left.right",right:s.map((function(t){return t.id})).indexOf("banner-bottom-right")>=0?"banner-bottom-right.left":"container.right",belowOthers:!0})),{components:a,template:s,layout:l}}function fn(t,e,n){Pt.call(this,{dialogClass:"about-dialog",appendTo:t},e),this._i18n=e,n&&this.update(n)}Vt(fn,Pt),fn.prototype.update=function(t){var e=$("<div>");this.set("title",this._i18n.t("about_dialog.title",{interactive_title:t.title})),t.subtitle&&e.append(te("**"+t.subtitle+"**")),e.append(te(t.about)),this.setContent(e)};var mn=fn;function gn(t){return'<div class="copyright-section"><strong>'+t.t("copyright.copyright")+" © "+(new Date).getFullYear()+'</strong> <a class="opens-in-new-window" href="https://concord.org" target="_blank">The Concord Consortium</a>. '+t.t("copyright.all_rights_reserved")+" "+t.t("copyright.license",{MIT_link:'<a class="opens-in-new-window" href="http://opensource.org/licenses/MIT" target="_blank">MIT</a>',license_link:'<a class="opens-in-new-window" href="https://github.com/concord-consortium/lab/blob/master/license.md" target="_blank">license.md</a>'})+" "+t.t("copyright.attribution",{concord_org_link:'<a class="opens-in-new-window" href="https://concord.org/" target="_blank">https://concord.org</a>'})+"</div>"}var vn=document.location;function yn(t,e,n,i){var o=vn.hash,a=vn.href.match(/(.*?\/\/.*?)\//)[1],s=vn.pathname;Pt.call(this,{dialogClass:"share-dialog",appendTo:t},n),this._view={paste_html:n.t("share_dialog.paste_html"),select_size:n.t("share_dialog.select_size"),size_larger:n.t("share_dialog.size_larger",{val:50}),size_actual:n.t("share_dialog.size_actual"),size_smaller:n.t("share_dialog.size_smaller",{val:30}),copyright:gn(n)},this._i18n=n,r.a.homeForSharing?this._view.embeddableSharingUrl=r.a.homeForSharing+r.a.homeEmbeddablePath+o:this._view.embeddableSharingUrl=a+s+o;var l="<a class='opens-in-new-window' href='"+this._view.embeddableSharingUrl+"' target='_blank'>"+n.t("share_dialog.link")+"</a>";this._view.paste_email_im=n.t("share_dialog.paste_email_im",{link:l}),this.setContent(qe.a.render("<div>\n  <h2>\n    {{{paste_email_im}}}\n  </h2>\n  <textarea>{{embeddableSharingUrl}}</textarea>\n  <h2>{{paste_html}}</h2>\n  <p>{{select_size}}\n    <select id='iframe-size'>\n      <option value='smaller'>{{size_smaller}}</option>\n      <option selected value='actual'>{{size_actual}}</option>\n      <option value='larger'>{{size_larger}}</option>\n    </select>\n  </p>\n  <textarea id='share-iframe-content'></textarea>\n  {{{copyright}}}\n</div>\n",this._view)),this._$interactiveContainer=$(e),this._$iframeSize=this.$element.find("#iframe-size"),this._$iframeContent=this.$element.find("#share-iframe-content"),this._$iframeSize.on("change",$.proxy(this.updateIframeSize,this)),this.updateIframeSize(),i&&this.update(i)}Vt(yn,Pt),yn.prototype.updateIframeSize=function(){var t=this._$interactiveContainer.innerWidth(),e=this._$interactiveContainer.innerHeight();switch(this._$iframeSize.val()){case"smaller":this._view.width=Math.floor(.7*t),this._view.height=Math.floor(.7*e);break;case"larger":this._view.width=Math.floor(1.5*t),this._view.height=Math.floor(1.5*e);break;default:this._view.width=t,this._view.height=e}this._$iframeContent.val(qe.a.render('<iframe width="{{width}}px" height="{{height}}px" frameborder="no" scrolling="no" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true" src="{{{embeddableSharingUrl}}}"></iframe>',this._view))},yn.prototype.update=function(t){this.set("title",this._i18n.t("share_dialog.title",{interactive_title:t.title}))};var bn=yn;function _n(t,e,n){Pt.call(this,{dialogClass:"credits-dialog",appendTo:t},e),this._i18n=e,n&&this.update(n)}Vt(_n,Pt),_n.prototype.update=function(t){var e,n,i=document.location.hash,o=document.location.href.match(/(.*?\/\/.*?)\//)[1],a=document.location.pathname,s=this._i18n,l="https://concord.org",u="http://mw.concord.org/nextgen/";this.set("title",this._i18n.t("credits_dialog.title",{interactive_title:t.title})),e=r.a.homeForSharing?r.a.homeForSharing+r.a.homeEmbeddablePath+i:o+a+i,r.a.utmCampaign&&(l+="?"+(n="utm_source="+encodeURIComponent(t.title.replace(/ /gi,"+"))+"&utm_medium=embedded_interactive&utm_campaign="+r.a.utmCampaign),u+="?"+n,e+="?"+encodeURI("utm_source=embed_link&utm_medium=embedded_interactive&utm_campaign="+r.a.utmCampaign));var c={credits_text:t.credits?te(t.credits):s.t("credits_dialog.credits_text",{CC_link:"<a class='opens-in-new-window' href='"+l+"' target='_blank'>Concord Consortium</a>",Next_Gen_MW_link:"<a class='opens-in-new-window' href='"+u+" ' target='_blank'>Next-Generation Molecular Workbench</a>",Google_link:"<a class='opens-in-new-window' href='http://www.google.org/' target='_blank'>Google.org</a>"}),find_shareable:s.t("credits_dialog.find_shareable",{shareable_ver_link:'<a href="'+e+'" class="opens-in-new-window" target="_blank">'+s.t("credits_dialog.shareable_ver")+"</a>",concord_org_link:'<a href="'+l+'" class="opens-in-new-window" target="_blank">concord.org</a>'}),copyright:gn(s)};r.a.sharing||(c.showShareable=!0),this.setContent(qe.a.render("<div>\n  <p>\n    {{{credits_text}}}\n  </p>\n  {{#showShareable}}\n  <p>\n    {{{find_shareable}}}\n  </p>\n  {{/showShareable}}\n  {{{copyright}}}\n</div>\n",c))};var xn,wn,Cn=_n,Tn=n(186),Sn={"model-only":[],simple:[{id:"top",bottom:"model.top",width:"interactive.width"},{id:"right",top:"model.top",left:"model.right",height:"model.height","padding-left":"1em","padding-right":"0.5em"},{id:"bottom",top:"model.bottom",width:"interactive.width","padding-top":"0.5em"}],"narrow-right":[{id:"top",bottom:"model.top",width:"interactive.width"},{id:"right",top:"model.top",left:"model.right",height:"model.height","padding-left":"1em","padding-right":"0.5em",width:"model.width / 4","min-width":"6em"},{id:"bottom",top:"model.bottom",width:"interactive.width","padding-top":"0.5em"}],"wide-right":[{id:"top",bottom:"model.top",width:"interactive.width"},{id:"right",top:"model.top",left:"model.right",height:"model.height","padding-left":"1em","padding-right":"0.5em",width:"model.width","min-width":"6em"},{id:"bottom",top:"model.bottom",width:"interactive.width","padding-top":"0.5em"}],"left-right-bottom":[{id:"left",top:"model.top",height:"model.height",right:"model.left","padding-right":"0.5em"},{id:"right",top:"model.top",height:"model.height",left:"model.right","padding-left":"1em","padding-right":"0.5em"},{id:"bottom",top:"model.bottom",left:"model.left",width:"model.width"}]},kn=!1,An={now:xn="undefined"!=typeof performance&&void 0!==performance.now?performance.now.bind(performance):Date.now.bind(Date),collectData:function(t){(kn=t)&&(wn={})},enterScope:function(t){if(kn){var e=wn[t];void 0===e&&(e=wn[t]={lastTime:0,timeSum:0,count:0}),e.lastTime=xn()}},leaveScope:function(t){if(kn){var e=wn[t];void 0!==e&&(e.timeSum+=xn()-e.lastTime,e.count+=1)}},getAvgTime:function(t){var e=wn[t];return void 0!==e?e.timeSum/e.count:0},getAvgFreq:function(t){var e=wn[t];return void 0!==e?1e3*e.count/e.timeSum:0}};function En(t,e,n,i,r,o,s){var l,u,c,h,d,p=d3.dispatch("modelLoaded","modelReset","modelSetupComplete");function f(){Math.seedrandom=a()(n.randomSeed+u.get("time"))}function m(){An.enterScope("js-rendering"),l.modelContainer.update(),An.leaveScope("js-rendering")}function g(){(u=new i(e,{waitForSetup:!0,i18n:n.i18n})).on("tickStart.modelController",f),u.on("tick.modelController",m),u.on("reset.modelController",v)}function v(){d=d||En.RESET_CAUSE.RESET,h.repaint(),p.modelReset(d)}return l={get type(){return i.type},get benchmarks(){return c},get modelUrl(){return t},get model(){return u},get modelContainer(){return h},on:function(t,e){p.on(t,e)},getViewContainer:function(){return l.modelContainer.$el},getHeightForWidth:function(t,e){return l.modelContainer.getHeightForWidth(t,e)},initializeView:function(){l.modelContainer.setup(),l.modelContainer.repaint()},resize:function(){l.modelContainer.resize()},repaint:function(){l.modelContainer.repaint()},updateView:function(){l.modelContainer.update()},reload:function(i,o,a){u&&u.willReset&&u.willReset(),t=i||t,e=o||e,g(),h?h.bindModel(u,t):h=new r(u,l.modelUrl,n.i18n),a||p.modelLoaded(En.LOAD_CAUSE.RELOAD)},reset:function(t){u.stop(),d=t,u.reset(),d=void 0},state:function(){return u.serialize()},ScriptingAPI:o,enableKeyboardHandlers:function(){return u.get("enableKeyboardHandlers")}},null!=e&&g(),window.getModel=function(){return u},c="function"==typeof s?new s(l):[],l}En.LOAD_CAUSE={RELOAD:"reload",INITIAL_LOAD:"initialLoad"},En.RESET_CAUSE={RESET:"reset"};var Mn=En;function Pn(t){return(Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dn(t,e,n){var i,r,o={};for(i in t)t.hasOwnProperty(i)&&void 0!==e[i]&&!1!==t[i].serialize&&(r=e[i],s.a.isArray(r)?o[i]=s.a.copy(r,[],n):"object"===Pn(r)&&null!==r?o[i]=$.extend(!0,{},r):o[i]=r);return function t(e){var n,i;if(s.a.isArray(e))for(n=0,i=e.length;n<i;n++)e[n]!==1/0&&e[n]!==-1/0||(e[n]=e[n].toString());else for(n in e)e.hasOwnProperty(n)&&(e[n]!==1/0&&e[n]!==-1/0||(e[n]=e[n].toString()),("object"===Pn(e[n])||s.a.isArray(e[n]))&&t(e[n]))}(o),o}function On(t){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var In={get:{defaultValue:void 0,type:"function"},set:{defaultValue:void 0,type:"function"},validate:{defaultValue:void 0,type:"function"},beforeSetCallback:{defaultValue:void 0,type:"function"},afterSetCallback:{defaultValue:void 0,type:"function"},afterGetTransform:{defaultValue:void 0,type:"function"},beforeSetTransform:{defaultValue:void 0,type:"function"},writable:{defaultValue:!0,type:"boolean"},includeInHistoryState:{defaultValue:!1,type:"boolean"},invokeSetterAfterBulkRestore:{defaultValue:!0,type:"boolean"},type:{defaultValue:void 0,type:"propertyType"},description:{defaultValue:void 0}};function Ln(t,e,n){if(On(n)!==t)throw new TypeError(e+" must be a "+t+".")}function Rn(t){var e,n,i=t&&t.types&&function(t){var e=[];return t.forEach((function(t){e.push(t)})),e}(t.types)||[],r={},o={all:void 0,byType:{}},a=!0,s=!1,l=d3.dispatch("beforeInvalidatingChange","afterInvalidatingChange","afterInvalidatingChangeSequence"),u=0,c=!1,h=[],d=[],p=[];function f(){return d.filter((function(t){return r[t].observers.length>0}))}function m(t){var e={};return Object.keys(In).forEach((function(n){var r=In[n];if(void 0!==t[n])switch(e[n]=t[n],r.type){case"boolean":e[n]=!!e[n];break;case"function":Ln("function",n,t[n]);break;case"string":Ln("string",n,t[n]);break;case"propertyType":!function(t){if(i.indexOf(t)<0)throw new TypeError(t+" is not a recognized property type.")}(t[n])}else e[n]=r.defaultValue})),e}function g(t){var e=[];t.forEach((function(t){e.indexOf(t)<0&&(t(),e.push(t))}))}function v(t){var e=[];s=!0,t(),s=!1,h.forEach((function(t){r[t].observers.forEach((function(t){e.push(t)}))})),h=[],g(e)}function y(t){s?h.push(t):g(r[t].observers)}function b(t){var e=r[t];return e.descriptor.get?a?(e.hasCachedValue||(e.hasCachedValue=!0,e.cachedValue=e.descriptor.get()),e.cachedValue):e.descriptor.get():e.cachedValue}function _(t,e){var n=r[t];if(!n.descriptor.writable)throw new Error("Attempt to set read-only property "+t);n.descriptor.get&&!a?n.hasCachedValue=!1:(n.hasCachedValue=!0,n.cachedValue=e)}function x(t,e){r[t].descriptor.description=e,function(t){g(r[t].propertyDescriptionObservers)}(t)}function w(t){var e=t?o.byType[t]:o.all;return e||(e={},Object.keys(r).forEach((function(n){t&&t!==r[n].descriptor.type||function(t,e){var n=r[e];Object.defineProperty(t,e,{enumerable:!0,configurable:!1,get:function(){var t=b(e);return n.descriptor.afterGetTransform&&(t=n.descriptor.afterGetTransform(t)),t},set:function(t){n.descriptor.beforeSetCallback&&n.descriptor.beforeSetCallback(),n.descriptor.beforeSetTransform&&(t=n.descriptor.beforeSetTransform(t)),n.descriptor.validate&&(t=n.descriptor.validate(t)),_(e,t),n.descriptor.set&&n.descriptor.set(t),n.descriptor.afterSetCallback&&n.descriptor.afterSetCallback(),y(e)}})}(e,n)})),Object.seal&&Object.seal(e),t?o.byType[t]=e:o.all=e),e}return n={mixInto:function(t){Object.defineProperty(t,"properties",{configurable:!1,enumerable:!0,get:w}),t.propertiesOfType=function(t){return w(t)},t.set=function(e,n){var i;"string"==typeof e?t.properties[e]=n:(i=e,v((function(){Object.keys(i).forEach((function(e){t.properties[e]=i[e]}))})))},t.get=function(e){return t.properties[e]},t.freeze=function(e){var n=t.getPropertyDescription(e);n.setFrozen(!0),x(e,n)},t.unfreeze=function(e){var n=t.getPropertyDescription(e);n.setFrozen(!1),x(e,n)},t.addObserver=function(t,e){if(r[t]){var n=r[t].observers;n.indexOf(e)<0&&n.push(e)}},t.removeObserver=function(t,e){var n=r[t]&&r[t].observers,i=n&&n.indexOf(e);void 0!==i&&i>=0&&n.splice(i,1)},t.addPropertyDescriptionObserver=function(t,e){if(r[t]){var n=r[t].propertyDescriptionObservers;n.indexOf(e)<0&&n.push(e)}},t.removePropertyDescriptionObserver=function(t,e){var n=r[t].propertyDescriptionObservers,i=n.indexOf(e);i>=0&&n.splice(i,1)},t.hasProperty=function(t){return null!=r[t]},t.isPropertyWritable=function(t){return!!r[t]&&r[t].descriptor.writable},t.getPropertyDescription=function(t){return r[t]&&r[t].descriptor?r[t].descriptor.description:null},t.getPropertyType=function(t){return r[t]&&r[t].descriptor?r[t].descriptor.type:null},t.getPropertyValidateFunc=function(t){return r[t]&&r[t].descriptor?r[t].descriptor.validate:null},t.makeInvalidatingChange=function(t){n.invalidatingChangePreHook(),t&&t(),n.invalidatingChangePostHook()},t.addPropertiesListener=function(e,n){"string"==typeof e?t.addObserver(e,n):e.forEach((function(e){t.addObserver(e,n)}))}},defineProperty:function(t,e){var n;e=m(e||{}),r[t]={descriptor:e,observers:[],propertyDescriptionObservers:[],hasCachedValue:!1,cachedValue:void 0,previousValue:void 0},e.get&&d.push(t),e.includeInHistoryState&&p.push(t),n=e.type,o.all=void 0,n&&(o.byType[n]=void 0)},setPropertyDescription:function(t,e){x(t,e)},deleteComputedPropertyCachedValues:function(){d.forEach((function(t){r[t].hasCachedValue=!1,r[t].cachedValue=void 0}))},storeComputedProperties:function(){f().forEach((function(t){r[t].previousValue=b(t)}))},notifyChangedComputedProperties:function(){v((function(){f().forEach((function(t){b(t)!==r[t].previousValue&&y(t),r[t].previousValue=void 0}))}))},notifyAllComputedProperties:function(){v((function(){f().forEach((function(t){y(t)}))}))},get properties(){return w()},propertiesOfType:function(t){return w(t)},get enableCaching(){return a},set enableCaching(t){a=!!t},get historyStateRawValues(){var t={};return p.forEach((function(e){t[e]=b(e)})),t},get rawValues(){var t={};return Object.keys(r).forEach((function(e){t[e]=b(e)})),t},setRawValues:function(t){v((function(){Object.keys(t).forEach((function(e){var n=r[e];n&&(b(e)!==t[e]&&y(e),_(e,t[e]),n.descriptor.invokeSetterAfterBulkRestore&&n.descriptor.set&&n.descriptor.set(b(e)))}))}))},invalidatingChangePreHook:function(){c&&e||(e=!0,0===u&&(n.storeComputedProperties(),n.deleteComputedPropertyCachedValues(),n.enableCaching=!1),u++,l.beforeInvalidatingChange())},invalidatingChangePostHook:function(){c||(u--,l.afterInvalidatingChange(),0===u&&(n.enableCaching=!0,n.notifyChangedComputedProperties(),l.afterInvalidatingChangeSequence()))},startBatch:function(){e=!1,c=!0},endBatch:function(){c=!1,e&&n.invalidatingChangePostHook()},on:function(t,e){l.on(t,e)}}}function Nn(t){return""===t}function Fn(t,e){var n;if(this._descriptionHash=e,this._label=e.label||"",this._unitName="",this._unitPluralName="",this._unitAbbreviation="",e.unitType){if(!(n=t.units[e.unitType]))throw new Error("PropertyDescription: couldn't find unitType "+e.unitType+" in the supplied units definition.");this._unitType=e.unitType,this._unitName=n.name,this._unitPluralName=n.pluralName,this._unitAbbreviation=n.symbol}e.unitName&&(this._unitName=e.unitName),e.unitPluralName&&(this._unitPluralName=e.unitPluralName),e.unitAbbreviation&&(this._unitAbbreviation=e.unitAbbreviation),this._min=e.min,this._max=e.max,this._frozen=e.frozen,this.setFormat(e.format)}Fn.prototype.getHash=function(){return h.a.extend(h.a.reject({unitName:this.getUnitName(),unitPluralName:this.getUnitPluralName(),unitAbbreviation:this.getUnitAbbreviation()},Nn),this._descriptionHash)},Fn.prototype.getLabel=function(){return this._label},Fn.prototype.getUnitType=function(){return this._unitType},Fn.prototype.getUnitName=function(){return this._unitName},Fn.prototype.getUnitPluralName=function(){return this._unitPluralName},Fn.prototype.getUnitAbbreviation=function(){return this._unitAbbreviation},Fn.prototype.getMin=function(){return this._min},Fn.prototype.getMax=function(){return this._max},Fn.prototype.getFrozen=function(){return this._frozen},Fn.prototype.setFrozen=function(t){this._frozen=t},Fn.prototype.setFormat=function(t){this._formatter=t?d3.format(t):function(t){return t}},Fn.prototype.format=function(t,e){var n,i,r=!0;return(e=e||{}).format?e.format===this._lastFormat?n=this._lastFormatter:(n=d3.format(e.format),this._lastFormat=e.format,this._lastFormatter=n):n=this._formatter,i=n(t),e&&null!=e.abbreviated&&(r=e.abbreviated),r?i+" "+this._unitAbbreviation:i+" "+(1!==parseFloat(i)?this._unitPluralName:this._unitName)};var Bn=Fn;function zn(t){var e=t.propertySupport,n=t.unitsDefinition||{};return{mixInto:function(t){t.defineParameter=function(i,r,o){var a={type:"parameter",includeInHistoryState:!0,invokeSetterAfterBulkRestore:!1,description:new Bn(n,r),beforeSetCallback:e.invalidatingChangePreHook,afterSetCallback:e.invalidatingChangePostHook};o&&(a.set=function(e){o.call(t,e)}),e.defineProperty(i,a)}}}}function jn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Vn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.periodLength=e,this._value=[],this._time=[],this._idx=-1,this._maxBufferLength=this.periodLength}var e,n,i;return e=t,(n=[{key:"addSample",value:function(t,e){var n=this;if(this._time[this._idx]!==t){if(this._time[this._idx]>t)throw new Error("RunningAverageFilter: cannot add sample with @_time less than previous sample.");return this._idx++,this._value.push(e),this._time.push(t),function(){for(var t=[];n._value.length>n._maxBufferLength;)n._time.shift(),n._value.shift(),t.push(n._idx--);return t}()}this._value[this._idx]=e}},{key:"calculate",value:function(){for(var t,e=Math.max(this._time[this._idx]-this.periodLength,0),n=0,i=0,r=this._idx;r>0&&this._time[r-1]>=e;)i+=t=this._time[r]-this._time[r-1],n+=t*(this._value[r-1]+this._value[r])/2,r--;if(r>0&&this._time[r]>e&&this._time[r-1]<e){i+=t=this._time[r]-e;var o=this._value[r-1]+(this._value[r]-this._value[r-1])*(e-this._time[r-1])/(this._time[r]-this._time[r-1]);n+=t*(this._value[r]+o)/2}return i?n/i:this._value[0]||0}},{key:"getCurrentBufferLength",value:function(){return this._value.length}},{key:"setMaxBufferLength",value:function(t){return this._maxBufferLength=t}},{key:"getCurrentTime",value:function(){return this._time[this._idx]}},{key:"getCurrentStep",value:function(){return this._idx}},{key:"setCurrentStep",value:function(t){if(t<-1||t>=this._value.length)throw new Error("RunningAverageFilter: cannot seek, location outside available range.");return this._idx=t}},{key:"invalidate",value:function(t){return this._value.length=t+1,this._time.length=t+1,this._idx=t}},{key:"reset",value:function(){return this._values.length=0,this._time=0,this._idx=0}}])&&jn(e.prototype,n),i&&jn(e,i),t}();function Hn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Wn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._values=[],this._time=[],this._idx=-1,this._zero_crossing_buffer=[],this._period_buffer=[],this._maxBufferLength=8192}var e,n,i;return e=t,(n=[{key:"addSample",value:function(t,e){var n;if(this._time[this._idx]!==t)if(this._time[this._idx]>t)console.log("Error: RunningAverageFilter: cannot add sample with @_time less than previous sample.");else{for(this._idx++,this._values.push(e),this._time.push(t),this._values.length>1&&(n=this._values[this._values.length-2]);this._values.length>this._maxBufferLength;)this._time.shift(),this._values.shift(),this._idx--;if(n<0&&e>0||n>0&&e<0){if(this._zero_crossing_buffer.push(t),this._zero_crossing_buffer.length>1){var i=this._zero_crossing_buffer[this._zero_crossing_buffer.length-2];this._period_buffer.push(t-i)}for(;this._zero_crossing_buffer.length>128;)this._zero_crossing_buffer.shift(),this._period_buffer.shift()}}else this._values[this._idx]=e}},{key:"calculate",value:function(){return this._period_buffer.length<1?0:1===this._period_buffer.length?2*this._period_buffer[0]:this._period_buffer.reduce((function(t,e){return t+e}))/this._period_buffer.length*2}},{key:"getCurrentBufferLength",value:function(){return this._values.length}},{key:"setMaxBufferLength",value:function(t){return this._maxBufferLength=t}},{key:"getCurrentTime",value:function(){return this._time[this._idx]}},{key:"getCurrentStep",value:function(){return this._idx}},{key:"setCurrentStep",value:function(t){if(t<-1||t>=this._values.length)throw new Error("SimplePeriodFilter: cannot seek, location outside available range.");return this._idx=t}},{key:"invalidate",value:function(t){return t?(this._values.length=t+1,this._time.length=t+1,this._idx=t):this.reset()}},{key:"reset",value:function(){this._values.length=0,this._time.length=0,this._idx=0,this._zero_crossing_buffer.length=0,this._period_buffer.length=0}}])&&Hn(e.prototype,n),i&&Hn(e,i),t}();function Un(t){var e=t.propertySupport,n=t.unitsDefinition||{},i=t.tickHistory||null,r=[];function o(){r.forEach((function(t){t.addSample()}))}return e.on("afterInvalidatingChange.output-support",o),{mixInto:function(t){t.defineOutput=function(t,i,r){e.defineProperty(t,{type:"output",writable:!1,get:r,includeInHistoryState:!1,description:new Bn(n,i)})},t.defineFilteredOutput=function(e,n,o,a,s){var l,u;if("RunningAverage"===a)l=new Vn(s);else{if("SimplePeriod"!==a)throw new Error("FilteredOutput: unknown filter type "+a+".");l=new Wn}if(void 0===(u=t.properties[o])||isNaN(Number(u)))throw new Error("FilteredOutput: property is not a valid numeric value or it is undefined.");l.addSample(t.properties.time,u),i?i.registerExternalObject({push:function(){l.addSample(t.properties.time,t.properties[o])},extract:function(t){l.setCurrentStep(t)},invalidate:function(t){l.invalidate(t)},setHistoryLength:function(t){l.setMaxBufferLength(t)},reset:function(){l.reset()}}):r.push({addSample:function(){l.addSample(t.properties.time,t.properties[o])}}),n.property=o,n.type=a,n.period=s,t.defineOutput(e,n,(function(){return l.calculate()}))},t.updateAllOutputProperties=function(){e.deleteComputedPropertyCachedValues(),e.notifyAllComputedProperties(),o()},t.resetAllOutputProperties=function(){r.forEach((function(t){t.reset()}))}}}}var $n=n(6);function Gn(t){var e=t&&t.dispatch||null,n=t&&t.propertySupport||null,i=t&&t.unitsDefinition||null,r=t.computeActualUseDuration,o=t.computeActualDuration,a=function(){if(e){if(e.on&&e.addEventTypes)return e.addEventTypes("play","stop","tickStart","tickEnd"),!0;throw new Error("[PlaybackSupport] Provided Dispatch object doesn't implement required interface!")}return!1}(),s=!0,l=!1,u=!1,c=!1;return{mixInto:function(t){var h;n&&t.defineOutput&&(t.defineOutput("durationOptions",{},(function(){var t=n.properties.timePerTick;return null!=t?[30,60,120,300,600,1800,3600].map((function(e){return e*t})):[]})),t.defineOutput("actualUseDuration",{},r),t.defineOutput("actualDuration",{label:"Experiment duration",unitType:"time",format:"f"},o)),!t.formatTime&&i&&(h=new Bn(i,{unitType:"time",format:".1f"}),t.formatTime=function(t){return h.format(t)}),"function"!=typeof t.tick&&(t.tick=function(){$n.a.warn("[PlaybackSupport] .tick() method should be overwritten by target!")}),t.start=function(){return l=!1,u=!1,s?(s=!1,i=function(i){return a&&e.tickStart(),An.leaveScope("gap"),l?(s=!0,a&&e.stop(),!0):u?(setTimeout(t.start,0),s=!0,!0):n&&n.properties.time>=n.properties.actualDuration?(t.stop(),!1):(An.enterScope("tick"),t.tick(i),An.leaveScope("tick"),An.enterScope("gap"),!1)},"default"===(o=n&&n.properties.modelSampleRate||"default")?d3.timer(i):r=window.setInterval((function(){i()&&window.clearInterval(r)}),1e3/o),a&&e.play(),An.enterScope("gap"),t):t;var i,r,o},t.restart=function(){return u=!0,t},t.stop=function(){return l=!0,t},t.isStopped=function(){return s||l},t.on("play.playback-support",(function(){c=!0})),t.on("reset.playback-support",(function(){c=!1})),Object.defineProperty(t,"hasPlayed",{enumerable:!0,get:function(){return c}})}}}function qn(t){var e,n,i=t.metadata,r=t.setters,o=t.unitsDefinition,a=t.unitsTranslation,s=t.initialProperties,l=t.tickHistory,u=void 0===t.usePlaybackSupport||!!t.usePlaybackSupport,c=new Rn({types:["output","parameter","mainProperty","viewOption"]}),h=new zn({propertySupport:c,unitsDefinition:o}),d=new Un({propertySupport:c,unitsDefinition:o,tickHistory:l}),f=new ft;function m(){var t,e=c.properties.actualUseDuration,n=c.properties.requestedDuration;return e?"number"==typeof n?n:(t=c.properties.durationOptions).length>0?t[Math.floor(t.length/2)]:1/0:1/0}function g(){var t=c.properties.useDuration;return!0===t||"codap"===t&&Ot.canExportData()}u&&(n=new Gn({dispatch:f,propertySupport:c,unitsDefinition:o,computeActualDuration:m,computeActualUseDuration:g}));var v=!1;return f.addEventTypes("reset","stepForward","stepBack","seek","invalidation","willReset","ready","log"),e={mixInto:function(t){c.mixInto(t),h.mixInto(t),d.mixInto(t),f.mixInto(t),n&&n.mixInto(t),t.willReset=function(){f.willReset()},t.ready=function(){if(v)throw new Error("ready() called on an already-ready model.");e.tickHistory&&(e.tickHistory.saveInitialState(),e.tickHistory.push()),c.invalidatingChangePreHook(),v=!0,c.invalidatingChangePostHook(),f.ready()},Object.defineProperty(t,"isReady",{enumerable:!0,get:function(){return v}}),i&&function(t){var e,n,i=t.propertySupport,r=t.metadata,o=t.unitsDefinition||{},a=t.unitsTranslation||null,s=t.setters||{},l=t.initialProperties||null;function u(t,e,n){var s,l,u,c;if("mainProperty"===e)s=r.mainProperties;else{if("viewOption"!==e)throw new Error(e+" is not a supported built-in property type");s=r.viewOptions}u=p.a.propertyChangeInvalidates(s[t]),l={type:e,writable:p.a.propertyIsWritable(s[t]),set:n,includeInHistoryState:!!s[t].storeInTickHistory,validate:function(e){return p.a.validateSingleProperty(s[t],t,e,!1)},beforeSetCallback:u?i.invalidatingChangePreHook:void 0,afterSetCallback:u?i.invalidatingChangePostHook:void 0},c=s[t].unitType,l.description=new Bn(o,{unitType:c,label:s[t].label||t}),c&&a&&(l.beforeSetTransform=function(t){return a.translateToModelUnits(t,c)},l.afterGetTransform=function(t){return a.translateFromModelUnits(t,c)}),i.defineProperty(t,l)}Object.keys(r.mainProperties).forEach((function(t){u(t,"mainProperty",s[t])})),Object.keys(r.viewOptions).forEach((function(t){u(t,"viewOption",s[t])})),l&&(e=p.a.validateCompleteness(r.mainProperties,l),i.setRawValues(e),n=p.a.validateCompleteness(r.viewOptions,l.viewOptions||{}),i.setRawValues(n))}({propertySupport:c,metadata:i,unitsDefinition:o,unitsTranslation:a,setters:r,initialProperties:s})},get propertySupport(){return c},get parameterSupport(){return h},get outputSupport(){return d},get dispatchSupport(){return f},get playbackSupport(){return n},get computeActualDuration(){return m},get computeActualUseDuration(){return g}}}function Yn(t,e,n){var i,r,o,a={},s=[],l=!!t.getProperties;function u(){var t;for(r=[],o={length:0,maxSize:n,index:-1,counter:-1,startCounter:0},t=0;t<s.length;t++)s[t].reset&&s[t].reset()}function c(e){var n,i,r,o,a;if(l)e.input=t.getProperties();else{for(n=0;n<t.input.length;n++)i=t.input[n],e.input[i]=t.getRawPropertyValue(i);for(a in o=t.parameters)o.hasOwnProperty(a)&&o[a].isDefined&&(e.parameters[a]=t.getRawPropertyValue(a))}for(r=t.state,n=0;n<r.length;n++)e.state[n]=r[n].clone()}function h(){var t,e={input:{},state:[],parameters:{}};for(c(e),r[o.index+1]=e,r.length>o.maxSize?(r.splice(0,1),o.startCounter++):o.index++,o.counter=o.index+o.startCounter,t=0;t<s.length;t++)s[t].push();d(),o.length=r.length}function d(){var t;for(r.length=o.index+1,o.length=r.length,t=0;t<s.length;t++)s[t].invalidate(o.index)}function p(e){var n,i;for(t.restoreProperties(e.input),l||t.restoreParameters(e.parameters),i=e.state,n=0;n<i.length;n++)t.state[n].restore(i[n]);for(n=0;n<s.length;n++)s[n].extract(o.index)}function f(t){if(t<0)throw new Error("TickHistory: extract index ["+t+"] less than 0");if(t>=r.length)throw new Error("TickHistory: extract index ["+t+"] greater than list.length: "+r.length);return t}return a.isEmpty=function(){return 0===o.index},a.push=function(){h()},a.returnTick=function(t){var e;return f(e="number"==typeof t?t:o.index),r[e]},a.extract=function(t){var e;f(e="number"==typeof t?t:o.index),p(r[e])},a.saveInitialState=function(){c(i={input:{},state:[],parameters:{}})},a.restoreInitialState=function(){u(),p(i),h()},a.reset=u,a.decrementExtract=function(){o.counter>o.startCounter&&(o.index--,o.counter--,p(r[o.index]))},a.incrementExtract=function(){o.index++,o.counter++,p(r[o.index])},a.seekExtract=function(t){t<o.startCounter&&(t=o.startCounter),t>=o.startCounter+o.length&&(t=o.startCounter+o.length-1),o.counter=t,o.index=t-o.startCounter,p(r[o.index])},a.invalidateFollowingState=d,a.get=function(t){return o[t]},a.set=function(t,e){return o[t]=e},a.registerExternalObject=function(t){t.setHistoryLength(o.maxSize),s.push(t)},null==n&&(n=1e3),u(),a}var Xn=[{fullName:"Alanine",abbreviation:"Ala",symbol:"A",molWeight:89.09,charge:0,hydrophobicityRB:2.15,pK:0,surface:115,volume:88.6,solubility:16.65,hydrophobicity:1,property:"Total aliphatic; hydrophobic"},{fullName:"Arginine",abbreviation:"Arg",symbol:"R",molWeight:174.2,charge:1,hydrophobicityRB:2.23,pK:12,surface:225,volume:173.4,solubility:15,hydrophobicity:-2,property:"Acidic side chains; strongly polar; cationic"},{fullName:"Asparagine",abbreviation:"Asn",symbol:"N",molWeight:132.12,charge:0,hydrophobicityRB:1.05,pK:0,surface:160,volume:114.1,solubility:3.53,hydrophobicity:-1,property:"Strongly polar"},{fullName:"Asparticacid",abbreviation:"Asp",symbol:"D",molWeight:133.1,charge:-1,hydrophobicityRB:1.13,pK:4.4,surface:150,volume:111.1,solubility:.778,hydrophobicity:-2,property:"Acidic side chains; strongly polar; anionic"},{fullName:"Cysteine",abbreviation:"Cys",symbol:"C",molWeight:121.15,charge:0,hydrophobicityRB:1.2,pK:8.5,surface:135,volume:108.5,solubility:1e3,hydrophobicity:1,property:"Polar side chains; semipolar"},{fullName:"Glutamine",abbreviation:"Gln",symbol:"Q",molWeight:146.15,charge:0,hydrophobicityRB:1.65,pK:0,surface:180,volume:143.8,solubility:2.5,hydrophobicity:-1,property:"Strongly polar"},{fullName:"Glutamicacid",abbreviation:"Glu",symbol:"E",molWeight:147.13,charge:-1,hydrophobicityRB:1.73,pK:4.4,surface:190,volume:138.4,solubility:.864,hydrophobicity:-2,property:"Acidic side chains; strongly polar; anionic"},{fullName:"Glycine",abbreviation:"Gly",symbol:"G",molWeight:75.07,charge:0,hydrophobicityRB:1.18,pK:0,surface:75,volume:60.1,solubility:24.99,hydrophobicity:1,property:"Semipolar"},{fullName:"Histidine",abbreviation:"His",symbol:"H",molWeight:155.16,charge:1,hydrophobicityRB:2.45,pK:6.5,surface:195,volume:153.2,solubility:4.19,hydrophobicity:-2,property:"Basic side chains; strongly polar; cationic"},{fullName:"Isoleucine",abbreviation:"Ile",symbol:"I",molWeight:131.17,charge:0,hydrophobicityRB:3.88,pK:0,surface:175,volume:166.7,solubility:4.117,hydrophobicity:1,property:"Branched chain aliphatic; hydrophobic"},{fullName:"Leucine",abbreviation:"Leu",symbol:"L",molWeight:131.17,charge:0,hydrophobicityRB:4.1,pK:10,surface:170,volume:166.7,solubility:2.426,hydrophobicity:1,property:"Branched chain aliphatic; hydrophobic"},{fullName:"Lysine",abbreviation:"Lys",symbol:"K",molWeight:146.19,charge:1,hydrophobicityRB:3.05,pK:0,surface:200,volume:168.6,solubility:1e3,hydrophobicity:-2,property:"Acidic side chains; strongly polar; cationic"},{fullName:"Methionine",abbreviation:"Met",symbol:"M",molWeight:149.21,charge:0,hydrophobicityRB:3.43,pK:0,surface:185,volume:162.9,solubility:3.81,hydrophobicity:1,property:"Totally alyphatic"},{fullName:"Phenylalanine",abbreviation:"Phe",symbol:"F",molWeight:165.19,charge:0,hydrophobicityRB:3.46,pK:0,surface:210,volume:189.9,solubility:2.965,hydrophobicity:2,property:"Totally aromatic"},{fullName:"Proline",abbreviation:"Pro",symbol:"P",molWeight:115.13,charge:0,hydrophobicityRB:3.1,pK:0,surface:145,volume:112.7,solubility:162.3,hydrophobicity:1,property:"Totally alyphatic"},{fullName:"Serine",abbreviation:"Ser",symbol:"S",molWeight:105.09,charge:0,hydrophobicityRB:1.4,pK:0,surface:115,volume:89,solubility:5.023,hydrophobicity:-1,property:"Semipolar"},{fullName:"Threonine",abbreviation:"Thr",symbol:"T",molWeight:119.12,charge:0,hydrophobicityRB:2.25,pK:0,surface:140,volume:116.1,solubility:1e3,hydrophobicity:-1,property:"Semipolar"},{fullName:"Tryptophan",abbreviation:"Trp",symbol:"W",molWeight:204.23,charge:0,hydrophobicityRB:4.11,pK:0,surface:255,volume:227.8,solubility:1.136,hydrophobicity:2,property:"Totally aromatic"},{fullName:"Tyrosine",abbreviation:"Tyr",symbol:"Y",molWeight:181.19,charge:0,hydrophobicityRB:2.81,pK:10,surface:230,volume:193.6,solubility:.045,hydrophobicity:1,property:"Hydrophobic; total aromatic"},{fullName:"Valine",abbreviation:"Val",symbol:"V",molWeight:117.15,charge:0,hydrophobicityRB:3.38,pK:0,surface:155,volume:140,solubility:8.85,hydrophobicity:1,property:"Branched chain aliphatic; hydrophobic"}],Qn={UUU:"Phe",UUC:"Phe",UUA:"Leu",UUG:"Leu",CUU:"Leu",CUC:"Leu",CUA:"Leu",CUG:"Leu",AUU:"Ile",AUC:"Ile",AUA:"Ile",AUG:"Met",GUU:"Val",GUC:"Val",GUA:"Val",GUG:"Val",UCU:"Ser",UCC:"Ser",UCA:"Ser",UCG:"Ser",AGU:"Ser",AGC:"Ser",CCU:"Pro",CCC:"Pro",CCA:"Pro",CCG:"Pro",ACU:"Thr",ACC:"Thr",ACA:"Thr",ACG:"Thr",GCU:"Ala",GCC:"Ala",GCA:"Ala",GCG:"Ala",UAU:"Tyr",UAC:"Tyr",CAU:"His",CAC:"His",CAA:"Gln",CAG:"Gln",AAU:"Asn",AAC:"Asn",AAA:"Lys",AAG:"Lys",GAU:"Asp",GAC:"Asp",GAA:"Glu",GAG:"Glu",UGU:"Cys",UGC:"Cys",UGG:"Trp",CGU:"Arg",CGC:"Arg",CGA:"Arg",CGG:"Arg",AGA:"Arg",AGG:"Arg",GGU:"Gly",GGC:"Gly",GGA:"Gly",GGG:"Gly",UAA:"STOP",UAG:"STOP",UGA:"STOP"},Kn={firstElementID:5,lastElementID:5+Xn.length-1,cysteineElement:9,abbrToElement:function(t){for(var e=0;e<Xn.length;e++){if(Xn[e].abbreviation===t)return e+this.firstElementID}},getAminoAcidByElement:function(t){return Xn[t-this.firstElementID]},isAminoAcid:function(t){return t>=this.firstElementID&&t<=this.lastElementID},getPolarAminoAcids:function(){var t=this;return["Asn","Gln","Ser","Thr"].map((function(e){return t.abbrToElement(e)}))},codonToAbbr:function(t){return 3!==t.length?"STOP":Qn[t]}},Jn=n(187),Zn=n.n(Jn),ti=n(55),ei=n.n(ti);var ni={normal:Zn.a.normal,getWindowedAverager:ei.a.getWindowedAverager,getAngleBetweenVec:ei.a.getAngleBetweenVec,minimize:function(t,e,n){null==(n=n||{}).precision&&(n.precision=.01);var i,r,o,a,s,l,u,c,h,d,p=n.precision,f=n.bounds,m=n.maxiter||1e3,g=n.stopval||-1/0,v=n.maxstep||.01,y=n.eps||.01,b=e.length;for(l=v*v,i=[],h=0;h<b;h++)i[h]=e[h];o=(r=t.apply(null,i))[0],s=r[1],c=0;do{if(o<=g)break;if(c>m)return $n.a.log("maxiter reached"),{error:"maxiter reached",f:o,iter:m,x:i};for(u=0,h=0;h<b;h++)u+=s[h]*s[h];if(y*y*u>l)for(d=Math.sqrt(l/u)/y,h=0;h<b;h++)s[h]=d*s[h];for(h=0;h<b;h++)i[h]-=y*s[h],f&&i[h]<f[h][0]&&(i[h]=f[h][0]),f&&i[h]>f[h][1]&&(i[h]=f[h][1]);a=o,o=(r=t.apply(null,i))[0],s=r[1],c++}while(Math.abs(o-a)>p);return[o,i]}},ii=ce.a.unit,ri=ce.a.COULOMB_CONSTANT.as(ce.a.unit.METERS_PER_FARAD),oi=ce.a.ratio(ii.NANOMETER,{per:ii.METER}),ai=Math.pow(ce.a.ratio(ii.COULOMB,{per:ii.ELEMENTARY_CHARGE}),2),si=ce.a.ratio(ii.EV,{per:ii.JOULE}),li=ce.a.ratio(ii.MW_FORCE_UNIT,{per:ii.NEWTON}),ui=.346*ri*ai*oi*si,ci=.346*ri*ai*oi*oi*li,hi=function(t,e,n,i,r){var o=Math.sqrt(t);return r&&i>1&&o<1.2&&(i=1+(i-1)/(1+Math.exp(-12*o+7))),e*n/t*-ci/i},di={potential:function(t,e,n,i,r){return r&&i>1&&t<1.2&&(i=1+(i-1)/(1+Math.exp(-12*t+7))),ui*(e*n/t)/i},forceFromSquaredDistance:hi,forceOverDistanceFromSquaredDistance:function(t,e,n,i,r){return hi(t,e,n,i,r)/Math.sqrt(t)},force:function(t,e,n,i,r){return hi(t*t,e,n,i,r)}},pi=ce.a.unit,fi=ce.a.ratio(pi.NANOMETER,{per:pi.METER}),mi=ce.a.ratio(pi.MW_FORCE_UNIT,{per:pi.NEWTON}),gi={pairwiseEpsilon:function(t,e){return.5*(t+e)},pairwiseSigma:function(t,e){return Math.sqrt(t*e)},rmin:function(t){return Math.pow(2,1/6)*t},radius:function(t){return.5*t},newLJCalculator:function(t,e){var n,i,r,o,a,s,l,u,c=!1,h=function(t,u){n=t,i=u,r=gi.rmin(i),null!=n&&null!=i&&(o=4*n*Math.pow(i,12),a=4*n*Math.pow(i,6),s=12*ce.a.convert(o,{from:pi.EV,to:pi.JOULE})*fi*mi,l=6*ce.a.convert(a,{from:pi.EV,to:pi.JOULE})*fi*mi),c&&"function"==typeof e&&e(d(),this)},d=function(){return{epsilon:n,sigma:i,rmin:r}},p=function(t){if(null==t||parseFloat(t)!==t)throw new Error("lennardJones: epsilon value "+t+" is invalid")},f=function(t){if(null==t||parseFloat(t)!==t||t<=0)throw new Error("lennardJones: sigma value "+t+" is invalid")};return p(t.epsilon),f(t.sigma),h(t.epsilon,t.sigma),c=!0,u={getCoefficients:d,setEpsilon:function(t){p(t),h(t,i)},setSigma:function(t){f(t),h(n,t)},potentialFromSquaredDistance:function(t){return t?o*Math.pow(t,-6)-a*Math.pow(t,-3):-1/0},potential:function(t){return u.potentialFromSquaredDistance(t*t)},forceOverDistanceFromSquaredDistance:function(t){var e=1/t,n=e*e*e,i=n*e;return s*(i*n)-l*i},force:function(t){return t*u.forceOverDistanceFromSquaredDistance(t*t)}}}},vi={coulomb:di,lennardJones:gi};function yi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var bi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._engine=e,this._data={}}var e,n,i;return e=t,(n=[{key:"registerChangeHooks",value:function(t,e){return this._changePreHook=t,this._changePostHook=e}},{key:"set",value:function(t,e,n){n=p.a.validate(me.a.pairwiseLJProperties,n),this._changePreHook(),null==this._data[t]&&(this._data[t]={}),null==this._data[e]&&(this._data[e]={}),null==this._data[t][e]&&(this._data[t][e]=this._data[e][t]={});for(var i=0,r=Object.keys(n||{});i<r.length;i++){var o=r[i];this._data[t][e][o]=n[o]}return this._engine.setPairwiseLJProperties(t,e),this._changePostHook()}},{key:"remove",value:function(t,e){return this._changePreHook(),delete this._data[t][e],delete this._data[e][t],this._engine.setPairwiseLJProperties(t,e),this._changePostHook()}},{key:"get",value:function(t,e){return this._data[t]&&this._data[t][e]?this._data[t][e]:void 0}},{key:"deserialize",value:function(t){var e=!0,n=!1,i=void 0;try{for(var r,o=t[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value,s=(a=p.a.validateCompleteness(me.a.pairwiseLJProperties,a)).element1,l=a.element2;delete a.element1,delete a.element2,this.set(s,l,a)}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"serialize",value:function(){for(var t=[],e=0,n=Object.keys(this._data||{});e<n.length;e++)for(var i=n[e],r=this._data[i],o=0,a=Object.keys(r||{});o<a.length;o++){var s=a[o];if(i<s){var l=this.get(i,s);l.element1=Number(i),l.element2=Number(s),t.push(l)}}return t}},{key:"clone",value:function(){return $.extend(!0,{},this._data)}},{key:"restore",value:function(t){this._data=t;for(var e=0,n=Object.keys(this._data||{});e<n.length;e++)for(var i=n[e],r=this._data[i],o=0,a=Object.keys(r||{});o<a.length;o++){var s=a[o];i<s&&this._engine.setPairwiseLJProperties(i,s)}}}])&&yi(e.prototype,n),i&&yi(e,i),t}();function _i(t,e,n){var i,r,o,a,s=function(){var s;for(i=Math.ceil(t/n),r=Math.ceil(e/n),o=i*r,a=new Array(o),s=0;s<o;s++)a[s]=[]};return s(),{reinitialize:function(i,r,o){var a=!1;void 0!==i&&i!==t&&(t=i,a=!0),void 0!==r&&r!==e&&(e=r,a=!0),void 0!==o&&o!==n&&(n=o,a=!0),a&&s()},addToCell:function(t,e,r){var o=Math.floor(r/n)*i+Math.floor(e/n);a[o].push(t)},getCell:function(t){return a[t]},getRowsNum:function(){return r},getColsNum:function(){return i},getNeighboringCells:function(t,e){var n=t*i+e,o=[];return e+1<i&&t+1<r&&o.push(a[n+i+1]),e+1<i&&o.push(a[n+1]),e+1<i&&t-1>=0&&o.push(a[n-i+1]),t-1>=0&&o.push(a[n-i]),o},clear:function(){var t;for(t=0;t<o;t++)a[t].length=0}}}function xi(t,e){var n,i,r,o,a,l,u,c,h,d=function(){i=0,r=(n=t+10)*(n-1)/2,h=!0,o=s.a.create(r,0,fe.int16Type),a=s.a.create(n,-1,fe.int16Type),l=s.a.create(n,-1,fe.int16Type),u=s.a.create(n,1/0,fe.floatType),c=s.a.create(n,1/0,fe.floatType)};return d(),{reinitialize:function(i,r){e=r,h=!0,(t=i)>n&&d()},clear:function(){var e;for(i=0,e=0;e<t;e++)a[e]=l[e]=-1},getList:function(){return o},markNeighbors:function(t,e){a[t]<0&&(a[t]=i),o[i]=e,i++,l[t]=i},getStartIdxFor:function(t){return a[t]},getEndIdxFor:function(t){return l[t]},saveAtomPosition:function(t,e,n){u[t]=e,c[t]=n},invalidate:function(){h=!0},shouldUpdate:function(n,i){var r,o=-1/0,a=-1/0;if(h)return h=!1,!0;for(r=0;r<t;r++)Math.abs(n[r]-u[r])>o&&(o=Math.abs(n[r]-u[r])),Math.abs(i[r]-c[r])>a&&(a=Math.abs(i[r]-c[r]));return Math.sqrt(o*o+a*a)>e}}}function wi(){var t=[];return{registerPlugin:function(e){t.push(e)},callPluginFunction:function(e,n,i){var r,o,a,s;for(r=0,o=t.length;r<o;r++)(a=t[r][e])&&(s=a.apply(t[r],n)),i&&i(s,r,t[r])}}}var Ci=ce.a.unit,Ti=vi.coulomb,Si=vi.lennardJones,ki=ce.a.BOLTZMANN_CONSTANT.as(Ci.JOULES_PER_KELVIN),Ai=function(t,e,n,i){return t*i-e*n},Ei=function(t,e){return t*t+e*e},Mi=function(t,e){if(0===e)return 0;var n=t/e;return ce.a.convert(n,{from:Ci.MW_ENERGY_UNIT,to:Ci.JOULE})/ki},Pi=function(t){var e=parseFloat(t);if(isNaN(e))throw new Error("md2d: requested temperature "+t+" could not be understood.");if(e<0)throw new Error("md2d: requested temperature "+e+" was less than zero");if(e===1/0)throw new Error("md2d: requested temperature was Infinity!")},Di=function(){var t,e,n,i,r,o,a,l,u,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E,M,P,D,O,I,L,R,N,F,B,z,j,V,H,W,U,$,G,q,Y,X,Q,K,J,Z,tt,et,nt,it,rt,ot,at,st,lt,ut,ct,ht,dt,pt,ft,mt,gt,vt,yt,bt,_t,xt,wt,Ct,Tt,St,kt,At,Et,Mt,Pt,Dt,Ot,It,Lt,Rt,Nt,Ft,Bt,zt,jt,Vt,Ht,Wt,Ut,$t,Gt,qt,Yt,Xt,Qt,Kt,Jt,Zt=!1,te=new wi,ee=!1,ne=1,ie=!0,re=0,oe=!1,ae=1,se=25,le=3,de=!0,pe=!1,me=1.67,ge=!1,ve=[10,10],ye=0,be=0,_e=10,xe=10,we=0,Ce=0,Te=0,Se=[],ke=0,Ae=!1,Ee=0,Me=0,Pe=0,De=0,Oe=0,Ie=0,Le=0,Re=[],Ne=[],Fe=[],Be=[],ze=function(){throw new Error("md2d: Don't change the epsilon or sigma parameters of the LJ calculator being used by MD2D. Use the setElementProperties method instead.")},je=function(t,e){var n,i,r=S[t],o=S[e],a=k[t],s=k[e],l=P.get(t,e);n=l&&void 0!==l.epsilon?l.epsilon:Si.pairwiseEpsilon(r,o),i=l&&void 0!==l.sigma?l.sigma:Si.pairwiseSigma(a,s),Re[t][e]=Re[e][t]=4*i*(4*i),Ne[t][e]=Ne[e][t]=4.1*i*(4.1*i),Fe[t][e]=Fe[e][t]=Si.newLJCalculator({epsilon:n,sigma:i},ze)},Ve=function(){var t,e,n,i,r=0;for(n=0;n<Te;n++)for(i=0;i<=n;i++)Se[n]&&Se[i]&&4.1*(e=(t=P.get(n,i))&&void 0!==t.sigma?t.sigma:Si.pairwiseSigma(k[n],k[i]))>r&&(r=4.1*e);return r||Math.max(ve[0],ve[1])},He=function(){var t,e,n,i,r=1/0;for(n=0;n<Te;n++)for(i=0;i<=n;i++)Se[n]&&Se[i]&&(4.1-4)*(e=(t=P.get(n,i))&&void 0!==t.sigma?t.sigma:Si.pairwiseSigma(k[n],k[i]))<r&&(r=(4.1-4)*e);return r},We=function(){void 0===Ht?Ht=new _i(ve[0],ve[1],Ve()):Ht.reinitialize(ve[0],ve[1],Ve())},Ue=function(){void 0===Wt?Wt=new xi(Ce,He()):Wt.reinitialize(Ce,He())},$e=function(){o=C.radius,a=C.px,l=C.py,u=C.x,c=C.y,h=C.vx,d=C.vy,p=C.speed,f=C.ax,m=C.ay,g=C.charge,y=C.friction,C.radical,v=C.element,b=C.pinned,_=C.mass,x=C.hydrophobicity,w=C.visited},Ge=function(){D=N.atom1,O=N.atom2,I=N.length,L=N.strength,R=N.type},qe=function(){F=V.atomIndex,B=V.k,z=V.x0,j=V.y0},Ye=function(){H=q.atom1,W=q.atom2,U=q.atom3,$=q.angle,G=q.strength},Xe=function(){T=M.mass,S=M.epsilon,k=M.sigma,A=M.radius,E=M.color},Qe=function(){Y=mt.x,X=mt.y,Q=mt.width,K=mt.height,it=mt.mass,J=mt.vx,Z=mt.vy,tt=mt.externalAx,et=mt.externalAy,nt=mt.friction,rt=mt.westProbe,ot=mt.northProbe,at=mt.eastProbe,st=mt.southProbe,ht=mt.westProbeValue,dt=mt.northProbeValue,pt=mt.eastProbeValue,ft=mt.southProbeValue,ut=mt.xPrev,ct=mt.yPrev,mt.color,mt.visible,lt=mt.permeability},Ke=function(){gt=wt.type,vt=wt.x,yt=wt.y,bt=wt.width,_t=wt.height,xt=wt.fence,wt.color,wt.lineColor,wt.lineDashes,wt.lineWeight,wt.layer,wt.layerPosition,wt.visible},Je=function(){Ct=Et.x1,Tt=Et.y1,St=Et.x2,kt=Et.y2,Et.beginStyle,Et.endStyle,At=Et.fence,Et.lineColor,Et.lineDashes,Et.lineWeight,Et.layer,Et.layerPosition,Et.visible},Ze=function(){Mt=Ot.intensity,Pt=Ot.orientation,Dt=Ot.shapeIdx},tn=function(){Ft=Vt[0],Bt=Vt[1],zt=Vt[2],jt=Vt[3]},en=function(){Rt=It.atom1,Nt=It.atom2},nn=function(e){(M=t.elements={}).mass=s.a.create(e,0,fe.floatType),M.epsilon=s.a.create(e,0,fe.floatType),M.sigma=s.a.create(e,0,fe.floatType),M.radius=s.a.create(e,0,fe.floatType),M.color=[],Xe()},rn=function(t){(C={}).radius=s.a.create(t,0,fe.floatType),C.px=s.a.create(t,0,fe.floatType),C.py=s.a.create(t,0,fe.floatType),C.x=s.a.create(t,0,fe.floatType),C.y=s.a.create(t,0,fe.floatType),C.vx=s.a.create(t,0,fe.floatType),C.vy=s.a.create(t,0,fe.floatType),C.speed=s.a.create(t,0,fe.floatType),C.ax=s.a.create(t,0,fe.floatType),C.ay=s.a.create(t,0,fe.floatType),C.charge=s.a.create(t,0,fe.floatType),C.friction=s.a.create(t,0,fe.floatType),C.radical=s.a.create(t,0,fe.uint8Type),C.element=s.a.create(t,0,fe.uint8Type),C.pinned=s.a.create(t,0,fe.uint8Type),C.mass=s.a.create(t,0,fe.floatType),C.hydrophobicity=s.a.create(t,0,fe.int8Type),C.visited=s.a.create(t,0,fe.uint8Type),C.marked=s.a.create(t,0,fe.uint8Type),C.visible=s.a.create(t,0,fe.floatType),C.draggable=s.a.create(t,0,fe.uint8Type),C.draggableWhenStopped=s.a.create(t,1,fe.uint8Type),$e()},on=function(e){(N=t.radialBonds={}).atom1=s.a.create(e,0,fe.uint16Type),N.atom2=s.a.create(e,0,fe.uint16Type),N.length=s.a.create(e,0,fe.floatType),N.strength=s.a.create(e,0,fe.floatType),N.type=s.a.create(e,0,fe.uint8Type),Ge()},an=function(e){(V=t.restraints={}).atomIndex=s.a.create(e,0,fe.uint16Type),V.k=s.a.create(e,0,fe.floatType),V.x0=s.a.create(e,0,fe.floatType),V.y0=s.a.create(e,0,fe.floatType),qe()},sn=function(e){(q=t.angularBonds={}).atom1=s.a.create(e,0,fe.uint16Type),q.atom2=s.a.create(e,0,fe.uint16Type),q.atom3=s.a.create(e,0,fe.uint16Type),q.angle=s.a.create(e,0,fe.floatType),q.strength=s.a.create(e,0,fe.floatType),Ye()},ln=function(e){(It=t.vdwPairs={}).count=0,It.atom1=s.a.create(e,0,fe.uint16Type),It.atom2=s.a.create(e,0,fe.uint16Type)},un=function(e){(Vt=t.springForces=[])[0]=s.a.create(e,0,fe.uint16Type),Vt[1]=s.a.create(e,0,fe.floatType),Vt[2]=s.a.create(e,0,fe.floatType),Vt[3]=s.a.create(e,0,fe.floatType),tn()},cn=function(e){(mt=t.obstacles={}).x=s.a.create(e,0,fe.floatType),mt.y=s.a.create(e,0,fe.floatType),mt.width=s.a.create(e,0,fe.floatType),mt.height=s.a.create(e,0,fe.floatType),mt.mass=s.a.create(e,0,fe.floatType),mt.vx=s.a.create(e,0,fe.floatType),mt.vy=s.a.create(e,0,fe.floatType),mt.externalAx=s.a.create(e,0,fe.floatType),mt.externalAy=s.a.create(e,0,fe.floatType),mt.friction=s.a.create(e,0,fe.floatType),mt.westProbe=s.a.create(e,0,fe.uint8Type),mt.northProbe=s.a.create(e,0,fe.uint8Type),mt.eastProbe=s.a.create(e,0,fe.uint8Type),mt.southProbe=s.a.create(e,0,fe.uint8Type),mt.westProbeValue=s.a.create(e,0,fe.floatType),mt.northProbeValue=s.a.create(e,0,fe.floatType),mt.eastProbeValue=s.a.create(e,0,fe.floatType),mt.southProbeValue=s.a.create(e,0,fe.floatType),mt.xPrev=s.a.create(e,0,fe.floatType),mt.yPrev=s.a.create(e,0,fe.floatType),mt.color=[],mt.visible=s.a.create(e,0,fe.uint8Type),mt.displayExternalAcceleration=s.a.create(e,0,fe.uint8Type),mt.permeability=[],Qe()},hn=function(e){(wt=t.shapes={}).type=[],wt.x=s.a.create(e,0,fe.floatType),wt.y=s.a.create(e,0,fe.floatType),wt.width=s.a.create(e,0,fe.floatType),wt.height=s.a.create(e,0,fe.floatType),wt.color=[],wt.lineColor=[],wt.lineDashes=[],wt.lineWeight=s.a.create(e,0,fe.floatType),wt.layer=s.a.create(e,0,fe.uint8Type),wt.layerPosition=s.a.create(e,0,fe.uint8Type),wt.visible=s.a.create(e,0,fe.uint8Type),wt.fence=s.a.create(e,0,fe.uint8Type),Ke()},dn=function(e){(Et=t.lines={}).x1=s.a.create(e,0,fe.floatType),Et.y1=s.a.create(e,0,fe.floatType),Et.x2=s.a.create(e,0,fe.floatType),Et.y2=s.a.create(e,0,fe.floatType),Et.beginStyle=[],Et.endStyle=[],Et.lineColor=[],Et.lineDashes=[],Et.lineWeight=s.a.create(e,0,fe.floatType),Et.layer=s.a.create(e,0,fe.uint8Type),Et.layerPosition=s.a.create(e,0,fe.uint8Type),Et.visible=s.a.create(e,0,fe.uint8Type),Et.fence=s.a.create(e,0,fe.uint8Type),Je()},pn=function(e){(Ot=t.electricFields={}).intensity=s.a.create(e,0,fe.floatType),Ot.orientation=[],Ot.shapeIdx=[],Ze()},fn=function(){var t,e=0;for(t=0;t<Ce;t++)e+=_[t]*(h[t]*h[t]+d[t]*d[t]);for(t=0;t<Pe;t++)it[t]!==1/0&&(e+=it[t]*(J[t]*J[t]+Z[t]*Z[t]));return Mi(e/2,Ce)},mn=function(t){var e,n,i=0;for(e=0;e<t.length;e++)n=t[e],i+=_[n]*(h[n]*h[n]+d[n]*d[n]);return Mi(i/2,t.length)},gn=function(t,e,n){h[t]+=e,d[t]+=n,a[t]=h[t]*_[t],l[t]=d[t]*_[t]},vn=function(t,e){h[t]-=e*(c[t]-Gt),d[t]+=e*(u[t]-$t),a[t]=h[t]*_[t],l[t]=d[t]*_[t]},yn=function(){!function(){var e,n=0,i=0,r=0,o=0,s=t.getTotalMass();for(e=0;e<Ce;e++)n+=u[e],i+=c[e],r+=a[e],o+=l[e];$t=n/Ce,Gt=i/Ce,qt=r,Yt=o,Xt=r/s,Qt=o/s}(),function(){var t,e,n=0,i=0;for(e=0;e<Ce;e++)n+=(t=_[e])*Ai(u[e]-$t,c[e]-Gt,h[e]-Xt,d[e]-Qt),i+=t*Ei(u[e]-$t,c[e]-Gt);Kt=n/i}()},bn=function(t){var e=ve[0],n=ve[1],i=e-Q[t],r=n-K[t];if(Y[t]<0){for(;Y[t]<0-e;)Y[t]+=e;Y[t]=0-Y[t]+0,J[t]*=-1}else if(Y[t]>i){for(;Y[t]>i+e;)Y[t]-=e;Y[t]=i-(Y[t]-i),J[t]*=-1}if(X[t]<0){for(;X[t]<0-n;)X[t]+=n;X[t]=0-X[t]+0,Z[t]*=-1}else if(X[t]>r){for(;X[t]>r+e;)X[t]-=e;X[t]=r-(X[t]-r),Z[t]*=-1}},_n=function(t){var e=o[t],n=e,i=e,r=ve[0],s=ve[1],p=r-e,f=s-e;if(u[t]<n){for(;u[t]<n-r;)u[t]+=r;u[t]=n+(n-u[t]),h[t]*=-1,a[t]*=-1}else if(u[t]>p){for(;u[t]>p+r;)u[t]-=r;u[t]=p-(u[t]-p),h[t]*=-1,a[t]*=-1}if(c[t]<i){for(;c[t]<i-s;)c[t]+=s;c[t]=i+(i-c[t]),d[t]*=-1,l[t]*=-1}else if(c[t]>f){for(;c[t]>f+s;)c[t]-=s;c[t]=f-(c[t]-f),d[t]*=-1,l[t]*=-1}},xn=function(t,e,n,i){var r,s,p,f,m,g,y,b,x,w,C,T,S,k,A,E,M,P,D,O,I;if(!(Pe<1))for(r=o[t],s=u[t],p=c[t],D=v[t],f=0;f<Pe;f++)-1===lt[f].indexOf(D)&&(m=Y[f]-r,g=Y[f]+Q[f]+r,y=X[f]+K[f]+r,b=X[f]-r,x=ut[f]-r,w=ut[f]+Q[f]+r,C=ct[f]+K[f]+r,T=ct[f]-r,I=0,s>m&&s<g&&p>b&&p<y&&(e<=x?(u[t]=m-(s-m),I=1):e>=w?(u[t]=g+(g-s),I=2):n<=T?(c[t]=b-(p-b),I=-1):n>=C&&(c[t]=y+(y-p),I=-2)),P=it[f],0!==I&&(P!==1/0?(O=P+(M=_[t]),I>0?(S=h[t],A=J[f],h[t]=(S*(M-P)+2*P*A)/O,J[f]=(A*(P-M)+2*a[t])/O):(k=d[t],E=Z[f],d[t]=(k*(M-P)+2*P*E)/O,Z[f]=(E*(P-M)+2*l[t])/O)):I>0?h[t]*=-1:d[t]*=-1,i&&(rt[f]&&1===I?ht[f]+=_[t]*((S||-h[t])-h[t]):at[f]&&2===I?pt[f]+=_[t]*(h[t]-(S||-h[t])):st[f]&&-1===I?ft[f]+=_[t]*((k||-d[t])-d[t]):ot[f]&&-2===I&&(dt[f]+=_[t]*(d[t]-(k||-d[t]))))))},wn=function(t,e,n){var i,r,a,s,l,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E,M,P,D,O,I,L,R,N,F,B,z,j,V,H,W;if(!(De<1))for(i=o[t],r=u[t],a=c[t],s=0;s<De;s++)xt[s]&&("rectangle"===gt[s]?(g=vt[s]-i,v=vt[s]+bt[s]+i,y=yt[s]+_t[s]+i,b=yt[s]-i,l=vt[s]+i,p=vt[s]+bt[s]-i,f=yt[s]+_t[s]-i,m=yt[s]+i,r>g&&r<v&&a>b&&a<y&&(e<=g?(u[t]=g-(r-g),h[t]*=-1):e>=v?(u[t]=v+(v-r),h[t]*=-1):n<=b?(c[t]=b-(a-b),d[t]*=-1):n>=y&&(c[t]=y+(y-a),d[t]*=-1)),e>l&&e<p&&n>m&&n<f&&(r<=l?(u[t]=l+(l-r),h[t]*=-1):r>=p&&(u[t]=p-(r-p),h[t]*=-1),a<=m?(c[t]=m+(m-a),d[t]*=-1):a>=f&&(c[t]=f-(a-f),d[t]*=-1))):"ellipse"===gt[s]&&(E=bt[s]/2,M=_t[s]/2,w=(r-(_=vt[s]+E))/(E+i),C=(a-(x=yt[s]+M))/(M+i),T=(e-_)/(E+i),S=(n-x)/(M+i),T*=T,S*=S,k=(E+i)/(E-i),A=(M+i)/(M-i),k*=k,A*=A,((w*=w)+(C*=C)<=1&&T+S>1||w*k+C*A>=1&&T*k+S*A<1)&&(bt[s]>_t[s]?(P=Math.sqrt(E*E-M*M),D=vt[s]+E+P,L=vt[s]+E-P,O=R=yt[s]+M):(P=Math.sqrt(M*M-E*E),D=L=vt[s]+E,O=yt[s]+M+P,R=yt[s]+M-P),z=(r+e)/2,j=(a+n)/2,I=Math.sqrt(Ei(D-z,O-j)),V=z-(D*(N=Math.sqrt(Ei(L-z,L-z)))+L*I)/(I+N),H=j-(O*N+R*I)/(I+N),V/=W=Math.sqrt(Ei(V,H)),H/=W,u[t]=z-e-2*((z-e)*V+(j-n)*H)*V+z,c[t]=j-n-2*((z-e)*V+(j-n)*H)*H+j,F=h[t],B=d[t],h[t]=F-2*(F*V+B*H)*V,d[t]=B-2*(F*V+B*H)*H)))},Cn=function(t,e,n){var i,r,a,s,l,p,f,m,g,v,y,b,_,x,w;if(!(Oe<1))for(i=o[t],x=u[t],w=c[t],_=0;_<Oe;_++)At[_]&&(l=Ai(e-Ct[_],n-Tt[_],x-Ct[_],w-Tt[_]))*Ai(e-St[_],n-kt[_],x-St[_],w-kt[_])<0&&(r=Math.sqrt(Ei(Ct[_]-St[_],Tt[_]-kt[_])),a=Ai(St[_]-e,kt[_]-n,Ct[_]-e,Tt[_]-n),s=Ai(St[_]-x,kt[_]-w,Ct[_]-x,Tt[_]-w),(a<0&&s>-i*r||a>0&&s<i*r)&&a*l>0&&(p=(x+e)/2,f=(w+n)/2,m=kt[_]-Tt[_],g=-(St[_]-Ct[_]),m/=v=Math.sqrt(Ei(m,g)),g/=v,u[t]=p-e-2*((p-e)*m+(f-n)*g)*m+p,c[t]=f-n-2*((p-e)*m+(f-n)*g)*g+f,y=h[t],b=d[t],h[t]=y-2*(y*m+b*g)*m,d[t]=b-2*(y*m+b*g)*g))},Tn=function(t,e){var n,i,r,o=v[t],a=v[e],s=u[e]-u[t],l=c[e]-c[t],h=Ei(s,l);Ut&&h<Ne[o][a]&&Wt.markNeighbors(t,e),jn&&jn[t]&&jn[t][e]||h<Re[o][a]&&(i=(n=Fe[o][a].forceOverDistanceFromSquaredDistance(h))*s,r=n*l,f[t]+=i,m[t]+=r,f[e]-=i,m[e]-=r)},Sn=function(){var t,e,n,i,r,o,a,s,l,u,c,h,d,p,f=Ht.getRowsNum(),m=Ht.getColsNum();for(t=0;t<f;t++)for(n=t*m,e=0;e<m;e++)for(i=n+e,r=Ht.getCell(i),p=Ht.getNeighboringCells(t,e),a=0,u=r.length;a<u;a++){for(l=r[a],s=0;s<a;s++)Tn(l,r[s]);for(h=0,d=p.length;h<d;h++)for(s=0,c=(o=p[h]).length;s<c;s++)Tn(l,o[s])}},kn=function(){var t,e,n,i,r=Wt.getList();for(t=0;t<Ce;t++)for(n=Wt.getStartIdxFor(t),i=Wt.getEndIdxFor(t);n<i;n++)e=r[n],Tn(t,e)},An=function(t){var e,n,i,r,o=0,a=0,s=0;for(i=0,r=t.length;i<r;i++)e=t[i],n=_[e],o+=u[e]*n,a+=c[e]*n,s+=n;return{x:o/=s,y:a/=s}},En=function(t,e,n){var i=vt[t],r=yt[t];return i<=e&&e<=i+bt[t]&&r<=n&&n<=r+_t[t]},Mn=function(t){var e=Pt[t];return("N"===e||"E"===e?1:-1)*Mt[t]},Pn=function(){var e,i;if(0!==Ce){for(e=0;e<Ce;e++)f[e]=m[e]=0;if(Ut=Wt.shouldUpdate(u,c))for(Ht.clear(),Wt.clear(),e=0;e<Ce;e++)Ht.addToCell(e,u[e],c[e]),Wt.saveAtomPosition(e,u[e],c[e]);for($n.a.time("short-range forces"),de&&(Ut?($n.a.time("cell lists"),Sn(),$n.a.timeEnd("cell lists")):($n.a.time("neighbor list"),kn(),$n.a.timeEnd("neighbor list"))),$n.a.timeEnd("short-range forces"),$n.a.time("long-range forces"),function(){var t,e,n,i,r,o,a,s,l,h,d,p,v;if(ee&&0!==zn.length)for(t=0,n=zn.length;t<n;t++)for(d=zn[t],h=g[d],v=jn&&jn[d],e=0;e<t;e++)p=zn[e],v&&v[p]||(o=(i=u[p]-u[d])*i+(r=c[p]-c[d])*r,s=(a=Ti.forceOverDistanceFromSquaredDistance(o,h,g[p],ne,ie))*i,l=a*r,f[d]+=s,m[d]+=l,f[p]-=s,m[p]-=l)}(),$n.a.timeEnd("long-range forces"),function(){var t,e,n,i,r,o,a,s,l,h,d,p;if(!(ke<1))for(t=0;t<ke;t++)e=D[t],n=O[t],o=(i=u[n]-u[e])*i+(r=c[n]-c[e])*r,a=Math.sqrt(o),s=L[t],l=I[t],d=(h=ce.a.convert(s*(a-l),{from:Ci.EV_PER_NM,to:Ci.MW_FORCE_UNIT})/a)*i,p=h*r,f[e]+=d,m[e]+=p,f[n]-=d,m[n]-=p}(),function(){var t,e,n,i,r,o,a,s,l,h,d,p,g,v,y,b,_,x,w,C,T,S,k;if(!(Me<1))for(t=0;t<Me;t++)e=H[t],n=W[t],i=U[t],v=$[t],g=G[t],r=u[e]-u[i],a=u[n]-u[i],l=r*r+(o=c[e]-c[i])*o,h=a*a+(s=c[n]-c[i])*s,(b=(r*a+o*s)/((d=Math.sqrt(l))*(p=Math.sqrt(h))))>1?b=1:b<-1&&(b=-1),_=Math.sqrt(1-b*b),y=Math.acos(b),_<1e-4&&(_=1e-4),x=(S=ce.a.convert(g*(y-v)/(_*d),{from:Ci.EV_PER_NM,to:Ci.MW_FORCE_UNIT})/p)*(a-(k=r*a+o*s)*r/l),w=S*(s-k*o/l),C=S*(r-k*a/h),T=S*(o-k*s/h),f[e]+=x,m[e]+=w,f[n]+=C,m[n]+=T,f[i]-=x+C,m[i]-=w+T}(),function(){var t,e,n,i,r,o,a,s,l,h;if(!(Ee<1))for(t=0;t<Ee;t++)h=F[t],e=z[t]-u[h],n=j[t]-c[h],0===e&&0===n||(r=e*e+n*n,i=Math.sqrt(r),o=B[t],s=(a=ce.a.convert(o*i,{from:Ci.EV_PER_NM,to:Ci.MW_FORCE_UNIT})/i)*e,l=a*n,f[h]+=s,m[h]+=l)}(),function(){var t,e,n,i,r,o,a,s,l,h;if(!(Le<1))for(t=0;t<Le;t++)h=Ft[t],e=Bt[t]-u[h],n=zt[t]-c[h],0===e&&0===n||(r=e*e+n*n,i=Math.sqrt(r),o=jt[t],s=(a=ce.a.convert(o*i,{from:Ci.EV_PER_NM,to:Ci.MW_FORCE_UNIT})/i)*e,l=a*n,f[h]+=s,m[h]+=l)}(),function(){var t,e;if(n)for(t=0;t<Ce;t++)e=n*y[t],f[t]+=-h[t]*e,m[t]+=-d[t]*e}(),function(){if(!(0===re||0===ae||Ce<2)){var e,n,i,r,o,a,s,l,h,d,p,g,v;for(p=0;p<Ce;p++)w[p]=0;for(r=6e-5*re*ae,p=0;p<Ce;p++)if(1!==w[p])for((e=t.getMoleculeAtoms(p)).push(p),i=An(e),g=0,v=e.length;g<v;g++)n=e[g],w[n]=1,0!==x[n]&&(o=u[n]-i.x,a=c[n]-i.y,(s=Math.sqrt(o*o+a*a))>0&&((d=x[n]*r)>0&&s<le&&(d*=(1-se)*s/le+se),l=d*o/s,h=d*a/s,f[n]-=l,m[n]-=h))}}(),e=0;e<Ce;e++)i=1/_[e],f[e]*=i,m[e]*=i;!function(){var t;if(ge)for(t=0;t<Ce;t++)m[t]-=ge}(),function(){var t,e,n,i,r,o;if(Ot)for(e=0;e<Ie;e++)for(i="N"===(n=Pt[e])||"S"===n,o=Mn(e)/ne,r=Dt[e],t=0;t<Ce;t++)(null==r||En(r,u[t],c[t]))&&(i?m[t]+=o*g[t]/_[t]:f[t]+=o*g[t]/_[t])}(),function(){var t,e;if(oe)for(t=0;t<Ce;t++)(e=Math.min(1,2.2-c[t]))>0&&(m[t]+=1e-4*e,f[t]-=3e-6)}()}},Dn=function(){var t,e;for(t=0;t<Ce;t++)e=_[t],h[t]+=.5*f[t]*i,a[t]=e*h[t],d[t]+=.5*m[t]*i,l[t]=e*d[t]},On=function(){var t,e,n,r=100*ve[0],o=100*ve[1];for(n=0;n<Ce;n++){if(t=u[n],e=c[n],u[n]+=h[n]*i,c[n]+=d[n]*i,isNaN(u[n])||isNaN(c[n])||Math.abs(u[n])>r||Math.abs(c[n])>o)throw new Error("Model has diverged!");_n(n),xn(n,t,e,!0),wn(n,t,e),Cn(n,t,e)}},In=function(){var t;for(t=0;t<Ce;t++)b[t]&&(h[t]=d[t]=f[t]=m[t]=0)},Ln=function(){var t;for(t=0;t<Ce;t++)p[t]=Math.sqrt(h[t]*h[t]+d[t]*d[t])},Rn=function(){var t,e,o,a,s,l,u,c;for(c=0;c<Pe;c++)it[c]!==1/0&&(o=J[c],a=Z[c],l=tt[c],u=et[c],(o||a||l||u||ge)&&(t=l-(s=n*nt[c])*o,e=u-s*a-ge,ut[c]=Y[c],ct[c]=X[c],Y[c]+=o*i+.5*t*r,X[c]+=a*i+.5*e*r,J[c]+=t*i,Z[c]+=e*i,bn(c)))},Nn=function(){var e,n,i,r,o,s,u,c;for(s=0;s<Ce;s++)w[s]=0;for(s=0;s<Ce;s++)if(1!==w[s]&&0!==(e=t.getMoleculeAtoms(s)).length){for(e.push(s),i=r=o=0,u=0,c=e.length;u<c;u++)n=e[u],w[n]=1,b[n]||(i+=h[n]*_[n],r+=d[n]*_[n],o+=_[n]);for(o=1/o,u=0,c=e.length;u<c;u++)n=e[u],b[n]||(h[n]-=i*o,d[n]-=r*o,a[n]=h[n]*_[n],l[n]=d[n]*_[n])}},Fn=function(t,n){var i,r;if(null==t&&(t=e),0===(Jt=fn())){for(r=0;r<Ce;r++)!1===b[r]&&(h[r]=.02*Math.random()-.01,d[r]=.02*Math.random()-.01);if(0===(Jt=fn()))return}if(n||pe&&Jt>0){for(i=Math.sqrt(t/Jt),r=0;r<Ce;r++)h[r]*=i,d[r]*=i,a[r]*=i,l[r]*=i;for(r=0;r<Pe;r++)J[r]*=i,Z[r]*=i;Jt=t}},Bn=function(e,n,i){var r;for(r=0;r<Me;)H[r]===e&&U[r]===n||H[r]===n&&U[r]===e||W[r]===e&&U[r]===n||W[r]===n&&U[r]===e?t.removeAngularBond(r,i):r++},zn=[];zn.reset=function(){var t,e=0;for(t=0;t<Ce;t++)C.charge[t]&&(this[e++]=t);this.length=e};var jn=[];jn.reset=function(){var t,e,n;for(this.length=0,t=0;t<ke;t++)e=D[t],n=O[t],this[e]=this[e]||[],this[e][n]=!0,this[n]=this[n]||[],this[n][e]=!0};var Vn=[];return Vn.reset=function(){var t,e,n;for(this.length=0,t=0;t<ke;t++)e=D[t],n=O[t],this[e]=this[e]||[],this[e].push(n),this[n]=this[n]||[],this[n].push(e)},Vn.unset=function(t,e){if(this[t]){var n=this[e].indexOf(t),i=this[t].indexOf(e);-1!==n&&(this[t].splice(i,1),this[e].splice(n,1))}},Vn.set=function(t,e){null==this[t]&&(this[t]=[]),null==this[e]&&(this[e]=[]),this[t].push(e),this[e].push(t)},t={addPlugin:function(t){t.initialize&&t.initialize({atoms:C,elements:M,radialBonds:N,angularBonds:q}),te.registerPlugin(t)},useCoulombInteraction:function(t){ee=!!t},useLennardJonesInteraction:function(t){de=!!t},useThermostat:function(t){pe=!!t},setVDWLinesRatio:function(t){"number"==typeof t&&0!==t&&(me=t)},setGravitationalField:function(t){ge="number"==typeof t&&0!==t&&t},setTemperatureOfAtoms:function(e,n){var i,r,o,a,s,l,u,c,p=e.length;for(s=function(t,e){var n=t*ki;return ce.a.convert(n,{from:Ci.JOULE,to:Ci.MW_ENERGY_UNIT})*e}(1e-4*(mn(e)||n),1),i=0;i<p;i++)r=e[i],b[r]||0!==h[r]||0!==d[r]||(o=Math.random()-.5,a=Math.random()-.5,u=Math.sqrt(2*s/_[r]/(o*o+a*a)),h[r]=o*u,d[r]=a*u);for(Jt=fn(),c=mn(e),l=Math.sqrt(n/c),i=0;i<p;i++)r=e[i],t.setAtomProperties(r,{vx:h[r]*l,vy:d[r]*l})},getTemperatureOfAtoms:function(t){return mn(t)},setTargetTemperature:function(t){Pi(t),e=t},setDielectricConstant:function(t){ne=t},setRealisticDielectricEffect:function(t){ie=t},setSolventForceType:function(t){re=t},setDNAState:function(t){oe=0===t.indexOf("translation:")},setSolventForceFactor:function(t){ae=t},setAdditionalSolventForceMult:function(t){se=t},setAdditionalSolventForceThreshold:function(t){le=t},setTime:function(t){we=t},setDimensions:function(t){if(Zt)throw new Error("The molecular model's size has already been set, and cannot be reset.");ye=t[0],be=t[1],_e=t[2],xe=t[3],ve=[_e-ye,xe-be],Zt=!0},getDimensions:function(){return[ye,be,_e,xe]},getLJCalculator:function(){return Fe},setAtomProperties:function(e,n){var i,r,o,s=Kn.cysteineElement;if(void 0!==n.element){if(n.element<0||n.element>=Te)throw new Error("md2d: Unknown element "+n.element+", an atom can't be created.");if(v[e]===s&&n.element!==s)for(o=0;o<ke;o++)if((D[o]===e||O[o]===e)&&109===R[o]){t.removeRadialBond(o);break}Se[n.element]=!0,n.mass=T[n.element],n.radius=A[n.element],Kn.isAminoAcid(n.element)&&(r=Kn.getAminoAcidByElement(n.element),n.charge=r.charge,n.hydrophobicity=r.hydrophobicity)}for(i in!g[e]&&n.charge?zn.push(e):g[e]&&0===n.charge&&zn.splice(zn.indexOf(e),1),n)n.hasOwnProperty(i)&&(C[i][e]=n[i]);a[e]=h[e]*_[e],l[e]=d[e]*_[e],p[e]=Math.sqrt(h[e]*h[e]+d[e]*d[e])},setRadialBondProperties:function(t,e,n){var i,r,o;for(i in r=D[t],o=O[t],jn[r]&&jn[r][o]&&(jn[r][o]=!1),jn[o]&&jn[o][r]&&(jn[o][r]=!1),Vn.unset(r,o),(void 0!==e.atom1&&e.atom1!==r||void 0!==e.atom2&&e.atom2!==o)&&Bn(r,o,n),e)e.hasOwnProperty(i)&&(N[i][t]=e[i]);r=D[t],o=O[t],jn[r]||(jn[r]=[]),jn[r][o]=!0,jn[o]||(jn[o]=[]),jn[o][r]=!0,Vn.set(r,o)},setAngularBondProperties:function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(q[n][t]=e[n])},setRestraintProperties:function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(V[n][t]=e[n])},setElementProperties:function(t,e){var n,i;if(null!=e.mass&&e.mass!==T[t])for(T[t]=e.mass,n=0;n<Ce;n++)v[n]===t&&(_[n]=e.mass);if(null!=e.sigma&&(k[t]=e.sigma,i=Si.radius(e.sigma),A[t]!==i))for(A[t]=i,n=0;n<Ce;n++)v[n]===t&&(o[n]=i);for(null!=e.epsilon&&(S[t]=e.epsilon),null!=e.color&&(E[t]=e.color),n=0;n<Te;n++)je(t,n);We(),Ue()},setPairwiseLJProperties:function(t,e){je(t,e),We(),Ue()},setObstacleProperties:function(e,n){var i;if(!t.canPlaceObstacle(n.x,n.y,n.width,n.height,e))throw new Error("Obstacle can't be placed at "+n.x+", "+n.y);for(i in void 0!==n.x&&(n.xPrev=n.x),void 0!==n.y&&(n.yPrev=n.y),"string"==typeof n.mass&&(n.mass=parseFloat(n.mass)),n)n.hasOwnProperty(i)&&(mt[i][e]=n[i])},setShapeProperties:function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(wt[n][t]=e[n])},setLineProperties:function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(Et[n][t]=e[n])},setElectricFieldProperties:function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(Ot[n][t]=e[n])},addAtom:function(e){Ce+1>C.x.length&&(he(C,Math.round(1.5*Ce+10)),$e()),e.ax=e.ay=0,g[Ce]=0,t.setAtomProperties(Ce,e),Ce++,We(),Ue()},removeAtom:function(e){var n,i,r,o,a,l;if(e>=Ce)throw new Error("Atom "+e+" doesn't exist, so it can't be removed.");for(n=0;n<ke;)D[n]===e||O[n]===e?t.removeRadialBond(n):n++;for(-1!==(n=zn.indexOf(e))&&s.a.remove(zn,n),n=e;n<Ce;n++)for(r in C)C.hasOwnProperty(r)&&(C[r][n]=n===Ce-1?0:C[r][n+1]);for(Ce--,l=[zn,D,O,H,W,U],o=0;o<l.length;o++)for(n=0,i=(a=l[o]).length;n<i;n++)a[n]>e&&a[n]--;jn.reset(),Vn.reset(),We(),Ue(),Wt.invalidate(),Pn()},addElement:function(t){var e;for(Te>=S.length&&(he(M,Te+10),Xe()),T[Te]=t.mass,S[Te]=t.epsilon,k[Te]=t.sigma,A[Te]=Si.radius(t.sigma),E[Te]=t.color,Fe[Te]=[],Re[Te]=[],Ne[Te]=[],e=0;e<=Te;e++)je(Te,e);Te++},addRadialBond:function(e){ke+1>D.length&&(he(N,ke+10),Ge()),ke++,t.setRadialBondProperties(ke-1,e),Ae=!0},removeRadialBond:function(t,e){var n,i;if(t>=ke)throw new Error("Radial bond "+t+" doesn't exist, so it can't be removed.");for(Bn(D[t],O[t],e),Vn.unset(D[t],O[t]),n=t;n<ke;n++)for(i in N)N.hasOwnProperty(i)&&(N[i][n]=n===ke-1?0:N[i][n+1]);ke--,jn.reset(),Ae=!0},addRestraint:function(e){Ee+1>V.atomIndex.length&&(he(V,Ee+10),qe()),Ee++,t.setRestraintProperties(Ee-1,e)},addAngularBond:function(e){Me+1>q.atom1.length&&(he(q,Me+10),Ye()),Me++,t.setAngularBondProperties(Me-1,e)},removeAngularBond:function(e,n){var i,r,o,a,s,l;if(e>=Me)throw new Error("Angular bond "+e+" doesn't exist, so it can't be removed.");for(n&&(o=H[e],a=W[e],s=U[e],l=$[e]-ni.getAngleBetweenVec(u[o],c[o],u[a],c[a],u[s],c[s]),t.addKEToAtoms(.5*G[e]*l*l,o,a,s)),i=e;i<Me;i++)for(r in q)q.hasOwnProperty(r)&&(q[r][i]=i===Me-1?0:q[r][i+1]);Me--},addSpringForce:function(t,e,n,i){return Le+1>Vt[0].length&&(he(Vt,Le+1),tn()),Ft[Le]=t,Bt[Le]=e,zt[Le]=n,jt[Le]=i,Le++},updateSpringForce:function(t,e,n){Bt[t]=e,zt[t]=n},removeSpringForce:function(t){var e,n;if(t>=Le)throw new Error("Spring force "+t+" doesn't exist, so it can't be removed.");for(Le--,e=t;e<Le;e++)for(n=0;n<4;n++)Vt[n][e]=Vt[n][e+1]},springForceAtomIndex:function(t){return Ft[t]},addObstacle:function(e){if(!t.canPlaceObstacle(e.x,e.y,e.width,e.height))throw new Error("Obstacle can't be placed at "+e.x+", "+e.y+".");Pe+1>mt.x.length&&(he(mt,Pe+1),Qe()),Pe++,t.setObstacleProperties(Pe-1,e)},removeObstacle:function(t){var e,n;if(t>=Pe)throw new Error("Obstacle "+t+" doesn't exist, so it can't be removed.");for(Pe--,e=t;e<Pe;e++)for(n in mt)mt.hasOwnProperty(n)&&(mt[n][e]=mt[n][e+1]);he(mt,Pe),Qe()},addShape:function(e){De+1>wt.x.length&&(he(wt,De+1),Ke()),De++,t.setShapeProperties(De-1,e)},removeShape:function(e){var n,i;if(e>=De)throw new Error("Shape "+e+" doesn't exist, so it can't be removed.");for(n=0;n<Ie;)Dt[n]===e?t.removeElectricField(n):n++;for(De--,n=e;n<De;n++)for(i in wt)wt.hasOwnProperty(i)&&(wt[i][n]=wt[i][n+1]);for(n=0;n<Ie;n++)Dt[n]>e&&Dt[n]--;he(wt,De),Ke()},addLine:function(e){Oe+1>Et.x1.length&&(he(Et,Oe+1),Je()),Oe++,t.setLineProperties(Oe-1,e)},removeLine:function(t){var e,n;if(t>=Oe)throw new Error("Line "+t+" doesn't exist, so it can't be removed.");for(e=t;e<Oe;e++)for(n in Et)Et.hasOwnProperty(n)&&(Et[n][e]=Et[n][e+1]);Oe--,he(Et,Oe),Je()},addElectricField:function(e){Ie+1>Ot.intensity.length&&(he(Ot,Ie+1),Ze()),Ie++,t.setElectricFieldProperties(Ie-1,e)},removeElectricField:function(t){var e,n;if(t>=Ie)throw new Error("Electric field "+t+" doesn't exist, so it can't be removed.");for(Ie--,e=t;e<Ie;e++)for(n in Ot)Ot.hasOwnProperty(n)&&(Ot[n][e]=Ot[n][e+1]);he(Ot,Ie),Ze()},atomInBounds:function(t,e,n){var i,r=o[n];if(t<r||t>ve[0]-r||e<r||e>ve[1]-r)return!1;for(i=0;i<Pe;i++)if(t>Y[i]-r&&t<Y[i]+Q[i]+r&&e>X[i]-r&&e<X[i]+K[i]+r)return!1;return!0},canPlaceAtom:function(e,n,i,r,o){var a,s,l,h,d,p,f,m;if(!t.atomInBounds(n,i,r))return!1;for(m=0;m<Pe;m++)if(h=Y[m],d=X[m],p=h+Q[m],f=d+K[m],n>h&&n<p&&i>d&&i<f)return!1;return!!o||("number"==typeof r&&(a=u[r],s=c[r],u[r]=c[r]=1/0),l=t.newPotentialCalculator(e,0,!1)(n,i),"number"==typeof r&&(u[r]=a,c[r]=s),l<=0)},canPlaceObstacle:function(t,e,n,i,r){var a,s,l,h,d,p,f=t+n,m=e+i;if(t<0||f>ve[0]||e<0||m>ve[0])return!1;for(p=0;p<Ce;p++)if(d=o[p],u[p]>t-d&&u[p]<f+d&&c[p]>e-d&&c[p]<m+d)return!1;for(p=0;p<Pe;p++)if((void 0===r||r!==p)&&(a=Y[p],s=X[p],l=a+Q[p],h=s+K[p],f>a&&t<l&&m>s&&e<h))return!1;return!0},setupAtomsRandomly:function(e){var n,i,r,o,a,s,l,u,c=e.temperature||100,h=Math.floor(Math.sqrt(Ce)),d=Math.ceil(Ce/h);for(Pi(c),a=ve[0]/(1+d),o=ve[1]/(1+h),n=-1,i=1;i<=h;i++)for(r=1;r<=d&&++n!==Ce;r++)s=ni.normal(1,.25),l=2*Math.random()*Math.PI,u={element:Math.floor(Math.random()*e.userElements),x:r*a,y:i*o,vx:s*Math.cos(l),vy:s*Math.sin(l),charge:n%2*2-1},t.setAtomProperties(n,u);yn(),function(){for(var t=0;t<Ce;t++)gn(t,-Xt,-Qt),vn(t,-Kt)}(),Fn(c,!0)},getVdwPairsArray:function(){var t,e,n,i,r,o,a,s,l,h,d,p,f,m=me*me;for(Lt=0,t=0;t<Ce;t++)for(d=v[t],a=k[d],s=k[d],r=u[t],o=c[t],e=t+1;e<Ce;e++)0!==ke&&jn[t]&&jn[t][e]||(p=v[e],l=k[p],h=k[p],g[t]*g[e]<=0&&(f=.5*(a+l),(n=u[e]-r)*n+(i=c[e]-o)*i<(f*=f)*m&&s*h>0&&(Lt+1>It.atom1.length&&(he(It,2*(Lt+1)),en()),Rt[Lt]=t,Nt[Lt]=e,Lt++)));return It.count=Lt,It},integrate:function(e,n){var o,a,l=we;for(void 0===e&&(e=100),void 0===n&&(n=1),r=(i=n)*i,Ae=!1,function(){var t,e,n=Kn.cysteineElement;for(Be.length=0,e=0;e<Ce;e++)v[e]===n&&Be.push(e);for(e=0;e<ke;e++)v[D[e]]===n&&v[O[e]]===n&&(-1!==(t=Be.indexOf(D[e]))&&s.a.remove(Be,t),-1!==(t=Be.indexOf(O[e]))&&s.a.remove(Be,t))}(),0===we&&Pn(),o=Math.floor(e/i),function(){var t;for(t=0;t<Pe;t++)ot[t]&&(dt[t]=0),st[t]&&(ft[t]=0),at[t]&&(pt[t]=0),rt[t]&&(ht[t]=0)}(),In(),a=1;a<=o;a++)we=l+a*i,Dn(),On(),Pn(),In(),Dn(),Ln(),Rn(),0===re||oe||Nn(),te.callPluginFunction("performActionWithinIntegrationLoop",[Wt,i,we]),Fn();!function(t){var e,n;for(e=13888.89/t,n=0;n<Pe;n++)ot[n]&&(dt[n]*=e/Q[n]),st[n]&&(ft[n]*=e/Q[n]),at[n]&&(pt[n]*=e/K[n]),rt[n]&&(ht[n]*=e/K[n])}(e),function(){var e,n,i,r,o,a,l,h;for(a=0,h=Be.length;a<h;a++)for(e=Be[a],l=a+1;l<h;l++)n=Be[l],(o=(i=u[e]-u[n])*i+(r=c[e]-c[n])*r)<.07&&(t.addRadialBond({atom1:e,atom2:n,length:Math.sqrt(o),strength:1e4,type:109}),s.a.remove(Be,a),s.a.remove(Be,l),h=Be.length,e=Be[a],l=a+1)}()},updateParticlesAccelerations:Pn,minimizeEnergy:function(){var t,e,n,i,r,o;for(Pn(),In(),t=0,r=0;r<Ce;r++)t<Math.abs(f[r])&&(t=Math.abs(f[r])),t<Math.abs(m[r])&&(t=Math.abs(m[r]));for(o=0;t>1e-4&&o<3e3;){for(o++,e=.001/t,r=0;r<Ce;r++)n=u[r],i=c[r],u[r]+=f[r]*e,c[r]+=m[r]*e,_n(r),xn(r,n,i,!1),wn(r,n,i),Cn(r,n,i);for(Pn(),In(),t=0,r=0;r<Ce;r++)t<Math.abs(f[r])&&(t=Math.abs(f[r])),t<Math.abs(m[r])&&(t=Math.abs(m[r]))}},getRadialBondsForAtom:function(t){var e,n,i,r=[];for(e=0;e<ke;e++)n=D[e],i=O[e],t!==n&&t!==i||r.push(e);return r},getAngularBondsForAtom:function(t){var e,n,i,r,o=[];for(e=0;e<Me;e++)n=H[e],i=W[e],r=U[e],t!==n&&t!==i&&t!==r||o.push(e);return o},getTotalMass:function(){var t,e=0;for(t=0;t<Ce;t++)e+=_[t];return e},getRadiusOfElement:function(t){return A[t]},getNumberOfAtoms:function(){return Ce},getNumberOfElements:function(){return Te},getNumberOfObstacles:function(){return Pe},getNumberOfShapes:function(){return De},getNumberOfLines:function(){return Oe},getNumberOfRadialBonds:function(){return ke},getNumberOfAngularBonds:function(){return Me},getNumberOfRestraints:function(){return Ee},getNumberOfSpringForces:function(){return Le},getNumberOfElectricFields:function(){return Ie},computeOutputState:function(t){var e,n,i,r,o,a,s,l,p,f,m,y,b,x,w,T,S,k,A,E,M,P,R;for(R=0,P=0,e=0;e<Ce;e++){for(ge&&(M=_[e]*ge*c[e],R+=ce.a.convert(M,{from:Ci.MW_ENERGY_UNIT,to:Ci.EV})),i=0;i<Ie;i++)if(null==(T=Dt[i])||En(T,u[e],c[e])){switch(E=g[e]*Mn(i),Pt[i]){case"N":case"S":E*=(null!=T?yt[T]:be)-c[e];break;case"W":case"E":E*=(null!=T?vt[T]:ye)-u[e]}R+=ce.a.convert(E,{from:Ci.MW_ENERGY_UNIT,to:Ci.EV})}for(P+=.5*_[e]*(h[e]*h[e]+d[e]*d[e]),n=e+1;n<Ce;n++)S=(p=u[n]-u[e])*p+(f=c[n]-c[e])*f,de&&(R-=Fe[v[e]][v[n]].potentialFromSquaredDistance(S)),ee&&zn.length>0&&(R+=Ti.potential(Math.sqrt(S),g[e],g[n],ne,ie))}for(e=0;e<ke;e++)r=D[e],o=O[e],s=v[r],l=v[o],S=(p=u[o]-u[r])*p+(f=c[o]-c[r])*f,R+=.5*L[e]*(k=Math.sqrt(S)-I[e])*k,de&&(R+=Fe[s][l].potentialFromSquaredDistance(S)),ee&&g[r]&&g[o]&&(R-=Ti.potential(Math.sqrt(S),g[r],g[o],ne,ie));for(e=0;e<Me;e++)r=H[e],o=W[e],a=U[e],(w=((m=u[r]-u[a])*(b=u[o]-u[a])+(y=c[r]-c[a])*(x=c[o]-c[a]))/(Math.sqrt(m*m+y*y)*Math.sqrt(b*b+x*x)))>1?w=1:w<-1&&(w=-1),A=Math.acos(w)-$[e],R+=.5*G[e]*A*A;for(e=0;e<Ee;e++)r=F[e],s=v[r],S=(p=z[e]-u[r])*p+(f=j[e]-c[r])*f,R+=.5*B[e]*(k=Math.sqrt(S))*k;for(e=0;e<Pe;e++)it[e]!==1/0&&(ge&&(M=it[e]*ge*X[e],R+=ce.a.convert(M,{from:Ci.MW_ENERGY_UNIT,to:Ci.EV})),P+=.5*it[e]*(J[e]*J[e]+Z[e]*Z[e]));Jt=Mi(P,Ce),t.time=we,t.PE=R,t.KE=ce.a.convert(P,{from:Ci.MW_ENERGY_UNIT,to:Ci.EV}),t.temperature=Jt,t.pCM=[qt,Yt],t.CM=[$t,Gt],t.vCM=[Xt,Qt],t.omega_CM=Kt,t.atoms=C,t.radialBonds=N,te.callPluginFunction("processOutputState",[t])},newPotentialCalculator:function(t,e,n){return function(i,r){var o,a,s,l,h,d,p,f=0,m=0,y=0,b=Fe[t];for(o=0;o<Ce;o++)l=(a=i-u[o])*a+(s=r-c[o])*s,d=0,de&&(f+=-(p=b[v[o]]).potentialFromSquaredDistance(l,t,v[o]),n&&(d+=p.forceOverDistanceFromSquaredDistance(l))),ee&&zn.length>0&&e&&(h=Math.sqrt(l),f+=-Ti.potential(h,e,g[o],ne,ie),n&&(d+=Ti.forceOverDistanceFromSquaredDistance(l,e,g[o],ne,ie))),d&&(m+=d*a,y+=d*s);return n?[f,[ce.a.convert(m,{from:Ci.MW_FORCE_UNIT,to:Ci.EV_PER_NM}),ce.a.convert(y,{from:Ci.MW_FORCE_UNIT,to:Ci.EV_PER_NM})]]:f}},addKEToAtoms:function(e){var n,i,r,o,s,u=Array.prototype.slice.call(arguments,1),c=0;if(0===u.length)for(r=0;r<Ce;r++)u.push(r);for(r=0,o=u.length;r<o;r++)c+=t.getAtomKineticEnergy(u[r]);if((n=c+e)<=0)return!1;for(0===c&&(s=u[0],h[s]=2*Math.random()-1e-5,d[s]=2*Math.random()-1e-5,c=t.getAtomKineticEnergy(s)),i=Math.sqrt(n/c),r=0,o=u.length;r<o;r++)s=u[r],h[s]*=i,d[s]*=i,a[s]*=i,l[s]*=i;return!0},addKEToAtomPairAndConserveMomentum:function(t,e,n){var i=u[n]-u[e],r=c[n]-c[e],o=-Math.atan2(r,i),s=Math.cos(o),p=Math.sin(o),f=s*h[e]-p*d[e],m=s*h[n]-p*d[n],g=p*h[e]+s*d[e],v=p*h[n]+s*d[n],y=_[e],b=_[n],x=.5*y*(f*f+g*g)+.5*b*(m*m+v*v),w=x+ce.a.convert(t,{from:Ci.EV,to:Ci.MW_ENERGY_UNIT});if(w<0)return!1;var C=y+y*y/b,T=2*y*(f-m),S=T*T-4*C*(2*(x-w));if(S<0)return!1;var k=(-T+(S=Math.sqrt(S)))/(2*C),A=(-T-S)/(2*C),E=Math.abs(k)<Math.abs(A)?k:A;return f+=E,m+=-y/b*E,p*=-1,h[e]=f*s-g*p,a[e]=y*h[e],d[e]=f*p+g*s,l[e]=y*d[e],h[n]=m*s-v*p,a[n]=b*h[n],d[n]=m*p+v*s,l[n]=b*d[n],!0},findMinimumPELocation:function(e,n,i,r){var o=t.newPotentialCalculator(e,r,!0),a=A[e],s=ni.minimize(o,[n,i],{bounds:[[a,ve[0]-a],[a,ve[1]-a]]});return!s.error&&s[1]},findMinimumPESquaredLocation:function(e,n,i,r){var o=t.newPotentialCalculator(e,r,!0),a=A[e],s=ni.minimize((function(t,e){var n,i,r;return i=(n=o(t,e))[0],(r=n[1])[0]*=2*i,r[1]*=2*i,[i*i,r]}),[n,i],{bounds:[[a,ve[0]-a],[a,ve[1]-a]],stopval:1e-4,precision:1e-6});return!s.error&&s[1]},getMoleculeAtoms:function(e){var n,i,r,o,a=[],s=[],l={};for(s.push(e),l[e]=!0;s.length>0;)for(r=0,o=(n=t.getBondedAtoms(s.pop())).length;r<o;r++)l[i=n[r]]||(l[i]=!0,s.push(i),a.push(i));return a},getBondedAtoms:function(t){return Vn[t]||[]},getCoulombForceAt:function(t,e,n){if(n=n||{},!ee||0===zn.length)return n.fx=n.fy=0,n;var i,r,o,a,s,l,h,d,p,f,m=0,v=0;for(i=0,r=zn.length;i<r;i++)d=zn[i],h=g[d],s=(o=u[d]-t)*o+(a=c[d]-e)*a,m+=(l=Ti.forceOverDistanceFromSquaredDistance(s,1,h,ne,ie))*o,v+=l*a;for(i=0;i<Ie;i++)(null==(p=Dt[i])||En(p,t,e))&&("N"===(f=Pt[i])||"S"===f?v+=Mn(i):m+=Mn(i));return n.fx=ce.a.convert(m,{from:Ci.MW_FORCE_UNIT,to:Ci.EV_PER_NM}),n.fy=ce.a.convert(v,{from:Ci.MW_FORCE_UNIT,to:Ci.EV_PER_NM}),n},getAtomKineticEnergy:function(t){var e=.5*_[t]*(h[t]*h[t]+d[t]*d[t]);return ce.a.convert(e,{from:Ci.MW_ENERGY_UNIT,to:Ci.EV})},getAtomNeighbors:function(t){var e,n,i=[],r=Wt.getList();for(e=Wt.getStartIdxFor(t),n=Wt.getEndIdxFor(t);e<n;e++)i.push(r[e]);return i},getNeighborList:function(){return Wt},setViscosity:function(t){n=t},get ljCalculator(){return Fe},get radialBondsChanged(){return Ae},atomsBonded:function(t,e){return!!(jn&&jn[t]&&jn[t][e])},getState:function(){var t=[new ue(M),new ue(C),new ue(mt),new ue(wt),new ue(Et),new ue(N),new ue(q),new ue(V),new ue(Vt),P,{clone:function(){return{time:we,N:Ce,N_elements:Te,N_obstacles:Pe,N_shapes:De,N_lines:Oe,N_radialBonds:ke,N_angularBonds:Me,N_restraints:Ee,N_springForces:Le}},restore:function(t){we=t.time,Ce=t.N,Te=t.N_elements,De=t.N_shapes,Oe=t.N_lines,ke=t.N_radialBonds,Me=t.N_angularBonds,Ee=t.N_restraints,Le=t.N_springForces,Wt.invalidate(),jn.reset(),Vn.reset(),zn.reset()}}];return te.callPluginFunction("getState",[],(function(e){t=t.concat(e)})),t},callPluginAccessor:function(t,e){var n;return e=e||[],te.callPluginFunction(t,e,(function(t){n=t})),n}},nn(0),rn(0),sn(0),on(0),an(0),ln(0),un(0),cn(0),hn(0),dn(0),pn(0),P=new bi(t),t.pairwiseLJProperties=P,t},Oi=n(12),Ii=n.n(Oi),Li={md2d:{name:"md2d",translated:!1,units:{length:{name:"nanometer",pluralName:"nanometers",symbol:"nm"},mass:{name:"atomic mass unit",pluralName:"atomic mass units",symbol:"amu"},time:{name:"femtosecond",pluralName:"femtoseconds",symbol:"fs",displayValue:{unitsPerBaseUnit:.001,pluralName:"picoseconds",name:"picosecond",symbol:"ps"}},inverseTime:{name:"1/femtosecond",pluralName:"1/femtoseconds",symbol:"1/fs"},velocity:{name:"nanometer per femtosecond",pluralName:"nanometers per second",symbol:"nm/s"},acceleration:{name:"nanometer per femtosecond squared",pluralName:"nanometers per femtosecond squared",symbol:"nm/fs²"},momentum:{name:"amu nanometer per femtosecond",pluralName:"amu nanometers per femtosecond",symbol:"amu⋅nm/fs"},force:{name:"amu nanometer per femtosecond squared",pluralName:"amu nanometers per femtosecond squared",symbol:"amu⋅nm/fs²"},energy:{name:"electron volt",pluralName:"electron volts",symbol:"eV"},dampingCoefficient:{name:"amu per femtosecond",pluralName:"amu per femtoseconds",symbol:"amu/fs"},stiffness:{name:"electron volt per nanometer squared",pluralName:"electron volts per nanometer squared",symbol:"eV/nm²"},rotationalStiffness:{name:"electron volt per radian",pluralName:"electron volts per radian",symbol:"eV/rad"},charge:{name:"elementary charge",pluralName:"elementary charges",symbol:"e"},temperature:{name:"Kelvin",pluralName:"Kelvin",symbol:"K"},pressure:{name:"bar",pluralName:"bar",symbol:"bar"},angle:{name:"radian",pluralName:"radians",symbol:"rad"}}},mks:{name:"mks",translated:!0,units:{length:{name:"meter",pluralName:"meters",symbol:"m",representationInMD2DUnits:1,valueInSIUnits:1},mass:{name:"kilogram",pluralName:"kilograms",symbol:"kg",representationInMD2DUnits:1,valueInSIUnits:1},time:{name:"second",pluralName:"seconds",symbol:"s",representationInMD2DUnits:1e4,valueInSIUnits:1},inverseTime:{name:"1/second",pluralName:"1/seconds",symbol:"1/s",valueInSIUnits:1},velocity:{name:"meter per second",pluralName:"meters per second",symbol:"m/s",valueInSIUnits:1},acceleration:{name:"meter per second squared",pluralName:"meters per second squared",symbol:"m/s²",valueInSIUnits:1},force:{name:"Newton",pluralName:"Newtons",symbol:"N",valueInSIUnits:1},energy:{name:"Joule",pluralName:"Joules",symbol:"J",valueInSIUnits:1},dampingCoefficient:{name:"Newton second per meter",pluralName:"Newton seconds per meter",symbol:"N⋅s/m",valueInSIUnits:1},stiffness:{name:"Newton per meter",pluralName:"Newtons per meter",symbol:"N/m",valueInSIUnits:1},rotationalStiffness:{name:"Newton-meter per radian",pluralName:"Newton-meters per radian",symbol:"N⋅m/rad",valueInSIUnits:1},charge:{name:"Coulomb",pluralName:"Coulombs",symbol:"C",valueInSIUnits:1}}}},Ri=function(t){var e;return"md2d"===t?Li.md2d:((e=h.a.extend({},Li[t])).units=h.a.extend({},Li.md2d.units,Li[t].units),e)},Ni=ce.a.COULOMB_CONSTANT.as(ce.a.unit.METERS_PER_FARAD),Fi=["length","mass","time"];function Bi(t){var e,n={},i={};return h.a.each(Fi,(function(e){var i=t.units[e];n[e]=i.valueInSIUnits/i.representationInMD2DUnits})),n.inverseTime=1/n.time,n.velocity=n.length/n.time,n.acceleration=n.velocity/n.time,n.force=n.mass*n.acceleration,n.energy=ce.a.ratio(ce.a.unit.MW_ENERGY_UNIT,{per:ce.a.unit.EV}),n.energy*=n.force*n.length,n.dampingCoefficient=n.force/n.velocity,n.stiffness=n.energy/n.length/n.length,n.rotationalStiffness=n.energy/n.length,e=di.force(1,-1,1,1),n.charge=Math.sqrt(e*n.force*n.length*n.length/Ni),h.a.each(h.a.keys(n),(function(e){i[e]=n[e]/t.units[e].valueInSIUnits})),{translateToModelUnits:function(t,e){return null==i[e]?t:t/i[e]},translateFromModelUnits:function(t,e){return null==i[e]?t:t*i[e]}}}var zi,ji,Vi=n(42),Hi=["undefined","intro-cells","intro-zoom1","intro-zoom2","intro-zoom3","intro-polymerase","dna","transcription","transcription-end","after-transcription","before-translation","translation","translation-end"],Wi={},Ui=0,$i="TGACCTCTCCGCGCCATCTATAAACCGAAGCGCTAGCTACA",Gi="ACCACAGGCCGCCAGTTCCGCTGGCGGCATTTT",qi=Xi($i),Yi=Xi(Gi);function Xi(t){return t.replace(/A/g,"t").replace(/G/g,"c").replace(/T/g,"a").replace(/C/g,"g").toUpperCase()}function Qi(){return Ui++}function Ki(t){var e,n,i,r="change",o=[],a="",s="",l=d3.dispatch("change","transition"),u=function(t){if(t>=a.length)return null;switch(a[t]){case"A":return"U";case"G":return"C";case"T":return"A";case"C":return"G"}},c=function(t,e){var n,i,r;for(t.length=e.length,n=0,i=e.length;n<i;n++)(r=t[n]||{}).idx=n,r.type!==e[n]&&(r.type=e[n],r.id=Qi(),t[n]=r);return t},h=function(t,e,n){var i,r,o,a=n?ji+qi+e+Yi+ji:zi+$i+e+Gi+zi,s=zi.length,l=s+$i.length,u=l+e.length,c=u+Gi.length;for(t.length=a.length,i=0,r=a.length;i<r;i++)(o=t[i]||{}).idx=i,o.region=i<s?"j":i<l?"p":i<u?"c":i<c?"t":"j",o.type!==a[i]&&(o.type=a[i],o.id=Qi(),t[i]=o);return t},p=function(){var o=t.get("DNA");h(e.viewModel.DNA,o,!1),a=Xi(o),h(e.viewModel.DNAComp,a,!0),s=function(){for(var t=u(0),e="";t;)t=u((e+=t).length);return e}(),function(){var t,e,r;for(n={},i=null,e=0,r=s.length;e<r;e+=3)t=s.substr(e,3),"STOP"===Kn.codonToAbbr(t)&&(null===i&&(i=e/3),3===t.length&&(n[e]=n[e+1]=n[e+2]=!0));null===i&&(i=Math.floor(s.length/3))}(),e.stateBefore("transcription:0")?c(e.viewModel.mRNA,""):"transcription"===e.state().name?c(e.viewModel.mRNA,s.substr(0,e.state().step)):e.stateAfter("transcription")&&c(e.viewModel.mRNA,s),"transition"!==r&&(e.stateBefore("translation:1")?f():e.stateEqual("translation-end")&&m())},f=function(){var e;if((e=t.getNumberOfAtoms())>0){for(t.startBatch();e>0;)t.removeAtom(e-1),e--;t.endBatch()}t.stop()},m=function(){for(var n=[],i=0,r=Kn.codonToAbbr(e.codon(0));"STOP"!==r;)n.push(r),r=Kn.codonToAbbr(e.codon(++i));e.generateProtein(n,void 0,2.3,.3),e.centerProtein(),t.start()},g=function(n){var i,r=n.name;return"transcription"===r?n.step<t.get("DNA").length-1?"transcription:"+(n.step+1):"transcription-end":"translation"===r?"STOP"!==Kn.codonToAbbr(e.codon(n.step))?"translation:"+(n.step+1):"translation-end":("transcription"!==(i=Hi[Wi[n.name]+1])&&"translation"!==i||(i+=":0"),i)},v=function(e){var n=e.name,i=e.step;return"transcription"===n&&i>0?"transcription:"+(i-1):"transcription-end"===n?"transcription:"+(t.get("DNA").length-1):"translation-end"===n||"translation"===n&&i>0?"translation:0":Hi[Wi[n]-1]},y=function(t,n){return t===n?0:(t=e.parseState(t),n=e.parseState(n),t.name===n.name?isNaN(t.step)||isNaN(n.step)?0:t.step<n.step?-1:1:Wi[t.name]<Wi[n.name]?-1:1)},b=function(t){void 0!==t&&(o.length>0?o.push(t):(o.push(t),_(t)))},_=function(t){C("DNAState",t,"transition")},x=function(t){C("DNA",t,"transition")},w=function(e){o.length=0,t.cancelTransitions(),l.change(e)},C=function(e,n,i){r=i||"change",t.properties[e]=n,r="change"};return e={PRECODING_LEN:zi.length+$i.length,viewModel:{mRNA:[],DNA:[],DNAComp:[]},on:function(t,e){l.on(t,e)},mutate:function(n,i,r){var o=t.get("DNA"),a=n-e.PRECODING_LEN;if(a<0||a>=o.length)throw new Error("Mutation can be performed only on DNA coding region.");o=o.substr(0,a)+(r?Xi(i):i)+o.substr(a+1),C("DNA",o)},insert:function(n,i,r){var o={type:r?Xi(i):i,id:Qi(),region:"c"},a={type:r?i:Xi(i),id:Qi(),region:"c"},s={type:r?Xi(i):i,id:Qi(),region:"c"},l=t.get("DNA"),u=e.state(),c=n-e.PRECODING_LEN;if(c<0||c>=l.length)throw new Error("Mutation can be performed only on DNA coding region.");e.viewModel.DNA.splice(n,0,o),e.viewModel.DNAComp.splice(n,0,a),e.viewModel.mRNA.splice(c,0,s),l=l.substr(0,c)+o.type+l.substr(c),"transcription"===u.name&&c<u.step&&C("DNAState",u.name+":"+(u.step+1),"suppress"),x(l)},delete:function(n){var i=t.get("DNA"),r=e.state(),o=n-e.PRECODING_LEN;if(o<0||o>=i.length)throw new Error("Mutation can be performed only on DNA coding region.");e.viewModel.DNA.splice(n,1),e.viewModel.DNAComp.splice(n,1),e.viewModel.mRNA.splice(o,1),i=i.substr(0,o)+i.substr(o+1),"transcription"===r.name&&o<r.step&&C("DNAState",v(r),"suppress"),x(i)},transitionToNextState:function(){e.stopTransition(),0===o.length&&b(g(e.lastState()))},stopTransition:function(){o.length>1&&(o.length=1)},jumpToNextState:function(){e.stateBefore("translation:0")?C("DNAState",g(e.state())):e.stateBefore("translation-end")&&C("DNAState","translation-end")},jumpToPrevState:function(){e.stateAfter("intro-cells")&&C("DNAState",v(e.state()))},transitionTo:function(t){for(;e.lastStateBefore(t);)b(g(e.lastState()))},transcribeStep:function(t){var n,i;if("dna"===(n=e.state()).name&&void 0===t)e.transitionToNextState();else if("transcription"===n.name){if(i=u(n.step),t&&t.toUpperCase()!==i)return;e.transitionToNextState()}},state:function(){return e.parseState(t.get("DNAState"))},stateBefore:function(e){return-1===y(t.get("DNAState"),e)},stateEqual:function(e){return 0===y(t.get("DNAState"),e)},stateAfter:function(e){return 1===y(t.get("DNAState"),e)},lastState:function(){var t=o.length;return t>0?e.parseState(o[t-1]):e.state()},lastStateBefore:function(e){var n=o.length,i=n?o[n-1]:t.get("DNAState");return-1===y(i,e)},lastStateAfter:function(e){var n=o.length,i=n?o[n-1]:t.get("DNAState");return 1===y(i,e)},parseState:function(t){return{name:(t=t.split(":"))[0],step:Number(t[1])}},codon:function(t){return s.substr(3*t,3)},codonComplement:function(t){return e.codon(t).replace(/A/g,"u").replace(/G/g,"c").replace(/U/g,"a").replace(/C/g,"g").toUpperCase()},translationStepStarted:function(n,i,r,o,a,s){var l=Kn.codonToAbbr(e.codon(n)),u=Kn.abbrToElement(l);a+=.02*Math.random()-.01,t.addAtom({x:i,y:r,element:u,visible:!0,pinned:!0},{suppressCheck:!0}),t.atomTransition().id(n).duration(s).prop("x",o),t.atomTransition().id(n).duration(s).prop("y",a),t.start()},shiftAminoAcids:function(e,n,i){var r,o,a;if(!(e<1))for(r=0;r<e;r++)o=t.getAtomProperties(r).x+n,a=t.getAtomProperties(r).y,t.atomTransition().id(r).duration(i).prop("x",o),t.atomTransition().id(r).duration(i).prop("y",a)},centerProtein:function(n){t.batch((function(){var i,r,o,a=e.proteinCenterOfMass(),s=t.properties.viewPortX+t.properties.viewPortWidth/2-a.x,l=t.properties.viewPortY+t.properties.viewPortHeight/2-a.y,u=t.properties.minX+.1,c=t.properties.maxX-.1,h=t.properties.minY+.1,d=t.properties.maxY-.1,p=t.getNumberOfAtoms();for(i=0;i<p;i++)(r=t.getAtomProperties(i).x)+s>c&&(s=c-r),r+s<u&&(s=u-r),(o=t.getAtomProperties(i).y)+l>d&&(l=d-o),o+l<h&&(l=h-o);for(i=0;i<p;i++)r=t.getAtomProperties(i).x+s,o=t.getAtomProperties(i).y+l,n?(t.atomTransition().id(i).duration(n).prop("x",r),t.atomTransition().id(i).duration(n).prop("y",o)):t.setAtomProperties(i,{x:r,y:o})})),t.tickInPlace()},connectAminoAcid:function(e){if(!(e<1)){var n=1.25*(t.getAtomProperties(e-1).radius+t.getAtomProperties(e).radius);t.addRadialBond({atom1:e,atom2:e-1,length:n,strength:1e4}),t.setAtomProperties(e-1,{pinned:!1})}},translationCompleted:function(){var e=t.getNumberOfAtoms();e>0&&t.setAtomProperties(e-1,{pinned:!1})},transitionEnded:function(){o.shift(),o.length>0&&_(o[0])},stopCodonsHash:function(){return n},lastTranslationStep:function(){return i},proteinCenterOfMass:function(){var e,n,i=0,r=0,o=0,a=t.getNumberOfAtoms();if(0===a)return null;for(n=0,a=t.getNumberOfAtoms();n<a;n++)r+=(e=t.getAtomProperties(n)).x*e.mass,o+=e.y*e.mass,i+=e.mass;return{x:r/=i,y:o/=i}},generateProtein:function(e,n,i,r){n=e?e.length:n,i=i||0,r=r||0;var o=t.properties.minX,a=t.properties.minY+r,s=t.properties.maxX,l=t.properties.maxY-i,u=0;return f(),t.batch((function(){var i,r,c,h,d,p,f,m,g,v,y,b={suppressCheck:!0},_=s-o,x=l-a,w=Kn.lastElementID-Kn.firstElementID+1,C=function(t,e){return 0===e?t>.5*l?-.1:.1:r>l-.3||r<.3?0:e},T=function(){return Math.floor(w*Math.random())+Kn.firstElementID};for(i=o+.1,r=a+.1,c=0,h=0,d=e?Kn.abbrToElement(e[0]):T(),f=t.getElementProperties(d).radius,p={x:i,y:r,element:d,visible:!0},t.addAtom(p,b),u+=1,v=1;v<n;v++){if(i=p.x,r=p.y,c=(y=r)>x-.6||y<.6?.1:.02-.04*Math.random(),h=C(r,h),r+=1.7*h,(i+=1.7*c)>_-.1)return;d=e?Kn.abbrToElement(e[v]):T(),p={x:i,y:r,element:d,visible:!0},t.addAtom(p,b),u+=1,m=f,g=1.25*((f=t.getElementProperties(d).radius)+m),t.addRadialBond({atom1:v,atom2:v-1,length:g,strength:1e4})}})),t.batch((function(){var e,i=t.getAtomProperties(u-1).x,r=(i-o)/2,a=t.properties.viewPortX+t.properties.viewPortWidth/2,l=s-i,c=Math.max(0,Math.min(a-r,l));for(e=0;e<n;e++)t.setAtomProperties(e,{x:t.getAtomProperties(e).x+c})})),t.minimizeEnergy(),u}},t.addPropertiesListener(["DNA"],(function(){"suppress"!==r&&(e.stateAfter("translation:0")&&e.stateBefore("translation-end")?C("DNAState","translation:0"):(p(),"transition"===r?l.transition("dna-updated",!0):w(!0)))})),t.addPropertiesListener(["DNAState"],(function(){var n=t.get("DNAState");if("suppress"!==r)if(p(),"transition"===r)l.transition(n);else{if(e.stateAfter("translation:0")&&e.stateBefore("translation-end"))return Object(d.a)("'"+n+"' cannot be set explicitly. 'translation:0' should be set and then animation to '"+n+"' should be triggered."),void C("DNAState","translation:0");w()}})),p(),e}!function(){var t,e;for(t=0,e=Hi.length;t<e;t++)Wi[Hi[t]]=t;zi=function(t){var e,n=["A","G","T","C"],i=n.length,r="";for(e=0;e<t;e++)r+=n[Math.floor(Math.random()*i)];return r}(50),ji=Xi(zi)}();function Ji(t){this._model=t,this._initialTimeStep=this._model.get("timeStep"),this._maxTimeStep=2*this._initialTimeStep,this._targetProgressRate=this._initialTimeStep*this._model.get("timeStepsPerTick")*60,this.enabled=!1}Ji.prototype._assessPerformance=function(){if(this.enabled&&!this._model.isStopped()){var t=this._model.getSimulationProgressRate(),e=this._model.getFPS(),n=this._model.get("timeStep"),i=this._model.get("timeStepsPerTick"),r=this._model.get("temperatureControl")?2.5*this._maxTimeStep:this._maxTimeStep;t<.9*this._targetProgressRate?1.1*n<r?this._model.set("timeStep",1.1*n):e>2.5&&this._model.set("timeStepsPerTick",Math.round(1.1*i+.5)):t>1.1*this._targetProgressRate&&this._model.set("timeStepsPerTick",Math.round(.9*i-.5)),setTimeout($.proxy(this._assessPerformance,this),250)}},Ji.prototype.enable=function(){this.enabled||(this._model.start(),this.enabled=!0,this._model.set("timeStepsPerTick",5),setTimeout($.proxy(this._assessPerformance,this),250))},Ji.prototype.disable=function(){this.enabled=!1};var Zi=Ji;function tr(){if(this.isFinished=!1,this._duration=0,this._easeFunc=d3.ease("cubic-in-out"),this._elapsedTime=0,this._id=null,this._propName=null,this._endValue=null,this._interpolator=null,null==this.getObjectProperties)throw new Error("getObjectProperties method must be implemented by descendant!");if(null==this.setObjectProperties)throw new Error("setObjectProperties method must be implemented by descendant!")}tr.prototype.id=function(t){return this._id=t,this},tr.prototype.prop=function(t,e){return this._propName=t,this._endValue=e,this},tr.prototype.duration=function(t){return this._duration=t,this},tr.prototype.delay=function(t){return this._elapsedTime=-t,this},tr.prototype.ease=function(t){return this._easeFunc=d3.ease(t),this},tr.prototype.process=function(t){var e,n;this.isFinished||this._incompleteSpec()||(this._elapsedTime+=t,this._elapsedTime<0||(null==this._interpolator&&(this._interpolator=d3.interpolate(this.getObjectProperties(this._id)[this._propName],this._endValue)),e=Math.min(1,this._elapsedTime/this._duration),e=this._easeFunc(e),(n={})[this._propName]=this._interpolator(e),this.setObjectProperties(this._id,n),e>=1&&(this.isFinished=!0)))},tr.prototype.getObjectProperties=null,tr.prototype.setObjectProperties=null,tr.prototype._incompleteSpec=function(){return null==this._id||null==this._propName||null==this._endValue};var er=tr;function nr(t){er.call(this),this._model=t}Vt(nr,er),nr.prototype.setObjectProperties=function(t,e){this._model.setAtomProperties(t,e)},nr.prototype.getObjectProperties=function(t){return this._model.getAtomProperties(t)};var ir,rr=nr,or=ce.a.unit,ar={1:101,2:107,3:108},sr=(ir={},Object.keys(ar).forEach((function(t){ir[ar[t]]=t})),ir);function lr(t,e,n,i){return t*n+e*i}function ur(t,e){var n,i,r,o,a=p.a.validateCompleteness(me.a.chemicalReactions,e),l=a.updateInterval,u=a.createAngularBonds,c=a.noLoops,h=a.valenceElectrons,d=a.bondEnergy,f=a.activationEnergy,m=a.bondProbability,g=[],v=!1,y={};function b(t){var e=h[n.element[t]],i=n.sharedElectrons[t];return i<e&&e+i<8}function _(t,e){return.6*(i.sigma[t]+i.sigma[e])}function x(t,e){return 2e4*Math.sqrt(i.epsilon[t]*i.epsilon[e])}function w(t){var e=h[n.element[t]];return Math.min(Math.min(8-e,e)-n.sharedElectrons[t])}function C(t,e,i){void 0===i&&(i=0);var r=Math.min(3,w(t),w(e)+i);if(r<=1)return r;var o,a,s=(o=n.element[t],a=n.element[e],null!=m[o+"-"+a]?m[o+"-"+a]:null!=m[a+"-"+o]?m[a+"+"+o]:m.default),l=Math.random();return 3===r?l<s[0]?1:l<s[0]+s[1]?2:3:l<s[0]+s[2]?1:2}function T(t){var e=r.type[t]-105;return e<0?1:e}function S(t,e,n){switch(void 0===n&&(n=1),n){case 1:return null!=d[t+"-"+e]?d[t+"-"+e]:null!=d[e+"-"+t]?d[e+"-"+t]:d.default;case 2:return null!=d[t+"="+e]?d[t+"="+e]:null!=d[e+"="+t]?d[e+"="+t]:2*S(t,e,1);case 3:return null!=d[t+"#"+e]?d[t+"#"+e]:null!=d[e+"#"+t]?d[e+"#"+t]:3*S(t,e,1)}}function k(t,e,n){return null!=f[t+"+"+e+"-"+n]?f[t+"+"+e+"-"+n]:null!=f[t+"+"+n+"-"+e]?f[t+"+"+n+"-"+e]:f.default}function A(e,i,r,o){t.removeRadialBond(e,!0),v=!0,y[i]=!0,y[r]=!0,n.sharedElectrons[i]-=o,n.sharedElectrons[r]-=o}function E(e,n){t.setAngularBondProperties(e,n),v=!0}function M(){var e,i,o;for(i=0,o=t.getNumberOfAtoms();i<o;i++)n.sharedElectrons[i]=0;for(i=0,o=t.getNumberOfRadialBonds();i<o;i++)e=T(i),n.sharedElectrons[r.atom1[i]]+=e,n.sharedElectrons[r.atom2[i]]+=e}function P(e){var i,o,a,s,l,u,c,h,d,p,f,m,g,v;for(i=0;i<t.getNumberOfRadialBonds();)v=!1,o=r.atom1[i],a=r.atom2[i],p=r.length[i],d=(c=n.x[o]-n.x[a])*c+(h=n.y[o]-n.y[a])*h,((u=Math.sqrt(d)-p)>0||e)&&(u=.5*r.strength[i]*u*u,s=n.element[o],l=n.element[a],f=T(i),(u-(g=-r.creationPotential[i]-t.ljCalculator[s][l].potentialFromSquaredDistance(d))>(m=S(s,l,f))||e)&&(u-=m,u-=g,t.addKEToAtomPairAndConserveMomentum(u,o,a)?(A(i,o,a,f),v=!0):e&&(t.addKEToAtoms(u),A(i,o,a,f),v=!0))),v||i++}function D(e,i,r,o,a){var s,l,u,h,d;if(function(t,e,i,r){return!(lr(n.vx[t],n.vy[t],i,r)>=0&&lr(n.vx[e],n.vy[e],i,r)<=0)}(e,i,r,o)&&(s=b(e),l=b(i),u=s&&l,h=s&&void 0!==g[i],d=l&&void 0!==g[e],u||h||d)){if(function(t,e){var n,i,r,o=t.length,a=e.length;for(n=0;n<o;n++)for(r=t[n],i=0;i<a;i++)if(r===e[i])return!0;return!1}(t.getBondedAtoms(e),t.getBondedAtoms(i)))return;if(c&&-1!==t.getMoleculeAtoms(i).indexOf(e))return;u?function(e,i,r){var o,a,s,l,u=n.element[e],c=n.element[i],h=C(e,i),d=S(u,c,h);if(d<=0)return;if(o=_(u,c),a=x(u,c),s=Math.sqrt(r)-o,s*=-.5*a*s,s+=d,(l=-t.ljCalculator[u][c].potentialFromSquaredDistance(r))>0)return;t.addKEToAtomPairAndConserveMomentum(s,e,i)&&function(e,i,r,o){e.atom1=i,e.atom2=r,e.type=ar[o],t.addRadialBond(e),v=!0,y[i]=!0,y[r]=!0,n.sharedElectrons[i]+=o,n.sharedElectrons[r]+=o}({length:o,strength:a,creationPotential:l},e,i,h)}(e,i,a):h?O(e,i,g[i],r,o,a):d&&O(i,e,g[e],r,o,a)}}function O(e,i,o,a,s,l){var u,c,h,d,p,f,m,b=n.element[e],w=n.element[i],A=r.atom1[o],E=r.atom2[o],M=n.element[A],P=n.element[E],D=A!==e&&A!==i?A:E,O=n.element[D],I=T(o),L=C(e,i,I),R=function(t,e,n,i,r){var o=S(e,n,i),a=S(t,e,r);return a>o?k(t,e,n):k(t,e,n)+o-a}(b,w,O,I,L),N=1/Math.sqrt(l),F=(n.vx[e]-n.vx[i])*a*N+(n.vy[e]-n.vy[i])*s*N,B=n.mass[e],z=n.mass[i];if(ce.a.convert(B*z/(B+z)*F*F,{from:or.MW_ENERGY_UNIT,to:or.EV})>R){if(u=_(b,w),c=x(b,w),h=r.length[o],d=r.strength[o],f=-.5*c*(p=Math.sqrt(l)-u)*p,f+=S(b,w,L),(m=-t.ljCalculator[b][w].potentialFromSquaredDistance(l))>0)return;l=(a=n.x[A]-n.x[E])*a+(s=n.y[A]-n.y[E])*s,f+=.5*d*(p=Math.sqrt(l)-h)*p,f-=S(M,P,I),f-=-r.creationPotential[o]-t.ljCalculator[M][P].potentialFromSquaredDistance(l),t.addKEToAtoms(f,e,i,D)&&function(e,i,r,o,a,s,l){i.atom1=r,i.atom2=o,i.type=ar[s],t.setRadialBondProperties(e,i,!0),v=!0,y[r]=!0,y[o]=!0,y[a]=!0,n.sharedElectrons[r]+=s,n.sharedElectrons[o]+=s-l,n.sharedElectrons[a]-=l,g[a]===e&&(g[a]=void 0),g[o]=void 0}(o,{length:u,strength:c,creationPotential:m},e,i,D,L,I)}}function I(){var e,n,i,r,a,s;for(e=0,n=t.getNumberOfAngularBonds();e<n;e++)0===o.strength[e]&&(i=o.atom1[e],r=o.atom2[e],a=o.atom3[e],s=o.angle[e]-L(i,r,a),s*=-25*s,t.addKEToAtoms(s,i,r,a)&&E(e,{strength:50}))}function L(t,e,i){return Object(ti.getAngleBetweenVec)(n.x[t],n.y[t],n.x[e],n.y[e],n.x[i],n.y[i])}function R(t,e,n){return 2*Math.PI/(Math.min(4,t)-(e-n))}function N(t,e,n,i){t.push({angle:L(e,n,i),a1:e,a2:n,aCentral:i})}function F(t,e){return t.angle<e.angle?-1:t.angle>e.angle?1:0}function B(t,e,n){var i,r;for(i=0;i<e;i++)z((r=t[i]).a1,r.a2,r.aCentral,n,r.angle)}function z(e,n,i,r,o){o||(o=L(e,n,i));var a={atom1:e,atom2:n,atom3:i,angle:r},s=r-o;s*=-25*s,t.addKEToAtoms(s,e,n,i)?a.strength=50:a.strength=0,function(e){t.addAngularBond(e),v=!0}(a)}return{initialize:function(t){var e;n=t.atoms,i=t.elements,r=t.radialBonds,o=t.angularBonds,e=n.x.length,n.sharedElectrons=s.a.create(e,0,fe.int8Type),function(){var t=r.atom1.length;r.creationPotential=s.a.create(t,0,fe.floatType)}()},performActionWithinIntegrationLoop:function(e,a,s){var c=s%l;(0===c||c<a&&Math.floor(s/l)===Math.round(s/l))&&(v=!1,Object.keys(y).forEach((function(t){delete y[t]})),M(),P(),function(){var e,n;for(g.length=0,e=0,n=t.getNumberOfRadialBonds();e<n;e++)g[r.atom1[e]]=g[r.atom2[e]]=e}(),function(e){var r,o,a,s,l,u,c,h,d,p,f,m,g=t.getNumberOfAtoms(),v=e.getList();for(a=0;a<g;a++)for(l=n.element[a],c=n.x[a],h=n.y[a],r=e.getStartIdxFor(a),o=e.getEndIdxFor(a);r<o;r++)s=v[r],t.atomsBonded(a,s)||(u=n.element[s],(f=(d=c-n.x[s])*d+(p=h-n.y[s])*p)<(m=.6*(i.sigma[l]+i.sigma[u]))*m&&D(a,s,d,p,f))}(e),u&&(Object.keys(y).length>0?(function(){for(var e=0;e<t.getNumberOfAngularBonds();)y[o.atom3[e]]?t.removeAngularBond(e,!0):e++}(),I(),function(){var e,i,o,a,s,l,u,c=[];for(e=0,i=t.getNumberOfRadialBonds();e<i;e++)o=r.atom1[e],a=r.atom2[e],sr[r.type],y[o]&&(c[o]?c[o].push(a):c[o]=[a]),y[a]&&(c[a]?c[a].push(o):c[a]=[o]);for(e=0,i=c.length;e<i;e++)!(l=c[e])||l.length<2||(s=R(h[n.element[e]],n.sharedElectrons[e],l.length),2===l.length?z(o=l[0],a=l[1],e,s):(u=[],3===l.length?(N(u,l[0],l[1],e),N(u,l[0],l[2],e),N(u,l[1],l[2],e)):4===l.length&&(N(u,l[0],l[1],e),N(u,l[0],l[2],e),N(u,l[0],l[3],e),N(u,l[1],l[2],e),N(u,l[1],l[3],e),N(u,l[2],l[3],e)),u.sort(F),B(u,l.length-1,s)))}()):I()),v&&t.updateParticlesAccelerations())},getState:function(){return[]},processOutputState:function(e){e.PE+=function(){var e,i,o=0;for(e=0,i=t.getNumberOfRadialBonds();e<i;++e)o-=S(n.element[r.atom1[e]],n.element[r.atom2[e]],T(e))-r.creationPotential[e];return o}()},setBondEnergy:function(t,e){d[t]=e},setValenceElectrons:function(t,e){h[t]=e,P(!0),M()}}}var cr=0;function hr(t,e,n){this.constructor.type="md2d",e=e||{};var i,r,o,a,s,l,u,c,d,f,m,g,v,y,b,_,x,w={},C="md2dModel"+ ++cr,T={targetTemperature:function(t){R.setTargetTemperature(t)},temperatureControl:function(t){R.useThermostat(t)},lennardJonesForces:function(t){R.useLennardJonesInteraction(t)},coulombForces:function(t){R.useCoulombInteraction(t)},solventForceType:function(t){R.setSolventForceType(t)},DNAState:function(t){R.setDNAState(t)},solventForceFactor:function(t){R.setSolventForceFactor(t)},additionalSolventForceMult:function(t){R.setAdditionalSolventForceMult(t)},additionalSolventForceThreshold:function(t){R.setAdditionalSolventForceThreshold(t)},dielectricConstant:function(t){R.setDielectricConstant(t)},realisticDielectricEffect:function(t){R.setRealisticDielectricEffect(t)},VDWLinesCutoff:function(t){var e=P[t];e&&R.setVDWLinesRatio(e)},gravitationalField:function(t){R.setGravitationalField(t)},modelSampleRate:function(){w.isStopped()||w.restart()},viscosity:function(t){R.setViscosity(t)},polarAAEpsilon:function(t){var e,n,i,r,o,a;for(r=0,a=(e=Kn.getPolarAminoAcids()).length;r<a;r++)for(n=e[r],o=r+1;o<a;o++)i=e[o],R.pairwiseLJProperties.set(n,i,{epsilon:t})},electricFieldDensity:function(t){if(B.length=0,t)for(var e,n=w.properties.width,i=w.properties.height,r=w.properties.width/t,o=0+.5*(i/r%1*r+(r<=i?r:0));o<i;){for(e=0+.5*r;e<n;)B.push({x:e,y:o}),e+=r;o+=r}}},S=Ri(t.unitsScheme||"md2d"),k=function(){if("md2d"!==(t.unitsScheme||"md2d"))return new Bi(S)}(),A=new qn({metadata:me.a,setters:T,unitsDefinition:S,unitsTranslation:k,initialProperties:t}),E=((x=A.dispatchSupport).addEventTypes("tick","addAtom","removeAtom","addRadialBond","removeRadialBond","addElectricField","removeElectricField","changeElectricField","removeAngularBond","textBoxesChanged","imagesChanged"),x),M=A.propertySupport,P={short:1.33,medium:1.67,long:2},D=!1,O=[],I=window.state={},L=[],R=((_=Di()).pairwiseLJProperties.registerChangeHooks(M.invalidatingChangePreHook,M.invalidatingChangePostHook),_),N=[],F=[],B=[],z=null;function j(t,e){for(var n in t=h.a.extend({},t))t.hasOwnProperty(n)&&(t[n]=e(n,t[n]));return t}function V(t,e){return k?j(t,(function(t,n){return k.translateToModelUnits(n,e[t]&&e[t].unitType)})):t}function H(t,e){return k?j(t,(function(t,n){return k.translateFromModelUnits(n,e[t]&&e[t].unitType)})):t}var W,U=(W=[{getNum:"getNumberOfAtoms",addEvent:"addAtom",removeEvent:"removeAtom"},{getNum:"getNumberOfRadialBonds",addEvent:"addRadialBond",removeEvent:"removeRadialBond"}],function(t){var e,n,i;for(e=0;e<W.length;e++)(n=W[e]).num=R[n.getNum]();for(t(),e=0;e<W.length;e++)(i=R[(n=W[e]).getNum]())>n.num?E[n.addEvent]():i<n.num&&E[n.removeEvent]()});function $(){R.updateParticlesAccelerations(),R.computeOutputState(I),v=R.callPluginAccessor("getViewPhotons"),function(t){var e,n,i,r,o=R.getNumberOfAtoms();for(N.length=o,e=0;e<o;e++){for(n in N[e]||(N[e]={idx:e}),r=N[e],t)t.hasOwnProperty(n)&&(r[n]=t[n][e]);r.aminoAcid=Kn.isAminoAcid(t.element[e]),r.aminoAcid&&(i=Kn.getAminoAcidByElement(t.element[e]),r.symbol=i.symbol,r.label=i.abbreviation)}}(I.atoms),function(t,e){var n,i,r,o=R.getNumberOfRadialBonds();for(F.length=o,r=0;r<o;r++){for(i in F[r]||(F[r]={idx:r}),n=F[r],t)n[i]=t[i][r];n.x1=e.x[n.atom1],n.y1=e.y[n.atom1],n.x2=e.x[n.atom2],n.y2=e.y[n.atom2]}}(I.radialBonds,I.atoms),function(){if(!B.length||!w.properties.showElectricField)return;var t,e,n;for(t=0,e=B.length;t<e;t++)n=B[t],R.getCoulombForceAt(n.x,n.y,n)}()}w.stepCounter=function(){return r.get("counter")},w.stepStartCounter=function(){return r.get("startCounter")},w.steps=function(){return r.get("length")},w.isNewStep=function(){return D},w.seek=function(t){return arguments.length||(t=0),w.isStopped()||w.stop(),D=!1,U((function(){r.seekExtract(t),$(),w.updateAllOutputProperties(),E.seek()})),r.get("counter")},w.stepBack=function(t){return arguments.length||(t=1),w.isStopped()||w.stop(),D=!1,U((function(){var e;for(e=-1;++e<t;)r.get("index")>0&&(r.decrementExtract(),$(),w.updateAllOutputProperties(),E.stepBack())})),r.get("counter")},w.stepForward=function(t){return arguments.length||(t=1),w.isStopped()||w.stop(),U((function(){var e;for(e=-1;++e<t;)r.get("index")<r.get("length")-1?(r.incrementExtract(),$(),w.updateAllOutputProperties(),E.stepForward()):w.tick()})),r.get("counter")},w.createElements=function(t){var e,n,i,r;if(w.startBatch(),void 0===t)return w.addElement({id:0}),void w.endBatch();for(e=0,n=t.mass.length;e<n;e++){for(i in r={},t)t.hasOwnProperty(i)&&(r[i]=t[i][e]);w.addElement(r)}return w.endBatch(),w},w.createAtoms=function(t){var e,n,i,r,o={suppressCheck:!0};for(E.willReset(),w.startBatch(),n=t.x.length,e=0;e<n;e++){for(i in r={},t)t.hasOwnProperty(i)&&(r[i]=t[i][e]);w.addAtom(r,o)}w.endBatch(),E.reset()},w.createRadialBonds=function(t){var e,n,i,r=t.strength.length;for(w.startBatch(),e=0;e<r;e++){for(n in i={},t)t.hasOwnProperty(n)&&(i[n]=t[n][e]);w.addRadialBond(i)}return w.endBatch(),w},w.createAngularBonds=function(t){var e,n,i,r=t.strength.length;for(w.startBatch(),e=0;e<r;e++){for(n in i={},t)t.hasOwnProperty(n)&&(i[n]=t[n][e]);w.addAngularBond(i)}return w.endBatch(),w},w.createRestraints=function(t){var e,n,i,r=t.atomIndex.length;for(e=0;e<r;e++){for(n in i={},t)t.hasOwnProperty(n)&&(i[n]=t[n][e]);w.addRestraint(i)}return w},w.createObstacles=function(t){var e,n,i,r=t.x.length;for(e=0;e<r;e++){for(n in i={},t)t.hasOwnProperty(n)&&(i[n]=t[n][e]);w.addObstacle(i)}return w},w.createShapes=function(t){var e,n,i,r=t.x.length;for(e=0;e<r;e++){for(n in i={},t)t.hasOwnProperty(n)&&(i[n]=t[n][e]);w.addShape(i)}return w},w.createLines=function(t){var e,n,i,r=t.x1.length;for(e=0;e<r;e++){for(n in i={},t)t.hasOwnProperty(n)&&(i[n]=t[n][e]);w.addLine(i)}return w},w.createElectricFields=function(t){return w.batch((function(){var e,n,i,r=t.intensity.length;for(e=0;e<r;e++){for(n in i={},t)t.hasOwnProperty(n)&&(i[n]=t[n][e]);w.addElectricField(i)}})),w},w.reset=function(){E.willReset(),M.invalidatingChangePreHook(),R.setTime(0),r.restoreInitialState(),M.invalidatingChangePostHook(),w.resetAllOutputProperties(),E.reset()},w.getTotalMass=function(){return R.getTotalMass()},w.getAtomKineticEnergy=function(t){return R.getAtomKineticEnergy(t)},w.addRandomAtom=function(t,e){null==t&&(t=function(){for(var t=R.getNumberOfElements(),e=Math.floor(Math.random()*t);Kn.isAminoAcid(e);)e=Math.floor(Math.random()*t);return e}()),null==e&&(e=0);var n,i,r,o=w.get("width"),a=w.get("height"),s=w.get("minX"),l=w.get("minY"),u=R.getRadiusOfElement(t),c=0;do{if(n=s+Math.random()*o-2*u,i=l+Math.random()*a-2*u,(r=R.findMinimumPELocation(t,n,i,0,0,e))&&w.addAtom({element:t,x:r[0],y:r[1],charge:e}))return!0}while(++c<10);return!1},w.addAtom=function(t,e){var n,i=w.get("minX"),r=w.get("minY"),o=w.get("maxX"),a=w.get("maxY");return e=e||{},t=p.a.validateCompleteness(me.a.atom,t),n=R.getRadiusOfElement(t.element),t.x<i+n&&(t.x=i+n),t.x>o-n&&(t.x=o-n),t.y<r+n&&(t.y=r+n),t.y>a-n&&(t.y=a-n),!(!e.suppressCheck&&!R.canPlaceAtom(t.element,t.x,t.y,null,w.get("skipPECheckOnAddAtom")))&&(M.invalidatingChangePreHook(),R.addAtom(t),M.invalidatingChangePostHook(),E.addAtom(),!0)},w.removeAtom=function(t){var e=R.getNumberOfRadialBonds(),n=R.getNumberOfAngularBonds();M.invalidatingChangePreHook(),R.removeAtom(t),N.length=0,M.invalidatingChangePostHook(),E.removeAtom(),R.getNumberOfRadialBonds()!==e&&E.removeRadialBond(),R.getNumberOfAngularBonds()!==n&&E.removeAngularBond()},w.addElement=function(t){t=p.a.validateCompleteness(me.a.element,t),R.addElement(t)},w.addObstacle=function(t){var e;e=p.a.validateCompleteness(me.a.obstacle,t),M.invalidatingChangePreHook(),R.addObstacle(e),M.invalidatingChangePostHook()},w.removeObstacle=function(t){M.invalidatingChangePreHook(),R.removeObstacle(t),M.invalidatingChangePostHook()},w.addShape=function(t){var e;e=p.a.validateCompleteness(me.a.shape,t),M.invalidatingChangePreHook(),R.addShape(e),M.invalidatingChangePostHook()},w.removeShape=function(t){var e=R.getNumberOfElectricFields();M.invalidatingChangePreHook(),R.removeShape(t),M.invalidatingChangePostHook(),R.getNumberOfElectricFields()!==e&&E.removeElectricField()},w.addLine=function(t){var e;e=p.a.validateCompleteness(me.a.line,t),M.invalidatingChangePreHook(),R.addLine(e),M.invalidatingChangePostHook()},w.removeLine=function(t){M.invalidatingChangePreHook(),R.removeLine(t),M.invalidatingChangePostHook()},w.addElectricField=function(t){var e;e=p.a.validateCompleteness(me.a.electricField,t),M.invalidatingChangePreHook(),R.addElectricField(e),M.invalidatingChangePostHook(),E.addElectricField()},w.removeElectricField=function(t){M.invalidatingChangePreHook(),R.removeElectricField(t),M.invalidatingChangePostHook(),E.removeElectricField()},w.addRadialBond=function(t){t=p.a.validateCompleteness(me.a.radialBond,t),M.invalidatingChangePreHook(),R.addRadialBond(t),M.invalidatingChangePostHook(),E.addRadialBond()},w.removeRadialBond=function(t){M.invalidatingChangePreHook(),R.removeRadialBond(t),M.invalidatingChangePostHook(),E.removeRadialBond()},w.addAngularBond=function(t){t=p.a.validateCompleteness(me.a.angularBond,t),M.invalidatingChangePreHook(),R.addAngularBond(t),M.invalidatingChangePostHook()},w.removeAngularBond=function(t){M.invalidatingChangePreHook(),R.removeAngularBond(t),M.invalidatingChangePostHook(),E.removeAngularBond()},w.addRestraint=function(t){t=p.a.validateCompleteness(me.a.restraint,t),M.invalidatingChangePreHook(),R.addRestraint(t),M.invalidatingChangePostHook()},w.getMoleculeBoundingBox=function(t){var e,n,i,r,o,a,s,l=I.atoms,u=-1/0,c=1/0,h=1/0,d=-1/0;for((e=R.getMoleculeAtoms(t)).push(t),n=0;n<e.length;n++)i=l.x[e[n]],r=l.y[e[n]],i-(o=l.radius[e[n]])<c&&(c=i-o),i+o>d&&(d=i+o),r-o<h&&(h=r-o),r+o>u&&(u=r+o);return a=l.x[t],{top:u-(s=l.y[t]),left:c-a,bottom:h-s,right:d-a}},w.setTemperatureOfAtoms=function(t,e){M.invalidatingChangePreHook(),R.setTemperatureOfAtoms(t,e),M.invalidatingChangePostHook()},w.addKEToAtoms=function(t,e){M.invalidatingChangePreHook(),null==e?R.addKEToAtoms(t):R.addKEToAtoms.apply(R,[t].concat(e)),M.invalidatingChangePostHook()},w.getTemperatureOfAtoms=function(t){return R.getTemperatureOfAtoms(t)},w.setAtomProperties=function(t,e,n,i,r){var o,a,s,l,u,c,h,d=I.atoms;if(e=p.a.validate(me.a.atom,e),i&&(o=R.getMoleculeAtoms(t)).length>0)for(a="number"==typeof e.x?e.x-d.x[t]:0,s="number"==typeof e.y?e.y-d.y[t]:0,c=0,h=o.length;c<h;c++)if(l=d.x[o[c]]+a,u=d.y[o[c]]+s,!w.setAtomProperties(o[c],{x:l,y:u},n,!1))return!1;if(n){var f="number"==typeof e.x?e.x:d.x[t],m="number"==typeof e.y?e.y:d.y[t],g="number"==typeof e.element?e.y:d.element[t];if(!R.canPlaceAtom(g,f,m,t,r))return!1}return M.invalidatingChangePreHook(),R.setAtomProperties(t,V(e,me.a.atom)),M.invalidatingChangePostHook(),!0},w.getAtomProperties=function(t){var e,n=I.atoms,i=me.a.atom,r={};for(e in i)i.hasOwnProperty(e)&&n[e]&&(r[e]=n[e][t]);return H(r,i)},w.getRadialBondsForAtom=function(t){return R.getRadialBondsForAtom(t)},w.getBondedAtoms=function(t){return R.getBondedAtoms(t)},w.getAngularBondsForAtom=function(t){return R.getAngularBondsForAtom(t)},w.getMoleculeAtoms=function(t){return R.getMoleculeAtoms(t)},w.setElementProperties=function(t,e){if(e=p.a.validate(me.a.element,e),Kn.isAminoAcid(t))throw new Error("Elements: elements with ID "+t+" cannot be edited, as they define amino acids.");M.invalidatingChangePreHook(),R.setElementProperties(t,V(e,me.a.element)),M.invalidatingChangePostHook()},w.getElementProperties=function(t){var e,n=me.a.element,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=s[e][t]);return H(i,n)},w.getAminoAcidByElement=function(t){return Kn.isAminoAcid(t)?Kn.getAminoAcidByElement(t):void 0},w.setObstacleProperties=function(t,e){e=p.a.validate(me.a.obstacle,e),M.invalidatingChangePreHook(),R.setObstacleProperties(t,V(e,me.a.obstacle)),M.invalidatingChangePostHook()},w.getObstacleProperties=function(t){var e,n=me.a.obstacle,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=l[e][t]);return H(i,n)},w.setShapeProperties=function(t,e){e=p.a.validate(me.a.shape,e),M.invalidatingChangePreHook(),R.setShapeProperties(t,V(e,me.a.shape)),M.invalidatingChangePostHook()},w.getShapeProperties=function(t){var e,n=me.a.shape,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=u[e][t]);return H(i,n)},w.setLineProperties=function(t,e){e=p.a.validate(me.a.line,e),M.invalidatingChangePreHook(),R.setLineProperties(t,V(e,me.a.line)),M.invalidatingChangePostHook()},w.getLineProperties=function(t){var e,n=me.a.line,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=c[e][t]);return H(i,n)},w.setElectricFieldProperties=function(t,e){e=p.a.validate(me.a.electricField,e),M.invalidatingChangePreHook(),R.setElectricFieldProperties(t,V(e,me.a.electricField)),M.invalidatingChangePostHook(),E.changeElectricField()},w.getElectricFieldProperties=function(t){var e,n=me.a.electricField,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=d[e][t]);return H(i,n)},w.setRadialBondProperties=function(t,e){e=p.a.validate(me.a.radialBond,e),M.invalidatingChangePreHook(),R.setRadialBondProperties(t,V(e,me.a.radialBond)),M.invalidatingChangePostHook()},w.getRadialBondProperties=function(t){var e,n=me.a.radialBond,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=f[e][t]);return H(i,n)},w.setRestraintProperties=function(t,e){e=p.a.validate(me.a.restraint,e),M.invalidatingChangePreHook(),R.setRestraintProperties(t,V(e,me.a.restraint)),M.invalidatingChangePostHook()},w.getRestraintProperties=function(t){var e,n=me.a.restraint,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=g[e][t]);return H(i,n)},w.setAngularBondProperties=function(t,e){e=p.a.validate(me.a.angularBond,e),M.invalidatingChangePreHook(),R.setAngularBondProperties(t,V(e,me.a.angularBond)),M.invalidatingChangePostHook()},w.getAngularBondProperties=function(t){var e,n=me.a.angularBond,i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=m[e][t]);return H(i,n)},w.setSolvent=function(t){var e=new Vi.a(t),n={solventForceType:e.forceType,dielectricConstant:e.dielectricConstant,backgroundColor:e.color};w.set(n)},w.addSpringForce=function(t,e,n,i){return null==i&&(i=500),k&&(i=k.translateToModelUnits(i,"stiffness")),R.addSpringForce(t,e,n,i)},w.updateSpringForce=function(t,e,n){R.updateSpringForce(t,e,n)},w.removeSpringForce=function(t){R.removeSpringForce(t)},w.addTextBox=function(t){t=p.a.validateCompleteness(me.a.textBox,t),w.get("textBoxes").push(t),E.textBoxesChanged()},w.removeTextBox=function(t){var e=w.get("textBoxes");if(!(t>=0&&t<e.length))throw new Error('Text box "'+t+'" does not exist, so it cannot be removed.');w.set("textBoxes",e.slice(0,t).concat(e.slice(t+1))),E.textBoxesChanged()},w.setTextBoxProperties=function(t,e){var n,i=w.get("textBoxes")[t];if(!i)throw new Error('Text box "'+t+'" does not exist, so it cannot have properties set.');for(n in e=p.a.validate(me.a.textBox,e))e.hasOwnProperty(n)&&(i[n]=e[n]);E.textBoxesChanged()},w.addImage=function(t){t=p.a.validateCompleteness(me.a.image,t),w.get("images").push(t),E.imagesChanged()},w.removeImage=function(t){var e=w.get("images");if(!(t>=0&&t<e.length))throw new Error('Image "'+t+'" does not exist, so it cannot be removed.');w.set("images",e.slice(0,t).concat(e.slice(t+1))),E.imagesChanged()},w.setImageProperties=function(t,e){var n,i=w.get("images")[t];if(!i)throw new Error('Image "'+t+'" does not exist, so it cannot have properties set.');for(n in e=p.a.validate(me.a.image,e))e.hasOwnProperty(n)&&(i[n]=e[n]);E.imagesChanged()},w.getTextBoxProperties=function(t){return w.get("textBoxes")[t]},w.getImageProperties=function(t){return w.get("images")[t]},w.liveDragStart=function(t,e,n){null==z&&(null==e&&(e=I.atoms.x[t]),null==n&&(n=I.atoms.y[t]),y=w.getAtomProperties(t).friction,w.setAtomProperties(t,{friction:w.LIVE_DRAG_FRICTION}),z=w.addSpringForce(t,e,n,500))},w.liveDrag=function(t,e){w.updateSpringForce(z,t,e)},w.liveDragEnd=function(){var t=R.springForceAtomIndex(z);w.setAtomProperties(t,{friction:y}),w.removeSpringForce(z),z=null},w.getFPS=function(){for(var t=0,e=O.length,n=-1;++n<e;)t+=O[n];return(t/=e)?1/t*1e3:0},w.getSimulationProgressRate=function(){return w.getFPS()*w.get("timeStep")*w.get("timeStepsPerTick")},w.get_elements=function(){return s},w.getAtoms=function(){return N},w.getRadialBonds=function(){return F},w.getElectricField=function(){return B},w.getPhotons=function(){return v},w.turnOnLightSource=function(){R.callPluginAccessor("turnOnLightSource")},w.turnOffLightSource=function(){R.callPluginAccessor("turnOffLightSource")},w.setLightSourceAngle=function(t){R.callPluginAccessor("setLightSourceAngle",[t])},w.setLightSourceFrequency=function(t){R.callPluginAccessor("setLightSourceFrequency",[t])},w.setLightSourcePeriod=function(t){R.callPluginAccessor("setLightSourcePeriod",[t])},w.setLightSourceNumber=function(t){R.callPluginAccessor("setLightSourceNumber",[t])},w.setBondEnergy=function(t,e){R.callPluginAccessor("setBondEnergy",[t,e])},w.setValenceElectrons=function(t,e){R.callPluginAccessor("setValenceElectrons",[t,e])};var G,q,Y,X,Q,K,J;function Z(){M.invalidatingChangePreHook(),M.invalidatingChangePostHook()}return w.onPhotonAbsorbed=function(t){R.callPluginAccessor("on",["photonAbsorbed.external-handler-0",t])},w.getNumberOfAtoms=function(t){return t?N.reduce((function(e,n){return t(n)?e+1:e}),0):N.length},w.get_obstacles=function(){return l},w.get_shapes=function(){return u},w.get_lines=function(){return c},w.getNumberOfElements=function(){return R.getNumberOfElements()},w.getNumberOfObstacles=function(){return R.getNumberOfObstacles()},w.getNumberOfShapes=function(){return R.getNumberOfShapes()},w.getNumberOfLines=function(){return R.getNumberOfLines()},w.getNumberOfRadialBonds=function(){return R.getNumberOfRadialBonds()},w.getNumberOfAngularBonds=function(){return R.getNumberOfAngularBonds()},w.getNumberOfSpringForces=function(){return R.getNumberOfSpringForces()},w.getNumberOfElectricFields=function(){return R.getNumberOfElectricFields()},w.getNumberOfTextBoxes=function(){return w.get("textBoxes").length},w.get_restraints=function(){return g},w.getPairwiseLJProperties=function(){return R.pairwiseLJProperties},w.geneticEngine=function(){return o},w.get_vdw_pairs=function(){return R.getVdwPairsArray()},w.tickInPlace=function(){return E.tick(),w},w.tick=function(){var t,e,n=w.get("timeStep");k&&(n=k.translateToModelUnits(n,"time")),w.isStopped()||(t=An.now(),i?(e=t-i,i=t,O.push(e),O.splice(0,O.length-64),function(t){var e,n;for(w.startBatch(),e=0,n=L.length;e<n;e++)L[e].process(t);for(e=0;e<L.length;)L[e].isFinished?L.splice(e,1):e++;w.endBatch()}(e)):i=t),An.enterScope("engine"),R.integrate(w.get("timeStepsPerTick")*n,n),An.leaveScope("engine"),$(),w.updateAllOutputProperties(),r.push(),D=!0,R.radialBondsChanged&&E.addRadialBond(),E.tick()},w.minimizeEnergy=function(){return M.invalidatingChangePreHook(),R.minimizeEnergy(),M.invalidatingChangePostHook(),E.tick(),w},w.dimensions=function(){return R.getDimensions()},w.format=function(t,e){e=e||{};var n=w.getPropertyDescription(t);return n?n.format(w.get(t),e):d3.format(e.format||"g")(w.get(t))},w.getUnitDefinition=function(t){return S.units[t]},w.atomTransition=function(){var t=new rr(w);return L.push(t),t},w.cancelTransitions=function(){L.length=0},w.startBatch=function(){M.startBatch(),E.startBatch()},w.endBatch=function(){M.endBatch(),E.endBatch()},w.batch=function(t){w.startBatch(),t(),w.endBatch()},w.serialize=function(){var t,e,n,i,r,o,a,h={},p=M.rawValues;if((h=Dn(me.a.mainProperties,p)).viewOptions=Dn(me.a.viewOptions,p),h.atoms=Dn(me.a.atom,I.atoms,R.getNumberOfAtoms()),R.getNumberOfRadialBonds()&&(h.radialBonds=Dn(me.a.radialBond,f,R.getNumberOfRadialBonds())),R.getNumberOfAngularBonds()&&(h.angularBonds=Dn(me.a.angularBond,m,R.getNumberOfAngularBonds())),R.getNumberOfObstacles())for(h.obstacles=Dn(me.a.obstacle,l,R.getNumberOfObstacles()),e=0,n=h.obstacles.x.length;e<n;e++)h.obstacles.westProbe[e]=Boolean(h.obstacles.westProbe[e]),h.obstacles.northProbe[e]=Boolean(h.obstacles.northProbe[e]),h.obstacles.eastProbe[e]=Boolean(h.obstacles.eastProbe[e]),h.obstacles.southProbe[e]=Boolean(h.obstacles.southProbe[e]);for(R.getNumberOfShapes()&&(h.shapes=Dn(me.a.shape,u,R.getNumberOfShapes())),R.getNumberOfLines()&&(h.lines=Dn(me.a.line,c,R.getNumberOfLines())),R.getNumberOfElectricFields()&&(h.electricFields=Dn(me.a.electricField,d,R.getNumberOfElectricFields())),R.getNumberOfRestraints()&&(h.restraints=Dn(me.a.restraint,g,R.getNumberOfRestraints())),h.elements=Dn(me.a.element,s,5),h.pairwiseLJProperties=[],e=0,n=(t=R.pairwiseLJProperties.serialize()).length;e<n;e++)t[e].element1<=5&&t[e].element2<=5&&h.pairwiseLJProperties.push(t[e]);return!1===h.temperatureControl&&delete h.targetTemperature,!1===h.viewOptions.showAtomTrace&&delete h.viewOptions.atomTraceId,"default"===h.modelSampleRate&&delete h.modelSampleRate,w.properties.useQuantumDynamics&&(h.quantumDynamics=(o=w.getPhotons(),(a={photons:Dn(me.a.photon,(i=o,r={},0===i.length?{}:(Object.keys(i[0]).forEach((function(t){r[t]=[]})),i.forEach((function(t){Object.keys(t).forEach((function(e){r[e].push(t[e])}))})),r)),o.length),elementEnergyLevels:R.callPluginAccessor("getElementEnergyLevels"),radiationlessEmissionProbability:R.callPluginAccessor("getRadiationlessEmissionProbability"),lightSource:R.callPluginAccessor("getLightSource")}).lightSource||delete a.lightSource,a)),w.properties.useChemicalReactions?h.chemicalReactions={}:delete h.atoms.radical,["marked","visible","draggable","draggableWhenStopped"].forEach((function(t){var e,n;e=t,n=me.a.atom[t].defaultValue,h.atoms[e].every((function(t){return t===n}))&&delete h.atoms[e]})),h},w.LIVE_DRAG_FRICTION=10,t.DNA&&(t.width=200,t.height=5,t.viewOptions=t.viewOptions||{},t.viewOptions.viewPortX=0,t.viewOptions.viewPortY=0,t.viewOptions.viewPortWidth=5,t.viewOptions.viewPortHeight=3),function(){if(t.viewOptions){var e,n,i=t.viewOptions.textBoxes||[],r=t.viewOptions.images||[];for(e=0,n=i.length;e<n;e++)i[e]=p.a.validateCompleteness(me.a.textBox,i[e]);for(e=0,n=r.length;e<n;e++)r[e]=p.a.validateCompleteness(me.a.image,r[e])}}(),b={quantumDynamics:t.quantumDynamics,chemicalReactions:t.chemicalReactions},a=t.elements,w.createElements(a),function(){var t,e,n,i;for(n=R.getNumberOfElements();n<=Kn.lastElementID;n++)w.addElement({id:n});for(n=0,i=Xn.length;n<i;n++)t=18*Math.pow(Xn[n].volume/Xn[0].volume,.3333333333333),e=Ii.a.convert(t/10,{from:Ii.a.unit.ANGSTROM,to:Ii.a.unit.NANOMETER}),R.setElementProperties(Kn.firstElementID+n,{mass:Xn[n].molWeight,sigma:e})}(),A.mixInto(w),G=w.properties,q=G.minX,Y=G.minY,X=G.maxX,Q=G.maxY,G.minX=null!=q?q:0,G.maxX=null!=X?X:G.width,G.minY=null!=Y?Y:0,G.maxY=null!=Q?Q:G.height,w.on("stop.last-sample-time-reset",(function(){i=null})),M.on("afterInvalidatingChange.read-model-state",$),M.on("afterInvalidatingChangeSequence.tick-history",(function(){r&&r.invalidateFollowingState(),E.invalidation()})),function(t,e){R.setDimensions([t.minX,t.minY,t.maxX,t.maxY]),e.quantumDynamics?(t.useQuantumDynamics=!0,R.addPlugin(new _e(R,e.quantumDynamics))):t.useQuantumDynamics=!1,e.chemicalReactions?(t.useChemicalReactions=!0,R.addPlugin(new ur(R,e.chemicalReactions))):t.useChemicalReactions=!1,s=R.elements,f=R.radialBonds,m=R.angularBonds,g=R.restraints,l=R.obstacles,u=R.shapes,c=R.lines,d=R.electricFields}(w.properties,b),o=new Ki(w),w.set({polarAAEpsilon:w.get("polarAAEpsilon")}),t.atoms&&w.createAtoms(t.atoms),t.radialBonds&&w.createRadialBonds(t.radialBonds),t.angularBonds&&w.createAngularBonds(t.angularBonds),t.restraints&&w.createRestraints(t.restraints),t.obstacles&&w.createObstacles(t.obstacles),t.shapes&&w.createShapes(t.shapes),t.lines&&w.createLines(t.lines),t.electricFields&&w.createElectricFields(t.electricFields),t.pairwiseLJProperties&&R.pairwiseLJProperties.deserialize(t.pairwiseLJProperties),r=new Yn({getProperties:function(){return M.historyStateRawValues},restoreProperties:M.setRawValues,state:R.getState()},w,1e3),A.tickHistory=r,new Un({propertySupport:M,unitsDefinition:S,tickHistory:r}).mixInto(w),D=!0,w.defineOutput("time",{label:"Time",unitType:"time",format:"f"},(function(){var t=I.time;return k&&(t=k.translateFromModelUnits(t,"time")),t})),w.defineOutput("timePerTick",{label:"Model time per tick",unitType:"time",format:"f"},(function(){return w.get("timeStep")*w.get("timeStepsPerTick")})),S.units.time.displayValue?K=S.units.time.displayValue:(K=h.a.extend({},S.units.time)).unitsPerBaseUnit=1,J=new Bn(K,{unitName:K.name,unitPluralName:K.pluralName,unitAbbreviation:K.symbol,format:".1f"}),w.defineOutput("displayTime",{label:"Time",unitName:K.name,unitPluralName:K.pluralName,unitAbbreviation:K.symbol,format:".1f"},(function(){return w.get("time")*K.unitsPerBaseUnit})),w.defineOutput("displayTimePerTick",{label:"Model time per tick",unitName:K.name,unitPluralName:K.pluralName,unitAbbreviation:K.symbol,format:".3f"},(function(){return w.get("timePerTick")*K.unitsPerBaseUnit})),w.formatTime=function(t){return J.format(t*K.unitsPerBaseUnit)},w.defineOutput("tickCounter",{label:"Tick Counter",unitType:"",format:"4g"},(function(){return r.get("counter")})),w.defineOutput("newStep",{label:"New Step",unitType:"",format:""},(function(){return D})),w.defineOutput("kineticEnergy",{label:"Kinetic Energy",unitType:"energy",format:".4g"},(function(){var t=I.KE;return k&&(t=k.translateFromModelUnits(t,"energy")),t})),w.defineOutput("potentialEnergy",{label:"Potential Energy",unitType:"energy",format:".4g"},(function(){var t=I.PE;return k&&(t=k.translateFromModelUnits(t,"energy")),t})),w.defineOutput("totalEnergy",{label:"Total Energy",unitType:"energy",format:".4g"},(function(){var t=I.KE+I.PE;return k&&(t=k.translateFromModelUnits(t,"energy")),t})),w.defineOutput("temperature",{label:"Temperature",unitType:"temperature",format:"f"},(function(){var t=I.temperature;return k&&(t=k.translateFromModelUnits(t,"temperature")),t})),w.on("play.model",Z),w.on("stop.model",Z),w.defineOutput("isPlayable",{label:"Playable"},(function(){return w.isReady&&w.isStopped()})),w.defineOutput("hasPlayed",{label:"has Played"},(function(){return w.hasPlayed})),w.defineOutput("isStopped",{label:"Stopped?"},(function(){return w.isStopped()})),$(),w.updateAllOutputProperties(),e.waitForSetup||w.ready(),w.performanceOptimizer=new Zi(w),w.namespace=C,w}var dr=0;function pr(){return dr++}var fr={},mr={get cssPointerEvents(){return void 0===fr.cssPointerEvents&&(fr.cssPointerEvents=function(){var t,e,n,i;switch(t=$("<div class='supported'>").css({position:"fixed",left:0,top:0,width:"10px",height:"10px"}).appendTo("body"),e=$("<div class='unsupported'>").css({position:"fixed",left:0,top:0,width:"10px",height:"10px","pointer-events":"none"}).appendTo("body"),n=$("<svg class='unsupported'>").css({position:"fixed",left:0,top:0,width:"10px",height:"10px","pointer-events":"none"}).appendTo("body"),i=$(document.elementFromPoint(5,5)).attr("class"),n.remove(),e.remove(),t.remove(),i){case"supported":return!0;case"unsupported":return!1;default:return console.warn("CSS pointer-events feature test failed"),!1}}()),fr.cssPointerEvents}},gr=["mousedown","mouseup","contextmenu"],vr=[];function yr(t,e,n){window.addEventListener(t,e,n),vr.push({type:t,func:e,capture:n})}function br(){}function _r(t){var e,n,i,r,o,a,s,l=mr.cssPointerEvents?"pointerEvents":"visibility",u=mr.cssPointerEvents?"none":"hidden";function c(t,e){var n=document.createEvent("MouseEvent");if(n.initMouseEvent(t.type,t.bubbles,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),n.forwardedTouchEvent=t.forwardedTouchEvent,0===n.pageX&&0===n.pageY&&Object.defineProperty){var i=document.documentElement,r=document.body,o=t.clientX,a=t.clientY;Object.defineProperty(n,"pageX",{get:function(){return o+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0)}}),Object.defineProperty(n,"pageY",{get:function(){return a+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)}})}return n}function h(t){var e=document.createEvent("MouseEvent");return e.initMouseEvent("click",!0,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),e}function d(t){var e=n[t];i[t]=e.style[l],e.style[l]=u}function p(t){for(var e=t;e>=0;e--)n[e].style[l]=i[e]}return e={passMouseMove:function(t,n){var i;function r(t,e,n){var i=document.createEvent("MouseEvent");return i.initMouseEvent(e,t.bubbles,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,n||t.relatedTarget),i}yr("mousemove",(function(o){if(!o.synthetic){var s,l;if(o.target!==t)return i===n&&n.dispatchEvent(r(o,"mouseout",o.target)),void(i=o.target);(s=n)!==i&&n.dispatchEvent(r(o,"mouseover",i)),o.stopPropagation(),o.preventDefault(),o.replacedBySynthetic=!0,(l=c(o)).synthetic=!0,e.hitTestCallback=br,s.dispatchEvent(l),a=l.defaultPrevented,i=s}}),!0)},addLayer:function(t){n.splice(1,0,t)},hitTestCallback:br,mouseupCallback:br},function(){for(var t;vr.length>0;)t=vr.pop(),window.removeEventListener(t.type,t.func,t.capture)}(),n=[t],gr.forEach((function(l){yr(l,(function(l){var u;l.target===t&&(l.stopPropagation(),"mousedown"!==l.type&&l.preventDefault(),u=function(t){var r,s,l,u,h,f;i=[],o=null;for(var m=0,g=n.length;m<g;m++)if(r=n[m],m>0&&d(m-1),"canvas"===r.tagName.toLowerCase()){if(l=c(t),e.hitTestCallback=function(t){u=t,t||(l.stopPropagation(),l.preventDefault())},e.mouseupCallback=function(t){h=t},r.dispatchEvent(l),e.hitTestCallback=br,e.mouseupCallback=br,h&&(o=r),u)return p(m-1),a=l.defaultPrevented,r}else if(f=r.style.backgroundColor,r.style.backgroundColor="rgba(0,0,0,0)",s=document.elementFromPoint(t.clientX,t.clientY),r.style.backgroundColor=f,s!==r)return p(m-1),l=c(t),s.dispatchEvent(l),a=l.defaultPrevented,s;p(n.length-2)}(l),"mousedown"===l.type?r=u:"mouseup"===l.type&&(u&&u===r&&"canvas"!==u.tagName.toLowerCase()&&!s&&u.dispatchEvent(h(l)),o&&!s&&o.dispatchEvent(h(l))))}),!0)})),yr("click",(function(e){e.target===t&&(e.stopPropagation(),e.preventDefault())}),!0),function(t){var e,n,i=null;function r(t,e){var n=document.createEvent("MouseEvent");return n.initMouseEvent(e,!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,n}function o(t){return Math.abs(t.screenX-e)>10||Math.abs(t.screenY-n)>10}function l(t){if(null!==i){if("touchmove"===t.type&&t.touches.length>1)return s=!0,void t.stopPropagation();var e,n,l,u,c;for(e=0,n=t.changedTouches.length;e<n;e++)if((l=t.changedTouches[e]).identifier===i)return 1===n&&t.stopPropagation(),u=document.elementFromPoint(l.clientX,l.clientY)||window,"touchmove"===t.type?(s||(s=o(l)),c=r(l,"mousemove"),u.dispatchEvent(c),c.replacedBySynthetic||(a=c.defaultPrevented)):"touchend"===t.type?(u.dispatchEvent(r(l,"mouseup")),i=null):"touchcancel"===t.type&&(s=!0,u.dispatchEvent(r(l,"mouseup")),i=null),void(("touchend"===t.type||a)&&t.preventDefault())}}yr("touchstart",(function(o){var l=o.changedTouches[0];o.touches.length>1||l.target!==t||(s=!1,e=l.screenX,n=l.screenY,i=l.identifier,t.dispatchEvent(r(l,"mousedown")),a&&o.preventDefault(),o.stopPropagation())}),!0),["touchmove","touchend","touchcancel"].forEach((function(t){yr(t,l,!0)}))}(t),e}var xr=n(7),wr=n.n(xr);function Cr(t,e){if(null==Cr.instance){var n,i=We.browser;n="Firefox"===i.browser&&i.oscpu.match(/Mac OS X 10.6/)?function(t,e,n,i){return new wr.a.CanvasRenderer(t,e,n,i)}:wr.a.autoDetectRenderer,Cr.instance=n(2*t,2*e,null,!0)}else Cr.instance.resize(t,e);return Cr.instance}function Tr(t,e,n,i){var r,o,a,s,l,u,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k=i&&i.i18n||null,A=i&&i.origin||"bottom-left",E=0,M=d3.scale.linear(),P=d3.scale.linear(),D=d3.scale.linear(),O=d3.scale.linear(),I=d3.dispatch("viewportDrag");function L(){return E++}function R(){return parseFloat(o.css("font-size"))||18}function N(){F()}function F(){t.get("enableKeyboardHandlers")&&a.focus()}function B(){return this.attr({xmlns:"http://www.w3.org/2000/svg","xmlns:xmlns:xlink":"http://www.w3.org/1999/xlink",overflow:"hidden"})}function z(){return this.style({position:"absolute",top:0,left:0})}function j(){var e,n,i,w,C,S,k;void 0===s&&(s=d3.select(a).append("svg").attr("class","root-layer container plot-container").style("z-index",L()).call(B),c=s.append("rect").attr("class","container-background background"),l=d3.select(a).append("svg").attr("class","root-layer container background-container svg-viewport").style("z-index",L()).call(B),h=l.append("g"),u=d3.select(a).append("svg").attr("class","root-layer container foreground-container svg-viewport").style("z-index",1e3).style("background-color","rgba(0,0,0,0)").on("contextmenu",(function(){d3.event.preventDefault()})).call(B),d=u.append("g"),p=u.append("g").attr("class","brush-container"),d3.select(a).selectAll(".root-layer").call(z),t.get("enableKeyboardHandlers")&&d3.select(a).attr("tabindex",0).on("mousedown",N),f=[],m=[],g=[],(v=new _r(u.node())).addLayer(s.node()),v.addLayer(l.node())),w=t.get("viewPortWidth"),C=t.get("viewPortHeight"),S=t.get("viewPortX"),k=t.get("viewPortY"),x=t.get("viewPortZoom")||1,i={minX:t.get("minX"),minY:t.get("minY"),maxX:t.get("maxX"),maxY:t.get("maxY")},(_={width:null!=w?w:i.maxX-i.minX,height:null!=C?C:i.maxY-i.minY,x:null!=S?S:i.minX,y:null!=k?k:i.minY}).scaledWidth=_.width/x,_.scaledHeight=_.height/x,"bottom-left"===A&&(_.y+=_.scaledHeight),n=_.width/_.height,y=o.width(),b=y/n,a.style.height=b+"px",D.domain([0,_.width]).range([0,y]),M.domain([0,_.scaledWidth]).range([0,2*y]),O.domain([_.height,0]).range("bottom-left"===A?[0,b]:[b,0]),P.domain([_.scaledHeight,0]).range("bottom-left"===A?[0,2*b]:[2*b,0]),T&&T.x(D).y(O),d3.select(a).selectAll(".root-layer").attr({width:y,height:b}).style({width:y+"px",height:b+"px"}),f.forEach((function(t){t.resize(2*y,2*b),$(t.view).css({width:y,height:b})})),e=D(_.x)+" "+O(_.y)+" "+D(_.scaledWidth)+" "+D(_.scaledHeight),d3.select(a).selectAll(".svg-viewport").attr({viewBox:e,x:0,y:0,width:D(_.width),height:D(_.height)}),g.forEach((function(t){t.pivot.x=M(_.x),t.pivot.y=P(_.y)})),c.attr({width:D(_.width),height:D(_.height),x:0,y:0}),function(){var e,n,i=.7*R(),r=d3.scale.linear().domain([_.x+.07*_.scaledWidth,_.x+_.scaledWidth]).range([.07*y,y]),o=d3.scale.linear().domain([_.y,_.y-.93*_.scaledHeight]).range([0,.93*b]),a=function(t){return"translate("+r(t)+",0)"},l=function(t){return"translate(0,"+o(t)+")"},u=function(t){return t?"#ccc":"#666"},c=r.tickFormat(5),h=o.tickFormat(5),d=t.getUnitDefinition?t.getUnitDefinition("length"):"",p=t.get("xunits"),f=t.get("yunits"),m=t.get("xlabel"),g=t.get("ylabel");d3.event&&d3.event.transform&&d3.event.transform(r,o),s.selectAll("g.x, g.y").remove();var v=s.selectAll("g.x").data(r.ticks(5),String).attr("transform",a).classed("axes",!0);v.select("text").text(c);var x=v.enter().append("g").attr("class","x").attr("transform",a);t.get("gridLines")?x.append("line").attr("stroke",u).attr("y1",0).attr("y2",b-(m?i:0)-(p?i:0)):x.selectAll("line").remove(),(e=s.selectAll("text.xlabel").data(m?[d.pluralName]:[])).enter().append("text"),e.attr("class","axis").attr("class","xlabel").attr("x",y/2).attr("y",b).attr("dy","-0.1em").style("text-anchor","middle").text(String),e.exit().remove(),p?x.append("text").attr("class","xunits").attr("y",b).attr("dy",t.get("xlabel")?"-1em":"-0.1em").attr("text-anchor","middle").text(c):x.select("text.xunits").remove();var w=s.selectAll("g.y").data(o.ticks(5),String).attr("transform",l).classed("axes",!0);w.select("text").text(h);var C=w.enter().append("g").attr("class","y").attr("transform",l).attr("background-fill","#FFEEB6");t.get("gridLines")?C.append("line").attr("stroke",u).attr("x1",(g?i:0)+(f?2*i:0)).attr("x2",y):C.selectAll("line").remove(),(n=s.selectAll("text.ylabel").data(g?[d.pluralName]:[])).enter().append("text"),n.attr("class","axis").attr("class","ylabel").attr("transform","translate(0 "+.5*b+") rotate(-90)").attr("dy","0.75em").style("text-anchor","middle").text(String),n.exit().remove(),f?C.append("text").attr("class","yunits").attr("dy","0.34em").attr("dx",t.get("ylabel")?"1em":"0.1em").text(h):x.select("text.yunits").remove()}(),r.renderCanvas()}function V(){var e,n,i,r,o=[],a=[],l=[],u=!1,c=t.properties.viewPortDrag||!1;function h(){o.push(t.properties.viewPortX),a.push(t.properties.viewPortY),l.push(An.now()),o.length>8&&(o.shift(),a.shift(),l.shift())}function d(){if(u)return!0;var r=An.now(),o=r-i,a=-.003*e,s=-.003*n;return t.properties.viewPortX+=e*o+.5*a*o*o,t.properties.viewPortY+=n*o+.5*s*o*o,I.viewportDrag(),e+=a*o,n+=s*o,i=r,Math.abs(e)<1e-5&&Math.abs(n)<1e-5}!1!==c?((r=d3.behavior.drag()).on("dragstart",(function(){u=!0,o.length=0,a.length=0,l.length=0,h(),d3.select(window).on("mousemove.viewport-drag",(function(){d3.event.preventDefault()}))})).on("drag",(function(){var e="y"===c?0:D.invert(d3.event.dx),n="x"===c?0:D.invert(d3.event.dy);t.properties.viewPortX-=e,t.properties.viewPortY+=n,I.viewportDrag(),h()})).on("dragend",(function(){d3.select(window).on("mousemove.viewport-drag",null),h();var t=o.length-1,r=l[t]-l[0];r<1e-5||l[t]-l[t-1]>100||(e=(o[t]-o[0])/r,n=(a[t]-a[0])/r,i=l[t],u=!1,d3.timer(d))})),s.call(r).classed("draggable",!0)):s.on("mousedown.drag",null).on("touchstart.drag",null).classed("draggable",!1)}function H(){j(),V(),w={},C={},t.addPropertiesListener(["backgroundColor"],r.repaint),t.addPropertiesListener(["gridLines","xunits","yunits","xlabel","ylabel","viewPortX","viewPortY","viewPortZoom"],j),t.addPropertiesListener(["viewPortDrag"],V)}return r={get $el(){return o},get node(){return a},get foregroundContainer(){return u},get model2px(){return D},get model2canvas(){return M},get model2pxInv(){return O},get model2canvasInv(){return P},get i18n(){return k},get setFocus(){return F},get fontFamily(){return this.$el.css("font-family")},get getFontSizeInPixels(){return R},get url(){return e},get clickHandler(){return w},get dragHandler(){return C},get hitTestCallback(){return v.hitTestCallback},get mouseupCallback(){return v.mouseupCallback},repaint:function(){var e;e=t.get("backgroundColor")||"rgba(0, 0, 0, 0)",c.attr("fill",e),m.forEach((function(t){t.setBackgroundColor(parseInt(d3.rgb(e.replace("rgba","rgb")).toString().substr(1),16))})),S.repaint&&S.repaint(),r.updateClickHandlers(),r.renderCanvas()},appendViewport:function(){return(f.length>0?d:h).append("g")},appendPixiViewport:function(){var t,e;0===f.length&&(t=Cr(y,b),e=new wr.a.Stage(null),a.appendChild(t.view),d3.select(t.view).attr("class","pixi-viewport").style("z-index",L()).call(z),f.push(t),m.push(e),v.addLayer(t.view),v.passMouseMove(u.node(),f[0].view));var n=new wr.a.DisplayObjectContainer;return m[0].addChild(n),g.push(n),{pixiContainer:n,canvas:f[0].view}},resize:function(){j(),r.repaint(),T&&p.select("g.select-area").call(T),S.resize&&S.resize(),r.renderCanvas()},setup:function(){S.setup&&S.setup(t),r.renderCanvas()},update:function(){S.update&&S.update(),r.renderCanvas()},renderCanvas:function(){var t,e;for(t=0,e=f.length;t<e;t++)f[t].render(m[t])},getHeightForWidth:function(t){return t/(_.width/_.height)},bindModel:function(n,i){e=i||e,t=n||t,function(){var t;for(t in w)w.hasOwnProperty(t)&&s.selectAll(t).on("click.custom",null)}(),r.setSelectHandler(null),H(),S.bindModel&&S.bindModel(n,i)},pos:function(){var t={bottom:0,top:0,height:0,left:0,right:0,width:0};return o&&(t.top=o.position().top,t.left=o.position().left,t.width=o.width(),t.height=o.height(),t.bottom=t.top+t.height,t.right=t.left+t.width),t},on:function(t,e){I.on(t,e)},setClickHandler:function(t,e){if("function"!=typeof e)throw new Error("Click handler should be a function.");w[t]=e,r.updateClickHandlers()},updateClickHandlers:function(){var t;function e(t){return function(e,n){if(!d3.event.defaultPrevented){var i=d3.mouse(c.node()),r=D.invert(i[0]),o=O.invert(i[1]);$n.a.log("[view] click at ("+r.toFixed(3)+", "+o.toFixed(3)+")"),t(r,o,e,n)}}}for(t in w)w.hasOwnProperty(t)&&d3.selectAll(t).on("click.custom",e(w[t]))},setSelectHandler:function(t){if("function"!=typeof t&&null!==t)throw new Error("Select handler should be a function or null.");p.select("g.select-area").remove(),null!==t?(T=d3.svg.brush().x(D).y(O).on("brushstart.select",(function(){d3.select(window).on("mousemove.select",(function(){d3.event.preventDefault()}))})).on("brushend.select",(function(){d3.select(window).on("mousemove.select",null);var e=T.extent(),n=e[0][0],i=e[0][1],r=e[1][0]-n,o=e[1][1]-i;$n.a.log("[view] selection area ("+n.toFixed(3)+", "+i.toFixed(3)+"), width: "+r+", height: "+o),t(n,i,r,o),T.clear(),p.select("g.select-area").call(T)})),p.append("g").classed("select-area",!0).call(T)):T=null},setDragHandler:function(t,e){C[t]=e}},o=$("<div>").attr({id:"model-container",class:"container",tabindex:pr}).css({width:"50px",height:"50px"}),a=o[0],t&&H(),S=new n(r,t),r}Cr.instance=null;var Sr=n(188),kr=n.n(Sr);function Ar(t){var e=t.match(/rgba\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+(?:\.\d+)?)\)/i);return null!==e?{rgb:d3.rgb(e[1],e[2],e[3]),a:Number(e[4])}:{rgb:d3.rgb(t),a:1}}var Er={d3rgba:Ar,contrastingColor:function(t){return(299*(t=Ar(t).rgb).r+587*t.g+114*t.b)/1e3>=128?"#000":"#fff"},color2number:function(t){return parseInt(Ar(t).rgb.toString().substr(1),16)}},Mr=function(t,e){var n=e?"slideDown":"show",i=e?"slideUp":"hide";return"hydrophobic"===t?($(".".concat("hydrophobic"))[n](),$(".".concat("hydrophilic"))[i](),$(".".concat("hydrophobic-category")).addClass("expanded"),$(".".concat("hydrophilic-category")).removeClass("expanded")):($(".".concat("hydrophobic"))[i](),$(".".concat("hydrophilic"))[n](),$(".".concat("hydrophobic-category")).removeClass("expanded"),$(".".concat("hydrophilic-category")).addClass("expanded"))},Pr=function(t,e,n,i){var r=e.i18n;return $.contextMenu("destroy",n),$.contextMenu({selector:n,appendTo:".lab-responsive-content",className:"aminoacids-menu",animation:{show:"show",hide:"hide"},trigger:"left",callback:function(n,r){var o=i(),a=Kn.getAminoAcidByElement(o.element).abbreviation;r.items[a].$node.removeClass("marked");var s=Kn.abbrToElement(n);return t.setAtomProperties(o.idx,{element:s}),e.repaint()},position:function(t,e,n){var i,r=$(window);if(e||n){"maintain"===e&&"maintain"===n?i=t.$menu.position():(t.$trigger.parents().andSelf().filter((function(){return"fixed"===$(this).css("position")})).length&&(n-=r.scrollTop(),e-=r.scrollLeft()),i={top:n,left:e});var o=r.scrollTop()+r.height(),a=r.scrollLeft()+r.width(),s=t.$menu[0].scrollHeight,l=t.$menu[0].scrollWidth;return i.top+s>o&&(i.top-=s),i.left+l>a&&(i.left-=l),i.left+=1,t.$menu.css(i)}t.determinePosition.call(this,t.$menu)},events:{show:function(t){var e=i(),n=e&&Kn.getAminoAcidByElement(e.element);if(!e||!n)return!1;var r=n.abbreviation,o=t.items[r].$node;return o.addClass("marked"),o.hasClass("hydrophobic")?Mr("hydrophobic"):Mr("hydrophilic"),!0},hide:function(t){var e=i(),n=Kn.getAminoAcidByElement(e.element).abbreviation;return t.items[n].$node.removeClass("marked"),!0}},items:{Hydrophobic:{name:r.t("md2d.aminoacid_menu.hydrophobic"),className:"".concat("hydrophobic-category"),callback:function(){return Mr("hydrophobic",!0),!1}},Gly:{name:r.t("md2d.aminoacid_menu.glycine"),className:"".concat("hydrophobic")},Ala:{name:r.t("md2d.aminoacid_menu.alanine"),className:"".concat("hydrophobic")},Val:{name:r.t("md2d.aminoacid_menu.valine"),className:"".concat("hydrophobic")},Leu:{name:r.t("md2d.aminoacid_menu.leucine"),className:"".concat("hydrophobic")},Ile:{name:r.t("md2d.aminoacid_menu.isoleucine"),className:"".concat("hydrophobic")},Phe:{name:r.t("md2d.aminoacid_menu.phenylalanine"),className:"".concat("hydrophobic")},Pro:{name:r.t("md2d.aminoacid_menu.proline"),className:"".concat("hydrophobic")},Trp:{name:r.t("md2d.aminoacid_menu.tryptophan"),className:"".concat("hydrophobic")},Met:{name:r.t("md2d.aminoacid_menu.methionine"),className:"".concat("hydrophobic")},Cys:{name:r.t("md2d.aminoacid_menu.cysteine"),className:"".concat("hydrophobic")},Tyr:{name:r.t("md2d.aminoacid_menu.tyrosine"),className:"".concat("hydrophobic")},Hydrophilic:{name:r.t("md2d.aminoacid_menu.hydrophilic"),className:"".concat("hydrophilic-category"),callback:function(){return Mr("hydrophilic",!0),!1}},Asn:{name:r.t("md2d.aminoacid_menu.asparagine"),className:"".concat("hydrophilic")},Gln:{name:r.t("md2d.aminoacid_menu.glutamine"),className:"".concat("hydrophilic")},Ser:{name:r.t("md2d.aminoacid_menu.serine"),className:"".concat("hydrophilic")},Thr:{name:r.t("md2d.aminoacid_menu.threonine"),className:"".concat("hydrophilic")},Asp:{name:r.t("md2d.aminoacid_menu.asparticacid"),className:"".concat("hydrophilic"," ").concat("neg-charge")},Glu:{name:r.t("md2d.aminoacid_menu.glutamicacid"),className:"".concat("hydrophilic"," ").concat("neg-charge")},Lys:{name:r.t("md2d.aminoacid_menu.lysine"),className:"".concat("hydrophilic"," ").concat("pos-charge")},Arg:{name:r.t("md2d.aminoacid_menu.arginine"),className:"".concat("hydrophilic"," ").concat("pos-charge")},His:{name:r.t("md2d.aminoacid_menu.histidine"),className:"".concat("hydrophilic"," ").concat("pos-charge")}}}),Mr("hydrophobic")},Dr={};function Or(t,e,n,i){return Math.atan2(n-t,i-e)}function Ir(t,e,n){return{x:t*Math.cos(n)-e*Math.sin(n),y:t*Math.sin(n)+e*Math.cos(n)}}function Lr(t,e,n){var i,r,o,a,s,l,u,c,h,p,f,m,g,v,y,b;function _(i,r,o,a){if(0===a.button){var u=null;if(function(t){if(!t)return!1;return A(t)&&e.isStopped()&&e.getMoleculeAtoms(t.idx).length>0}(o)){var c="translate"===e.get("onAtomDrag")?["translate","rotate"]:["rotate","translate"];u=a.altKey?c[1]:c[0]}else A(o)&&(u="translate");null!==u&&function(i,r){var o,a,u,c,h,p="translate"===r;$(window).on("mousemove.lab-drag",(function(n){n.preventDefault();var r=D(n,!0),d=r.x,f=r.y;if(!y){if(o=function(t){return e.getMoleculeAtoms(t.idx).concat(t.idx).map((function(t){var n=e.getAtomProperties(t);return{idx:t,x:n.x,y:n.y}}))}(i),p)!e.isStopped()&&i.draggable&&e.liveDragStart(i.idx);else{u=e.getMoleculeAtoms(i.idx).concat(i.idx);var m=e.getMoleculeBoundingBox(i.idx);c=.5*(i.x+m.left+i.x+m.right),h=.5*(i.y+m.top+i.y+m.bottom),a=Or(c,h,d,f)}v=!0,y=!0}if(p)!function(t,n,i){var r=e.getMoleculeBoundingBox(t.idx);r.left+n<0&&(n=0-r.left);r.right+n>s&&(n=s-r.right);r.bottom+i<0&&(i=0-r.bottom);r.top+i>l&&(i=l-r.top);e.isStopped()?(o=t.idx,a=n,u=i,e.setAtomProperties(o,{x:a,y:u},!1,!0)):e.liveDrag(n,i);var o,a,u}(i,d,f);else{var g=Or(c,h,d,f);!function(t,n,i,r){if(0===r)return;for(var o=!0,a=0,s=t.length;a<s;a++){var l=t[a],u=e.getAtomProperties(l),c=Ir(u.x-n,u.y-i,r),h=O(l,c.x+n,c.y+i);o=o&&h}}(u,c,h,a-g),a=g}M("move"),t.dragHandler.atom&&t.dragHandler.atom(d,f,i,i.idx),t.update()})).on("selectstart.lab-drag",(function(t){t.preventDefault()})).one("mouseup.lab-drag",(function(r){var a;($(window).off(".lab-drag"),y)&&(v=!1,r.preventDefault(),function(t){if(t.target!==n)return void M("auto");var e=D(t);E(P(e.x,e.y))}(r),p&&!e.isStopped()&&e.liveDragEnd(),e.isStopped()&&(a=i.idx,e.setAtomProperties(a,{},!0,!0)||(Object(d.a)(t.i18n.t("md2d.invalid_object_position_alert")),o.forEach((function(t){O(t.idx,t.x,t.y)})),t.update())))}))}(m,u)}}function x(e){var n=D(e);m=P(n.x,n.y),g=null,y=!1,t.hitTestCallback(!!m),m&&_(n.x,n.y,m,e)}function w(e){var n=D(e),i=P(n.x,n.y);t.hitTestCallback(!!i),n.x,n.y,v||E(i)}function C(e){var n,i,r,o=D(e),a=P(o.x,o.y),s=!1;t.hitTestCallback(!!a),a&&(o.x,o.y,a===m&&(s=!0,n=o.x,i=o.y,r=m,!y&&t.clickHandler[".atom"]&&t.clickHandler[".atom"](n,i,r,r.idx))),t.mouseupCallback(s),m=null}function T(t){}function S(t){var e=D(t);e.x,e.y,M("auto")}function k(e){var n=D(e);g=!y&&P(n.x,n.y),t.hitTestCallback(!!g),g&&(n.x,n.y)}function A(t){return!!t&&(e.isStopped()?t.draggableWhenStopped||e.properties.isBeingEdited:t.draggable)}function E(t){A(t)?M("move"):M("auto")}function M(t){b!==t&&(b=t,document.documentElement.style.cursor=t)}function P(t,e){for(var n,i,r,o,s=a.length-1;s>=0;s--)if(i=(n=a[s]).x,r=n.y,t>i-(o=n.radius)&&t<i+o&&e>r-o&&e<r+o)return n;return null}function D(t,n){return n||(c=u.offset(),h=u.attr("width")/u.width(),p=e.get("viewPortX")||0,f=e.get("viewPortY")||0),Dr.x=r.invert((t.pageX-c.left)*h)+p,Dr.y=o.invert((t.pageY-c.top)*h)+f,Dr}function O(t,n,i){return e.setAtomProperties(t,{x:n,y:i})}return i={bindModel:function(n){a=(e=n).getAtoms(),s=e.get("width"),l=e.get("height"),Pr(e,t,".atoms-interaction-layer",(function(){return g}))}},r=t.model2canvas,o=t.model2canvasInv,(u=$(n)).addClass("atoms-interaction-layer"),u.on("mousedown.atoms-interactions",x),u.on("mouseup.atoms-interactions",C),u.on("mousemove.atoms-interactions",w),u.on("mouseover.atoms-interactions",T),u.on("mouseout.atoms-interactions",S),u.on("contextmenu.atoms-interactions",k),i.bindModel(e),i}var Rr=["#FFFFFF","#F2F2F2","#A4A4A4"],Nr=["#FFFFFF","#FF8080","#FF2020"],Fr=["#FFFFFF","#f2f2f2","#A4A4A4"],Br=d3.scale.linear().interpolate(d3.interpolateRgb).range(["#FFFFFF","#ffefff"]),zr=d3.scale.linear().interpolate(d3.interpolateRgb).range(["#f2f2f2","#9090FF"]),jr=d3.scale.linear().interpolate(d3.interpolateRgb).range(["#A4A4A4","#3030FF"]),Vr=d3.scale.linear().interpolate(d3.interpolateRgb).range(["#FFFFFF","#dfffff"]),Hr=d3.scale.linear().interpolate(d3.interpolateRgb).range(["#f2f2f2","#FF8080"]),Wr=d3.scale.linear().interpolate(d3.interpolateRgb).range(["#A4A4A4","#FF2020"]),Ur=function(t,e){var n=Math.round(25*Math.min(Math.abs(t)/3,1));return n/=25,"biology"===e&&t>0||"chemistry"===e&&t<0?[Br(n),zr(n),jr(n)]:"biology"===e&&t<0||"chemistry"===e&&t>0?[Vr(n),Hr(n),Wr(n)]:Fr},$r=function(t){return t>0?["#F0E6D1","#E0A21B","#AD7F1C"]:["#dfffef","#75a643","#2a7216"]},Gr=["keShading","chargeShading","chargeShadingStyle","atomNumbers","showChargeSymbols","atomRadiusScale","aminoAcidColorScheme","aminoAcidLabels","useThreeLetterCode","viewPortZoom"];function qr(t,e,n,i){var r,o,a,s,l,u,c={},h={},d=new Lr(t,e,i);function p(){e.get("width"),e.get("height"),f(),e.addPropertiesListener(Gr,(function(){f(),r.setup(),t.renderCanvas()}))}function f(){Gr.forEach((function(t){h[t]=e.get(t)}))}function m(t){var n,i,r=l[t],o=r.element,a=e.getElementProperties(o);if(r.marked)return n=e.get("markColor"),[(i=d3.rgb(n)).brighter(1).toString(),i.toString(),i.darker(1).toString()];if(r.aminoAcid)switch(h.aminoAcidColorScheme){case"charge":return Ur(r.charge,h.chargeShadingStyle);case"hydrophobicity":return $r(r.hydrophobicity);case"chargeAndHydro":return 0!==r.charge?Ur(r.charge,h.chargeShadingStyle):$r(r.hydrophobicity)}return h.keShading?Rr:h.chargeShading?Ur(r.charge,h.chargeShadingStyle):("number"==typeof a.color?(n=(a.color+Math.pow(2,24)).toString(16),n="000000".substr(0,6-n.length)+n,i=d3.rgb("#"+n)):i=Er.d3rgba(a.color).rgb,[i.brighter(1).toString(),i.toString(),i.darker(1).toString()])}function g(t){var n=l[t],i=n.element,r=e.getElementProperties(i);return n.marked||n.aminoAcid||h.keShading||h.chargeShading?n.visible:"number"==typeof r.color?n.visible:Er.d3rgba(r.color).a*n.visible}function v(n,i){var r,o=l[n].element,s=a(e.getElementProperties(o).radius)*h.atomRadiusScale,u=l[n].excitation,d=function(t){var e="",n=0;h.atomNumbers?(e=t,n=1.2):h.aminoAcidLabels&&h.useThreeLetterCode&&l[t].label?(e=l[t].label,n=1):h.aminoAcidLabels&&!h.useThreeLetterCode&&l[t].symbol?(e=l[t].symbol,n=1.4):h.showChargeSymbols&&(l[t].charge>0?e="+":l[t].charge<0&&(e="-"),n=1.6);return{text:e,fontSize:16*n}}(n),p=g(n);if(i=i||m(n),r=p>0?o+"-"+s+"-"+i.join("")+"-"+p+"-"+d.text+"-"+u+"-"+d.fontSize:s+"-invisible",void 0===c[r]){var f,v=document.createElement("canvas");Pe({font:t.fontFamily,weight:"bold",onchange:y}),f={width:u?4*s:2*s,height:u?4*s:2*s,lightCol:i[0],medCol:i[1],darkCol:i[2],opacity:p,label:d.text,fontSize:d.fontSize,fontFamily:t.fontFamily,excited:u},kr()(v,qe.a.render('<svg x="0px" y="0px" width="{{ width }}px" height="{{ height }}px"        viewBox="0 0 32 32" xml:space="preserve">         <style type="text/css">         <![CDATA[           text {             font-family: {{{ fontFamily }}};             font-size: {{ fontSize }}px;             font-weight: bold;             fill: #222;           }           .shadow {             stroke: rgba(255, 255, 255, 0.7);             stroke-width: 3px;           }         ]]>         </style>          <defs>             <radialGradient id="grad" cx="50%" cy="47%" r="53%" fx="35%" fy="30%">               <stop style="stop-color:{{ lightCol }}" offset="0%"/>               <stop style="stop-color:{{ medCol }}" offset="40%"/>               <stop style="stop-color:{{ darkCol }}" offset="80%"/>               <stop style="stop-color:{{ medCol }}" offset="100%"/>             </radialGradient>          </defs>          <g opacity="{{ opacity }}">            {{#excited}}             <circle fill="#ffe600" cx="16" cy="16" r="12"/>             <circle fill="{{ medCol }}" cx="16" cy="16" r="8"/>             <circle fill="url(#grad)" cx="16" cy="16" r="8"/>            {{/excited}}            {{^excited}}             <circle fill="{{ medCol }}" stroke="{{ darkCol }}" cx="16" cy="16" r="14"/>             <circle fill="url(#grad)" cx="16" cy="16" r="16"/>            {{/excited}}            <text class="shadow" text-anchor="middle" x="16" y="16" dy="0.31em">{{ label }}</text>            <text text-anchor="middle" x="16" y="16" dy="0.31em">{{ label }}</text>          </g>        </svg>',f)),v.width<2&&(v.width=2),v.height<2&&(v.height=2),c[r]=new wr.a.Texture.fromCanvas(v),v.svg.stop()}return c[r]}function y(){c={},u.forEach((function(t,e){t.setTexture(v(e))})),t.renderCanvas()}return r={setup:function(){var i,c,d,p;for(o&&n.removeChild(o),o=new wr.a.DisplayObjectContainer,n.addChild(o),a=t.model2canvas,s=t.model2canvasInv,u=[],i=0,c=(l=e.getAtoms()).length;i<c;++i)(d=new wr.a.Sprite(v(i))).anchor.x=.5,d.anchor.y=.5,d.i=i,d.marked=l[i].marked,u.push(d),o.addChild(d);if(h.keShading)for(i=0,c=l.length;i<c;++i)(p=new wr.a.Sprite(v(i,Nr))).anchor.x=.5,p.anchor.y=.5,u[i].keSprite=p,o.addChild(p);r.update()},bindModel:function(t){e=t,p(),d.bindModel(t)},update:function(){var t,n,i,r,o,c,d,p;for(t=0,n=u.length;t<n;++t)i=u[t],r=l[t],o=a(r.x),c=s(r.y),i.position.x=o,i.position.y=c,r.marked!==i.marked&&(i.setTexture(v(t)),i.marked=l[t].marked),h.keShading&&(d=e.get("keShadingMinEnergy"),p=e.get("keShadingMaxEnergy"),i.keSprite.alpha=Math.min((e.getAtomKineticEnergy(t)-d)/(p-d),1),i.keSprite.position.x=o,i.keSprite.position.y=c),e.properties.useQuantumDynamics&&i.setTexture(v(t))},getAtomColors:m,getAtomOpacity:g},p(),r}var Yr=104,Xr=106,Qr=107,Kr=108,Jr=109,Zr=["keShading","chargeShading","chargeShadingStyle","aminoAcidColorScheme"];function to(t,e,n,i){var r,o,a,s,l,u=new wr.a.Graphics;function c(){e.addPropertiesListener(Zr,(function(){r.setup(),t.renderCanvas()}))}function h(t){var e,n,i,r=o(t.x1),s=a(t.y1),l=o(t.x2),c=a(t.y2),h=l-r,d=c-s,g=Math.sqrt(h*h+d*d)/o(.01),v=Math.floor(24*t.length),y=g/v,b=h/g,_=d/g,x=b*y,w=_*y,C=b*v,T=_*v;for(u.lineStyle(m(t),p(t,1),f(t,1)),u.moveTo(r,s),i=0;i<v;i++)i%2==0?(e=r+(i+.5)*x-.5*T,n=s+(i+.5)*w+.5*C):(e=r+(i+.5)*x+.5*T,n=s+(i+.5)*w-.5*C),u.lineTo(e,n);u.lineTo(l,c)}function d(t){var e=o(t.x1),n=a(t.y1),i=o(t.x2),r=a(t.y2),s=o(l[t.atom1].radius),c=o(l[t.atom2].radius),h=i-e,d=r-n,g=Math.sqrt(h*h+d*d);if(!(2*g-s-c<=0)){var v,y,b,_,x=.5*(g+s-c)/g,w=e+x*h,C=n+x*d,T=m(t),S=p(t,1),k=p(t,2),A=f(t,1),E=f(t,2);t.type===Qr?(v=.4*o(Math.min(l[t.atom1].radius,l[t.atom2].radius)),y=Math.atan2(d,h),b=Math.sin(y)*v,_=-Math.cos(y)*v,u.lineStyle(T,S,A),u.moveTo(e+b,n+_),u.lineTo(w+b,C+_),u.moveTo(e-b,n-_),u.lineTo(w-b,C-_),u.lineStyle(T,k,E),u.moveTo(w+b,C+_),u.lineTo(i+b,r+_),u.moveTo(w-b,C-_),u.lineTo(i-b,r-_)):t.type===Kr?(v=.52*o(Math.min(l[t.atom1].radius,l[t.atom2].radius)),y=Math.atan2(d,h),b=Math.sin(y)*v,_=-Math.cos(y)*v,u.lineStyle(T,S,A),u.moveTo(e,n),u.lineTo(w,C),u.moveTo(e+b,n+_),u.lineTo(w+b,C+_),u.moveTo(e-b,n-_),u.lineTo(w-b,C-_),u.lineStyle(T,k,E),u.moveTo(w,C),u.lineTo(i,r),u.moveTo(w+b,C+_),u.lineTo(i+b,r+_),u.moveTo(w-b,C-_),u.lineTo(i-b,r-_)):t.type!==Yr&&(u.lineStyle(T,S,A),u.moveTo(e,n),u.lineTo(w,C),u.lineStyle(T,k,E),u.moveTo(w,C),u.lineTo(i,r))}}function p(t,e){return t.type===Xr?8947848:t.type===Jr?16771418:1===e?parseInt(i.getAtomColors(t.atom1)[2].substr(1),16):2===e?parseInt(i.getAtomColors(t.atom2)[2].substr(1),16):void 0}function f(t,e){return 1===e?i.getAtomOpacity(t.atom1):2===e?i.getAtomOpacity(t.atom2):void 0}function m(t){if(t.type===Xr)return o(.012);var e=o(Math.min(l[t.atom1].radius,l[t.atom2].radius));return t.type===Qr?.5*e:t.type===Kr?.35*e:.75*e}return r={setup:function(){s=e.getRadialBonds(),l=e.getAtoms(),o=t.model2canvas,a=t.model2canvasInv,r.update()},bindModel:function(t){e=t,c()},update:function(){var t,e,n;for(u.clear(),t=0,e=s.length;t<e;++t)(n=s[t]).type===Xr?h(n):d(n)}},c(),n.addChild(u),r}function eo(t,e){var n,i,r,o,a,s,l,u,c,h,d,p,f,m,g,v;function y(t){var e=a[t],n=u(t),o=c(t),s=h(t)*f,l=d(t)*f,m=Math.sqrt(s*s+l*l),g=Math.PI+Math.atan2(s,l),y=e.arrowHead;v&&(s=.15*f*s/m,l=.15*f*l/m,m=.15*f);var b=i(m);if(b<1)return e.alpha=0,void(y.alpha=0);if(p?(e.alpha=p(t),y.alpha=p(t)):(e.alpha=1,y.alpha=1),b>1e6){var _=b/1e6;s/=_,l/=_,m/=_,b/=_}e.position.x=i(n),e.position.y=r(o),e.scale.y=b,e.rotation=g,y.position.x=i(n+s),y.position.y=r(o+l),y.rotation=g}return n={setup:function(){if(l=e.count,u=e.x,c=e.y,h=e.vx,d=e.vy,p=e.alpha,s=e.show,f=e.length,m=e.width,g=e.color,v=e.dirOnly,i=e.m2px,r=e.m2pxInv,o&&(t.removeChild(o),o=null),s&&0!==l){var y,b,_,x,w,C;for(o=new wr.a.DisplayObjectContainer,t.addChild(o),a=[],w=document.createElement("canvas"),C=w.getContext("2d"),w.width=1,w.height=1,C.fillStyle=g,C.fillRect(0,0,1,1),x=new wr.a.Texture.fromCanvas(w),y=0;y<l;++y)(b=new wr.a.Sprite(x)).anchor.x=.5,b.scale.x=i(m),b.i=y,a.push(b),o.addChild(b);for(x=function(){var t=document.createElement("canvas"),e=t.getContext("2d"),n=i(3.5*m);return t.width=n,t.height=n,e.fillStyle=g,e.beginPath(),e.moveTo(0,0),e.lineTo(n,0),e.lineTo(.5*n,n),e.closePath(),e.fill(),new wr.a.Texture.fromCanvas(t)}(),y=0;y<l;++y)(_=new wr.a.Sprite(x)).anchor.x=.5,a[y].arrowHead=_,o.addChild(_);n.update()}},update:function(){if(s&&0!==l)for(var t=0;t<l;++t)y(t)}}}function no(t,e){var n,i,r,o,a,s,l,u,c,h,d,p,f,m;function g(){var t=document.createElement("canvas"),e=t.getContext("2d"),n=o(f),i=n*(.2+function(t){return 1/(1+Math.exp(-t))}(-8*((n-30)/30-.5))*(1/3-.2));return t.height=n,t.width=i,e.beginPath(),e.moveTo(0,0),e.lineTo(.5*i,n),e.lineTo(i,0),e.fillStyle=m,e.fill(),new wr.a.Texture.fromCanvas(t)}function v(t){var e=r[t],n=u(t),i=c(t);e.position.x=o(n),e.position.y=a(i),e.rotation=Math.PI+Math.atan2(h(t),d(t)),e.alpha=p(t)}return n={setup:function(){var v,y,b;if(l=e.count,u=e.x,c=e.y,h=e.vx,d=e.vy,p=e.alpha,s=e.show,f=e.length,m=e.color,o=e.m2px,a=e.m2pxInv,i&&(t.removeChild(i),i=null),s&&0!==l){for(i=new wr.a.DisplayObjectContainer,t.addChild(i),r=[],b=g(),v=0;v<l;++v)(y=new wr.a.Sprite(b)).anchor.x=.5,y.anchor.y=.5,y.i=v,r.push(y),i.addChild(y);n.update()}},update:function(){if(s&&0!==l)for(var t=0;t<l;++t)v(t)}}}function io(t,e,n){var i,r,o,a,s=[];function l(){i&&(n.removeChild(i),i=null),s=[]}function u(){i=new wr.a.DisplayObjectContainer,n.addChild(i),s=[]}function c(){if(e.properties.showVDWLines){var n,o,l,u,c,h,d,p=e.get_vdw_pairs(),f=e.getAtoms();for(n=s.length;n<p.count;n++)s[n]=new wr.a.Sprite(r),s[n].anchor.y=.5,i.addChild(s[n]);for(n=0;n<p.count;n++)o=f[p.atom1[n]],l=f[p.atom2[n]],h=t.model2canvas(o.x),d=t.model2canvasInv(o.y),u=t.model2canvas(l.x)-h,c=t.model2canvasInv(l.y)-d,s[n].visible=!0,s[n].scale.x=Math.ceil(Math.sqrt(u*u+c*c))/a,s[n].position.x=h,s[n].position.y=d,s[n].rotation=Math.atan2(c,u);for(;n<s.length;n++)s[n].visible=!1}}return{setup:function(){var n;e.properties.showVDWLines?((n=t.model2canvas(.02))!==o&&(r=function(e){var n=document.createElement("canvas"),i=n.getContext("2d"),r=t.model2canvas(.02),o=t.model2canvas(.03),s=e/2;a=5*(o+r)+o,n.width=a,n.height=e,i.strokeStyle="#aaa",i.lineWidth=e;for(var l=0,u=0;u<5;u++)i.moveTo(l,s),i.lineTo(l+o,s),i.stroke(),l+=o+r;return wr.a.Texture.fromCanvas(n)}(o=n),l(),u()),i||u(),c()):l()},update:c,bindModel:function(t){e=t}}}var ro={outline:{A:"M20.7,0.4l-0.075-0.075C20.672,0.273,20.73,0.231,20.8,0.2             c0.122-0.049,0.247-0.058,0.375-0.025c0.031,0.002,0.064,0.011,0.1,0.025c0.151,0.054,0.26,0.154,0.325,0.3l6.35,14.15             c0.026,0.065,0.043,0.132,0.05,0.2c0.092,0.104,0.142,0.229,0.15,0.375c0.01,0.163-0.041,0.304-0.15,0.425l-9.025,9.85             c-1.65,1.667-3.292,3.55-4.925,5.65L0.2,15.65c-0.11-0.121-0.16-0.262-0.15-0.425c0.008-0.146,0.058-0.271,0.15-0.375             c0.005-0.068,0.021-0.134,0.05-0.2L6.6,0.5c0.074-0.146,0.19-0.246,0.35-0.3c0.151-0.064,0.301-0.064,0.45,0             c0.038,0.019,0.071,0.043,0.1,0.075C7.593,0.339,7.66,0.431,7.7,0.55c0.047,0.112-0.012,0.154-0.175,0.125             C7.461,0.656,7.386,0.63,7.3,0.6L1.65,15.125l12.4,13.625l12.6-13.725L20.7,0.4z",C:"M12.45,0c2.167,0.5,4.066,1.95,5.7,4.35             c2.033,2.967,3.05,6.533,3.05,10.7c0,3.8-0.867,7.117-2.6,9.95c-0.067,0.133-0.167,0.217-0.3,0.25c-0.133,0.067-0.267,0.067-0.4,0             c-0.133-0.033-0.233-0.117-0.3-0.25c-0.133-0.233-0.283-0.45-0.45-0.65V24.3c-1.8-2.667-3.983-4-6.55-4             c-2.567,0.034-4.767,1.383-6.6,4.05c-0.167,0.2-0.3,0.417-0.4,0.65c-0.1,0.133-0.217,0.217-0.35,0.25             c-0.133,0.067-0.267,0.067-0.4,0c-0.133-0.033-0.233-0.117-0.3-0.25C0.85,22.167,0,18.85,0,15.05c0-4.167,1-7.733,3-10.7             C4.633,1.95,6.55,0.5,8.75,0H12.45z M4,5.05V5C3.991,5.016,3.982,5.033,3.975,5.05C2.289,7.935,1.431,11.126,1.4,14.625             c-0.03,3.519,0.536,6.477,1.7,8.875c2.066-3.39,4.566-5.064,7.5-5.025c2.933,0.04,5.433,1.731,7.5,5.075             c1.088-2.518,1.605-5.559,1.55-9.125c-0.055-3.565-0.888-6.69-2.5-9.375V5c-1.8-2.397-3.983-3.589-6.55-3.575             C8.033,1.439,5.833,2.647,4,5.05z",G:"M8.75,0h3.675c2.191,0.504,4.1,1.963,5.725,4.375V4.35             c2.035,2.963,3.052,6.53,3.05,10.7c0.001,4.17-1.015,7.737-3.05,10.7v-0.025c-2.066,3.065-4.583,4.59-7.55,4.575             c-2.966,0.023-5.5-1.494-7.6-4.55v-0.025C0.999,22.77-0.001,19.211,0,15.05c-0.001-4.161,0.999-7.72,3-10.675V4.35             C4.647,1.953,6.564,0.503,8.75,0z M17.15,25.05c1.754-2.938,2.621-6.354,2.6-10.25c-0.022-3.895-0.889-7.145-2.6-9.75V5.025             c-1.8-2.269-3.984-3.402-6.55-3.4C8.033,1.63,5.833,2.771,4,5.05V5.025c-1.646,2.778-2.496,6.12-2.55,10.025             C1.396,18.955,2.246,22.297,4,25.075V25.05c1.583,2.593,3.667,3.985,6.25,4.175c2.583,0.189,4.883-1.194,6.9-4.15V25.05z",T:"M7.45,0.2H7.9C7.794,0.442,7.677,0.709,7.55,1             C6.388,3.721,4.504,8.396,1.9,15.025l6.9,8.35l1.025-1.35c1.258-1.424,2.55-2.816,3.875-4.175l0.025-0.025             c0.148-0.186,0.314-0.336,0.5-0.45c0.046-0.028,0.096-0.036,0.15-0.025c0.059,0.007,0.109,0.032,0.15,0.075l5.325,5.95l6.95-8.35             C24.252,8.584,22.369,3.909,21.15,1c-0.127-0.284-0.243-0.551-0.35-0.8h0.6h0.575c0.041,0.045,0.075,0.095,0.1,0.15l6.35,14.15             c0.028,0.066,0.053,0.133,0.075,0.2c0.087,0.129,0.137,0.279,0.15,0.45c0.01,0.238-0.065,0.447-0.225,0.625l-8.2,8.95             c-0.102,0.12-0.227,0.204-0.375,0.25c-0.167,0.043-0.334,0.043-0.5,0c-0.147-0.046-0.272-0.129-0.375-0.25l-4.675-5.1l-4.625,5.1             c-0.101,0.121-0.226,0.204-0.375,0.25c-0.167,0.043-0.334,0.043-0.5,0c-0.147-0.046-0.272-0.129-0.375-0.25l-8.15-8.95             c-0.16-0.178-0.235-0.387-0.225-0.625c0.014-0.168,0.063-0.318,0.15-0.45c0.019-0.066,0.044-0.133,0.075-0.2l6.35-14.15V0.325             C6.649,0.28,6.674,0.238,6.7,0.2H7.45z",U:"M20.8,0.2h0.6h0.575c0.041,0.045,0.075,0.095,0.1,0.15             l6.35,14.15c0.028,0.066,0.053,0.133,0.075,0.2c0.087,0.129,0.137,0.279,0.15,0.45c0.01,0.238-0.065,0.447-0.225,0.625l-8.2,8.95             c-0.102,0.12-0.227,0.204-0.375,0.25c-0.167,0.043-0.334,0.043-0.5,0c-0.147-0.046-0.272-0.129-0.375-0.25l-4.675-5.1l-4.625,5.1             c-0.101,0.121-0.226,0.204-0.375,0.25c-0.167,0.043-0.334,0.043-0.5,0c-0.147-0.046-0.272-0.129-0.375-0.25l-8.15-8.95             c-0.16-0.178-0.235-0.387-0.225-0.625c0.014-0.168,0.063-0.318,0.15-0.45c0.019-0.066,0.044-0.133,0.075-0.2l6.35-14.15V0.325             C6.649,0.28,6.674,0.238,6.7,0.2h0.75H7.9C7.794,0.442,7.677,0.709,7.55,1C6.388,3.721,4.504,8.396,1.9,15.025l6.9,8.35             l1.025-1.35c1.258-1.424,2.55-2.816,3.875-4.175l0.025-0.025c0.148-0.186,0.314-0.336,0.5-0.45             c0.046-0.028,0.096-0.036,0.15-0.025c0.059,0.007,0.109,0.032,0.15,0.075l5.325,5.95l6.95-8.35C24.252,8.584,22.369,3.909,21.15,1             C21.023,0.716,20.907,0.449,20.8,0.2z"},interior:{A:"M21.175,0.175C21.046,0.143,20.921,0.151,20.8,0.2             c-0.069,0.031-0.128,0.073-0.175,0.125c-0.055,0.054-0.097,0.121-0.125,0.2c-0.063,0.16,0.003,0.118,0.2-0.125l5.95,14.625             L14.05,28.75L1.65,15.125L7.3,0.6c0.086,0.03,0.161,0.056,0.225,0.075C7.688,0.704,7.747,0.662,7.7,0.55             C7.66,0.431,7.593,0.339,7.5,0.275L7.6,0.2c4.8-0.067,7.283-0.1,7.45-0.1l6.1,0.05L21.175,0.175z",C:"M3.975,5.05H4c1.833-2.402,4.033-3.611,6.6-3.625             C13.167,1.411,15.35,2.603,17.15,5v0.05c1.612,2.685,2.445,5.81,2.5,9.375c0.055,3.566-0.461,6.607-1.55,9.125             c-2.067-3.344-4.567-5.035-7.5-5.075c-2.934-0.04-5.434,1.635-7.5,5.025c-1.164-2.398-1.73-5.356-1.7-8.875             C1.431,11.126,2.289,7.935,3.975,5.05z",G:"M17.15,25.05v0.025c-2.017,2.956-4.317,4.339-6.9,4.15             C7.667,29.035,5.583,27.643,4,25.05v0.025c-1.754-2.778-2.604-6.12-2.55-10.025C1.504,11.145,2.354,7.803,4,5.025V5.05             c1.833-2.278,4.033-3.42,6.6-3.425c2.566-0.002,4.75,1.131,6.55,3.4V5.05c1.711,2.605,2.578,5.855,2.6,9.75             C19.771,18.695,18.904,22.112,17.15,25.05z",T:"M21.4,0.2h-0.6c0.107,0.249,0.223,0.516,0.35,0.8             c1.219,2.909,3.103,7.584,5.65,14.025l-6.95,8.35l-5.325-5.95c-0.041-0.042-0.091-0.067-0.15-0.075             c-0.054-0.011-0.104-0.003-0.15,0.025c-0.186,0.114-0.352,0.264-0.5,0.45L13.7,17.85c-1.325,1.358-2.617,2.75-3.875,4.175             L8.8,23.375l-6.9-8.35C4.504,8.396,6.388,3.721,7.55,1C7.677,0.709,7.794,0.442,7.9,0.2H7.45c0.133-0.067,0.333-0.1,0.6-0.1             c0.406,0,1.606-0.008,3.6-0.025l-1.375,0.05C17.28,0.048,20.955,0.056,21.3,0.15C21.334,0.164,21.368,0.181,21.4,0.2z",U:"M7.9,0.2l0.15-0.1c0.406,0,1.606-0.008,3.6-0.025l-1.375,0.05             c6.009-0.066,9.568-0.066,10.675,0L20.8,0.2c0.107,0.249,0.223,0.516,0.35,0.8c1.219,2.909,3.103,7.584,5.65,14.025l-6.95,8.35             l-5.325-5.95c-0.041-0.042-0.091-0.067-0.15-0.075c-0.054-0.011-0.104-0.003-0.15,0.025c-0.186,0.114-0.352,0.264-0.5,0.45             L13.7,17.85c-1.325,1.358-2.617,2.75-3.875,4.175L8.8,23.375l-6.9-8.35C4.504,8.396,6.388,3.721,7.55,1             C7.677,0.709,7.794,0.442,7.9,0.2z"},letter:{A:{1:"M12.85,12.55h2.6l-1.3-3.95L12.85,12.55z M13,6.25h2.4l3.55,10.1               h-2.3L16,14.3h-3.7l-0.7,2.05H9.4L13,6.25z",2:"M18.7,5.95l-3.55,10.1h-2.4l-3.6-10.1h2.2L12.05,8h3.7l0.65-2.05               H18.7z M12.6,9.75l1.3,3.95l1.3-3.95H12.6z"},C:{1:"M10.45,6.4c1.667,0,2.883,0.55,3.65,1.65               c0.433,0.633,0.667,1.267,0.7,1.9h-2.1c-0.133-0.5-0.3-0.867-0.5-1.1c-0.4-0.434-0.967-0.65-1.7-0.65S9.183,8.5,8.75,9.1               C8.317,9.733,8.1,10.617,8.1,11.75c0,1.1,0.217,1.933,0.65,2.5c0.467,0.567,1.05,0.85,1.75,0.85c0.733,0,1.283-0.233,1.65-0.7               c0.233-0.267,0.417-0.667,0.55-1.2h2.05c-0.167,1.1-0.617,2-1.35,2.7c-0.733,0.7-1.683,1.05-2.85,1.05               c-1.433,0-2.566-0.467-3.4-1.4c-0.8-0.933-1.2-2.216-1.2-3.85c0-1.767,0.466-3.117,1.4-4.05C8.15,6.817,9.183,6.4,10.45,6.4z",2:"M15,12.35c-0.033,0.633-0.267,1.267-0.7,1.9               c-0.767,1.1-1.983,1.65-3.65,1.65c-1.267,0-2.3-0.417-3.1-1.25c-0.933-0.933-1.4-2.283-1.4-4.05c0-1.633,0.4-2.917,1.2-3.85               c0.833-0.933,1.967-1.4,3.4-1.4c1.167,0,2.117,0.35,2.85,1.05c0.733,0.7,1.183,1.6,1.35,2.7H12.9               c-0.133-0.533-0.316-0.934-0.55-1.2c-0.367-0.467-0.917-0.7-1.65-0.7c-0.7,0-1.284,0.283-1.75,0.85               c-0.434,0.567-0.65,1.4-0.65,2.5c0,1.133,0.217,2.017,0.65,2.65c0.433,0.6,1.017,0.9,1.75,0.9c0.733,0,1.3-0.217,1.7-0.65               c0.2-0.233,0.367-0.6,0.5-1.1H15z"},G:{1:"M14.8,10.8h-2.05c-0.167-0.667-0.567-1.133-1.2-1.4               c-0.333-0.167-0.716-0.25-1.15-0.25c-0.8,0-1.467,0.3-2,0.9c-0.5,0.633-0.75,1.567-0.75,2.8s0.283,2.1,0.85,2.6               c0.567,0.533,1.2,0.8,1.9,0.8c0.7,0,1.283-0.217,1.75-0.65c0.434-0.4,0.717-0.934,0.85-1.6h-2.35v-1.65h4.2v5.4h-1.4l-0.2-1.25               c-0.4,0.467-0.767,0.8-1.1,1C11.583,17.833,10.9,18,10.1,18c-1.333,0-2.434-0.467-3.3-1.4c-0.867-0.9-1.3-2.167-1.3-3.8               s0.45-2.933,1.35-3.9c0.867-1,2.05-1.5,3.55-1.5c1.267,0,2.3,0.333,3.1,1C14.267,9.033,14.7,9.833,14.8,10.8z",2:"M10.65,9.65c-0.7,0-1.333,0.267-1.9,0.8               c-0.567,0.5-0.85,1.367-0.85,2.6c0,1.233,0.25,2.167,0.75,2.8c0.533,0.6,1.2,0.9,2,0.9c0.434,0,0.817-0.083,1.15-0.25               c0.633-0.267,1.034-0.733,1.2-1.4h2.05c-0.1,0.967-0.533,1.767-1.3,2.4c-0.8,0.667-1.833,1-3.1,1c-1.5,0-2.683-0.5-3.55-1.5               c-0.9-0.967-1.35-2.267-1.35-3.9s0.433-2.9,1.3-3.8c0.867-0.933,1.967-1.4,3.3-1.4c0.8,0,1.483,0.167,2.05,0.5               c0.333,0.2,0.7,0.533,1.1,1l0.2-1.25h1.4v5.4h-4.2V11.9h2.35c-0.133-0.667-0.417-1.2-0.85-1.6C11.933,9.867,11.35,9.65,10.65,9.65z"},T:{1:"M10.3,5 L18.45,5 L18.45,6.8 L15.4,6.8 L15.4,15.1 L13.3,15.1               L13.3,6.8 L10.3,6.8z",2:"M10.2,14.65 L10.2,12.85 L13.2,12.85 L13.2,4.55 L15.3,4.55               L15.3,12.85 L18.35,12.85 L18.35,14.65z"},U:{1:"M10.15,10.8V4.6h2.15v6.2c0,0.7,0.083,1.217,0.25,1.55               c0.267,0.566,0.817,0.85,1.65,0.85c0.867,0,1.417-0.284,1.65-0.85c0.167-0.333,0.25-0.85,0.25-1.55V4.6h2.15v6.2               c0,1.067-0.167,1.9-0.5,2.5c-0.633,1.1-1.817,1.65-3.55,1.65c-1.733,0-2.917-0.55-3.55-1.65C10.317,12.7,10.15,11.867,10.15,10.8z",2:"M12.45,8.4v6.2H10.3V8.4c0-1.066,0.167-1.9,0.5-2.5               c0.633-1.1,1.817-1.65,3.55-1.65S17.267,4.8,17.9,5.9c0.333,0.6,0.5,1.434,0.5,2.5v6.2h-2.15V8.4c0-0.7-0.083-1.217-0.25-1.55               C15.767,6.283,15.217,6,14.35,6c-0.833,0-1.383,0.283-1.65,0.85C12.533,7.183,12.45,7.7,12.45,8.4z"}}},oo={BACKB:52,A:28.151,C:21.2,G:21.2,T:28.651,U:28.651,A_GLOW:44.125,C_GLOW:37.2,G_GLOW:36.2,T_GLOW:45.566},ao={BACKB:14,A:31.15,C:25.3,G:30.3,T:25.007,U:25.007,A_GLOW:44.55,C_GLOW:41.417,G_GLOW:45.3,T_GLOW:40.65};function so(){var t=null,e="",n=1,i=1,r="DNA",o=null,a=!0,s=!1,l=!1,u=0,c=0;function h(t){var e,n;t?(e=Math.random()>=.5?.25*Math.PI:1.25*Math.PI,e+=Math.random()*Math.PI*.5,n=6*so.HEIGHT,u=n*Math.cos(e),c=n*Math.sin(e)):u=c=0}function d(e){return"translate("+t(u+so.WIDTH*e.idx)+" "+t(c)+")"}function p(u){u.each((function(u,c){var p,f,m,g,v,y,b,_,x,w=d3.select(this),C=r?.9*ao.BACKB:0,T=t(C+.5*ao.A),S=t(C+.97*ao.A),k="function"==typeof e?e(u,c):e;"string"==typeof k&&(k=k.split("")).forEach((function(t,e){k[e]={id:e,idx:e,type:t}})),f=(p=w.selectAll(".nucleotide").data(k,(function(t){return t.id}))).enter(),m=p.exit(),h(a),(g=(f=f.append("g").attr({transform:d}).style({opacity:a?0:1})).append("g").attr({class:"scale",transform:"scale(1, "+(1===n?1:-1)+")"})).append("path").attr("class","bonds").style({"stroke-width":t(.01),stroke:"#fff"}),v=g.append("g").classed("nucleo-shape",!0).classed("clickable-nucleo",(function(t){return"c"===t.region&&s})).on("click",(function(){})),s&&v.append("image").attr({class:"glow",y:t(C-.17*oo.G_GLOW),preserveAspectRatio:"none"}),(y=v.append("svg").attr({y:t(C),preserveAspectRatio:"none"})).append("path").attr({class:"outline","fill-rule":"evenodd","clip-rule":"evenodd"}),y.append("path").attr({class:"interior","fill-rule":"evenodd","clip-rule":"evenodd"}),y.append("path").attr({class:"letter","fill-rule":"evenodd","clip-rule":"evenodd",d:function(t){return ro.letter[t.type][n]}}),r&&g.append("image").attr({class:"backbone",x:0,y:0,width:t(oo.BACKB),height:t(ao.BACKB),preserveAspectRatio:"none","xlink:href":lt("dna/Backbone_"+r+".svg")}),l&&(p=f),p.attr("class",(function(t){var e="";switch(t.region){case"c":e="coding-region";break;case"j":e="junk-region";break;case"p":e="promoter-region";break;case"t":e="terminator-region"}return"nucleotide "+e})),p.select(".bonds").attr("d",(function(e){return"C"===e.type||"G"===e.type?"M"+t(.14)+" "+T+" L "+t(.14)+" "+S+"M"+t(.182)+" "+T+" L "+t(.182)+" "+S+"M"+t(.224)+" "+T+" L "+t(.224)+" "+S:"M"+t(.154)+" "+T+" L "+t(.154)+" "+S+"M"+t(.21)+" "+T+" L "+t(.21)+" "+S})),p.select(".glow").attr({x:function(e){return t(oo.BACKB)/2-t(oo[e.type+"_GLOW"])/2},width:function(e){return t(oo[e.type+"_GLOW"])},height:function(e){return t(ao[e.type+"_GLOW"])},"xlink:href":function(t){return lt("dna/NucleotideGlow_"+t.type+".svg")}}),(b=p.select(".nucleo-shape > svg")).attr({class:function(t){var e="type-"+t.type;return o&&o[t.idx]&&(e+=" stop-codon"),e},viewBox:function(t){return"0 0 "+oo[t.type]/.007+" "+ao[t.type]/.007},x:function(e){return t(oo.BACKB)/2-t(oo[e.type])/2},width:function(e){return t(oo[e.type])},height:function(e){return t(ao[e.type])}}),b.select("path.interior").attr("d",(function(t){return ro.interior[t.type]})),b.select("path.outline").attr("d",(function(t){return ro.outline[t.type]})),h(!1),(_=d3.transition(p).attr("transform",d).style("opacity",1)).select(".bonds").style("opacity",i),_.attrTween?(x="scale(1, "+(1===n?1:-1)+")",_.select("g.scale").attrTween("transform",(function(t,e,n){return d3.interpolateString(n,x)})),_.select("path.letter").attrTween("d",(function(t,e,i){return function(e){return e<.5?i:ro.letter[t.type][n]}}))):(p.select("g.scale").attr("transform","scale(1, "+(1===n?1:-1)+")"),p.select("path.letter").attr("d",(function(t){return ro.letter[t.type][n]}))),h(!0),d3.transition(m).attr("transform",d).style("opacity",0).remove()}))}return p.sequence=function(t){return arguments.length?(e=t,p):e},p.model2px=function(e){return arguments.length?(t=e,p):t},p.direction=function(t){return arguments.length?(n=t,p):n},p.bonds=function(t){return arguments.length?(i=t,p):i},p.randomEnter=function(t){return arguments.length?(a=t,p):a},p.glow=function(t){return arguments.length?(s=t,p):s},p.backbone=function(t){return arguments.length?(r=t,p):r},p.stopCodonsHash=function(t){return arguments.length?(o=t,p):o},p.enterExitOnly=function(t){return arguments.length?(l=t,p):l},p}!function(){var t;for(t in oo)oo.hasOwnProperty(t)&&(oo[t]*=.007);for(t in ao)ao.hasOwnProperty(t)&&(ao[t]*=.007)}(),so.WIDTH=.92*oo.BACKB,so.HEIGHT=.96*(.9*ao.BACKB+ao.A);var lo=so,uo={CELLS:720,DNA1:661,DNA2:720,DNA3:337.4,POLY_UNDER:426.15,POLY_OVER:402.525,NUCLEUS:729.45,RIBO_TOP:550.7,RIBO_BOTTOM:509.031,RIBO_UNDER:550.55,RIBO_OVER:550.7,TRNA:117.325,TRNA_NECK:15.925},co={CELLS:500,DNA1:550,DNA2:414.263,DNA3:89.824,POLY_UNDER:368.6,POLY_OVER:368.6,NUCLEUS:543.199,RIBO_TOP:250,RIBO_BOTTOM:147.15,RIBO_UNDER:311.6,RIBO_OVER:311.6,TRNA:67.9,TRNA_NECK:21.14,A:31.15};function ho(t,e,n,i){function o(t){return t.opacity}function a(t){var i=t.translateX||0,r=t.translateY||0;return"translate("+e(i)+" "+n(r)+")"}function s(t){return a(t)+" "+function(t){return"scale("+t.scale+")"}(t)}function l(t){var e=t?i.geneticEngine().PRECODING_LEN:0,n=Math.floor(i.properties.viewPortX/lo.WIDTH)-2,r=Math.ceil((i.properties.viewPortX+i.properties.viewPortWidth)/lo.WIDTH)+4;return[Math.max(0,n+e),r+e]}function u(){var t=i.properties.dnaEngineImagesPath;return t&&t.length>0?r.a.modelsRootUrl&&r.a.modelsRootUrl.length>0?r.a.modelsRootUrl+t:t:"dna"}return{cells:function(t,n){var i=t.select(".background-layer").selectAll(".cells").data(n.cells);i.enter().append("image").attr({class:"cells",x:e(-.567*uo.CELLS),y:e(-.445*co.CELLS),width:e(uo.CELLS),height:e(co.CELLS),preserveAspectRatio:"none","xlink:href":lt(u()+"/Cells.svg"),transform:s}).style("opacity",o),d3.transition(i).attr("transform",s).style("opacity",o),d3.transition(i.exit()).remove()},dna1:function(t,n){var i=t.select(".dna-layer").selectAll(".dna1").data(n.dna1);i.enter().append("image").attr({class:"dna1",x:e(-.5*uo.DNA1),y:e(-.5*co.DNA1),width:e(uo.DNA1),height:e(co.DNA1),preserveAspectRatio:"none","xlink:href":lt(u()+"/DNA_InsideNucleus_1.svg"),transform:s}).style("opacity",o),d3.transition(i).attr("transform",s).style("opacity",o),d3.transition(i.exit()).remove()},dna2:function(t,n){var i=t.select(".dna-layer").selectAll(".dna2").data(n.dna2);i.enter().append("image").attr({class:"dna2",x:e(-.5*uo.DNA2),y:e(-.404*co.DNA2),width:e(uo.DNA2),height:e(co.DNA2),preserveAspectRatio:"none","xlink:href":lt(u()+"/DNA_InsideNucleus_2.svg"),transform:s}).style("opacity",o),d3.transition(i).attr("transform",s).style("opacity",o),d3.transition(i.exit()).remove()},dna3:function(t,n){var i;i=t.select(".dna-layer").selectAll(".dna3").data(n.dna3),i.enter().append("g").attr({class:"dna3 main-dna",transform:s}).style("opacity",o).selectAll("dna3-unit").data(new Array(14)).enter().append("image").attr({class:"dna3-unit",x:function(t,n){return(n-7)*e(uo.DNA3)*.98},y:e(-.5*co.DNA3),width:e(uo.DNA3),height:e(co.DNA3),preserveAspectRatio:"none","xlink:href":lt(u()+"/DoubleHelix_Unit.svg")}),d3.transition(i).attr("transform",s).style("opacity",o),d3.transition(i.exit()).remove()},dna:function(t,n,r){var o=i.geneticEngine().viewModel,s=l(!0),u=n.dna[0]?n.dna[0].bonds:0,c=lo(),h=t.select(".dna-layer").selectAll(".dna");c.model2px(e).sequence(o.DNA.slice(s[0],s[1])).glow(i.get("DNAMutations")).bonds(u),r?h.call(c.enterExitOnly(!0)):(h=h.data(n.dna),h.enter().append("g").attr({class:"dna",transform:a}),h.call(c),d3.transition(h).attr("transform",a),d3.transition(h.exit()).remove())},dnaComp:function(t,n,r){var o=i.geneticEngine().viewModel,s=l(!0),u=n.dnaComp[0]?n.dnaComp[0].bonds:0,c=lo(),h=t.select(".dna-layer").selectAll(".dna-comp");c.model2px(e).sequence(o.DNAComp.slice(s[0],s[1])).direction(2).glow(i.get("DNAMutations")).bonds(u),r?h.call(c.enterExitOnly(!0)):(h=h.data(n.dnaComp),h.enter().append("g").attr({class:"dna-comp",transform:a}),h.call(c),d3.transition(h).attr("transform",a),d3.transition(h.exit()).remove())},mrna:function(t,n,r){var o=i.geneticEngine(),s=o.viewModel.mRNA,u=l(),c=o.stopCodonsHash(),h=n.mrna[0]?n.mrna[0].bonds:0,d=n.mrna[0]?n.mrna[0].direction:1,p=lo(),f=t.select(".dna-layer").selectAll(".mrna");p.model2px(e).sequence(s.slice(u[0],u[1])).backbone("RNA").direction(d).bonds(h).stopCodonsHash(c),r?f.call(p.enterExitOnly(!0)):(f=f.data(n.mrna),f.enter().append("g").attr({class:"mrna",transform:a}),f.call(p),d3.transition(f).attr("transform",a),d3.transition(f.exit()).remove())},polymeraseUnder:function(t,n){var i=t.select(".under-dna-layer").selectAll(".polymerase-under").data(n.polymeraseUnder);i.enter().append("image").attr({class:"polymerase-under",x:e(-.5*uo.POLY_UNDER),y:e(-.5*co.POLY_UNDER),width:e(uo.POLY_UNDER),height:e(co.POLY_UNDER),preserveAspectRatio:"none","xlink:href":lt(u()+"/Polymerase_Under.svg"),transform:s}).style("opacity",o),d3.transition(i).attr("transform",s).style("opacity",o),d3.transition(i.exit()).remove()},polymeraseOver:function(t,n){var i=t.select(".over-dna-layer").selectAll(".polymerase-over").data(n.polymeraseOver);i.enter().append("image").attr({class:"polymerase-over",x:e(-.5*uo.POLY_OVER),y:e(-.5*co.POLY_OVER),width:e(uo.POLY_OVER),height:e(co.POLY_OVER),preserveAspectRatio:"none","xlink:href":lt(u()+"/Polymerase_Over.svg"),transform:s}).style("opacity",o),d3.transition(i).attr("transform",s).style("opacity",o),d3.transition(i.exit()).remove()},nucleus:function(t,n){var i=t.select(".background-layer").selectAll(".nucleus").data(n.nucleus);i.enter().append("image").attr({class:"nucleus",x:e(-.5*uo.NUCLEUS),y:e(-.5*co.NUCLEUS),width:e(uo.NUCLEUS),height:e(co.NUCLEUS),preserveAspectRatio:"none","xlink:href":lt(u()+"/BG_Nucleus.svg"),transform:a}).style("opacity",o),d3.transition(i).attr("transform",a).style("opacity",o),d3.transition(i.exit()).remove()},ribosomeBottom:function(t,n){var i=t.select(".over-dna-layer").selectAll(".ribosome-bottom").data(n.ribosomeBottom);i.enter().append("image").attr({class:"ribosome-bottom",x:e(-.5*uo.RIBO_BOTTOM),y:e(-.5*co.RIBO_BOTTOM),width:e(uo.RIBO_BOTTOM),height:e(co.RIBO_BOTTOM),preserveAspectRatio:"none","xlink:href":lt(u()+"/Ribosome_bottom1.svg"),transform:a}).style("opacity",0),d3.transition(i).attr("transform",a).style("opacity",o),d3.transition(i.exit()).style("opacity",0).remove()},ribosomeTop:function(t,n){var i=t.select(".over-dna-layer").selectAll(".ribosome-top").data(n.ribosomeTop);i.enter().append("image").attr({class:"ribosome-top",x:e(-.5*uo.RIBO_TOP),y:e(-.5*co.RIBO_TOP),width:e(uo.RIBO_TOP),height:e(co.RIBO_TOP),preserveAspectRatio:"none","xlink:href":lt(u()+"/Ribosome_top1.svg"),transform:a}).style("opacity",0),d3.transition(i).attr("transform",a).style("opacity",o),d3.transition(i.exit()).style("opacity",0).remove()},ribosomeUnder:function(t,n){var i=t.select(".under-dna-layer").selectAll(".ribosome-under").data(n.ribosomeUnder);i.enter().append("image").attr({class:"ribosome-under",x:e(-.5*uo.RIBO_UNDER),y:e(-.5*co.RIBO_UNDER),width:e(uo.RIBO_UNDER),height:e(co.RIBO_UNDER),preserveAspectRatio:"none","xlink:href":lt(u()+"/Ribosome_under.png"),transform:a}).style({opacity:o}),d3.transition(i).attr("transform",a).style("opacity",o),d3.transition(i.exit()).remove()},ribosomeOver:function(t,n){var i=t.select(".over-dna-layer").selectAll(".ribosome-over").data(n.ribosomeOver);i.enter().append("image").attr({class:"ribosome-over",x:e(-.5*uo.RIBO_OVER),y:e(-.5*co.RIBO_OVER),width:e(uo.RIBO_OVER),height:e(co.RIBO_OVER),preserveAspectRatio:"none","xlink:href":lt(u()+"/Ribosome_over.png"),transform:a}).style("opacity",o),d3.transition(i).attr("transform",a).style("opacity",o),d3.transition(i.exit()).remove()},trna:function(t,n){var r,s,l,c=i.geneticEngine(),h=3*lo.WIDTH,d=.55*(h-uo.TRNA);(s=(r=t.select(".top-layer").selectAll(".trna").data(n.trna,(function(t){return t.index}))).enter().append("g").attr({class:"trna",display:function(t){return t.index<0?"none":"inline"},transform:function(t,n){return"translate("+e(2*lo.HEIGHT)+", "+e(-2.78)+") "+a(t)+" rotate(30)"}}).style("opacity",o)).append("g").attr("transform","translate(0, "+e(-co.A)+")").call(lo().model2px(e).sequence((function(t){return c.codonComplement(t.index)})).backbone(!1).randomEnter(!1)),s.append("image").attr({class:"trna-neck",x:e(.52*(h-uo.TRNA_NECK)),y:e(-co.TRNA_NECK-.95*co.TRNA-.92*co.A),width:e(uo.TRNA_NECK),height:e(co.TRNA_NECK),preserveAspectRatio:"none","xlink:href":lt(u()+"/tRNA_neck.png")}),s.append("image").attr({class:"trna-base",x:e(d),y:e(-co.TRNA-.92*co.A),width:e(uo.TRNA),height:e(co.TRNA),preserveAspectRatio:"none","xlink:href":lt(u()+"/tRNA_base.png")}),d3.transition(r).attr("transform",a).style("opacity",o).select(".trna-neck").style("opacity",(function(t){return t.neck})),(l=d3.transition(r.exit()).attr("transform",(function(t,n){return"translate("+e(-5*lo.HEIGHT)+", "+e(-4*lo.HEIGHT)+") "+a(t)+" rotate(-30)"})).style("opacity",0)).selectAll(".bonds").style("opacity",0),l.remove()},viewPort:function(e,n){var r=n.viewPort[0].position,o=n.viewPort[0].ease,a=n.viewPort[0].drag,s=d3.transition(d3.select(t));i.set("viewPortDrag",!!a&&"x"),s.duration?(s.ease(o),s.tween("model-update",(function(){var t=d3.interpolate(Number(i.properties.viewPortX),r*lo.WIDTH);return function(e){var n=t(e);Math.abs(i.properties.viewPortX-n)>.001&&(i.properties.viewPortX=n)}}))):i.set("viewPortX",r*lo.WIDTH)},background:function(e,n){!function(t){var e,n=function(t){var e=t.select("defs");return e.empty()&&(e=t.append("defs")),e}(t);n.select("#transcription-bg").empty()&&((e=n.append("linearGradient").attr("id","transcription-bg").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%")).append("stop").attr("stop-color","#C8DD69").attr("offset","0%"),e.append("stop").attr("stop-color","#778B3D").attr("offset","100%"))}(e),d3.transition(d3.select(t).select(".container-background")).attr("fill",n.background[0].color)}}}!function(){var t;for(t in uo)uo.hasOwnProperty(t)&&(uo[t]*=.007);for(t in co)co.hasOwnProperty(t)&&(co[t]*=.007)}(),ho.W=uo,ho.H=co,ho.OBJECT_NAMES=["background","cells","dna1","dna2","dna3","polymeraseUnder","polymeraseOver","polymeraseUnder","polymeraseOver","dna","dnaComp","mrna","nucleus","ribosomeBottom","ribosomeTop","ribosomeUnder","ribosomeOver","trna","viewPort"];var po=ho;function fo(t){var e=[],n={};return{newState:function(i,r){var o=$.extend(!0,{},r);t.forEach((function(t){void 0===o[t]&&(o[t]=[])})),e.push(o),n[i]=o},extendLastState:function(i,r){var o=e[e.length-1],a={};t.forEach((function(t){a[t]=[],void 0!==r[t]&&r[t].forEach((function(e,n){a[t].push($.extend(!0,{},o[t][n],e))}))})),e.push(a),n[i]=a},getState:function(t){var e,i=n[t],r=$.extend(!0,{},i);for(e in r)r.hasOwnProperty(e)&&r[e].forEach((function(t,n){var r;for(r in t)"function"==typeof t[r]&&(t[r]=i[e][n][r]())}));return r}}}var mo=po.H,go=po.OBJECT_NAMES;function vo(t){var e,n=new fo(go),i=t.geneticEngine(),r=t.get("viewPortWidth"),o=t.get("viewPortHeight"),a=.5*r,s=.5*o;function l(){var n=i.state();return"translation-end"===n.name?t.geneticEngine().lastTranslationStep():e=isNaN(n.step)?e:n.step}function u(){return(1.65+3*Math.max(0,l()-2))*lo.WIDTH}function c(){return 3*this.index()*lo.WIDTH}return n.newState("intro-cells",{cells:[{translateX:a+.33,translateY:s,scale:1}],dna1:[{translateX:a+.33,translateY:s,scale:.13,opacity:0}],viewPort:[{position:0,ease:"cubic-in-out",drag:!1}],background:[{color:"#55b7b2"}]}),n.extendLastState("intro-zoom1",{cells:[{translateX:a,scale:6}],dna1:[{translateX:a,scale:.78,opacity:5}],dna2:[{translateX:a,translateY:s,scale:.5,opacity:0}],viewPort:[{}],background:[{}]}),n.extendLastState("intro-zoom2",{cells:[{scale:24}],dna1:[{scale:3.12,opacity:0}],dna2:[{scale:2,opacity:1}],dna3:[{translateX:a,translateY:s,scale:.2,opacity:0}],viewPort:[{}],background:[{}]}),n.extendLastState("intro-zoom3-s0",{cells:[{}],dna2:[{scale:3.8,opacity:0}],dna3:[{scale:.4,opacity:1}],viewPort:[{}],background:[{}]}),n.extendLastState("intro-zoom3",{cells:[{}],dna3:[{scale:.6}],polymeraseUnder:[{scale:.2,translateX:-2,translateY:4,opacity:1}],viewPort:[{}],background:[{}]}),n.extendLastState("intro-polymerase-s0",{cells:[{}],dna3:[{}],polymeraseUnder:[{scale:.8,translateX:a,translateY:s,opacity:1}],polymeraseOver:[{translateX:a,translateY:s,scale:.8,opacity:0}],viewPort:[{}],background:[{}]}),n.extendLastState("intro-polymerase",{cells:[{}],dna3:[{}],polymeraseUnder:[{scale:1}],polymeraseOver:[{scale:1,opacity:1}],viewPort:[{}],background:[{}]}),n.extendLastState("dna-s0",{cells:[{opacity:0}],dna3:[{scale:1.5}],polymeraseUnder:[{scale:2.5}],polymeraseOver:[{scale:2.5}],viewPort:[{}],background:[{}]}),n.extendLastState("dna",{polymeraseUnder:[{opacity:0}],polymeraseOver:[{opacity:0}],dna3:[{opacity:0}],dna:[{translateX:-t.geneticEngine().PRECODING_LEN*lo.WIDTH,translateY:o/2+lo.HEIGHT,bonds:1}],dnaComp:[{translateX:-t.geneticEngine().PRECODING_LEN*lo.WIDTH,translateY:o/2-lo.HEIGHT,bonds:1}],viewPort:[{position:-2,drag:!0}],background:[{color:"url(#transcription-bg)"}]}),n.extendLastState("transcription",{dna:[{translateY:o/2+2.5*lo.HEIGHT,bonds:0}],dnaComp:[{translateY:o/2-2.5*lo.HEIGHT,bonds:function(){var e=l()+t.geneticEngine().PRECODING_LEN;return function(t){return"c"===t.region&&t.idx<e?1:0}}}],mrna:[{translateY:o/2-.5*lo.HEIGHT,bonds:1,direction:1}],viewPort:[{position:function(){return Math.max(0,Math.min(t.get("DNA").length-10,l()-6))-2},ease:"linear"}],background:[{}]}),n.extendLastState("transcription-end",{dna:[{}],dnaComp:[{bonds:function(){return function(t){return"c"===t.region?1:0}}}],mrna:[{}],polymeraseUnder:[{translateX:function(){return t.get("DNA").length*lo.WIDTH},translateY:.5*o,scale:3.5,opacity:0}],polymeraseOver:[{translateX:function(){return t.get("DNA").length*lo.WIDTH},translateY:.5*o,scale:3.5,opacity:0}],viewPort:[{position:function(){return Math.max(0,t.get("DNA").length-10)-2}}],background:[{}]}),n.extendLastState("after-transcription",{dna:[{}],dnaComp:[{}],mrna:[{}],polymeraseUnder:[{opacity:1}],polymeraseOver:[{opacity:1}],viewPort:[{}],background:[{}]}),n.extendLastState("before-translation-s0",{dna:[{}],dnaComp:[{}],mrna:[{}],polymeraseUnder:[{scale:1.4}],polymeraseOver:[{scale:1.4,opacity:0}],viewPort:[{}],background:[{color:"#55b7b2"}]}),n.extendLastState("before-translation-s1",{dna:[{}],dnaComp:[{}],mrna:[{}],polymeraseUnder:[{translateX:function(){return t.get("viewPortX")+.5*r+5},translateY:.5*o-2,scale:.7}],viewPort:[{}],background:[{}]}),n.extendLastState("before-translation-s2",{dna:[{}],dnaComp:[{}],mrna:[{}],nucleus:[{translateX:.5*r-2*lo.WIDTH,translateY:.5*o}],viewPort:[{position:-2,ease:"cubic-in-out"}],background:[{}]}),n.extendLastState("before-translation-s3",{dna:[{translateY:4*lo.HEIGHT}],dnaComp:[{translateY:2*lo.HEIGHT,bonds:0}],mrna:[{bonds:0}],nucleus:[{translateY:0}],viewPort:[{}],background:[{color:function(){return t.get("backgroundColor")}}]}),n.extendLastState("before-translation-s4",{dna:[{translateY:-1*lo.HEIGHT}],dnaComp:[{translateY:-3*lo.HEIGHT}],mrna:[{translateY:2.5*lo.HEIGHT}],nucleus:[{translateY:-.5*mo.NUCLEUS}],viewPort:[{}],background:[{}]}),n.extendLastState("before-translation",{mrna:[{translateY:1.5*lo.HEIGHT,direction:2,bonds:0}],ribosomeBottom:[{translateX:-3,translateY:s,opacity:0}],viewPort:[{}],background:[{}]}),n.extendLastState("translation-s0",{mrna:[{}],ribosomeBottom:[{translateX:u,translateY:1.75*lo.HEIGHT,opacity:1}],ribosomeTop:[{translateX:-3,translateY:6,opacity:0}],viewPort:[{}],background:[{}]}),n.extendLastState("translation-s1",{mrna:[{}],ribosomeBottom:[{}],ribosomeTop:[{translateX:u,translateY:4.52*lo.HEIGHT,opacity:1}],ribosomeUnder:[{translateX:u,translateY:3.7*lo.HEIGHT,opacity:0}],ribosomeOver:[{translateX:u,translateY:3.7*lo.HEIGHT,opacity:0}],viewPort:[{}],background:[{}]}),n.extendLastState("translation",{mrna:[{bonds:function(){var t=l();return function(e){return e.idx<3*(t-2)||e.idx>=3*t?0:1}}}],ribosomeUnder:[{opacity:1}],ribosomeOver:[{opacity:1}],trna:[{index:function(){return l()-2},translateX:c,translateY:2.5*lo.HEIGHT,neck:0},{index:function(){return l()-1},translateX:c,translateY:2.5*lo.HEIGHT,neck:1}],viewPort:[{position:function(){return Math.max(0,3*(l()-3))-2},ease:"linear"}],background:[{}]}),n.extendLastState("translation-step0",{mrna:[{bonds:function(){var t=l();return function(e){return e.idx<3*(t-3)||e.idx>=3*t?0:1}}}],ribosomeUnder:[{}],ribosomeOver:[{}],trna:[{index:function(){return l()-3}},{index:function(){return l()-2}},{index:function(){return l()-1},translateX:c,translateY:2.5*lo.HEIGHT,neck:1}],viewPort:[{}],background:[{}]}),n.extendLastState("translation-step1",{mrna:[{}],ribosomeUnder:[{}],ribosomeOver:[{}],trna:[{},{neck:0},{}],viewPort:[{}],background:[{}]}),n.extendLastState("translation-end-s0",{mrna:[{}],ribosomeUnder:[{}],ribosomeOver:[{}],trna:[{index:function(){return l()-2}},{index:function(){return l()-1},neck:0}],viewPort:[{}],background:[{}]}),n.extendLastState("translation-end-s1",{mrna:[{bonds:function(){var t=l();return function(e){return e.idx<3*(t-1)||e.idx>=3*t?0:1}}}],ribosomeUnder:[{}],ribosomeOver:[{}],trna:[{index:function(){return l()-1}}],viewPort:[{}],background:[{}]}),n.extendLastState("translation-end-s2",{mrna:[{bonds:0}],ribosomeUnder:[{}],ribosomeOver:[{}],viewPort:[{}],background:[{}]}),n.extendLastState("translation-end-s3",{mrna:[{}],ribosomeBottom:[{translateX:u,translateY:1.75*lo.HEIGHT,opacity:1}],ribosomeTop:[{translateX:u,translateY:4.52*lo.HEIGHT,opacity:1}],viewPort:[{}],background:[{}]}),n.extendLastState("translation-end-s4",{mrna:[{}],ribosomeBottom:[{translateY:1.75*lo.HEIGHT-.3}],ribosomeTop:[{translateY:4.52*lo.HEIGHT+.5}],viewPort:[{}],background:[{}]}),n.extendLastState("translation-end-s5",{mrna:[{}],ribosomeBottom:[{translateX:function(){return u()+8},translateY:1.75*lo.HEIGHT-.5}],ribosomeTop:[{translateX:function(){return u()+8},translateY:4.52*lo.HEIGHT+5}],viewPort:[{}],background:[{}]}),n.extendLastState("translation-end",{mrna:[{}],viewPort:[{}],background:[{}]}),n}var yo=n(189);n.n(yo).a;var bo=function(t,e,n,i){var r=null;$.contextMenu("destroy",t),$.contextMenu({selector:t,appendTo:".lab-responsive-content",className:"mutations-menu",trigger:"left",events:{show:function(t){r=d3.select(t.$trigger[0]).datum().type;for(var e=t.items.Substitution.items,n=0,i=Object.keys(e||{});n<i.length;n++){var o=i[n],a=e[o];o=o.split(":")[1],a.$node.addClass("".concat(r,"-to-").concat(o))}return d3.select(t.$trigger[0]).classed("glowing",!0),!0},hide:function(t){for(var e=t.items.Substitution.items,n=0,i=Object.keys(e||{});n<i.length;n++){var o=i[n],a=e[o];o=o.split(":")[1],a.$node.removeClass("".concat(r,"-to-").concat(o))}return d3.select(t.$trigger[0]).classed("glowing",!1),!0}},callback:function(t,i){t=t.split(":");var r=d3.select(i.$trigger[0]).datum();switch(t[0]){case"substitute":return e.geneticEngine().mutate(r.idx,t[1],n);case"insert":return e.geneticEngine().insert(r.idx,t[1],n);case"delete":return e.geneticEngine().delete(r.idx)}},items:{Substitution:{name:i.t("md2d.mutations_menu.substitution_mutation"),className:"substitution-submenu",items:{"substitute:A":{name:""},"substitute:T":{name:""},"substitute:G":{name:""},"substitute:C":{name:""}}},Insertion:{name:i.t("md2d.mutations_menu.insertion_mutation"),className:"insertion-submenu",items:{"insert:A":{name:i.t("md2d.mutations_menu.insert"),className:"A"},"insert:T":{name:i.t("md2d.mutations_menu.insert"),className:"T"},"insert:G":{name:i.t("md2d.mutations_menu.insert"),className:"G"},"insert:C":{name:i.t("md2d.mutations_menu.insert"),className:"C"}}},delete:{name:i.t("md2d.mutations_menu.deletion_mutation")}}})},_o=po.OBJECT_NAMES;d3.selection.prototype.interrupt=function(){return this.each((function(){var t=this.__transition__;if(t){var e=-1;for(var n in t)(n=+n)>e&&(e=n);t.active=e+1}}))};var xo=function(t,e){var n,i,r=t.node,o=t.model2px,a=t.model2pxInv,s=d3.select(r).select(".below-atoms"),l=null,u=null,c=null,h=null,d=!1,p=!1,f=null,m=new vo(e),g=new po(r,o,a,e);function v(){c=e.geneticEngine().state(),x(),s.selectAll("g.genetics").remove(),l=null,e.get("DNA")&&((l=s.insert("g",".image-container-below").attr("class","genetics")).append("g").attr("class","background-layer"),l.append("g").attr("class","under-dna-layer"),l.append("g").attr("class","dna-layer"),l.append("g").attr("class","over-dna-layer"),l.append("g").attr("class","top-layer"),y())}function y(t){d=t,c=e.geneticEngine().state(),x(),b(l,c.name,null,p),p=!1}function b(t,e,n,i){var r=m.getState(e),o=h?m.getState(h):null;function a(){t.each((function(){var t=d3.select(this);_o.forEach((function(e){(function(t){var e=!!r[t].length,n=!(!o||!o[t].length);return(!d||"viewPort"!==t)&&!!(i||e||n)})(e)&&g[e](t,r)}))})),n&&n(t)}t.duration?(t.each("start.transition-name",(function(){f=e,a()})),t.each("end.transition-name",(function(){f=null}))):a(),h=e,c.step||0}function _(t){var e;return e=!t&&u&&u.node().__transition__?u.transition():l.transition(),u=e,e}function x(){var t=d3.select(r),e=t.select("g.genetics");!e.empty()&&e.node().__transition__&&(t.selectAll("g.genetics, g.genetics *").interrupt(),t.select(".container-background").interrupt(),u=null,f=null)}function w(t,n){p=!0,d=n,c=e.geneticEngine().state(),Number(t.split(":")[1])>0&&(t=t.split(":")[0]),i[t](),u.each("end.trans-end",(function(){p=!1,e.geneticEngine().transitionEnded()}))}return i={"dna-updated":function(){b(_(!0).ease("cubic-in-out").duration(800),c.name,null,!0)},"intro-zoom1":function(){b(_(!0).ease("cubic").duration(3e3),"intro-zoom1")},"intro-zoom2":function(){b(_(!0).ease("linear").duration(3e3),"intro-zoom2")},"intro-zoom3":function(){var t=_(!0).ease("linear").duration(2e3);b(t,"intro-zoom3-s0"),b(t=_().ease("quad-out").duration(3300),"intro-zoom3")},"intro-polymerase":function(){var t=_(!0).ease("quad-out").duration(3e3);b(t,"intro-polymerase-s0"),b(t=_().ease("cubic-in-out").duration(1e3),"intro-polymerase")},dna:function(){var t=_(!0).duration(2e3);b(t,"dna-s0"),b(t=_().duration(1e3),"dna",(function(t){t.selectAll(".nucleotide").duration(5),t.selectAll(".container-background").duration(5)}))},"transcription:0":function(){b(_(!0).duration(1500),"transcription",(function(t){t.selectAll(".bonds").duration(250)}))},transcription:function(){b(_(!0).duration(500),"transcription",(function(t){t.selectAll(".bonds").ease("cubic")}))},"transcription-end":function(){b(_(!0).duration(500),"transcription-end",(function(t){t.selectAll(".bonds").ease("cubic")}))},"after-transcription":function(){b(_(!0).ease("cubic-in-out").duration(700),"after-transcription")},"before-translation":function(){var t=_(!0).ease("cubic-in-out").duration(1e3);b(t,"before-translation-s0",(function(t){t.selectAll(".container-background").duration(1)})),b(t=_().ease("cubic-in-out").duration(1500),"before-translation-s1"),b(t=_().ease("cubic-in-out").duration(1500),"before-translation-s2"),b(t=_().ease("cubic").duration(1e3),"before-translation-s3",(function(t){t.selectAll(".bonds").duration(250),t.selectAll(".container-background").duration(1)})),b(t=_().ease("cubic-out").duration(1e3),"before-translation-s4"),b(t=_().ease("cubic-out").duration(500),"before-translation")},"translation:0":function(){var t=_(!0).ease("cubic-in-out").duration(1e3);b(t,"translation-s0"),b(t=_().ease("cubic-in-out").duration(1e3),"translation-s1"),b(t=_().ease("cubic-in-out").duration(500),"translation")},translation:function(){var t=e.geneticEngine(),n=c.step-1;b(_(!0).duration(1e3),"translation-step0",(function(e){e.selectAll(".bonds").ease("cubic"),t.translationStepStarted(n,1.45+3*n*lo.WIDTH,3.95,.53+3*n*lo.WIDTH,1.57,1e3)})),b(_().duration(500),"translation-step1",(function(e){e.selectAll(".trna-neck").duration(150),t.shiftAminoAcids(n,2*lo.WIDTH,500)})),n>0&&b(_().duration(900),"translation",(function(e){t.connectAminoAcid(n),e.selectAll(".bonds").duration(150)}))},"translation-end":function(){var t=e.geneticEngine();e.getNumberOfAtoms()>=1?(b(_(!0).duration(150),"translation-end-s0"),b(_().duration(800),"translation-end-s1",(function(e){t.translationCompleted(),e.selectAll(".bonds").duration(150)})),b(_().duration(800),"translation-end-s2",(function(t){t.selectAll(".bonds").duration(150)})),b(_().duration(500),"translation-end-s3")):b(_(!0).duration(500),"translation-end-s3"),b(_().duration(300),"translation-end-s4"),b(_().duration(1e3),"translation-end-s5"),b(_().duration(700),"translation-end",(function(){t.centerProtein(700)}))}},n={setup:v,render:y},e.geneticEngine().on("change",y),e.geneticEngine().on("transition",w),e.addPropertiesListener(["DNAMutations"],v),e.addPropertiesListener(["viewPortX"],(function(){if(l&&e.get("DNA")&&("transcription"!==c.name||!p)){var t=m.getState(f||c.name);g.mrna(l,t,!0),g.dna(l,t,!0),g.dnaComp(l,t,!0),!p&&"translation-end"===c.name&&e.getNumberOfAtoms()>0&&e.geneticEngine().centerProtein()}})),bo('[class~="dna"] [class~="clickable-nucleo"]',e,!1,t.i18n),bo('[class~="dna-comp"] [class~="clickable-nucleo"]',e,!0,t.i18n),n},wo="http://www.w3.org/2000/svg",Co=window.wrapSVGText=function(t,e,n,i,r){var o,a,s,l=/-/gi;t.search("\n")>0?(s=t.split("\n"),a=!0,o=[]):(s=t.split(/[\s-]/),a=!1,o=function(){for(var e,n=[];e=l.exec(t);)n.push(e.index);return n}());for(var u=0,c=0,h=1,d=0,p=0;p<s.length;p++){var f,m,g,v,y,b=s[p];if(u+=b.length+1,0===p||a||n>0&&c>n)p>0&&(a?(d=Math.max(v.getComputedTextLength(),d),h++):((m=v.firstChild.nodeValue).length>s[p-1].length+1?(y=m.slice(m.length-s[p-1].length-1),v.firstChild.nodeValue=m.slice(0,m.length-s[p-1].length-1)):m.length===s[p-1].length+1&&(v.firstChild.nodeValue=m.slice(0,m.length-1)),d=Math.max(v.getComputedTextLength(),d),h++)),(v=document.createElementNS(wo,"tspan")).setAttributeNS(null,"x",i),v.setAttributeNS(null,"dy",0===p?0:r),g=document.createTextNode(f),v.appendChild(g),e.appendChild(v),f=~o.indexOf(u-1)?b+"-":b+" ",p&&y&&(f=y+f);else~o.indexOf(u-1)?f+=b+"-":f+=b+" ";v.firstChild.nodeValue=f,c=v.getComputedTextLength(),a&&(d=Math.max(v.getComputedTextLength(),d)),a||p&&p===s.length-1&&n>0&&c>n&&(m=v.firstChild.nodeValue,v.firstChild.nodeValue=m.slice(0,m.length-s[p].length-1),(v=document.createElementNS(wo,"tspan")).setAttributeNS(null,"x",i),v.setAttributeNS(null,"dy",r),g=document.createTextNode(s[p]),v.appendChild(g),e.appendChild(v),h++)}return 0===d&&(d=e.childNodes[0].getComputedTextLength()),{lines:h,width:n>d?n:d,textWidth:d}},To={createRadialGradient:function(t,e,n,i,r){var o,a,s;return(a=r.select("defs")).empty()&&(a=r.append("defs")),(s=a.select("#"+t)).empty()?s=a.append("radialGradient").attr("id",t).attr("cx","50%").attr("cy","47%").attr("r","53%").attr("fx","35%").attr("fy","30%"):s.selectAll("stop").remove(),s.append("stop").attr("stop-color",e).attr("offset","0%"),s.append("stop").attr("stop-color",n).attr("offset","40%"),s.append("stop").attr("stop-color",i).attr("offset","80%"),s.append("stop").attr("stop-color",n).attr("offset","100%"),o="url(#"+t+")",this.mainColorOfGradient[o]=i,o},mainColorOfGradient:{},settleParens:function(t,e){var n,i,r;for(i=!1,t=t.split(""),n=0;n<t.length;n++)i?")"==t[n]?i=!1:"("==t[n]&&(t[r]=" ",r=n):"("==t[n]?e?(t[n]=" ",e=!1):(i=!0,r=n):")"==t[n]&&(t[n]=" ");return t.join("").replace(/\s+/," ").trim()},smartSplit:function(t,e){var n,i,r,o,a;for(t=this.settleParens(t,e),o=!1,r=[],i=1;i<t.length;i++)o?")"==t[i]&&(o=!1):","==t[i]||" "==t[i]?((a=t.slice(n,i).trim()).length>0&&r.push(this.parseWord(a)),n=i+1):"("==t[i]&&(o=!0);return i==t.length&&r.push(this.parseWord(t.slice(n,i).trim())),r},parseWord:function(t){var e,n;return e=new String(t),-1!=t.search(/(^|[^a-zA-Z])li?n?e?a?r?($|[^a-zA-Z])/)&&(e.isLinear=!0),-1!=t.search(/(^|[^a-zA-Z])ra?d?i?a?l?($|[^a-zA-Z])/)&&(e.isRadial=!0),-1!=t.search(/(^|[^a-zA-Z])gr?a?d?i?e?n?t?($|[^a-zA-Z])/)&&(e.isGradient=!0),-1!=t.search(/(\(|\))/)?(e.isParens=!0,e):(n=parseFloat(t),isNaN(n)||(e.asNumber=n),-1!=t.search(/(^|[^a-zA-Z])de?g?r?e?e?s?($|[^a-zA-Z])/)&&(e.isDegrees=!0),-1!=t.search(/(^|[^a-zA-Z])ri?g?h?t?($|[^a-zA-Z])/)&&(e.isRight=!0),-1!=t.search(/(^|[^a-zA-Z])le?f?t?($|[^a-zA-Z])/)&&(e.isLeft=!0),-1!=t.search(/(^|[^a-zA-Z])(t|u)o?p?($|[^a-zA-Z])/)&&(e.isTop=!0),-1!=t.search(/(^|[^a-zA-Z])bo?t?t?o?m?($|[^a-zA-Z])/)&&(e.isBottom=!0),-1!=t.search(/(^|[^a-zA-Z])re?pe?a?t?($|[^a-zA-Z])/)&&(e.isRepeat=!0),-1!=t.search(/(^|[^a-zA-Z])re?fl?e?c?t?($|[^a-zA-Z])/)&&(e.isReflect=!0),e)},interpolateStops:function(t){var e,n,i,r,o;if(0==t.length)return t;if("offset"in t[0]||(t[0].offset=0),1==t.length)return t;"offset"in t[t.length-1]||(t[t.length-1].offset=100);for(e=2;e<t.length;e++)if("offset"in t[e]&&!("offset"in t[e-1])){for(i=0,r=t[e].offset,n=e-2;n>=0;n--)if("offset"in t[n]){i=t[n].offset;break}o=(r-i)/(e-n);for(var a=n+1;a<e;a++)t[a].offset=i+o*(a-n)}return t},fullParse:function(t){if(-1==(t=t.trim().toLowerCase()).search(/[^#0-9a-zA-Z-]/))return{color:t};var e,n,i,r,o,a,s,l,u,c,h;for(t=t.replace(/[\n\r:;]/g," ").replace(/\/\*.*\*\/$/,"").replace(/\{\[/,"(").replace(/\}\]/,")").replace(/[^a-zA-Z0-9%#\-\(\)\., ]*/g,"").replace(/\s*-\s+/g,"-").replace(/\s*\(/g,"(").replace(/\s+/g," "),n=this.smartSplit(t,!1),s={},a=0;a<n.length;a++)!0!==n[a].isParens||!0!==n[a].isGradient&&!0!==n[a].isLinear&&!0!==n[a].isRadial||n.splice.apply(n,[a,1].concat(this.smartSplit(n[a],!0)));for(i=!1,o=!1,r=!1,h=!1,u=0,c=0,a=0;a<n.length;a++)l=!1,!0===n[a].isLeft?(u-=1,l=!0):!0===n[a].isRight&&(u+=1,l=!0),!0===n[a].isTop?(c+=1,l=!0):!0===n[a].isBottom&&(c-=1,l=!0),!0===n[a].isRadial&&!0!==n[a].isRight&&(o=!0,l=!0),!0===n[a].isLinear&&!0!==n[a].isLeft&&(r=!0,l=!0),"asNumber"in n[a]&&(!0===n[a].isDegrees||a+1<n.length&&!0===n[a+1].isDegrees)&&(!1===i&&(i=n[a].asNumber),l=!0),!0===n[a].isRepeat?(h="repeat",l=!0):!0===n[a].isReflect&&(h="reflect",l=!0),(l||!0===n[a].isDegrees||!0===n[a].isGradient)&&(n.splice(a,1),a--);for(!1!==i||0==u&&0==c||(i=180*Math.atan2(c,u)/Math.PI%360),e=[],a=0;a<n.length;a++)"asNumber"in n[a]||(a+1<n.length&&"asNumber"in n[a+1]?(e.push({color:n[a],offset:n[a+1].asNumber}),n.splice(a,2)):(e.push({color:n[a]}),n.splice(a,1)),a--);if(1==e.length)return{color:e[0].color};if(0==e.length)return{color:"none"};for(this.interpolateStops(e),a=0;a<n.length;a++)!0===n[a].isNumber&&!1===i&&(i=n[a].asNumber);return o&&!r?(i=!1,s.gradient="radial"):(!1===i&&(i=0),(i%=360)<0&&(i+=360),s.gradient="linear",s.direction=i),!1!==h&&(s.repeat=h),s.stops=e,s.standard=this.toStandardForm(s),s},parse:function(t){if(-1==(t=t.trim().toLowerCase().replace(/\s+/g," ")).search(/ /))return{color:t,standard:t};var e,n,i,r,o,a,s;if(i={},"linear"!=(r=(e=t.split(" ")).shift())&&"radial"!=r)return this.fullParse(t);if(i.gradient=r,"linear"==r){if(n=parseFloat(e.shift()),isNaN(n))return this.fullParse(t);(n%=360)<0&&(n+=360),i.direction=n,s=!0}if(i.stops=[],e.length%2!=0)return this.fullParse(t);for(o=0;o<e.length;o+=2){if(a=parseFloat(e[o+1]),isNaN(a))return this.fullParse(t);i.stops.push({color:e[o],offset:a})}return i.standard=s?this.toStandardForm(i):t,i},toCSS:function(t,e){var n,i;if("color"in t)e.style.backgroundColor=t.color.length?t.color:"inherit",e.style.backgroundImage="none";else{for(n="radial"==t.gradient?"-webkit-radial-gradient(ellipse,":"-webkit-linear-gradient("+t.direction+"deg, ",i=0;i<t.stops.length;i++)n+=t.stops[i].color+" "+t.stops[i].offset+"%",i<t.stops.length-1&&(n+=",");n+=")",e.style.backgroundColor="none",e.style.backgroundImage=n}},toStandardForm:function(t){var e,n;if("color"in t)return t.standard=t.color,t.color;for(e=t.gradient+" "+("linear"==t.gradient?t.direction+"deg ":""),n=0;n<t.stops.length;n++)e+=t.stops[n].color+" "+t.stops[n].offset+"%",n<t.stops.length-1&&(e+=" ");return t.standard=e,e},toSVG:function(t,e){if(t.color)return t.color;var n,i,r,o,a,s,l,u,c,h;if((n=e.select("defs")).empty()&&(n=e.append("defs")),r=t.standard.replace(/[^a-z0-9]/g,""),!(i=n.select("#"+r)).empty())return"url(#"+r+")";for("linear"==t.gradient?(l=-Math.cos(Math.PI*t.direction/180),u=-Math.sin(Math.PI*t.direction/180),Math.abs(u)>Math.abs(l)?(a=l*Math.abs(50/u),s=50*(u<0?-1:1)):(a=50*(l<0?-1:1),s=u*Math.abs(50/l)),i=n.append("linearGradient").attr("id",r).attr("x1",50+a+"%").attr("y1",50+s+"%").attr("x2",50-a+"%").attr("y2",50-s+"%")):i=n.append("radialGradient").attr("id",r).attr("cx","50%").attr("cy","50%").attr("r","50%").attr("fx","50%").attr("fy","50%"),o=0;o<t.stops.length;o++)h=i.append("stop").attr("stop-color",t.stops[o].color).attr("offset",t.stops[o].offset+"%"),4!=(c=t.stops[o].color.split(",")).length||isNaN(c=parseFloat(c[3]))||h.attr("stop-opacity",c);return"url(#"+r+")"}};function So(t,e){var n,i={};function o(e){return t.model2px(.01*e)}function a(){var a=[{},{}];n=[[],[]],(e.properties.images||[]).forEach((function(s){var u,c,h,d,p=1===s.imageLayer?1:0,f=n[p],m=a[p],g=function(n){var i=e.properties.imageMapping,o="";e.properties.imagePath?o=r.a.modelsRootUrl+e.properties.imagePath:t.url&&(o=r.a.modelsRootUrl+t.url.slice(0,t.url.lastIndexOf("/")+1));return o+(i[n.imageUri]||n.imageUri)}(s);s.imageHostType?(u=1,c=!1):(u=0,c=!0,h=t.model2px(s.imageX),d=t.model2pxInv(s.imageY)),function(e,n){if(!i[e]){i[e]={width:0,height:0};var r=new Image;r.src=e,r.onload=function(){var a=$(r).appendTo("body"),s=i[e];s.width=a.width()*n,s.height=a.height()*n,a.remove(),d3.select(t.node).selectAll("image").each((function(){d3.select(this).attr("xlink:href")===e&&d3.select(this).attr("width",o(s.width)).attr("height",o(s.height)).attr("transform",l)}))}}}(g,s.scale),f.push({imageDescription:s,src:g,srcIndex:void 0===m[g]?m[g]=0:++m[g],x:h,y:d,rotation:s.rotation,scale:s.scale,opacity:s.opacity,referencePoint:u,capturesPointer:c,zOrder:s.imageLayerPosition||0,visible:s.visible})})),n.forEach((function(t){t.sort((function(t,e){return d3.ascending(t.zOrder,e.zOrder)}))})),s()}function s(){n.forEach((function(n){n.forEach((function(n){var i,r,o,a,s,l=n.imageDescription,u=l.imageHostType,c=l.imageHostIndex,h=l.rotation||0;"Atom"===u?(a=(i=e.getAtoms())[c].x,s=i[c].y):"RectangularObstacle"===u?(a=(r=e.get_obstacles()).x[c]+r.width[c]/2,s=r.y[c]+r.height[c]/2):"RadialBond"===u&&(a=((o=e.getRadialBonds()[c]).x1+o.x2)/2,s=(o.y1+o.y2)/2,h+=180*Math.atan2(o.y1-o.y2,o.x1-o.x2)/Math.PI),void 0!==a&&(n.x=t.model2px(a),n.y=t.model2pxInv(s)),n.rotation=h}))}))}function l(t){var e,n,r=i[t.src],a=o(r.width/2),s=o(r.height/2);return 0===t.referencePoint?(e=t.x,n=t.y):(e=t.x-a,n=t.y-s),(0===t.rotation?["translate(",e,", ",n,")"]:["translate(",e,", ",n,") rotate(",-t.rotation,",",a,",",s,")"]).join("")}return{setup:function(){a(),d3.select(t.node).selectAll(".image-container").data(n).each((function(t){var e=d3.select(this).selectAll("image").data(t,(function(t){return t.src+"-"+t.srcIndex}));e.enter().append("image").attr("xlink:href",(function(t){return t.src})),e.attr({height:function(t){return o(i[t.src].height)},width:function(t){return o(i[t.src].width)},opacity:function(t){return t.opacity},"pointer-events":function(t){return t.capturesPointer?"auto":"none"},transform:l}).style("display",(function(t){return t.visible?"":"none"})),e.exit().remove()}))},update:function(){s(),d3.select(t.node).selectAll(".image-container image").attr("transform",l)},bindModel:function(t){e=t}}}var ko=[[255,0,0],[255,200,0],[255,255,0],[0,255,0],[0,255,255],[0,0,255],[139,0,255]];function Ao(t,e){var n,i,o,a,s,l,u,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E=t.i18n,M=!1,P=t.appendViewport().classed("below-atoms",!0),D=P.append("g").attr("class","shape-container-below"),O=(P.append("g").attr("class","image-container image-container-below"),P.append("g").attr("class","text-container-below")),I=t.appendViewport().classed("atoms",!0).append("g").attr("class","atoms-container"),L=t.appendPixiViewport(),R=t.appendPixiViewport(),N=t.appendPixiViewport(),F=t.appendPixiViewport(),B=t.appendPixiViewport(),z=t.appendViewport().classed("above-atoms",!0),j=z.append("g").attr("class","shape-container-top"),V=z.append("g").attr("class","line-container-top"),H=(z.append("g").attr("class","image-container image-container-top"),z.append("g").attr("class","text-container-top")),W=t.foregroundContainer.append("g").attr("class","icon-container"),U=new qr(t,e,F.pixiContainer,F.canvas),G=new to(t,e,N.pixiContainer,U),q=new io(t,e,R.pixiContainer),Y=new eo(B.pixiContainer,{get show(){return e.get("showVelocityVectors")},get length(){return e.get("velocityVectors").length},get width(){return e.get("velocityVectors").width},get color(){return e.get("velocityVectors").color},get dirOnly(){return!1},get count(){return n.length},x:function(t){return n[t].x},y:function(t){return n[t].y},vx:function(t){return 100*n[t].vx},vy:function(t){return 100*n[t].vy},m2px:t.model2canvas,m2pxInv:t.model2canvasInv}),X=new eo(B.pixiContainer,{get show(){return e.get("showForceVectors")},get length(){return e.get("forceVectors").length},get width(){return e.get("forceVectors").width},get color(){return e.get("forceVectors").color},get dirOnly(){return e.get("forceVectorsDirectionOnly")},get count(){return n.length},x:function(t){return n[t].x},y:function(t){return n[t].y},vx:function(t){var e=n[t];return e.ax*e.mass*100},vy:function(t){var e=n[t];return e.ay*e.mass*100},m2px:t.model2canvas,m2pxInv:t.model2canvasInv}),Q=new no(L.pixiContainer,{get show(){return e.get("showElectricField")},get length(){return.8*e.get("width")/e.get("electricFieldDensity")},get color(){var t=e.get("electricFieldColor");return"auto"!==t?t:Er.contrastingColor(e.get("backgroundColor"))},get count(){return i.length},x:function(t){return i[t].x},y:function(t){return i[t].y},vx:function(t){return i[t].fx},vy:function(t){return i[t].fy},alpha:function(t){var e=i[t];return Math.min(1,.3*Math.pow(e.fx*e.fx+e.fy*e.fy,.2))},m2px:t.model2canvas,m2pxInv:t.model2canvasInv}),K=new So(t,e),J=[],Z=[],tt=[],et=[],nt=!0,it=We.what_browser(),rt=Math.PI/2,ot="MSIE"===it.browser&&Number(it.version)>=10;function at(t,e,n){if(!e||"none"===e)return"none";var i,r="arrowhead-path"+e.toLowerCase().replace(/[^a-z0-9]/g,"")+(n?"start":"")+v.lineColor[t].toLowerCase().replace(/[^a-z0-9]/g,"");c[r]||((i=I.select("defs")).empty()&&(i=I.append("defs")),i.select("#"+r),I.append("marker").attr("id",r).attr("class","custom-arrow-head").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","4").attr("markerHeight","4").attr("orient","auto").append("path").attr("d",e).attr("fill",v.lineColor[t]).attr("transform",n?"translate(10, 10) rotate(180)":""),c[r]=!0);return"url(#"+r+")"}function st(){var t,n=e.get("temperatureControl"),i=e.get("keShading"),r=0,o=Math.max(h,12);n?(r+=1,t=W.select("#heat-bath").attr({y:r,width:2*o,height:2*o}).style("display",""),r+=parseInt(t.attr("height"),10)):W.select("#heat-bath").style("display","none"),i?(r+=1,W.select("#ke-gradient").attr({y:r,width:2.2*o,height:6*o}).style("display","")):W.select("#ke-gradient").style("display","none")}function lt(t){var e,i,r,o,a,u,c,h,d=s(t.fontSize);return e=t.x,i=t.y,t.hostType&&(nt=!1,"Atom"===t.hostType?(r=n[t.hostIndex].x,o=n[t.hostIndex].y):(r=p.x[t.hostIndex]+p.width[t.hostIndex]/2,o=p.y[t.hostIndex]+p.height[t.hostIndex]/2)),t.hostType&&!t.calloutPoint&&(e=r,i=o),t.calloutPoint&&(t.hostType?(c=r,h=o):(c=t.calloutPoint[0],h=t.calloutPoint[1])),[(a=s(e))+.75*d,(u=l(i))+1.2*d,a,u,c=s(c),h=l(h)]}function ut(t,e,n,i,r){var o=[parseFloat(t[0]),parseFloat(t[1])],a=[parseFloat(e.getAttribute("x"))+n/2,parseFloat(e.getAttribute("y"))+i/2],s=rt-Math.atan((o[0]-a[0])/(o[1]-a[1])),l=Math.min(r,i/2),u=Math.sin(s)*l,c=Math.cos(s)*l;return a[0]+u+", "+(a[1]-c)+" "+(a[0]-u)+", "+(a[1]+c)+" "+o}function ct(){var t,e=[H,O];(t=function(t){var n=e[t-1],i=w.filter((function(e){return e.layer===t}));n.selectAll("g.textBoxWrapper rect").data(i.filter((function(t){return t.frame}))).attr({x:function(t){return lt(t)[2]},y:function(t){return lt(t)[3]},transform:function(t){var e=t.rotate,n=lt(t);return"rotate("+e+" "+n[0]+" "+n[1]+")"}}),n.selectAll("g.textBoxWrapper text").data(i).attr({y:function(t){return $(this).find("tspan").attr("x",lt(t)[0]),lt(t)[1]}}),n.selectAll("g.textBoxWrapper polygon").data(i.filter((function(t){return t.calloutPoint}))).attr({"callout-location-data":function(t){var e=lt(t);return e[4]+", "+e[5]}})})(1),t(2),$(".textBox").each((function(){var t,e,n,i,r=$(this.parentNode),o=r.find("polygon"),a=r.find("rect")[0];a&&0!==o.length&&(t=parseFloat(this.getAttributeNS(null,"font-size")),e=a.getAttribute("width"),n=a.getAttribute("height"),i=o.attr("callout-location-data").split(", "),o.attr("points",ut(i,a,e,n,t)))}))}function ht(){var t,n,i,o="Chrome"===it.browser&&!!it.oscpu.match(/Windows|Mac OS X/);w=e.get("textBoxes"),t=[e.get("width"),e.get("height")],n=[H,O],(i=function(e){var i,a,l,u=n[e-1];u.selectAll("g.textBoxWrapper").remove(),a=w.filter((function(t){return t.layer===e})),(i=(l=u.selectAll("g.textBoxWrapper").data(a)).enter().append("svg:g").attr("class","textBoxWrapper")).filter((function(t){return t.calloutPoint})).append("polygon").attr({points:"0,0 0,0 0,0",style:function(t){var e=t.backgroundColor,n=t.strokeWidthEms*h,i=t.strokeOpacity;return"fill:"+e+";opacity:1.0;fill-opacity:1;stroke:"+t.strokeColor+";stroke-width:"+2*n+";stroke-opacity:"+i},"callout-location-data":function(t){var e=lt(t);return e[4]+", "+e[5]}}),i.filter((function(t){return t.frame})).append("rect").attr({class:function(t,e){return"textBoxFrame text-"+e},id:function(t,e){return"text-"+e},transform:function(t){var e=t.rotate,n=lt(t);return"rotate("+e+" "+n[0]+" "+n[1]+")"},style:function(t){var e=t.backgroundColor,n=t.strokeWidthEms*h,i=t.strokeOpacity,r=t.strokeColor;return o&&n<1&&(i*=n,n=1),"fill:"+e+";opacity:1.0;fill-opacity:1;stroke:"+r+";stroke-width:"+n+";stroke-opacity:"+i},width:0,height:0,rx:function(t){return"rounded rectangle"===t.frame?s(t.fontSize)/2.5:0},ry:function(t){return"rounded rectangle"===t.frame?s(t.fontSize)/2:0},x:function(t){return lt(t)[2]},y:function(t){return lt(t)[3]}}),i.filter((function(t){return t.calloutPoint})).append("polygon").attr({points:"0,0 0,0 0,0",style:function(t){return"fill:"+t.backgroundColor+";opacity:1.0;fill-opacity:1;stroke:#000000;stroke-width:0;"}}),i.append("text").attr({class:function(){return"textBox"+(AUTHORING?" draggable":"")},transform:function(t){var e=t.rotate,n=lt(t);return"rotate("+e+" "+n[0]+" "+n[1]+")"},"x-data":function(t){return lt(t)[0]},y:function(t){return lt(t)[1]},"width-data":function(t){return t.width},"height-data":function(t){return t.height},width:s(t[0]),height:s(t[1]),"xml:space":"preserve","font-family":"'"+r.a.fontface+"', sans-serif","font-size":function(t){return s(t.fontSize)+"px"},fill:function(t){return t.color||"black"},"text-data":function(t){return t.text},"text-anchor":function(t){var e=t.textAlign||"left";return"center"===e&&(e="middle"),e},"has-host":function(t){return!!t.hostType},"pointer-events":function(t){return t.hostType?"none":"auto"}}).call(d3.behavior.drag().on("drag",vt).on("dragend",(function(t){$n.a.log('"x": '+t.x+","),$n.a.log('"y": '+t.y+",")}))),l.exit().remove()})(1),i(2),$(".textBox").each((function(){var t,e,n,i,r,o,a,l,u,c,h,d=this.getAttributeNS(null,"text-data"),p=this.getAttributeNS(null,"x-data"),f=this.getAttributeNS(null,"width-data"),m=this.getAttributeNS(null,"height-data"),g=parseFloat(this.getAttributeNS(null,"font-size")),v=this.getAttributeNS(null,"transform"),y=this.getAttributeNS(null,"has-host"),b=this.getAttributeNS(null,"text-anchor"),_=$(this.parentNode);for(a=1.2*g,t=1.5*+g,e=g/1.8,f=""===f?-1:s(f),m=""===m?-1:s(m);this.firstChild;)this.removeChild(this.firstChild);n=Co(d,this,f,p,a),_.find("rect").length>0&&(o=_.find("rect")[0],i=n.width+t,o.setAttributeNS(null,"width",i),r=m>0?m:n.lines*a+e,o.setAttributeNS(null,"height",r)),c=_.find("polygon"),o&&c.length>0&&(h=c.attr("callout-location-data").split(", "),c.attr("points",ut(h,o,i,r,g))),"middle"===b&&(v=v+" translate("+(l=n.width/2)+","+(u=m>0?m/2-1.5*e-(n.lines-1)*a/2:0)+")",$(this).attr("transform",v)),"true"===y&&0===c.length&&(l=n.width/-2-t/2,u=n.lines*a/-2-e/2,_.attr("transform","translate("+l+","+u+")"))}))}function dt(){var t;p=e.get_obstacles(),I.selectAll("g.obstacle").remove(),p&&(J.length=p.x.length,d=I.selectAll("g.obstacle").data(J),(t=d.enter().append("g")).attr("class","obstacle").attr("transform",(function(t,e){return"translate("+s(p.x[e])+" "+l(p.y[e]+p.height[e])+")"})),t.append("rect").attr({class:"obstacle-shape",x:0,y:0,width:function(t,e){return s(p.width[e])},height:function(t,e){return s(p.height[e])},fill:function(t,e){return p.visible[e]?To.toSVG(To.parse(p.color[e]),I):"transparent"},"stroke-width":function(t,e){return p.visible[e]?.2:0},stroke:function(t,e){return p.visible[e]?To.toSVG(To.parse(p.color[e]),I):"transparent"}}),t.each((function(t,e){if(p.displayExternalAcceleration[e]&&(p.externalAx[e]||p.externalAy[e])){var n,i,r=d3.select(this),o=p.height[e],a=p.width[e],l=p.externalAx[e],u=p.externalAy[e];l&&(n=(o-.12)/Math.round((o-.12)/.2),i=d3.range(.06,o,n),r.selectAll("path.obstacle-force-hor").data(i).enter().append("path").attr({class:"obstacle-force-hor",d:function(t){return l<0?"M "+s(a+.06+.06)+","+s(t)+" L "+s(a+.06)+","+s(t):"M "+s(-.12)+","+s(t)+" L "+s(-.06)+","+s(t)}})),u&&(n=(a-.12)/Math.round((a-.12)/.2),i=d3.range(.06,a,n),r.selectAll("path.obstacle-force-vert").data(i).enter().append("path").attr({class:"obstacle-force-vert",d:function(t){return u<0?"M "+s(t)+","+s(-.12)+" L "+s(t)+","+s(-.06):"M "+s(t)+","+s(o+.06+.06)+" L "+s(t)+","+s(o+.06)}})),r.selectAll("path.obstacle-force-hor, path.obstacle-force-vert").attr({"marker-end":ot?"":"url(#Triangle-force)","stroke-width":s(x),stroke:_,fill:"none"})}})))}function pt(){if(f=e.get_shapes(),j.selectAll(".shape").remove(),D.selectAll(".shape").remove(),f){Z=[],tt=[];for(var t=0;t<f.x.length;t++)1===f.layer[t]?Z.push({index:t,layerPosition:f.layerPosition[t]}):tt.push({index:t,layerPosition:f.layerPosition[t]});Z.sort((function(t,e){return t.layerPosition-e.layerPosition})),tt.sort((function(t,e){return t.layerPosition-e.layerPosition})),m=j.selectAll(".shape").data(Z),g=D.selectAll(".shape").data(tt),function(){var t,e=[m,g];for(t=0;t<e.length;t++){var n=e[t].enter().append("g");n.attr("class","shape").attr("transform",(function(t){return"translate("+s(f.x[t.index])+" "+l(f.y[t.index]+f.height[t.index])+")"})),n.append("rect").attr({class:"shape-rectangle",x:0,y:0,width:function(t){return s(f.width[t.index])},height:function(t){return s(f.height[t.index])},fill:function(t){return f.visible[t.index]&&"rectangle"===f.type[t.index]?To.toSVG(To.parse(f.color[t.index]),I):"transparent"},"stroke-width":function(t){return f.lineWeight[t.index]},"stroke-dasharray":function(t){return f.lineDashes[t.index]},stroke:function(t){return f.visible[t.index]&&"rectangle"===f.type[t.index]?f.lineColor[t.index]:"transparent"}}),n.append("ellipse").attr({class:"shape-ellipse",cx:function(t){return s(f.width[t.index])/2},cy:function(t){return s(f.height[t.index])/2},rx:function(t){return s(f.width[t.index])/2},ry:function(t){return s(f.height[t.index])/2},fill:function(t){return f.visible[t.index]&&"ellipse"===f.type[t.index]?To.toSVG(To.parse(f.color[t.index]),I):"transparent"},"stroke-width":function(t){return f.lineWeight[t.index]},"stroke-dasharray":function(t){return f.lineDashes[t.index]},stroke:function(t){return f.visible[t.index]&&"ellipse"===f.type[t.index]?f.lineColor[t.index]:"transparent"}})}}()}}function ft(){v=e.get_lines(),et.length=v.x1.length,(y=V.selectAll(".line").data(et)).exit().remove(),v&&(y.enter().append("line"),y.attr({class:"line",x1:function(t,e){return s(v.x1[e])},y1:function(t,e){return l(v.y1[e])},x2:function(t,e){return s(v.x2[e])},y2:function(t,e){return l(v.y2[e])},"stroke-width":function(t,e){return v.lineWeight[e]},"stroke-dasharray":function(t,e){return v.lineDashes[e]},stroke:function(t,e){return v.lineColor[e]},"marker-start":function(t,e){return at(e,v.beginStyle[e],!0)},"marker-end":function(t,e){return at(e,v.endStyle[e])},visibility:function(t,e){return v.visible[e]?"visible":"hidden"}}))}function mt(){I.selectAll("path.atomTrace").remove(),A="",C=e.get("showAtomTrace"),T=e.get("atomTraceId"),C&&(k=I.selectAll("path.atomTrace").data([n[T]])).enter().append("path").attr({class:"atomTrace",d:gt,"stroke-width":s(.01),stroke:S,fill:"none","stroke-dasharray":"6, 6"})}function gt(t){var e,n,i=Math.floor(100*s(t.x))/100,r=Math.floor(100*l(t.y))/100;return A?((A+=i+","+r+" ").length>4e3&&(e=A.indexOf("L"),n=A.indexOf(" "),A="M"+A.slice(e+1,n)+"L"+A.slice(n+1)),A):(A="M"+i+","+r+"L","M "+i+","+r)}function vt(t){var n=s.invert(d3.event.dx),i=s.invert(d3.event.dy);AUTHORING&&e.isStopped()&&(t.x=t.x+n,t.y=t.y-i,ct())}function yt(){var n=We.what_browser();function i(e,n,i){if(e()){var r=t.$el.parent().find("#"+n);0===r.length&&((r=$("<div id='"+n+"' class='warning-pane'>"+i+"</div>")).on("click",(function(){$(this).fadeOut()})),r.appendTo(t.$el.parent()));var o=t.pos();r.css({width:o.width-20,top:o.bottom-r.height()-10,left:o.left+10})}}i((function(){return"Firefox"===n.browser&&n.version>="18"&&n.version<"23"}),"ff1823warning","<a href='http://blog.concord.org/serious-performance-regression-in-firefox-18-and-newer' class='opens-in-new-window' target='_blank'>Firefox v18-22 performance issue...</a>)"),i((function(){return"Firefox"===n.browser&&-1!==n.oscpu.indexOf("Windows")&&n.version>="27"&&n.version<"28"}),"ff27warning","Because of a problem in Firefox 27 with certain types of graphics (SVG), you may see minor visual problems with some models. We recommend using another browser until Firefox 28 becomes available."),i((function(){return e.get("DNA")&&"Safari"===n.browser&&0===n.version.indexOf("6.1")}),"saf61DNAwarning","This model may have visual problems on Safari 6. We recommend upgrading Safari, or using another browser.")}function bt(){_=e.get("forceVectors").color,x=e.get("forceVectors").width,function(t,e){var n,i="Triangle-"+e;(n=I.select("defs")).empty()&&(n=I.append("defs")),n.select("#"+i).remove(),n.append("marker").attr("id","Triangle-"+e).attr("viewBox","0 0 10 10").attr("refX","0").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","4").attr("markerHeight","3").attr("orient","auto").attr("stroke",t).attr("fill",t).append("path").attr("d","M 0 0 L 10 5 L 0 10 z")}(_,"force"),c={},I.selectAll(".custom-arrow-head").remove(),S=e.get("atomTraceColor")}function _t(){var n;(b=e.properties.useQuantumDynamics)&&function(){var t,e;(t=I.select("defs")).empty()&&(t=I.append("defs")),(e=t.select("#glow")).empty()&&((e=t.append("filter").attr("id","glow").attr("x","-2").attr("y","-2").attr("width","800%").attr("height","800%")).append("feMorphology").attr("result","bigger").attr("in","SourceGraphic").attr("operator","dilate").attr("radius","6"),e.append("feGaussianBlur").attr("result","blurOut").attr("in","bigger").attr("stdDeviation","10"),e.append("feBlend").attr("in","SourceGraphic").attr("in2","blurOut").attr("mode","normal"))}(),n=Math.max(h,12),W.select("#heat-bath").empty()&&W.append("image").attr({id:"heat-bath",x:"1%",width:2*n,height:2*n,preserveAspectRatio:"xMinYMin","xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNC4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDQzMzYzKSAgLS0+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgd2lkdGg9Ijk2LjIzNnB4IiBoZWlnaHQ9IjUzLjMyMXB4IiB2aWV3Qm94PSIxLjc2NCAxMy44MSA5Ni4yMzYgNTMuMzIxIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDEuNzY0IDEzLjgxIDk2LjIzNiA1My4zMjEiDQoJIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8xXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSItNjIyIiB5MT0iOTQ1LjU2MSIgeDI9Ii02MjIiIHkyPSI5MjYuNDM5OSI+DQoJPHN0b3AgIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6IzU1NTU1NSIvPg0KCTxzdG9wICBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiNGRkZGRkYiLz4NCjwvbGluZWFyR3JhZGllbnQ+DQo8cGF0aCBmaWxsPSIjRTZFN0U4IiBzdHJva2U9InVybCgjU1ZHSURfMV8pIiBzdHJva2Utd2lkdGg9IjAuNSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNNzEuMzMsMTQuMzg0DQoJYy04Ljk0MiwwLTE2LjgyNyw0LjQ1OS0yMS41OTYsMTEuMjY1Yy00Ljc3LTYuODAzLTEyLjY1NS0xMS4yNjUtMjEuNTk4LTExLjI2NWMtMTQuNTY0LDAtMjYuMzczLDExLjgwNi0yNi4zNzMsMjYuMzczDQoJYzAsMTQuNTY4LDExLjgwNSwyNi4zNzQsMjYuMzczLDI2LjM3NGM4Ljk0MiwwLDE2LjgyOC00LjQ2LDIxLjU5OC0xMS4yNjZjNC43NjksNi44MDIsMTIuNjUzLDExLjI2NiwyMS41OTYsMTEuMjY2DQoJYzE0LjU2NiwwLDI2LjM3Mi0xMS44MDYsMjYuMzcyLTI2LjM3NEM5Ny43MDIsMjYuMTksODUuODk2LDE0LjM4NCw3MS4zMywxNC4zODR6Ii8+DQo8cGF0aCBmaWxsPSIjNTU1NTU1IiBkPSJNMzEuNDQ4LDQ3LjcxOVYyNy4xMzNjMC0xLjE2LTAuOTQxLTIuMS0yLjEwMi0yLjFjLTEuMTU3LDAtMi4wOTUsMC45NC0yLjA5NSwyLjF2MjAuNTg2DQoJYy0xLjM4NSwwLjc1Mi0yLjMzOCwyLjE5Ni0yLjMzOCwzLjg4MWMwLDIuNDQ3LDEuOTg2LDQuNDI4LDQuNDMzLDQuNDI4YzIuNDUxLDAsNC40MzQtMS45OCw0LjQzNC00LjQyOA0KCUMzMy43ODMsNDkuOTE2LDMyLjgzLDQ4LjQ3MSwzMS40NDgsNDcuNzE5eiIvPg0KPHBhdGggZmlsbD0iIzU1NTU1NSIgZD0iTTgwLjIwOSwzNy42NjN2LTMuOTc0YzAtNC43NzUtMy44ODItOC42NTktOC42NTMtOC42NTlTNjIuOSwyOC45MTUsNjIuOSwzMy42ODl2My45NzRoLTIuMDY3djE1Ljk3M2gyMS43Mg0KCVYzNy42NjNIODAuMjA5eiBNNjYuMjM5LDMzLjY4OWMwLTIuOTMsMi4zODQtNS4zMTYsNS4zMTMtNS4zMTZjMi45MzEsMCw1LjMxNiwyLjM4Niw1LjMxNiw1LjMxNnYzLjk3NGgtMTAuNjNWMzMuNjg5eiIvPg0KPC9zdmc+DQo=",class:"opaque-on-hover"}).append("title").text(E.t("md2d.heatbath_icon_tooltip")),W.select("#ke-gradient").empty()&&W.append("image").attr({id:"ke-gradient",x:"0",width:2.2*n,height:6*n,preserveAspectRatio:"xMinYMin","xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNC4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDQzMzYzKSAgLS0+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgd2lkdGg9IjM5cHgiIGhlaWdodD0iMTExcHgiIHZpZXdCb3g9IjI1LjUgNC4wOTMgMzkgMTExIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDI1LjUgNC4wOTMgMzkgMTExIiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwYXRoIGZpbGw9IiNFNkU3RTgiIGQ9Ik02MC45MTUsMTA2LjAzOGMwLDYuODEtMS4wNTMsNy45Mi03LjY4LDcuOTJsLTE0LjQ0NSwwLjI3M2MtNi42MjcsMC03LjYyNS0xLjM4NC03LjYyNS04LjE5M1YxMy41NjMNCgljMC02LjgxLDAuOTk4LTguMjIsNy42MjUtOC4yMmgxNC40NDVjNi42MjcsMCw3LjY4LDEuNDEsNy42OCw4LjIyVjEwNi4wMzh6Ii8+DQo8bGluZWFyR3JhZGllbnQgaWQ9IlNWR0lEXzFfIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9Ijk4Ni4wNDQ5IiB5MT0iMTI5MC41MjY2IiB4Mj0iOTg2LjA0NDkiIHkyPSIxMjI2LjEzMjEiPg0KCTxzdG9wICBvZmZzZXQ9IjAiIHN0eWxlPSJzdG9wLWNvbG9yOiNBN0E5QUMiLz4NCgk8c3RvcCAgb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojRkZGRkZGIi8+DQo8L2xpbmVhckdyYWRpZW50Pg0KPHBhdGggZmlsbD0iI0U2RTdFOCIgc3Ryb2tlPSJ1cmwoI1NWR0lEXzFfKSIgc3Ryb2tlLXdpZHRoPSIwLjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTM2Ljk3MSwyNC43NjMNCgljMC0yLjAwNSwxLjYyNC0zLjYyOCwzLjYyOC0zLjYyOGgxMC45MzdjMi4wMDQsMCwzLjYyOCwxLjYyMiwzLjYyOCwzLjYyOHY2OC40NThjMCwyLjAwMy0xLjYyNCwzLjYyOS0zLjYyOCwzLjYyOUg0MC41OTkNCgljLTIuMDA0LDAtMy42MjgtMS42MjUtMy42MjgtMy42MjlWMjQuNzYzeiIvPg0KPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8yXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSIxMjQ1LjU4ODkiIHkxPSI4OTAuMDQ1MiIgeDI9IjEyNDUuNTg4OSIgeTI9Ijk2Mi4yNiIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgtMSAwIDAgMSAxMjkxLjYyODkgLTg2Ny4yMzgzKSI+DQoJPHN0b3AgIG9mZnNldD0iMC4wMDQzIiBzdHlsZT0ic3RvcC1jb2xvcjojRUY0MTM2Ii8+DQoJPHN0b3AgIG9mZnNldD0iMC4xNjUzIiBzdHlsZT0ic3RvcC1jb2xvcjojRjE2MDRCIi8+DQoJPHN0b3AgIG9mZnNldD0iMC41MTg5IiBzdHlsZT0ic3RvcC1jb2xvcjojRjc5RTg1Ii8+DQoJPHN0b3AgIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6I0ZGRkZGRiIvPg0KPC9saW5lYXJHcmFkaWVudD4NCjxwYXRoIGZpbGw9InVybCgjU1ZHSURfMl8pIiBkPSJNNDIuODI3LDk1LjAyM2MtMi4yMTUsMC00LjAwOS0xLjc5Ni00LjAwOS00LjAxMVYyNi44OTNjMC0yLjI1NywxLjgyOC00LjA4Niw0LjA4NS00LjA4Nmg2LjI3NA0KCWMyLjI1NywwLDQuMDg2LDEuODI5LDQuMDg2LDQuMDg2djY0LjExOWMwLDIuMjE1LTEuNzk1LDQuMDExLTQuMDExLDQuMDExSDQyLjgyN3oiLz4NCjxyZWN0IHg9IjE0LjM5NyIgeT0iOS42MDciIGZpbGw9Im5vbmUiIHdpZHRoPSI2MS4zNiIgaGVpZ2h0PSIxNC44MTIiLz4NCjx0ZXh0IHRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIDEgMzQuNjA2IDE3LjAxMjkpIiBmb250LWZhbWlseT0iJ0FyaWFsTVQnIiBmb250LXNpemU9IjkuNDc5OCI+SElHSDwvdGV4dD4NCjxyZWN0IHg9IjE0LjM5NyIgeT0iMTAzLjAzMyIgZmlsbD0ibm9uZSIgd2lkdGg9IjYxLjM2IiBoZWlnaHQ9IjE0LjgxMiIvPg0KPHRleHQgdHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgMSAzNS4yOTMgMTA4LjY2OTIpIiBmb250LWZhbWlseT0iJ0FyaWFsTVQnIiBmb250LXNpemU9IjkuNDc5OCI+TE9XPC90ZXh0Pg0KPC9zdmc+DQo=",class:"opaque-on-hover"}).append("title").text(E.t("md2d.ke_icon_tooltip")),u=new xo(t,e)}function xt(t){var e,n=[],i=d3.svg.line().x((function(t){return s(.0125*t.x)})).y((function(t){return s(.1*t.y)})),r=2*t.angularFrequency*Math.PI/40;for(e=0;e<40;e++)n.push({x:e-20,y:Math.sin(e*r)/(1+.01*(e-20)*(e-20))});return i(n)}function wt(t){var e=t.angularFrequency;if(e<=5||e>=12)return"rgba(0,0,0,0.8)";var n=Math.floor((e-5)/1);if(6===n)return"rgb("+ko[n].join(",")+")";var i=(e-5-1*n)/1,r=ko[n][0],o=ko[n+1][0],a=ko[n][1],s=ko[n+1][1],l=ko[n][2],u=ko[n+1][2];return"rgb("+Math.floor(r+i*(o-r))+","+Math.floor(a+i*(s-a))+","+Math.floor(l+i*(u-l))+")"}function Ct(t){var e=t.angularFrequency;return e<=5||e>=12?"4,2":null}function Tt(){var t=I.selectAll(".photon").data(e.getPhotons(),(function(t){return t.id}));t.enter().append("path").attr({class:"photon",d:xt,stroke:wt,"stroke-dasharray":Ct,"stroke-width":s(.011),"fill-opacity":0}),t.exit().remove(),t.attr("transform",(function(t){return"translate("+s(t.x)+", "+l(t.y)+") rotate("+t.angle+")"}))}function St(){function r(e){return function(){e(),t.updateClickHandlers()}}function u(){Q.setup(),t.renderCanvas()}s=t.model2px,l=t.model2pxInv,h=t.getFontSizeInPixels(),n=e.getAtoms(),i=e.getElectricField(),e.get_elements(),o=e.get("width"),a=e.get("height"),o/a,_t(),e.addPropertiesListener(["temperatureControl","keShading"],st),e.addPropertiesListener(["chargeShading","chargeShadingStyle","showChargeSymbols","useThreeLetterCode","showAtomTrace","atomTraceId","aminoAcidColorScheme","backgroundColor","markColor","forceVectorsDirectionOnly"],r(kt)),e.addPropertiesListener(["electricFieldDensity","showElectricField","electricFieldColor"],u),e.addPropertiesListener(["showVelocityVectors","velocityVectors"],(function(){Y.setup(),t.renderCanvas()})),e.addPropertiesListener(["showForceVectors","forceVectors","forceVectorsDirectionOnly"],(function(){X.setup(),t.renderCanvas()})),e.addPropertiesListener(["showVDWLines","VDWLinesCutoff"],(function(){q.setup(),t.renderCanvas()})),e.on("addAtom",r((function(){U.setup(),Y.setup(),X.setup(),Q.update(),t.renderCanvas()}))),e.on("removeAtom",r((function(){U.setup(),Y.setup(),X.setup(),Q.update(),t.renderCanvas()}))),e.on("addRadialBond",r((function(){G.setup(),t.renderCanvas()}))),e.on("removeRadialBond",r((function(){G.setup(),t.renderCanvas()}))),e.on("textBoxesChanged",r(ht)),e.on("imagesChanged",r(K.setup)),e.on("addElectricField",u),e.on("removeElectricField",u),e.on("changeElectricField",u),yt(),M=!0}function kt(e,n){arguments.length&&(s=e,l=n),h=t.getFontSizeInPixels(),bt(),dt(),U.setup(),G.setup(),q.setup(),pt(),ft(),u.setup(),Y.setup(),X.setup(),Q.setup(),mt(),K.setup(),ht(),st(),yt(),b&&Tt()}function At(){$n.a.time("view update"),p&&d.attr("transform",(function(t,e){return"translate("+s(p.x[e])+" "+l(p.y[e]+p.height[e])+")"})),f&&(m.attr("transform",(function(t){return"translate("+s(f.x[t.index])+" "+l(f.y[t.index]+f.height[t.index])+")"})),g.attr("transform",(function(t){return"translate("+s(f.x[t.index])+" "+l(f.y[t.index]+f.height[t.index])+")"}))),U.update(),G.update(),q.update(),Y.update(),X.update(),Q.update(),C&&k.attr({d:gt}),e.properties.images&&0!==e.properties.images.length&&K.update(),w&&w.length>0&&!nt&&ct(),b&&Tt(),$n.a.timeEnd("view update")}return{setup:function(){M||St()},update:function(){M&&At()},repaint:function(){M&&kt()},bindModel:function(t){e=t,U.bindModel(t),G.bindModel(t),q.bindModel(t),K.bindModel(t),St()}}}var Eo=function(t,e,n){return new Tr(t,e,Ao,{i18n:n})};function Mo(t){var e,n,i,r,o,a,s=t.get("DNA");return e={open:function(){o.text(""),a.removeAttr("disabled"),i.val(t.get("DNA")),n.dialog("open")},bindModel:function(e){e!==t&&(s=(t=e).get("DNA"),r.val(s))}},n=$("<div></div>"),$("<div>Enter DNA sequence below</div>").appendTo(n),$("<div>&nbsp;</div>").appendTo(n),(r=$('<input type="text" size="55" disabled/>')).val(s),$("<div>Original sequence</div>").append(r).appendTo(n),i=$('<input type="text" id="dna-sequence-input" size="55"/>'),$("<div>Edited sequence</div>").prepend(i).appendTo(n),(o=$('<p class="error"></p>')).appendTo(n),n.dialog({dialogClass:"dna-edit-dialog",appendTo:".lab-responsive-content",title:"DNA Sequence",autoOpen:!1,width:"35em",buttons:{Apply:function(){t.set({DNA:i.val()}),$(this).dialog("close")}}}),a=$(".dna-edit-dialog button:contains('Apply')"),i.on("input",(function(){try{t.getPropertyValidateFunc("DNA")(i.val()),a.button("enable"),o.text("")}catch(t){a.button("disable"),o.text(t.message)}})),e}function Po(t){var e=null,n=0,i=function(){var e,n=arguments[0],i=arguments[1];Array.isArray(i)?(e=Array.prototype.slice.call(arguments,2,arguments.length),t.api.batch((function(){for(var t=0,r=i[0];t<i.length;r=i[++t])n.apply(null,Array.prototype.concat(r,e))}))):(e=Array.prototype.slice.call(arguments,1,arguments.length),n.apply(null,e)),t.api.repaintIfReady()};function r(e){return function(n,i){try{t.model[e].call(t.model,n)}catch(t){if(!i||!i.silent)throw t}t.api.repaintIfReady()}}return{getCurrentComputerTime:function(){return Date.now()},getNumberOfAtoms:function(e){return t.model.getNumberOfAtoms(e)},getNumberOfObstacles:function(){return t.model.getNumberOfObstacles()},getNumberOfElements:function(){return t.model.getNumberOfElements()},getNumberOfRadialBonds:function(){return t.model.getNumberOfRadialBonds()},getNumberOfAngularBonds:function(){return t.model.getNumberOfAngularBonds()},addAtom:function(e){return t.model.addAtom(e)},removeAtom:function(e,n){try{t.model.removeAtom(e,n)}catch(t){if(!n||!n.silent)throw t}},removeRadialBond:function(e,n){try{t.model.removeRadialBond(e)}catch(t){if(!n||!n.silent)throw t}t.api.repaintIfReady()},removeAngularBond:function(e,n){try{t.model.removeAngularBond(e)}catch(t){if(!n||!n.silent)throw t}t.api.repaintIfReady()},addRadialBond:function(e){t.model.addRadialBond(e),t.api.repaintIfReady()},addRestraint:function(e){t.model.addRestraint(e),t.api.repaintIfReady()},setRestraintProperties:function(e,n){t.model.setRestraintProperties(e,n),t.api.repaintIfReady()},addAngularBond:function(e){t.model.addAngularBond(e),t.api.repaintIfReady()},addRandomAtom:function(){return t.model.addRandomAtom.apply(t.model,arguments)},adjustTemperature:function(e){t.model.set({targetTemperature:e*t.model.get("targetTemperature")})},setTemperatureOfAllAtoms:function(e){for(var n=[],i=0;i<t.model.getNumberOfAtoms();i++)n.push(i);t.model.setTemperatureOfAtoms(n,e)},setTemperatureOfAtoms:function(e,n){t.model.setTemperatureOfAtoms(e,n)},addKEToAtoms:function(e,n){t.model.addKEToAtoms(e,n)},getTemperatureOfAllAtoms:function(){for(var e=[],n=0;n<t.model.getNumberOfAtoms();n++)e.push(n);return t.model.getTemperatureOfAtoms(e)},getTemperatureOfAtoms:function(e){return t.model.getTemperatureOfAtoms(e)},limitHighTemperature:function(e){t.model.get("targetTemperature")>e&&t.model.set({targetTemperature:e})},randomAtoms:function(e){var n=t.model.getNumberOfAtoms();if(null===e&&(e=1+t.api.randomInteger(n-1)),!t.api.isInteger(e))throw new Error("randomAtoms: number of atoms requested, "+e+", is not an integer.");if(e<0)throw new Error("randomAtoms: number of atoms requested, "+e+", was less be greater than zero.");return e>n&&(e=n),t.api.choose(e,n)},turnOnLightSource:function(){t.model.turnOnLightSource()},turnOffLightSource:function(){t.model.turnOffLightSource()},setLightSourceAngle:function(e){t.model.setLightSourceAngle(e)},setLightSourceFrequency:function(e){t.model.setLightSourceFrequency(e)},setLightSourcePeriod:function(e){t.model.setLightSourcePeriod(e)},setLightSourceNumber:function(e){t.model.setLightSourceNumber(e)},setBondEnergy:function(e,n){t.model.setBondEnergy(e,n)},setValenceElectrons:function(e,n){t.model.setValenceElectrons(e,n),t.api.repaintIfReady()},atomsWithinCircle:function(e,n,i,r){var o,a,s,l=[];for(a=0,s=t.model.getNumberOfAtoms();a<s;a++)o=t.model.getAtomProperties(a),void 0!==r&&o.element!==r||Math.sqrt(Math.pow(e-o.x,2)+Math.pow(n-o.y,2))<=i&&l.push(a);return l},atomsWithinRect:function(e,n,i,r,o){var a,s,l,u,c,h=[];for(u=0,c=t.model.getNumberOfAtoms();u<c;u++)a=t.model.getAtomProperties(u),void 0!==o&&a.element!==o||(void 0===r?Math.sqrt(Math.pow(e-a.x,2)+Math.pow(n-a.y,2))<=i&&h.push(u):(s=a.x>=e&&a.x<=e+i,l=a.y>=n&&a.y<=n+r,s&&l&&h.push(u)));return h},atomsWithinTriangle:function(e,n,i,r,o,a,s){var l,u,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T=[];for(u=0,c=t.model.getNumberOfAtoms();u<c;u++)l=t.model.getAtomProperties(u),void 0!==s&&l.element!==s||(h=l.x,d=l.y,p=void 0,f=void 0,m=void 0,g=void 0,v=void 0,y=void 0,b=void 0,_=void 0,x=void 0,w=void 0,C=void 0,C=((g=(p=[o-e,a-n])[0]*p[0]+p[1]*p[1])*(_=(f=[i-e,r-n])[0]*(m=[h-e,d-n])[0]+f[1]*m[1])-(v=p[0]*f[0]+p[1]*f[1])*(y=p[0]*m[0]+p[1]*m[1]))*(x=1/(g*(b=f[0]*f[0]+f[1]*f[1])-v*v)),(w=(b*y-v*_)*x)>=0&&C>=0&&w+C<1&&T.push(u));return T},markAtoms:function(e){var n,i;if(0!==arguments.length){for(t.api.isArray(arguments[0])||(e=arguments),t.api.unmarkAllAtoms(),n=0,i=e.length;n<i;n++)t.model.setAtomProperties(e[n],{marked:1});t.api.repaintIfReady()}},unmarkAllAtoms:function(){for(var e=0,n=t.model.getNumberOfAtoms();e<n;e++)t.model.setAtomProperties(e,{marked:0});t.api.repaintIfReady()},traceAtom:function(e){null!==e&&(t.model.set({atomTraceId:e}),t.model.set({showAtomTrace:!0}))},untraceAtom:function(){t.model.set({showAtomTrace:!1})},setAtomProperties:function(e,n,r,o){i(t.model.setAtomProperties,e,n,r,o)},atomTransition:function(){return t.model.atomTransition()},getAtomProperties:function(e){return t.model.getAtomProperties(e)},getRadialBondsForAtom:function(e){return t.model.getRadialBondsForAtom(e)},getAngularBondsForAtom:function(e){return t.model.getAngularBondsForAtom(e)},getMoleculeAtoms:function(e){return t.model.getMoleculeAtoms(e)},setElementProperties:function(e,n){i(t.model.setElementProperties,e,n)},setPairwiseLJProperties:function(e,n,i){t.model.getPairwiseLJProperties().set(e,n,i)},removePairwiseLJProperties:function(e,n){t.model.getPairwiseLJProperties().remove(e,n)},getElementProperties:function(e){return t.model.getElementProperties(e)},getAminoAcid:function(e){return t.model.getAminoAcidByElement(e)},addObstacle:r("addObstacle"),addShape:r("addShape"),addLine:r("addLine"),setObstacleProperties:function(e,n){i(t.model.setObstacleProperties,e,n)},getObstacleProperties:function(e){return t.model.getObstacleProperties(e)},removeObstacle:function(e,n){try{t.model.removeObstacle(e)}catch(t){if(!n||!n.silent)throw t}t.api.repaintIfReady()},setShapeProperties:function(e,n){i(t.model.setShapeProperties,e,n)},getShapeProperties:function(e){return t.model.getShapeProperties(e)},setLineProperties:function(e,n){i(t.model.setLineProperties,e,n)},getLineProperties:function(e){return t.model.getLineProperties(e)},addElectricField:function(e,n){try{t.model.addElectricField(e)}catch(t){if(!n||!n.silent)throw t}},removeElectricField:function(e,n){try{t.model.removeElectricField(e)}catch(t){if(!n||!n.silent)throw t}},setElectricFieldProperties:function(e,n){t.model.setElectricFieldProperties(e,n)},getElectricFieldProperties:function(e){return t.model.getElectricFieldProperties(e)},getAtomsWithinShape:function(e){var n=t.model.getShapeProperties(e);return this.atomsWithinRect(n.x,n.y,n.width,n.height)},removeShape:function(e,n){try{t.model.removeShape(e)}catch(t){if(!n||!n.silent)throw t}t.api.repaintIfReady()},removeLine:function(e,n){try{t.model.removeLine(e)}catch(t){if(!n||!n.silent)throw t}t.api.repaintIfReady()},setRadialBondProperties:function(e,n){t.model.setRadialBondProperties(e,n),t.api.repaintIfReady()},getRadialBondProperties:function(e){return t.model.getRadialBondProperties(e)},setAngularBondProperties:function(e,n){t.model.setAngularBondProperties(e,n),t.api.repaintIfReady()},getAngularBondProperties:function(e){return t.model.getAngularBondProperties(e)},openDNADialog:function(){null==e&&(e=new Mo(t.model)),e.bindModel(t.model),e.open()},jumpToNextDNAState:function(){t.model.geneticEngine().jumpToNextState()},jumpToPrevDNAState:function(){t.model.geneticEngine().jumpToPrevState()},DNAStateBefore:function(e){return t.model.geneticEngine().stateBefore(e)},DNAStateAfter:function(e){return t.model.geneticEngine().stateAfter(e)},animateToNextDNAState:function(){t.model.geneticEngine().transitionToNextState()},animateToDNAState:function(e){t.model.geneticEngine().transitionTo(e)},stopDNAAnimation:function(){t.model.geneticEngine().stopTransition()},transcribeDNAStep:function(e){var n=t.model.geneticEngine();n.stateBefore("dna")||n.stateAfter("transcription-end")?(t.model.set("DNAState","dna"),n.transitionTo("transcription:0"),n.transcribeStep(e)):"transcription-end"!==t.model.get("DNAState")&&n.transcribeStep(e)},translateDNAStep:function(){var e=t.model.geneticEngine();e.stateBefore("translation:0")||e.stateAfter("translation-end")?(t.model.set("DNAState","translation:0"),e.transitionTo("translation:1")):"translation-end"!==t.model.get("DNAState")&&e.transitionToNextState()},generateRandomProtein:function(e){var n=t.model.geneticEngine().generateProtein(void 0,e);if(n!==e)throw new Error("Generated protein was truncated due to limited area of the parent.model. Only"+n+" amino acids were generated.")},setSolvent:function(e){t.model.setSolvent(e)},pe:function(){return t.model.get("potentialEnergy")},ke:function(){return t.model.get("kineticEnergy")},atomsKe:function(e){var n,i=0;for(n=0;n<e.length;n++)i+=t.model.getAtomKineticEnergy(e[n]);return i},minimizeEnergy:function(){t.model.minimizeEnergy(),t.api.repaintIfReady()},addTextBox:function(e){t.model.addTextBox(e)},removeTextBox:function(e){t.model.removeTextBox(e)},setTextBoxProperties:function(e,n){t.model.setTextBoxProperties(e,n)},getTextBoxProperties:function(e){return t.model.getTextBoxProperties(e)},getNumberOfTextBoxes:function(){return t.model.getNumberOfTextBoxes()},getNumberOfLines:function(){return t.model.getNumberOfLines()},getNumberOfShapes:function(){return t.model.getNumberOfShapes()},addImage:function(e){t.model.addImage(e)},removeImage:function(e){t.model.removeImage(e)},getImageProperties:function(e){return t.model.getImageProperties(e)},setImageProperties:function(e,n){i(t.model.setImageProperties,e,n)},repaintIfReady:function(){0===n&&t.api.repaint()},batch:function(e){++n,t.model.startBatch(),e(),t.model.endBatch(),--n,t.api.repaintIfReady()}}}function Do(t){var e;return[{name:"atoms",numeric:!0,run:function(e){e(t.model.getNumberOfAtoms())}},{name:"temperature",numeric:!0,formatter:d3.format("5.1f"),run:function(e){e(t.model.get("temperature"))}},{name:"engine (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(n){t.model.start(),setTimeout((function(){t.model.stop(),An.collectData(!0),e=t.model.stepCounter(),setTimeout((function(){t.model.start(),setTimeout((function(){t.model.stop(),An.collectData(!1),n(An.getAvgTime("engine"))}),5e3)}),100)}),1e3)}},{name:"JS rendering (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(t){t(An.getAvgTime("js-rendering"))}},{name:"tick (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(t){t(An.getAvgTime("tick"))}},{name:"gap b/w frames (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(t){t(An.getAvgTime("gap"))}},{name:"fps",numeric:!0,formatter:d3.format("5.1f"),run:function(n){n(1e3*(t.model.stepCounter()-e)/5e3)}}]}var Oo={mainProperties:{type:{defaultValue:"signal-generator",immutable:!0},frequency:{defaultValue:1,unitType:"frequency",propertyChangeInvalidates:!0},modelSampleRate:{defaultValue:60,propertyChangeInvalidates:!0},timeScale:{defaultValue:1,unitType:"time",propertyChangeInvalidates:!0},sampleBatchLength:{defaultValue:1,propertyChangeInvalidates:!1},useDuration:{defaultValue:"codap",storeInTickHistory:!1,validate:function(t){if(!0===t||!1===t||"codap"===t)return t;throw new Error("Invalid 'useDuration' value: "+t)}},requestedDuration:{defaultValue:null,storeInTickHistory:!1}},viewOptions:{showClock:{defaultValue:!0,propertyChangeInvalidates:!1},controlButtons:{defaultValue:"play_reset",propertyChangeInvalidates:!1},controlButtonStyle:{defaultValue:"video",propertyChangeInvalidates:!1,serialize:!1}}},Io={units:{time:{name:"second",pluralName:"seconds",symbol:"s"},frequency:{name:"Hertz",pluralName:"Hertz",symbol:"Hz"},angle:{name:"radian",pluralName:"radians",symbol:"rad"}}};function Lo(t){var e,n,i=new qn({metadata:Oo,setters:{frequency:function(t){void 0!==e&&(o=u(o+2*Math.PI*(e-t)*n.properties.time)),e=t}},unitsDefinition:Io,initialProperties:t}),r=i.dispatchSupport,o=0,a=[],s=0,l=-1;function u(t){return t-2*Math.PI*Math.floor(t/(2*Math.PI))}function c(t){return u(o+2*Math.PI*n.properties.frequency*t)}function h(t,e,n){return e<0?n:t[e]}return n={tick:function(){var t=1e3/n.properties.modelSampleRate,e=h(a,a.length-1,0);if(a.push(e+.001*t*n.properties.timeScale),++s%n.properties.sampleBatchLength==0)for(;l<a.length-1;)l++,n.updateAllOutputProperties(),r.tick()},stepCounter:function(){return s},reset:function(){r.reset()}},r.addEventTypes("tick"),r.addEventTypes("reset"),i.mixInto(n),n.on("play.model",n.makeInvalidatingChange),n.on("stop.model",n.makeInvalidatingChange),n.defineOutput("isPlayable",{label:"Playable"},(function(){return n.isReady&&n.isStopped()})),n.defineOutput("hasPlayed",{label:"has Played"},(function(){return n.hasPlayed})),n.defineOutput("timePerTick",{label:"Model time per tick",unitType:"time",format:".2f"},(function(){return 1/n.properties.modelSampleRate*n.properties.timeScale})),n.defineOutput("time",{label:"Time",unitType:"time",format:".2f"},(function(){return h(a,l,0)})),n.defineOutput("displayTime",{label:"Time",unitType:"time",format:".2f"},(function(){return h(a,l,0)})),n.defineOutput("signalValue",{label:"Signal Value",format:".2f"},(function(){var t=h(a,l,0);return Math.cos(c(t))})),n.defineOutput("angle",{label:"Angle",unitType:"angle",format:".2f"},(function(){return c(h(a,l,0))})),n}var Ro=function(){return{$el:$("<div id='model-container' class='container'/>"),getHeightForWidth:function(){return 0},resize:function(){},repaint:function(){},bindModel:function(){},setup:function(){},update:function(){}}},No=function(){},Fo={mainProperties:{type:{defaultValue:"iframe-model",immutable:!0},url:{immutable:!0}},viewOptions:{aspectRatio:{defaultValue:1.55},showClock:{defaultValue:!1,propertyChangeInvalidates:!1},controlButtons:{defaultValue:"reset",propertyChangeInvalidates:!1},controlButtonStyle:{defaultValue:"video",propertyChangeInvalidates:!1,serialize:!1}}};function Bo(t){var e=new qn({metadata:Fo,initialProperties:t,usePlaybackSupport:!1});e.mixInto(this),this.set=zo,this._phone=null,this._stopped=!0,this._hasPlayed=!1,this._initialProperties=t,this._propertySupport=e.propertySupport,this._dispatch=e.dispatchSupport,this._stepCounter=0,this._propertyUpdateComingFromIframe=!1,this._iframeOutputs={},this._dispatch.addEventTypes("tick","tickStart","tickEnd","play","stop","reset","stepForward","stepBack","log"),this.defineOutput("hasPlayed",{label:"has Played"},function(){return this._hasPlayed}.bind(this))}function zo(t,e){var n=this;if("string"==typeof t)this.hasProperty(t)||this._propertySupport.defineProperty(t,{type:"mainProperty",writable:!0,set:function(e){n._propertyUpdateComingFromIframe||n._phone.post("set",{name:t,value:e})},includeInHistoryState:!1,beforeSetCallback:this._propertySupport.invalidatingChangePreHook,afterSetCallback:this._propertySupport.invalidatingChangePostHook}),this.properties[t]=e;else{var i=t;Object.keys(i).forEach((function(t){n.set(t,i[t])}))}}Bo.prototype._defineModelSpecificProperties=function(){var t=this._initialProperties,e=this;Object.keys(t).forEach((function(n){Fo.mainProperties[n]||Fo.viewOptions[n]||e.set(n,t[n])}))},Bo.prototype.start=function(){return this._phone.post({type:"play"}),this._hasPlayed=!0,this},Bo.prototype.stop=function(){return this._phone.post({type:"stop"}),this},Bo.prototype.restart=function(){return this.stop(),this.start(),this},Bo.prototype.isStopped=function(){return this._stopped},Bo.prototype.serialize=function(){return this._initialProperties},Object.defineProperty(Bo.prototype,"iframePhone",{set:function(t){this._phone=t,this._addListeners(),this._defineModelSpecificProperties()},get:function(){return this._phone}}),Bo.prototype.stepCounter=function(){return this._stepCounter},Bo.prototype.iframeOutput=function(t){return this._iframeOutputs[t]},Bo.prototype._updateOutputs=function(t){var e=this;this.makeInvalidatingChange((function(){Object.keys(t).forEach((function(n){e._iframeOutputs[n]=t[n]}))}))},Bo.prototype._updatePropertiesFromIframe=function(t){this._propertyUpdateComingFromIframe=!0,this.set(t),this._propertyUpdateComingFromIframe=!1},Bo.prototype._addListeners=function(){var t=this;this._phone.addListener("play.iframe-model",(function(){t._stopped=!1,t._dispatch.play()})),this._phone.addListener("stop.iframe-model",(function(){t._stopped=!0,t._dispatch.stop()})),this._phone.addListener("properties",(function(e){t._updatePropertiesFromIframe(e)})),this._phone.addListener("outputs",(function(e){t._updateOutputs(e)})),this._phone.addListener("tick",(function(e){t._stepCounter++,e&&e.outputs&&t._updateOutputs(e.outputs),e&&e.properties&&t._updatePropertiesFromIframe(e.properties),t._dispatch.tick()})),this._phone.addListener("log",(function(e){t._dispatch.log(e.action,e.data)}))};var jo=Bo;function Vo(t){var e=t,n=$("<div id='model-container' class='container'></div>");function i(t){n.find("#iframe-model").remove();var e=$("<iframe id='iframe-model' style='width:100%;height:100%' src='"+t.get("url")+"'></iframe>");n.append(e);var i=new St.a.ParentEndpoint(n.find("#iframe-model")[0]);e.on("destroyed",(function(){i.disconnect()})),t.iframePhone=i}return i(t),{$el:n,getHeightForWidth:function(t){return t/e.get("aspectRatio")},resize:function(){},bindModel:function(t){i(t),e=t},setup:function(){},update:function(){},repaint:function(){}}}function Ho(t){var e=t.bindModel;return t.bindModel=function(){e.apply(t,arguments),t.model.iframePhone.addListener("registerScriptingAPIFunc",(function(e){null==t.api[e]&&(t.api[e]=function(n){t.model.iframePhone.post(e,n)})}))},{post:function(e,n){t.model.iframePhone.post(e,n)},iframeOutput:function(e){return t.model.iframeOutput(e)}}}var Wo={mainProperties:{type:{defaultValue:"sensor",immutable:!0},sensorType:{defaultValue:null},samplesPerSecond:{readOnly:!0},collectionTime:{defaultValue:null},tareValue:{defaultValue:0}},viewOptions:{showClock:{defaultValue:!0,propertyChangeInvalidates:!1},controlButtons:{defaultValue:"play_reset",propertyChangeInvalidates:!1},controlButtonStyle:{defaultValue:"video",propertyChangeInvalidates:!1,serialize:!1}}},Uo=n(9),$o=n.n(Uo),Go=$o.a.sensorDefinitions;function qo(t){return Go.goMotion.measurementName=t.t("sensor.measurements.distance"),Go.goMotion.sensorName=t.t("sensor.names.goMotion"),Go.goTemp.measurementName=t.t("sensor.measurements.temperature"),Go.goTemp.sensorName=t.t("sensor.names.goTemp"),Go.goLinkTemperature.measurementName=t.t("sensor.measurements.temperature"),Go.goLinkTemperature.sensorName=t.t("sensor.names.goLinkTemperature"),Go.goLinkLight.measurementName=t.t("sensor.measurements.light_intensity"),Go.goLinkLight.sensorName=t.t("sensor.names.goLinkLight"),Go.goLinkForce.measurementName=t.t("sensor.measurements.force"),Go.goLinkForce.sensorName=t.t("sensor.names.goLinkForce"),Go.goLinkPH.measurementName=t.t("sensor.measurements.acidity"),Go.goLinkPH.sensorName=t.t("sensor.names.goLinkPH"),Go.goLinkCO2.measurementName=t.t("sensor.measurements.CO2_concentration"),Go.goLinkCO2.sensorName=t.t("sensor.names.goLinkCO2"),Go.goLinkO2.measurementName=t.t("sensor.measurements.O2_concentration"),Go.goLinkO2.sensorName=t.t("sensor.names.goLinkO2"),Go.labQuestMotion.measurementName=t.t("sensor.measurements.distance"),Go.labQuestMotion.sensorName=t.t("sensor.names.labQuestMotion"),Go.labQuestTemperature.measurementName=t.t("sensor.measurements.temperature"),Go.labQuestTemperature.sensorName=t.t("sensor.names.labQuestTemperature"),Go.labQuestLight.measurementName=t.t("sensor.measurements.light_intensity"),Go.labQuestLight.sensorName=t.t("sensor.names.labQuestLight"),Go.labQuestForce.measurementName=t.t("sensor.measurements.force"),Go.labQuestForce.sensorName=t.t("sensor.names.labQuestForce"),Go.labQuestPH.measurementName=t.t("sensor.measurements.acidity"),Go.labQuestPH.sensorName=t.t("sensor.names.labQuestPH"),Go.labQuestCO2.measurementName=t.t("sensor.measurements.CO2_concentration"),Go.labQuestCO2.sensorName=t.t("sensor.names.labQuestCO2"),Go.labQuestO2.measurementName=t.t("sensor.measurements.O2_concentration"),Go.labQuestO2.sensorName=t.t("sensor.names.labQuestO2"),Go}function Yo(t){this._i18n=t}Yo.prototype.alert=function(t,e,n){var i=$.extend({width:"60%",buttons:e,closeOnEscape:!1},n),r=new Pt(i,this._i18n);r.setContent("<div>"+t+"</div>"),r.open()},Yo.prototype.status=function(t,e){var n=$.extend({width:"60%",closeOnEscape:!1,modal:!0},e),i=new Pt(n,this._i18n);return i.setContent("<div>"+t+"</div>"),i.open(),i};var Xo=Yo,Qo=$o.a.unitsDefinition;function Ko(t,e){var n,i,o,a,s,l,u,c,h,d,p,f,m,g,v,y,b=e.i18n,_=new Xo(b),x=!0,w=!1,C=!1,T=!1,S={label:b.t("sensor.measurements.sensor_reading"),unitAbbreviation:"-",format:".2f",min:0,max:1},k=qo(b);function A(){var t,e,n,r,o;null!=y.properties.collectionTime&&(t="displayTime",e=0,n=y.properties.collectionTime,(r=y.getPropertyDescription(t).getHash()).min=e,r.max=n,o=new Bn(Qo,r),i.setPropertyDescription(t,o))}function E(){l&&(l.removeListeners("data"),l.removeListeners("deviceUnplugged"),l.removeListeners("sensorUnplugged"),l.remove()),y.makeInvalidatingChange((function(){C=!1,T=!1}))}function M(){y.makeInvalidatingChange((function(){T=!0})),setTimeout((function(){l.on("data",R),l.on("deviceUnplugged",(function(){O("device")})),l.on("sensorUnplugged",(function(){O("sensor")})),l.append($("body"),(function(t){if(t)return t instanceof $o.a.JavaLoadError?D(b.t("sensor.messages.java_applet_error")):t instanceof $o.a.AppletInitializationError?D(b.t("sensor.messages.java_applet_not_loading")):t instanceof $o.a.SensorConnectionError?P():D(b.t("sensor.messages.unexpected_error")),void y.makeInvalidatingChange((function(){T=!1}));y.makeInvalidatingChange((function(){C=!0,T=!1}))}))}),10)}function P(){E();var t={};t[b.t("sensor.messages.try_again")]=function(){$(this).dialog("close"),M()},t[b.t("sensor.messages.cancel")]=function(){$(this).remove(),y.reload()},_.alert(b.t("sensor.messages.sensor_not_attached",{sensor_name:y.properties.sensorName}),t)}function D(t){E(),_.alert(t,{OK:function(){$(this).remove(),y.reload()}})}function O(t){E(),y.stop(),Ot.logAction("Unplugged"+y.properties[t+"Name"]);var e={};e[b.t("sensor.messages.try_again")]=function(){$(this).dialog("close"),M()},e[b.t("sensor.messages.cancel")]=function(){$(this).dialog("close")},_.alert(b.t("sensor.messages.sensor_or_device_unplugged",{sensor_or_device_name:y.properties[t+"Name"]}),e)}function I(){p=0,h=0,d=void 0,f=!1,g=!1,m=!1}function L(t){var e,n,o,a;s!==t&&(s&&(y.properties.tareValue=0),s=t,d=void 0,l&&E(),s?(n=k[s],c=n.samplesPerSecond,a=n.measurementType,e=$o.a[n.appletClass],g=n.tareable,l=window.Lab.sensor[s]=new e({listenerPath:"Lab.sensor."+s,sensorDefinitions:[n],appletId:s+"-sensor",codebase:r.a.rootUrl+"/jars/lab-sensor-applet-interface-dist"}),M(),o=new Bn(Qo,{label:n.measurementName,unitType:a,min:n.minReading,max:n.maxReading}),i.setPropertyDescription("sensorReading",o),null==y.properties.collectionTime&&(y.properties.collectionTime=n.maxSeconds)):y.properties.hasOwnProperty("sensorReading")&&(o=new Bn(Qo,S),i.setPropertyDescription("sensorReading",o)))}function R(t){p++,h+=1/c,window.__bizarreSafariFix=1,d=t[0],f||y.freeze("sensorType"),f=!0,y.updateAllOutputProperties(),o.tick()}return y={on:function(t,e){o.on(t,e)},start:function(){y.properties.isPlayable&&l.start((function(t,e){t?t instanceof $o.a.SensorConnectionError&&P():e&&(y.makeInvalidatingChange((function(){x=!1})),o.play())}))},stop:function(){l&&l.stop(),y.makeInvalidatingChange((function(){x=!0})),o.stop()},tare:function(){if(!x)throw new Error("Sensor model: tare() called on a non-stopped model.");null!=u&&null!=d?y.properties.tareValue=d:y.makeInvalidatingChange((function(){m=!0}))},willReset:function(){o.willReset()},reset:function(){y.stop(),E(),I(),y.properties.tareValue=v,y.unfreeze("sensorType"),y.properties.sensorType=a,o.reset()},reload:function(){y.stop(),y.makeInvalidatingChange((function(){w=!0}))},isStopped:function(){return x},stepCounter:function(){return p},serialize:function(){return""}},I(),void 0===window.Lab&&(window.Lab={}),window.Lab.sensor={},(n=new qn({metadata:Wo,setters:{sensorType:L},unitsDefinition:Qo,initialProperties:t,usePlaybackSupport:!1})).mixInto(y),i=n.propertySupport,(o=n.dispatchSupport).addEventTypes("tick","play","stop","tickStart","tickEnd"),a=y.properties.sensorType,v=y.properties.tareValue,y.defineOutput("time",{label:b.t("sensor.measurements.time"),unitType:"time",format:".2f"},(function(){return h})),y.defineOutput("displayTime",{label:b.t("sensor.measurements.time"),unitType:"time",format:".2f"},(function(){return h})),y.defineOutput("sensorReading",S,(function(){return null==d?d:d-y.properties.tareValue})),y.defineOutput("sensorName",{label:"Sensor Name"},(function(){return k[s].sensorName})),y.defineOutput("deviceName",{label:"Sensor Interface Device Name"},(function(){return k[s].deviceName})),y.defineOutput("isStopped",{label:"Stopped?"},(function(){return x})),y.defineOutput("isPlayable",{label:"Startable?"},(function(){return C&&!f})),y.defineOutput("hasPlayed",{label:"Has successfully collected data?"},(function(){return f})),y.defineOutput("shouldPollSensor",{label:"Polling Sensor?"},(function(){return y.properties.isPlayable&&x})),y.defineOutput("isSensorInitializing",{label:"Loading Sensor?"},(function(){return T})),y.defineOutput("isTaring",{label:"Waiting for a tare value?"},(function(){return m})),y.defineOutput("canTare",{label:"Can set a tare value?"},(function(){return x&&!f&&g&&!m})),y.defineOutput("needsReload",{label:"Needs Reload?"},(function(){return w})),y.on("willReset.model",E),y.addObserver("shouldPollSensor",(function(){y.properties.shouldPollSensor?function(){u&&clearInterval(u);var t=function(t,e){if(t)if(t instanceof $o.a.AlreadyReadingError);else{if(!(t instanceof $o.a.SensorConnectionError))throw clearInterval(u),t;clearInterval(u),P()}else y.makeInvalidatingChange((function(){d=e[0],m&&(y.properties.tareValue=d,m=!1)}))};u=setInterval((function(){l.readSensor(t)}),1e3)}():u&&(clearInterval(u),u=null)})),y.addObserver("collectionTime",A),A(),L(y.properties.sensorType),y}var Jo=$o.a.sensorDefinitions,Zo=function(t,e,n){var i,r,o=new ae({id:"sensor-type-view",options:[{value:null,text:n.t("sensor.select_sensor_type"),selected:null==t.properties.sensorType,disabled:!0}].concat(Object.keys(Jo).map((function(e){return{value:e,text:Jo[e].sensorName,selected:e===t.properties.sensorType,disabled:!1}}))),onChange:function(e){t.properties.sensorType=e.value}}),a=d3.format(".2f");function s(){t.properties.isTaring?r.$zeroButton.find("button").html(n.t("sensor.zeroing")):r.$zeroButton.find("button").html(n.t("sensor.zero"))}function l(){t.properties.canTare?Wt(r.$zeroButton):Ht(r.$zeroButton)}function u(){t.getPropertyDescription("sensorType").getFrozen()?Ht(r.$selectBox):Wt(r.$selectBox)}function c(){t.addObserver("isTaring",s),s(),t.addObserver("canTare",l),l(),t.addPropertyDescriptionObserver("sensorType",u),u()}return r={$el:$("<div id='model-container' class='container sensor-model-container' />"),bindModel:function(n,i){e=i||e,t=n||t,c()},getHeightForWidth:function(){return"2.6em"},setup:function(){this.$el.empty(),i=new De({id:"sensor-value-view",label:n.t("sensor.reading"),units:t.getPropertyDescription("sensorReading").getUnitAbbreviation()});var e=o.render(this.$el),r=$("<div><button>"+n.t("sensor.zero")+"</button></div>"),a=i.render();e.addClass("interactive-pulldown component component-spacing"),r.addClass("interactive-button component component-spacing"),a.addClass("numeric-output component horizontal component-spacing"),this.$el.css("zIndex",4),this.$el.append(e),this.$el.append(a),this.$el.append(r),this.$zeroButton=r,this.$selectBox=e,i.resize(),c(),r.on("click","button",(function(){t.tare()}))},showInitializationProgress:function(){var t;this.$progressbarContainer||(t=$("<div/>").attr("id","sensor-progressbar"),this.$progressbarContainer=$("<div/>").attr("id","sensor-progressbar-container").css("bottom",$("body").height()/2+75+$(".lab-responsive-content").offset().top).append('<div class="label">'+n.t("sensor.loading_sensor")+"</div>").append(t).appendTo(".lab-responsive-content"),t.progressbar({value:!1})),this.$progressbarContainer.show()},hideInitializationProgress:function(){this.$progressbarContainer.hide()},resize:function(){i&&i.resize()},repaint:function(){},setFocus:function(){},updateUnits:function(e){i.updateUnits(e),null==t.properties.sensorReading&&i.hideUnits()},update:function(){null==t.properties.sensorReading?(i.update(""),i.hideUnits()):(i.update(a(t.properties.sensorReading)),i.showUnits())}}};function ta(t){return{resetModel:function(e){t.intController.resetModel(e)}}}var ea={type:{defaultValue:"dual-sensor",immutable:!0},sensorType:{defaultValue:null},sensorType2:{defaultValue:null},samplesPerSecond:{readOnly:!0},collectionTime:{defaultValue:null},tareValue:{defaultValue:0},tareValue2:{defaultValue:0},clientId:{defaultValue:null},useRandomClientId:{defaultValue:!1}},na={showClock:{defaultValue:!0,propertyChangeInvalidates:!1},controlButtons:{defaultValue:"play_reset",propertyChangeInvalidates:!1},controlButtonStyle:{defaultValue:"video",propertyChangeInvalidates:!1,serialize:!1}},ia=$o.a.unitsDefinition;function ra(t,e){var n,i,o,a,s,l,u,c,h,d,f,m,g,v,y,b,_,x,w=new Rn({types:["mainProperty","viewOption","parameter","output"]}),C=e.i18n,T=new Xo(C),S=!0,k=!1,A=d3.dispatch("play","stop","tick","tickStart","willReset","reset","stepForward","stepBack","seek","invalidation"),E=!1,M=!1,P=10,D=0,O=[],I={label:C.t("sensor.measurements.sensor_reading"),unitAbbreviation:"-",format:".2f",min:0,max:1},L=qo(C);function R(t,e,n){var i,r,o,a;if("mainProperty"===e)i=ea;else{if("viewOption"!==e)throw new Error(e+" is not a supported built-in property type");i=na}o=p.a.propertyChangeInvalidates(i[t]),r={type:e,writable:p.a.propertyIsWritable(i[t]),set:n,includeInHistoryState:!!i[t].storeInTickHistory,validate:function(e){return p.a.validateSingleProperty(i[t],t,e,!1)},beforeSetCallback:o?N:void 0,afterSetCallback:o?F:void 0},a=i[t].unitType,r.description=a?new Bn(ia,{unitType:a}):new Bn(null,{label:i.label||t}),w.defineProperty(t,r)}function N(){0===D&&(w.storeComputedProperties(),w.deleteComputedPropertyCachedValues(),w.enableCaching=!1),D++}function F(){D--,z(),0===D&&(w.enableCaching=!0,w.notifyChangedComputedProperties())}function B(t){N(),t(),F()}function z(){O.forEach((function(t){t.addSample()}))}function j(){var t,e,n,i,r;null!=x.properties.collectionTime&&(t="displayTime",e=0,n=x.properties.collectionTime,(i=x.getPropertyDescription(t).getHash()).min=e,i.max=n,r=new Bn(ia,i),w.setPropertyDescription(t,r))}function V(){l&&(l.removeListeners("data"),l.removeListeners("deviceUnplugged"),l.removeListeners("sensorUnplugged"),l.remove()),B((function(){E=!1,M=!1}))}function H(){B((function(){M=!0})),setTimeout((function(){l.on("data",J),l.on("deviceUnplugged",(function(){G("device")})),l.on("sensorUnplugged",(function(){G("sensor")})),l.append($("body"),(function(t){if(t)return t instanceof $o.a.JavaLoadError?U(C.t("sensor.messages.java_applet_error")):t instanceof $o.a.AppletInitializationError?U(C.t("sensor.messages.java_applet_not_loading")):t instanceof $o.a.SensorConnectionError?W():U(C.t("sensor.messages.unexpected_error")),void B((function(){M=!1}));B((function(){E=!0,M=!1}))}))}),10)}function W(){V();var t={};t[C.t("sensor.messages.try_again")]=function(){$(this).dialog("close"),H()},t[C.t("sensor.messages.cancel")]=function(){$(this).remove(),x.reload()},T.alert(C.t("sensor.messages.sensor_not_attached",{sensor_name:x.properties.sensorName}),t)}function U(t){V(),T.alert(t,{OK:function(){$(this).remove(),x.reload()}})}function G(t){V(),x.stop(),Ot.logAction("Unplugged"+x.properties[t+"Name"]);var e={};e[C.t("sensor.messages.try_again")]=function(){$(this).dialog("close"),H()},e[C.t("sensor.messages.cancel")]=function(){$(this).dialog("close")},T.alert(C.t("sensor.messages.sensor_or_device_unplugged",{sensor_or_device_name:x.properties[t+"Name"]}),e)}function q(){f=0,c=0,h=void 0,d=void 0,m=!1,y=!1,b=!1,g=!1,v=!1}function Y(){if(a&&s){var t=L[a],e=L[s],n=$o.a[t.appletClass];l=window.Lab.sensor[a+s]=new n({listenerPath:"Lab.sensor."+a+s,sensorDefinitions:[t,e],appletId:a+s+"-sensor",codebase:r.a.rootUrl+"/jars/lab-sensor-applet-interface-dist"}),H()}}function X(){if(a&&s){var t=L[a],e=L[s];P=Math.max(t.samplesPerSecond,e.samplesPerSecond)}}function Q(t){var e,n,i;a!==t&&(a&&(x.properties.tareValue=0),a=t,h=void 0,l&&V(),a?(i=(e=L[a]).measurementType,y=e.tareable,X(),Y(),n=new Bn(ia,{label:e.measurementName,unitType:i,min:e.minReading,max:e.maxReading}),w.setPropertyDescription("sensorReading",n),null==x.properties.collectionTime&&(x.properties.collectionTime=e.maxSeconds)):x.properties.hasOwnProperty("sensorReading")&&(n=new Bn(ia,I),w.setPropertyDescription("sensorReading",n)))}function K(t){var e,n,i;s!==t&&(s&&(x.properties.tareValue2=0),s=t,d=void 0,l&&V(),s?(i=(e=L[s]).measurementType,b=e.tareable,X(),Y(),n=new Bn(ia,{label:e.measurementName,unitType:i,min:e.minReading,max:e.maxReading}),w.setPropertyDescription("sensorReading2",n),null==x.properties.collectionTime&&(x.properties.collectionTime=e.maxSeconds)):x.properties.hasOwnProperty("sensorReading2")&&(n=new Bn(ia,I),w.setPropertyDescription("sensorReading2",n)))}function J(t){f++,c+=1/P,window.__bizarreSafariFix=1,h=t[0],d=t[1],m||(x.freeze("sensorType"),x.freeze("sensorType2")),m=!0,w.deleteComputedPropertyCachedValues(),w.notifyAllComputedProperties(),z(),A.tick()}return x={on:function(t,e){A.on(t,e)},start:function(){x.properties.isPlayable&&l.start((function(t,e){t?t instanceof $o.a.SensorConnectionError&&W():e&&(B((function(){S=!1})),A.play())}))},stop:function(){l&&l.stop(),B((function(){S=!0})),A.stop()},tare:function(){if(!S)throw new Error("Sensor model: tare() called on a non-stopped model.");null!=u&&null!=h?x.properties.tareValue=h:B((function(){g=!0}))},tare2:function(){if(!S)throw new Error("Sensor model: tare() called on a non-stopped model.");null!=u&&null!=d?x.properties.tareValue2=d:B((function(){v=!0}))},willReset:function(){A.willReset()},reset:function(){x.stop(),V(),q(),x.unfreeze("sensorType"),x.unfreeze("sensorType2"),x.properties.sensorType=o,x.properties.sensorType2=o,A.reset()},reload:function(){x.stop(),B((function(){k=!0}))},isStopped:function(){return S},stepCounter:function(){return f},addPropertiesListener:function(t,e){"string"==typeof t?x.addObserver(t,e):t.forEach((function(t){x.addObserver(t,e)}))},defineParameter:function(t,e,n){var i={type:"parameter",includeInHistoryState:!0,invokeSetterAfterBulkRestore:!1,description:new Bn(ia,e),beforeSetCallback:N,afterSetCallback:F};n&&(i.set=function(t){n.call(x,t)}),w.defineProperty(t,i)},defineOutput:function(t,e,n){w.defineProperty(t,{type:"output",writable:!1,get:n,includeInHistoryState:!1,description:new Bn(ia,e)})},defineFilteredOutput:function(t,e,n,i,r){var o,a;if("RunningAverage"!==i)throw new Error("FilteredOutput: unknown filter type "+i+".");if(o=new Vn(r),void 0===(a=x.properties[t])||isNaN(Number(a)))throw new Error("FilteredOutput: property is not a valid numeric value or it is undefined.");o.addSample(x.properties.time,a),O.push({addSample:function(){o.addSample(x.properties.time,x.properties[n])}}),e.property=n,e.type=i,e.period=r,x.defineOutput(t,e,(function(){return o.calculate()}))},serialize:function(){return""}},q(),void 0===window.Lab&&(window.Lab={}),window.Lab.sensor={},w.mixInto(x),_={sensorType:Q,sensorType2:K},i=p.a.validateCompleteness(ea,t),Object.keys(i).forEach((function(t){R(t,"mainProperty",_[t])})),w.setRawValues(i),o=x.properties.sensorType,x.properties.tareValue,n=p.a.validateCompleteness(na,t.viewOptions||{}),Object.keys(n).forEach((function(t){R(t,"viewOption")})),w.setRawValues(n),x.defineOutput("time",{label:C.t("sensor.measurements.time"),unitType:"time",format:".2f"},(function(){return c})),x.defineOutput("displayTime",{label:C.t("sensor.measurements.time"),unitType:"time",format:".2f"},(function(){return c})),x.defineOutput("sensorReading",I,(function(){return null==h?h:h-x.properties.tareValue})),x.defineOutput("sensorReading2",I,(function(){return null==d?d:d-x.properties.tareValue2})),x.defineOutput("sensorName",{label:"Sensor Name"},(function(){return L[a].sensorName})),x.defineOutput("sensorName2",{label:"Sensor Name"},(function(){return L[s].sensorName})),x.defineOutput("deviceName",{label:"Sensor Interface Device Name"},(function(){return L[a].deviceName})),x.defineOutput("deviceName2",{label:"Sensor Interface Device Name"},(function(){return L[s].deviceName})),x.defineOutput("isStopped",{label:"Stopped?"},(function(){return S})),x.defineOutput("isPlayable",{label:"Startable?"},(function(){return E&&!m})),x.defineOutput("hasPlayed",{label:"Has successfully collected data?"},(function(){return m})),x.defineOutput("shouldPollSensor",{label:"Polling Sensor?"},(function(){return x.properties.isPlayable&&S})),x.defineOutput("isSensorInitializing",{label:"Loading Sensor?"},(function(){return M})),x.defineOutput("isTaring",{label:"Waiting for a tare value?"},(function(){return g})),x.defineOutput("isTaring2",{label:"Waiting for a tare value?"},(function(){return v})),x.defineOutput("canTare",{label:"Can set a tare value?"},(function(){return S&&!m&&y&&!g})),x.defineOutput("canTare2",{label:"Can set a tare value?"},(function(){return S&&!m&&b&&!v})),x.defineOutput("needsReload",{label:"Needs Reload?"},(function(){return k})),x.on("willReset.model",V),x.addObserver("shouldPollSensor",(function(){x.properties.shouldPollSensor?function(){u&&clearInterval(u);var t=function(t,e){if(t)if(t instanceof $o.a.AlreadyReadingError);else{if(!(t instanceof $o.a.SensorConnectionError))throw clearInterval(u),t;clearInterval(u),W()}else B((function(){h=e[0],d=e[1],g&&(x.properties.tareValue=h,g=!1),v&&(x.properties.tareValue2=d,v=!1)}))};u=setInterval((function(){l.readSensor(t)}),1e3)}():u&&(clearInterval(u),u=null)})),x.addObserver("collectionTime",j),j(),Q(x.properties.sensorType),K(x.properties.sensorType2),x}var oa=$o.a.sensorDefinitions,aa=function(t,e,n){var i,r,o,a=new ae({id:"sensor-type-view",options:[{value:null,text:n.t("sensor.select_sensor_type"),selected:null==t.properties.sensorType,disabled:!0}].concat(Object.keys(oa).filter((function(t){return"LabQuest"===oa[t].appletClass})).map((function(e){return{value:e,text:oa[e].sensorName,selected:e===t.properties.sensorType,disabled:!1}}))),onChange:function(e){t.properties.sensorType=e.value}}),s=new ae({id:"sensor-type2-view",options:[{value:null,text:n.t("sensor.select_sensor_type"),selected:null==t.properties.sensorType2,disabled:!0}].concat(Object.keys(oa).filter((function(t){return"LabQuest"===oa[t].appletClass})).map((function(e){return{value:e,text:oa[e].sensorName,selected:e===t.properties.sensorType2,disabled:!1}}))),onChange:function(e){t.properties.sensorType2=e.value}}),l=d3.format(".2f");function u(){t.properties.isTaring?o.$zeroButton.find("button").html(n.t("sensor.zeroing")):o.$zeroButton.find("button").html(n.t("sensor.zero"))}function c(){t.properties.canTare?Wt(o.$zeroButton):Ht(o.$zeroButton)}function h(){t.properties.isTaring2?o.$zeroButton2.find("button").html(n.t("sensor.zeroing")):o.$zeroButton2.find("button").html(n.t("sensor.zero"))}function d(){t.properties.canTare2?Wt(o.$zeroButton2):Ht(o.$zeroButton2)}function p(){t.getPropertyDescription("sensorType").getFrozen()?Ht(o.$selectBox):Wt(o.$selectBox)}function f(){t.getPropertyDescription("sensorType2").getFrozen()?Ht(o.$selectBox2):Wt(o.$selectBox2)}function m(){t.addObserver("isTaring",u),t.addObserver("isTaring2",h),u(),h(),t.addObserver("canTare",c),t.addObserver("canTare2",d),c(),d(),t.addPropertyDescriptionObserver("sensorType",p),p(),t.addPropertyDescriptionObserver("sensorType2",f),f()}return o={$el:$("<div id='model-container' class='container sensor-model-container' />"),bindModel:function(n,i){e=i||e,t=n||t,m()},getHeightForWidth:function(){return"4.8em"},setup:function(){this.$el.empty(),i=new De({id:"sensor-value-view",label:n.t("sensor.reading"),units:t.getPropertyDescription("sensorReading").getUnitAbbreviation()}),r=new De({id:"sensor-value-2-view",label:n.t("sensor.reading"),units:t.getPropertyDescription("sensorReading2").getUnitAbbreviation()});var e=$("<div></div>"),o=$("<div></div>"),l=a.render(this.$el),u=s.render(this.$el),c=$("<div><button>"+n.t("sensor.zero")+"</button></div>"),h=$("<div><button>"+n.t("sensor.zero")+"</button></div>"),d=i.render(),p=r.render();l.addClass("interactive-pulldown component component-spacing"),u.addClass("interactive-pulldown component component-spacing"),c.addClass("interactive-button component component-spacing"),h.addClass("interactive-button component component-spacing"),d.addClass("numeric-output component horizontal component-spacing"),p.addClass("numeric-output component horizontal component-spacing"),this.$el.css("zIndex",4),this.$el.append(e),this.$el.append(o),e.append(l),e.append(d),e.append(c),o.append(u),o.append(p),o.append(h),this.$zeroButton=c,this.$zeroButton2=h,this.$selectBox=l,this.$selectBox2=u,i.resize(),r.resize(),m(),c.on("click","button",(function(){t.tare()})),h.on("click","button",(function(){t.tare2()}))},showInitializationProgress:function(){var t;this.$progressbarContainer||(t=$("<div/>").attr("id","sensor-progressbar"),this.$progressbarContainer=$("<div/>").attr("id","sensor-progressbar-container").css("bottom",$("body").height()/2+75+$(".lab-responsive-content").offset().top).append('<div class="label">'+n.t("sensor.loading_sensor")+"</div>").append(t).appendTo(".lab-responsive-content"),t.progressbar({value:!1})),this.$progressbarContainer.show()},hideInitializationProgress:function(){this.$progressbarContainer.hide()},resize:function(){i&&i.resize(),r&&r.resize()},repaint:function(){},setFocus:function(){},updateUnits:function(e){i.updateUnits(e),null==t.properties.sensorReading&&i.hideUnits()},updateUnits2:function(e){r.updateUnits(e),null==t.properties.sensorReading2&&r.hideUnits()},update:function(){null==t.properties.sensorReading?(i.update(""),i.hideUnits()):(i.update(l(t.properties.sensorReading)),i.showUnits()),null==t.properties.sensorReading2?(r.update(""),r.hideUnits()):(r.update(l(t.properties.sensorReading2)),r.showUnits())}}};function sa(t){return{resetModel:function(e){t.intController.resetModel(e)}}}var la={mainProperties:{type:{defaultValue:"dual-sensor-connector",immutable:!0},tareValue:{defaultValue:0},tareValue2:{defaultValue:0},clientId:{defaultValue:null},clientName:{defaultValue:null},useRandomClientId:{defaultValue:!1},useDuration:{defaultValue:"codap",storeInTickHistory:!1,validate:function(t){if(!0===t||!1===t||"codap"===t)return t;throw new Error("Invalid 'useDuration' value: "+t)}},requestedDuration:{defaultValue:10,storeInTickHistory:!1}},viewOptions:{showClock:{defaultValue:!0,propertyChangeInvalidates:!1},controlButtons:{defaultValue:"play_reset",propertyChangeInvalidates:!1},controlButtonStyle:{defaultValue:"video",propertyChangeInvalidates:!1,serialize:!1}}};function ua(t){var e=this;this.states=t,this.currentState=null,Object.keys(t).forEach((function(n){var i=t[n];if(void 0!==i.name&&i.name!==n)throw new Error("State "+n+" already has a 'name' property. The 'name' property is reserved.");if(i.name=n,void 0!==i.gotoState)throw new Error("State "+n+" already has a 'gotoState' property. The 'gotoState' property is reserved.");i.gotoState=function(t){if(this!==e.currentState)throw new Error("gotoState was called on state "+this.name+" but the current state is ",e.getCurrentStateName());e.gotoState(t)}}))}ua.prototype.getCurrentStateName=function(){return this.currentState?this.currentState.name:"<no state>"},ua.prototype.gotoState=function(t){var e=this.states[t];if(!e)throw new Error("gotoState was called with state name "+t+" but no such state exists.");this.currentState&&"function"==typeof this.currentState.leaveState&&this.currentState.leaveState(),this.currentState=e,"function"==typeof this.currentState.enterState&&this.currentState.enterState()},ua.prototype.handleEvent=function(t){var e=Array.prototype.slice.call(arguments,1);return"function"==typeof this.currentState[t]&&(this.currentState[t].apply(this.currentState,e),!0)};var ca=ua,ha=n(79),da=n.n(ha),pa={units:{time:{name:"second",pluralName:"seconds",symbol:"s"}}},fa=function(t){return{lux:{sensorName:t.t("sensor.names.light"),measurementName:t.t("sensor.measurements.light_level"),measurementType:"light level",tareable:!0,minReading:0,maxReading:2e3},m:{sensorName:t.t("sensor.names.motion"),measurementName:t.t("sensor.measurements.position"),measurementType:"position",tareable:!0,minReading:-2,maxReading:2},"m/s²":{sensorName:t.t("sensor.names.accelerometer"),measurementName:t.t("sensor.measurements.acceleration"),measurementType:"acceleration",tareable:!0,minReading:-50,maxReading:50},"m/s^2":{sensorName:t.t("sensor.names.accelerometer"),measurementName:t.t("sensor.measurements.acceleration"),measurementType:"acceleration",tareable:!0,minReading:-50,maxReading:50},g:{sensorName:t.t("sensor.names.accelerometer"),measurementName:t.t("sensor.measurements.acceleration"),measurementType:"acceleration",tareable:!0,minReading:-5,maxReading:5},"N/kg":{sensorName:t.t("sensor.names.accelerometer"),measurementName:t.t("sensor.measurements.acceleration"),measurementType:"acceleration",tareable:!0,minReading:-25,maxReading:25},"mg/L":{sensorName:t.t("sensor.names.dissolved_oxygen"),measurementName:t.t("sensor.measurements.dissolved_oxygen"),measurementType:"do",tareable:!0,minReading:0,maxReading:12},kPa:{sensorName:t.t("sensor.names.pressure"),measurementName:t.t("sensor.measurements.pressure"),measurementType:"pressure",tareable:!0,minReading:0,maxReading:220},"mm Hg":{sensorName:t.t("sensor.names.pressure"),measurementName:t.t("sensor.measurements.pressure"),measurementType:"pressure",tareable:!0,minReading:0,maxReading:2e3},"in Hg":{sensorName:t.t("sensor.names.pressure"),measurementName:t.t("sensor.measurements.pressure"),measurementType:"pressure",tareable:!0,minReading:0,maxReading:80},mbar:{sensorName:t.t("sensor.names.pressure"),measurementName:t.t("sensor.measurements.pressure"),measurementType:"pressure",tareable:!0,minReading:0,maxReading:2200},psi:{sensorName:t.t("sensor.names.pressure"),measurementName:t.t("sensor.measurements.pressure"),measurementType:"pressure",tareable:!0,minReading:0,maxReading:40},atm:{sensorName:t.t("sensor.names.pressure"),measurementName:t.t("sensor.measurements.pressure"),measurementType:"pressure",tareable:!0,minReading:0,maxReading:2.5},torr:{sensorName:t.t("sensor.names.pressure"),measurementName:t.t("sensor.measurements.pressure"),measurementType:"pressure",tareable:!0,minReading:0,maxReading:2e3},nC:{sensorName:t.t("sensor.names.charge_sensor"),measurementName:t.t("sensor.measurements.charge"),measurementType:"charge",tareable:!1,minReading:-20,maxReading:20},V:{sensorName:t.t("sensor.names.voltage"),measurementName:t.t("sensor.measurements.potential"),measurementType:"potential",tareable:!0,minReading:-30,maxReading:30},pH:{sensorName:t.t("sensor.names.pH"),measurementName:t.t("sensor.measurements.pH"),measurementType:"ph",tareable:!1,minReading:0,maxReading:14},ppm:{sensorName:t.t("sensor.names.CO2_gas"),measurementName:t.t("sensor.measurements.CO2"),measurementType:"co2",tareable:!1,minReading:0,maxReading:5e3},ppt:{sensorName:t.t("sensor.names.CO2_gas"),measurementName:t.t("sensor.measurements.CO2"),measurementType:"co2",tareable:!1,minReading:0,maxReading:5},"%":{sensorName:t.t("sensor.names.CO2_gas"),measurementName:t.t("sensor.measurements.CO2"),measurementType:"co2",tareable:!1,minReading:0,maxReading:.5},"%T":{sensorName:t.t("sensor.names.colorimeter"),measurementName:t.t("sensor.measurements.transmittance"),measurementType:"transmittance",tareable:!1,minReading:0,maxReading:100},"µS/cm":{sensorName:t.t("sensor.names.conductivity"),measurementName:t.t("sensor.measurements.conductivity"),measurementType:"conductivity",tareable:!0,minReading:0,maxReading:2e3},"dS/m":{sensorName:t.t("sensor.names.conductivity"),measurementName:t.t("sensor.measurements.conductivity"),measurementType:"conductivity",tareable:!0,minReading:0,maxReading:2},A:{sensorName:t.t("sensor.names.current"),measurementName:t.t("sensor.measurements.current"),measurementType:"current",tareable:!0,minReading:-1.2,maxReading:1.2},mA:{sensorName:t.t("sensor.names.current"),measurementName:t.t("sensor.measurements.current"),measurementType:"current",tareable:!0,minReading:0,maxReading:500},"°C":{sensorName:t.t("sensor.names.temperature"),measurementName:t.t("sensor.measurements.temperature"),measurementType:"temperature",tareable:!1,minReading:0,maxReading:40},degC:{sensorName:t.t("sensor.names.temperature"),measurementName:t.t("sensor.measurements.temperature"),measurementType:"temperature",tareable:!1,minReading:0,maxReading:40},"°F":{sensorName:t.t("sensor.names.temperature"),measurementName:t.t("sensor.measurements.temperature"),measurementType:"temperature",tareable:!1,minReading:30,maxReading:100},degF:{sensorName:t.t("sensor.names.temperature"),measurementName:t.t("sensor.measurements.temperature"),measurementType:"temperature",tareable:!1,minReading:30,maxReading:100},K:{sensorName:t.t("sensor.names.temperature"),measurementName:t.t("sensor.measurements.temperature"),measurementType:"temperature",tareable:!1,minReading:250,maxReading:400},N:{sensorName:t.t("sensor.names.force"),measurementName:t.t("sensor.measurements.force"),measurementType:"force",tareable:!0,minReading:-50,maxReading:50},lb:{sensorName:t.t("sensor.names.force"),measurementName:t.t("sensor.measurements.force"),measurementType:"force",tareable:!0,minReading:-12.5,maxReading:12.5},mV:{sensorName:null,measurementName:t.t("sensor.measurements.potential"),measurementType:"potential",tareable:!0,minReading:-500,maxReading:1100},"m/s":{sensorName:t.t("sensor.names.motion"),measurementName:t.t("sensor.measurements.velocity"),measurementType:"velocity",tareable:!0,minReading:-5,maxReading:5},"ft/s":{sensorName:t.t("sensor.names.anemometer"),measurementName:t.t("sensor.measurements.speed"),measurementType:"speed",tareable:!0,minReading:0,maxReading:100},ft:{sensorName:t.t("sensor.names.motion"),measurementName:t.t("sensor.measurements.position"),measurementType:"position",tareable:!0,minReading:0,maxReading:6},kg:{sensorName:t.t("sensor.names.hand_dynamometer"),measurementName:t.t("sensor.measurements.force"),measurementType:"force",tareable:!0,minReading:0,maxReading:50},v:{sensorName:t.t("sensor.names.heart_rate"),measurementName:t.t("sensor.measurements.signal"),measurementType:"signal",tareable:!1,minReading:0,maxReading:3},mT:{sensorName:t.t("sensor.names.magnetic_field"),measurementName:t.t("sensor.measurements.magnetic_field"),measurementType:"magnetic field",tareable:!0,minReading:-8,maxReading:8},G:{sensorName:t.t("sensor.names.magnetic_field"),measurementName:t.t("sensor.measurements.magnetic_field"),measurementType:"magnetic field",tareable:!0,minReading:-80,maxReading:80},rad:{sensorName:t.t("sensor.names.rotary_motion"),measurementName:t.t("sensor.measurements.angle"),measurementType:"angle",tareable:!0,minReading:-15,maxReading:15},"°":{sensorName:t.t("sensor.names.rotary_motion"),measurementName:t.t("sensor.measurements.angle"),measurementType:"angle",tareable:!0,minReading:-1e3,maxReading:1e3},cm:{sensorName:t.t("sensor.names.linear_position_sensor"),measurementName:t.t("sensor.measurements.position"),measurementType:"position",tareable:!0,minReading:0,maxReading:15},dB:{sensorName:t.t("sensor.names.sound_level"),measurementName:t.t("sensor.measurements.sound_level"),measurementType:"sound level",tareable:!0,minReading:40,maxReading:110},dbA:{sensorName:t.t("sensor.names.sound_level"),measurementName:t.t("sensor.measurements.sound_level"),measurementType:"sound level",tareable:!0,minReading:40,maxReading:110},rel:{sensorName:t.t("sensor.names.spectrophotometer"),measurementName:t.t("sensor.measurements.intensity"),measurementType:"intensity",tareable:!1,minReading:0,maxReading:1},Rel:{sensorName:t.t("sensor.names.spectrophotometer"),measurementName:t.t("sensor.measurements.fluorescence_405_nm"),measurementType:"fluorescence 405 nm",tareable:!1,minReading:0,maxReading:1},"Rel.":{sensorName:t.t("sensor.names.spectrophotometer"),measurementName:t.t("sensor.measurements.fluorescence_500_nm"),measurementType:"fluorescence 500 nm",tareable:!1,minReading:0,maxReading:1},"L/s":{sensorName:t.t("sensor.names.spirometer"),measurementName:t.t("sensor.measurements.flow_rate"),measurementType:"flow rate",tareable:!0,minReading:-4,maxReading:4},"mL/s":{sensorName:t.t("sensor.names.spirometer"),measurementName:t.t("sensor.measurements.flow_rate"),measurementType:"flow rate",tareable:!0,minReading:-4e3,maxReading:4e3},NTU:{sensorName:t.t("sensor.names.turbidity"),measurementName:t.t("sensor.measurements.turbidity"),measurementType:"turbidity",tareable:!0,minReading:0,maxReading:50},"mW/m²":{sensorName:t.t("sensor.names.UV_sensor"),measurementName:t.t("sensor.measurements.UV_intensity"),measurementType:"uv intensity",tareable:!0,minReading:0,maxReading:2e4},mL:{sensorName:t.t("sensor.names.drop_counter"),measurementName:t.t("sensor.measurements.volume"),measurementType:"volume",tareable:!1,minReading:0,maxReading:3},f:{sensorName:t.t("sensor.names.altitude"),measurementName:t.t("sensor.measurements.altitude"),measurementType:"altitude",tareable:!0,minReading:-300,maxReading:300},mph:{sensorName:t.t("sensor.names.anemometer"),measurementName:t.t("sensor.measurements.speed"),measurementType:"speed",tareable:!0,minReading:0,maxReading:10},"km/h":{sensorName:t.t("sensor.names.anemometer"),measurementName:t.t("sensor.measurements.speed"),measurementType:"speed",tareable:!0,minReading:0,maxReading:20},knots:{sensorName:t.t("sensor.names.anemometer"),measurementName:t.t("sensor.measurements.speed"),measurementType:"speed",tareable:!0,minReading:0,maxReading:50}}};function ma(t,e){var n,i,r,o,a,s,l,u,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E,M,P,D,O,I=e.i18n,L=new Xo(I),R={label:I.t("sensor.measurements.sensor_reading"),unitAbbreviation:"-",format:".2f",min:0,max:10},N=fa(I);function F(){var t,e,n,r,o;null!==O.properties.actualDuration&&O.properties.actualDuration!==1/0&&(t="displayTime",e=0,n=O.properties.actualDuration,(r=O.getPropertyDescription(t).getHash()).min=e,r.max=n,o=new Bn(pa,r),i.setPropertyDescription(t,o))}function B(){var t,e;l?(t=N[l.units])?(e={label:t.measurementName,format:".2f",min:t.minReading,max:t.maxReading},pa.units[t.measurementType]?e.unitType=t.measurementType:e.unitAbbreviation=l.units,A=t.tareable,d=t.sensorName||l.units+" "+I.t("sensor.names.sensor")):(e={label:l.name||I.t("sensor.measurements.sensor_reading"),unitAbbreviation:l.units,format:".2f",min:0,max:10},A=!0,d=l.units+" "+I.t("sensor.names.sensor")):(e=R,A=!1,d=I.t("sensor.names.no_sensor")),i.setPropertyDescription("sensorReading",new Bn(pa,e)),i.setPropertyDescription("liveSensorReading",new Bn(pa,e))}function z(){var t,e;u?(t=N[u.units])?(e={label:t.measurementName,format:".2f",min:t.minReading,max:t.maxReading},pa.units[t.measurementType]?e.unitType=t.measurementType:e.unitAbbreviation=u.units,E=t.tareable,p=t.sensorName||l.units+" "+I.t("sensor.names.sensor")):(e={label:u.name||I.t("sensor.measurements.sensor_reading"),unitAbbreviation:u.units,format:".2f",min:0,max:10},E=!0,p=u.units+" "+I.t("sensor.names.sensor")):(e=R,E=!1,p=I.t("sensor.names.no_sensor")),i.setPropertyDescription("sensorReading2",new Bn(pa,e)),i.setPropertyDescription("liveSensorReading2",new Bn(pa,e))}function j(){f=!0,S=a.canControl,k=!1,null==c&&(c={index:1}),null==h&&(h={index:2}),x=0,g=0,0,v=void 0,y=void 0,b=void 0,_=void 0,s=void 0,l=void 0,u=void 0}function V(t,e){var n=t.columns[e];return!(!n||n.units!==c.units)&&(c.index=e,!0)}function H(t,e){var n=t.columns[e];return!(!n||n.units!==h.units)&&(h.index=e,!0)}function W(){var t,e,n,i=a.datasets[0];k=i.columns.length>2,s=i.columns[0],a.hasAttachedInterface?(function(t){return!(t.columns.length<2)&&!(2===t.columns.length&&!t.columns[1].name&&!t.columns[1].units)}(i)&&k?(M=S?I.t("sensor.messages.ready"):a.inControl.clientName?I.t("sensor.messages.ready_nocontrol",{controlling_client:a.inControl.clientName}):I.t("sensor.messages.ready_nocontrol_noname"),w=!0):(M=I.t("sensor.messages.no_sensors"),w=!1),(n=c.index)>=i.columns.length&&i.columns.length>1&&(n=i.columns.length-1),(t=i.columns[n])&&c.units&&t.units!==c.units&&(V(i,n+1)?t=i.columns[n+1]:n>1&&V(i,n-1)?t=i.columns[n-1]:(t=i.columns[1],c.index=1)),(n=h.index)>=i.columns.length&&i.columns.length>2&&(n=i.columns.length-1),(e=i.columns[n])&&h.units&&e.units!==h.units&&(H(i,n+1)?e=i.columns[n+1]:n>1&&H(i,n-1)?e=i.columns[n-1]:(e=i.columns[2],h.index=2))):(M=I.t("sensor.messages.no_devices"),w=!1),!t||t.name||t.units||(t=null),!e||e.name||e.units||(e=null),(l=t)&&(c.units=l.units),B(),(u=e)&&(h.units=u.units),z(),l||(b=void 0),u||(_=void 0)}function U(){if(s&&l&&u)for(var t=Math.min(Math.min(s.data.length,l.data.length),u.data.length);x<t;x++)(g=s.data[x])>O.properties.actualDuration&&O.stop(),v=l.data[x],y=u.data[x],O.updateAllOutputProperties(),r.tick()}function G(t){return t.receivedValuesTimeStamp>=t.requestedValuesTimeStamp}function q(){return G(s)&&(!l||G(l))&&(!u||G(u))}function Y(t){var e=Array.prototype.slice.call(arguments,0);O.makeInvalidatingChange((function(){o.handleEvent.apply(o,e)||("connectionTimedOut"===t?o.gotoState("disconnected"):"sessionChanged"===t?(a.stopPolling(),o.gotoState("disconnected")):"statusErrored"===t&&o.gotoState("initialConnectionFailure"))}))}return O={on:function(t,e){r.on(t,e)},start:function(){Y("start")},stop:function(){Y("stop")},tare:function(){var t=w;w=!1,Y("tare"),w=t},tare2:function(){var t=w;w=!1,Y("tare2"),w=t},willReset:function(){r.willReset()},reset:function(){Y("reset")},reload:function(){O.stop(),O.makeInvalidatingChange((function(){m=!0}))},isStopped:function(){return f},stepCounter:function(){return x},connectedSensors:function(){var t,e=[],n=a.datasets[0];for(t=0;t<n.columns.length;t++)e.push({units:n.columns[t].units,name:n.columns[t].name});return e},getSelectedSensor:function(){return c.index},getSelectedSensor2:function(){return h.index},setSelectedSensor:function(t){c.index!==t&&(c.index=t,c.units=null,O.properties.tareValue=0,W())},setSelectedSensor2:function(t){h.index!==t&&(h.index=t,h.units=null,O.properties.tareValue2=0,W())},serialize:function(){return""}},o=new ca({notConnected:{enterState:function(){M=I.t("sensor.messages.not_connected"),0,a.startPolling(["https://localhost:11181","https://127.0.0.1:11181","http://localhost:11180","http://127.0.0.1:11180"],O.properties.clientId,O.properties.clientName),this.gotoState("connecting")}},connecting:{enterState:function(){M=I.t("sensor.messages.connecting"),a.isConnected?this.gotoState("connected"):P=L.status(I.t("sensor.messages.connection_in_progress"),{dialogClass:"interactive-dialog no-close"})},leaveState:function(){P&&(P.close(),P=null)},statusErrored:function(){this.gotoState("initialConnectionFailure")},connectionTimedOut:function(){this.gotoState("initialConnectionFailure")},launchTimedOut:function(){this.gotoState("initialConnectionFailure")},statusReceived:function(){this.gotoState("connected")},sessionChanged:function(){a.stopPolling(),a.startPolling()}},initialConnectionFailure:{enterState:function(){a.stopPolling(),M=I.t("sensor.messages.connection_failed",{retry_link:""});L.alert(I.t("sensor.messages.connection_failed_alert",{click_here_link:"<a target='_blank' style='color: #222299;' href='http://sensorconnector.concord.org/'>"+I.t("sensor.messages.click_here")+"</a>"}),{"Try again":function(){$(this).dialog("close"),Y("dismiss")}},{close:function(){Y("closed")}})},statusErrored:function(){},connectionTimedOut:function(){},launchTimedOut:function(){},closed:function(){M=I.t("sensor.messages.connection_failed",{retry_link:"<a href='javascript:void(0);' class='retry-link'>"+I.t("sensor.messages.connection_failed_retry_link_text")+"</a>"});!function t(){var e=$("a.retry-link");e[0]?e.click((function(){Y("dismiss")})):setTimeout(t,50)}()},dismiss:function(){this.gotoState("notConnected")}},connected:{enterState:function(){M=I.t("sensor.messages.connected"),C=!0,T=!0,w=!0,f=!0,W(),S?this.controlEnabled():this.controlDisabled(),a.isCollecting&&this.gotoState("started")},leaveState:function(){C=!1,T=!1,w=!1},columnAdded:W,columnRemoved:W,columnTypeChanged:W,columnMoved:W,interfaceConnected:W,interfaceRemoved:W,tare:function(){l&&(O.properties.tareValue=l.liveValue)},tare2:function(){u&&(O.properties.tareValue2=u.liveValue)},start:function(){a.requestStart().catch((function(){Y("startRequestFailed")})),this.gotoState("starting")},controlEnabled:function(){M=I.t("sensor.messages.connected")},controlDisabled:function(){M=a.inControl.clientName?I.t("sensor.messages.connected_start_sensorconnector",{controlling_client:a.inControl.clientName}):I.t("sensor.messages.connected_start_sensorconnector_noname")},sessionChanged:function(){a.stopPolling(),a.startPolling(),this.gotoState("connecting")},collectionStarted:function(){this.gotoState("started")}},starting:{enterState:function(){M=I.t("sensor.messages.starting_data_collection"),f=!1;var t=this;this._startTimerId=setTimeout(5e3,(function(){t.gotoState("startRequestFailed")}))},leaveState:function(){clearTimeout(this._startTimerId)},startRequestFailed:function(){this.gotoState("errorStarting")},collectionStarted:function(){this.gotoState("started")}},errorStarting:{enterState:function(){M=I.t("sensor.messages.error_starting_data_collection"),f=!0,L.alert(I.t("sensor.messages.error_starting_data_collection_alert"),{OK:function(){$(this).dialog("close"),Y("dismissErrorStarting")}})},collectionStarted:function(){this.gotoState("started")},dismissErrorStarting:function(){this.gotoState("connected")}},started:{enterState:function(){f=!1,W(),w=!1,M=S?I.t("sensor.messages.collecting_data"):I.t("sensor.messages.collecting_data_stop_sensorconnector"),a.isCollecting||this.gotoState("stopped"),l&&u||this.gotoState("startedWithNoDataColumn")},data:U,controlEnabled:function(){M=I.t("sensor.messages.collecting_data")},controlDisabled:function(){M=I.t("sensor.messages.collecting_data_stop_sensorconnector")},stop:function(){a.requestStop().catch((function(){Y("stopRequestFailed")})),this.gotoState("stopping")},collectionStopped:function(){this.gotoState("collectionStopped")}},startedWithNoDataColumn:{enterState:function(){M=I.t("sensor.messages.no_data"),a.requestStop(),L.alert(I.t("sensor.messages.no_data_alert"),{OK:function(){$(this).dialog("close")}})},collectionStopped:function(){this.gotoState("stoppedWithNoDataColumn")}},stoppedWithNoDataColumn:{enterState:function(){q()&&this.gotoState("connected")},data:function(){q()&&this.gotoState("connected")}},stopping:{enterState:function(){M=I.t("sensor.messages.stopping_data_collection")},data:U,stopRequestFailed:function(){this.gotoState("errorStopping")},collectionStopped:function(){this.gotoState("collectionStopped")}},errorStopping:{enterState:function(){M=I.t("sensor.messages.error_stopping_data_collection"),L.alert(I.t("sensor.messages.error_stopping_data_collection_alert"),{OK:function(){$(this).dialog("close"),Y("dismissErrorStopping")}})},data:U,collectionStopped:function(){this.gotoState("collectionStopped")},dismissErrorStopping:function(){this.gotoState("started")}},collectionStopped:{enterState:function(){M=I.t("sensor.messages.data_collection_stopped"),q()&&this.gotoState("collectionComplete")},data:function(){U(),q()&&this.gotoState("collectionComplete")}},collectionComplete:{enterState:function(){M=I.t("sensor.messages.data_collection_complete"),f=!0,r.stop()},reset:function(){j(),B(),z(),this.gotoState("connecting"),r.reset()}},disconnected:{enterState:function(){M=I.t("sensor.messages.disconnected"),a.stopPolling();var t=this;setTimeout((function(){t.gotoState("notConnected")}),2e3)}}}),(a=new da.a).on("*",(function(){var t=Array.prototype.slice.call(arguments,0);Y.apply(null,[this.event].concat(t))})),a.on("statusReceived",(function(){l&&O.makeInvalidatingChange((function(){b=l.liveValue})),u&&O.makeInvalidatingChange((function(){_=u.liveValue}))})),a.on("controlEnabled",(function(){S=!0})),a.on("controlDisabled",(function(){S=!1})),n=new qn({metadata:la,setters:{},unitsDefinition:pa,initialProperties:t,usePlaybackSupport:!1}),i=n.propertySupport,(r=n.dispatchSupport).addEventTypes("tick","play","stop","tickStart","tickEnd"),n.mixInto(O),j(),O.properties.useRandomClientId&&(O.properties.clientId=Math.floor(4294967296*(1+Math.random())).toString(16)),O.addObserver("clientName",(function(){a.clientName=O.properties.clientName})),O.defineOutput("time",{label:I.t("sensor.measurements.time"),unitType:"time",format:".2f"},(function(){return g})),O.defineOutput("displayTime",{label:I.t("sensor.measurements.time"),unitType:"time",format:".2f"},(function(){return g})),D=O.getPropertyDescription("displayTime"),O.defineOutput("sensorReading",R,(function(){return null==v?v:v-O.properties.tareValue})),O.defineOutput("sensorReading2",R,(function(){return null==y?y:y-O.properties.tareValue2})),O.defineOutput("durationOptions",{},(function(){return[1,5,10,15,20,30,45,60]})),O.formatTime=function(t){return D.format(t)},O.defineOutput("actualUseDuration",{},n.computeActualUseDuration),O.defineOutput("actualDuration",{label:"Experiment duration",unitType:"time",format:"f"},n.computeActualDuration),O.defineOutput("liveSensorReading",R,(function(){return null==b?b:b-O.properties.tareValue})),O.defineOutput("liveSensorReading2",R,(function(){return null==_?_:_-O.properties.tareValue2})),O.defineOutput("sensorName",{label:"Sensor Name"},(function(){return d})),O.defineOutput("sensorName2",{label:"2nd Sensor Name"},(function(){return p})),O.defineOutput("isStopped",{label:"Stopped?"},(function(){return f})),O.defineOutput("isPlayable",{label:"Startable?"},(function(){return w})),O.defineOutput("hasPlayed",{label:"Has successfully collected data?"},(function(){return x>0})),O.defineOutput("canTare",{label:"Can set a tare value?"},(function(){return C&&A})),O.defineOutput("canTare2",{label:"Can set a tare value?"},(function(){return T&&E})),O.defineOutput("canControl",{label:"Can remotely start/stop the Sensor Connector?"},(function(){return S})),O.defineOutput("hasMultipleSensors",{label:"Are multiple sensors connected to the Sensor Connector?"},(function(){return k})),O.defineOutput("needsReload",{label:"Needs Reload?"},(function(){return m})),O.defineOutput("message",{label:"User Message"},(function(){return M})),O.defineParameter("isNewRunInProgress",{initialValue:!1}),O.on("willReset.model",(function(){a.stopPolling(),a.isCollecting&&a.requestStop()})),O.addObserver("actualDuration",F),F(),O.updateAllOutputProperties(),o.gotoState("notConnected"),O}var ga=function(t,e,n){var i,r,o,a=d3.format(".2f"),s=fa(n);function l(){t.properties.canTare?Wt(o.$zeroButton):Ht(o.$zeroButton)}function u(){t.properties.canTare2?Wt(o.$zeroButton2):Ht(o.$zeroButton2)}function c(){}function h(){t.properties.hasMultipleSensors&&t.properties.isPlayable?(Wt(o.$selectSensorButton),Wt(o.$selectSensorButton2)):(Ht(o.$selectSensorButton),Ht(o.$selectSensorButton2))}function d(){o.$message.html(t.properties.message)}function p(){t.addObserver("canTare",l),t.addObserver("canTare2",u),l(),u(),t.addObserver("canConnect",c),t.addObserver("hasMultipleSensors",h),t.addObserver("isPlayable",h),h(),t.addObserver("message",d),d()}function f(){g(!1)}function m(){g(!0)}function g(e){e=e||!1;var i,r,o,a=new Pt({width:"60%",dialogClass:"interactive-dialog no-close",closeOnEscape:!1,title:n.t("sensor.choose_sensor_title"),buttons:{OK:function(){console.log("OK Clicked"),$(this).dialog("close"),e?t.setSelectedSensor2($(this).find("input:checked").val()):t.setSelectedSensor($(this).find("input:checked").val())},Cancel:function(){console.log("Cancel Clicked"),$(this).dialog("close")}}},n),l="",u=t.connectedSensors(),c=!0,h=e?t.getSelectedSensor2():t.getSelectedSensor();for(i=0;i<u.length;i++)"s"!==u[i].units&&(r="",u[i].name?o={measurementName:u[i].name}:(o=s[u[i].units])||(o={measurementName:"Unknown"}),(h==i||c&&-1==h)&&(r="checked "),l+="<input type='radio' name='selected-sensor-index' value='"+i+"' "+r+"/>"+(o.measurementName+" ("+u[i].units+")")+"<br/>",c=!1);a.setContent(l),a.open()}return o={$el:$("<div id='model-container' class='container sensor-model-container' />"),remoteAddress:null,bindModel:function(n,i){e=i||e,t=n||t,p()},getHeightForWidth:function(){return"2.8em"},setup:function(){o.$el.empty(),o.$controlsContainer=$("<div></div>"),o.$statusContainer=$("<div></div>"),i=new De({id:"sensor-value-view",label:n.t("sensor.reading"),units:t.getPropertyDescription("sensorReading").getUnitAbbreviation()}),r=new De({id:"sensor-value-view-2",label:n.t("sensor.reading"),units:t.getPropertyDescription("sensorReading2").getUnitAbbreviation()}),o.$zeroButton=$("<div class='interactive-button'><button>"+n.t("sensor.zero")+"</button></div>"),o.$zeroButton2=$("<div class='interactive-button'><button>"+n.t("sensor.zero")+"</button></div>"),o.$selectSensorButton=$("<div class='interactive-button'><button>"+n.t("sensor.select_sensor")+"</button></div>"),o.$selectSensorButton2=$("<div class='interactive-button'><button>"+n.t("sensor.select_sensor")+"</button></div>"),o.$message=$("<div class='message'></div>"),o.$sensorReading=i.render().addClass("horizontal"),o.$sensorReading2=r.render().addClass("horizontal"),o.$controlsContainer.append(o.$sensorReading).append(o.$zeroButton).append(o.$selectSensorButton).append(o.$sensorReading2).append(o.$zeroButton2).append(o.$selectSensorButton2),o.$statusContainer.append(o.$message),o.$el.css("zIndex",4).append(o.$controlsContainer).append(o.$statusContainer),o.$controlsContainer.find("div").addClass("component component-spacing"),o.$statusContainer.find("div").addClass("component component-spacing"),i.resize(),r.resize(),p(),o.$zeroButton.on("click","button",t.tare),o.$zeroButton2.on("click","button",t.tare2),o.$selectSensorButton.on("click","button",f),o.$selectSensorButton2.on("click","button",m)},resize:function(){i&&i.resize(),r&&r.resize()},repaint:function(){},setFocus:function(){},updateUnits:function(e){i.updateUnits(e),null==t.properties.liveSensorReading&&i.hideUnits()},updateUnits2:function(e){r.updateUnits(e),null==t.properties.liveSensorReading2&&r.hideUnits()},update:function(){null==t.properties.liveSensorReading?(i.update(""),i.hideUnits()):(i.update(a(t.properties.liveSensorReading)),i.showUnits()),null==t.properties.liveSensorReading2?(r.update(""),r.hideUnits()):(r.update(a(t.properties.liveSensorReading2)),r.showUnits())}}};function va(t){return{resetModel:function(e){t.intController.resetModel(e)}}}var ya={mainProperties:{type:{defaultValue:"sensor-connector",immutable:!0},sensorType:{defaultValue:null},tareValue:{defaultValue:0},clientId:{defaultValue:null},clientName:{defaultValue:null},useRandomClientId:{defaultValue:!1},useDuration:{defaultValue:"codap",storeInTickHistory:!1,validate:function(t){if(!0===t||!1===t||"codap"===t)return t;throw new Error("Invalid 'useDuration' value: "+t)}},requestedDuration:{defaultValue:10,storeInTickHistory:!1}},viewOptions:{showClock:{defaultValue:!0,propertyChangeInvalidates:!1},controlButtons:{defaultValue:"play_reset",propertyChangeInvalidates:!1},controlButtonStyle:{defaultValue:"video",propertyChangeInvalidates:!1,serialize:!1}}},ba={units:{time:{name:"second",pluralName:"seconds",symbol:"s"}}};function _a(t,e){var n,i,r,o,a,s,l,u,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k=e.i18n,A=new Xo(k),E={label:k.t("sensor.measurements.sensor_reading"),unitAbbreviation:"-",format:".2f",min:0,max:10},M=fa(k);function P(){var t,e,n,r,o;null!==S.properties.actualDuration&&S.properties.actualDuration!==1/0&&(t="displayTime",e=0,n=S.properties.actualDuration,(r=S.getPropertyDescription(t).getHash()).min=e,r.max=n,o=new Bn(ba,r),i.setPropertyDescription(t,o))}function D(){var t,e;l?(t=M[l.units])?(e={label:t.measurementName,format:".2f",min:t.minReading,max:t.maxReading},ba.units[t.measurementType]?e.unitType=t.measurementType:e.unitAbbreviation=l.units,x=t.tareable,c=t.sensorName||l.units+" sensor"):(e={label:l.name||k.t("sensor.measurements.sensor_reading"),unitAbbreviation:l.units,format:".2f",min:0,max:10},x=!0,c=l.units+" sensor"):(e=E,x=!1,c="(no sensor)"),i.setPropertyDescription("sensorReading",new Bn(ba,e)),i.setPropertyDescription("liveSensorReading",new Bn(ba,e))}function O(){h=!0,b=a.canControl,_=!1,null==u&&(u={index:1}),g=0,p=0,0,f=void 0,m=void 0,s=void 0,l=void 0}function I(t,e){var n=t.columns[e];return!(!n||n.units!==u.units)&&(u.index=e,!0)}function L(){var t,e,n=a.datasets[0];_=n.columns.length>2,s=n.columns[0],a.hasAttachedInterface?(!function(t){return!(t.columns.length<2)&&!(2===t.columns.length&&!t.columns[1].name&&!t.columns[1].units)}(n)?(w=k.t("sensor.messages.no_sensors"),v=!1):(w=b?k.t("sensor.messages.ready"):a.inControl.clientName?k.t("sensor.messages.ready_nocontrol",{controlling_client:a.inControl.clientName}):k.t("sensor.messages.ready_nocontrol_noname"),v=!0),(e=u.index)>=n.columns.length&&n.columns.length>1&&(e=n.columns.length-1),(t=n.columns[e])&&u.units&&t.units!==u.units&&(I(n,e+1)?t=n.columns[e+1]:e>1&&I(n,e-1)?t=n.columns[e-1]:(t=n.columns[1],u.index=1))):(w=k.t("sensor.messages.no_devices"),v=!1),!t||t.name||t.units||(t=null),(l=t)&&(u.units=l.units),D(),l||(m=void 0)}function R(){if(s&&l)for(var t=Math.min(s.data.length,l.data.length);g<t;g++)(p=s.data[g])>S.properties.actualDuration&&S.stop(),f=l.data[g],S.updateAllOutputProperties(),r.tick()}function N(t){return t.receivedValuesTimeStamp>=t.requestedValuesTimeStamp}function F(){return N(s)&&(!l||N(l))}function B(t){var e=Array.prototype.slice.call(arguments,0);S.makeInvalidatingChange((function(){o.handleEvent.apply(o,e)||("connectionTimedOut"===t?o.gotoState("disconnected"):"sessionChanged"===t?(a.stopPolling(),o.gotoState("disconnected")):"statusErrored"===t&&o.gotoState("initialConnectionFailure"))}))}return S={on:function(t,e){r.on(t,e)},start:function(){B("start")},stop:function(){B("stop")},tare:function(){var t=v;v=!1,B("tare"),v=t},willReset:function(){r.willReset()},reset:function(){B("reset")},reload:function(){S.stop(),S.makeInvalidatingChange((function(){d=!0}))},isStopped:function(){return h},stepCounter:function(){return g},connectedSensors:function(){var t,e=[],n=a.datasets[0];for(t=0;t<n.columns.length;t++)e.push({units:n.columns[t].units,name:n.columns[t].name});return e},getSelectedSensor:function(){return u.index},setSelectedSensor:function(t){u.index!=t&&(u.index=t,u.units=null,S.properties.tareValue=0,L())},serialize:function(){return""}},o=new ca({notConnected:{enterState:function(){w=k.t("sensor.messages.not_connected"),0,a.startPolling(["https://localhost:11181","https://127.0.0.1:11181","http://localhost:11180","http://127.0.0.1:11180"],S.properties.clientId,S.properties.clientName),this.gotoState("connecting")}},connecting:{enterState:function(){w=k.t("sensor.messages.connecting"),a.isConnected?this.gotoState("connected"):C=A.status(k.t("sensor.messages.connection_in_progress"),{dialogClass:"interactive-dialog no-close"})},leaveState:function(){C&&(C.close(),C=null)},statusErrored:function(){this.gotoState("initialConnectionFailure")},connectionTimedOut:function(){this.gotoState("initialConnectionFailure")},launchTimedOut:function(){this.gotoState("initialConnectionFailure")},statusReceived:function(){this.gotoState("connected")},sessionChanged:function(){a.stopPolling(),a.startPolling()}},initialConnectionFailure:{enterState:function(){a.stopPolling(),w=k.t("sensor.messages.connection_failed",{retry_link:""});A.alert(k.t("sensor.messages.connection_failed_alert",{click_here_link:"<a target='_blank' style='color: #222299;' href='http://sensorconnector.concord.org/'>"+k.t("sensor.messages.click_here")+"</a>"}),{"Try again":function(){$(this).dialog("close"),B("dismiss")}},{close:function(){B("closed")}})},statusErrored:function(){},connectionTimedOut:function(){},launchTimedOut:function(){},closed:function(){w=k.t("sensor.messages.connection_failed",{retry_link:"<a href='javascript:void(0);' class='retry-link'>"+k.t("sensor.messages.connection_failed_retry_link_text")+"</a>"});!function t(){var e=$("a.retry-link");e[0]?e.click((function(){B("dismiss")})):setTimeout(t,50)}()},dismiss:function(){this.gotoState("notConnected")}},connected:{enterState:function(){w=k.t("sensor.messages.connected"),y=!0,v=!0,h=!0,L(),b?this.controlEnabled():this.controlDisabled(),a.isCollecting&&this.gotoState("started")},leaveState:function(){y=!1,v=!1},columnAdded:L,columnRemoved:L,columnTypeChanged:L,columnMoved:L,interfaceConnected:L,interfaceRemoved:L,tare:function(){l&&(S.properties.tareValue=l.liveValue)},start:function(){a.requestStart().catch((function(){B("startRequestFailed")})),this.gotoState("starting")},controlEnabled:function(){w=k.t("sensor.messages.connected")},controlDisabled:function(){w=a.inControl.clientName?k.t("sensor.messages.connected_start_sensorconnector",{controlling_client:a.inControl.clientName}):k.t("sensor.messages.connected_start_sensorconnector_noname")},sessionChanged:function(){a.stopPolling(),a.startPolling(),this.gotoState("connecting")},collectionStarted:function(){this.gotoState("started")}},starting:{enterState:function(){w=k.t("sensor.messages.starting_data_collection"),h=!1;var t=this;this._startTimerId=setTimeout(5e3,(function(){t.gotoState("startRequestFailed")}))},leaveState:function(){clearTimeout(this._startTimerId)},startRequestFailed:function(){this.gotoState("errorStarting")},collectionStarted:function(){this.gotoState("started")}},errorStarting:{enterState:function(){w=k.t("sensor.messages.error_starting_data_collection"),h=!0,A.alert(k.t("sensor.messages.error_starting_data_collection_alert"),{OK:function(){$(this).dialog("close"),B("dismissErrorStarting")}})},collectionStarted:function(){this.gotoState("started")},dismissErrorStarting:function(){this.gotoState("connected")}},started:{enterState:function(){h=!1,L(),v=!1,w=b?k.t("sensor.messages.collecting_data"):k.t("sensor.messages.collecting_data_stop_sensorconnector"),a.isCollecting||this.gotoState("stopped"),l||this.gotoState("startedWithNoDataColumn")},data:R,controlEnabled:function(){w=k.t("sensor.messages.collecting_data")},controlDisabled:function(){w=k.t("sensor.messages.collecting_data_stop_sensorconnector")},stop:function(){a.requestStop().catch((function(){B("stopRequestFailed")})),this.gotoState("stopping")},collectionStopped:function(){this.gotoState("collectionStopped")}},startedWithNoDataColumn:{enterState:function(){w=k.t("sensor.messages.no_data"),a.requestStop(),A.alert(k.t("sensor.messages.no_data_alert"),{OK:function(){$(this).dialog("close")}})},collectionStopped:function(){this.gotoState("stoppedWithNoDataColumn")}},stoppedWithNoDataColumn:{enterState:function(){F()&&this.gotoState("connected")},data:function(){F()&&this.gotoState("connected")}},stopping:{enterState:function(){w=k.t("sensor.messages.stopping_data_collection")},data:R,stopRequestFailed:function(){this.gotoState("errorStopping")},collectionStopped:function(){this.gotoState("collectionStopped")}},errorStopping:{enterState:function(){w=k.t("sensor.messages.error_stopping_data_collection"),A.alert(k.t("sensor.messages.error_stopping_data_collection_alert"),{OK:function(){$(this).dialog("close"),B("dismissErrorStopping")}})},data:R,collectionStopped:function(){this.gotoState("collectionStopped")},dismissErrorStopping:function(){this.gotoState("started")}},collectionStopped:{enterState:function(){w=k.t("sensor.messages.data_collection_stopped"),F()&&this.gotoState("collectionComplete")},data:function(){R(),F()&&this.gotoState("collectionComplete")}},collectionComplete:{enterState:function(){w=k.t("sensor.messages.data_collection_complete"),h=!0,r.stop()},reset:function(){O(),D(),this.gotoState("connecting"),r.reset()}},disconnected:{enterState:function(){w=k.t("sensor.messages.disconnected"),a.stopPolling();var t=this;setTimeout((function(){t.gotoState("notConnected")}),2e3)}}}),(a=new da.a).on("*",(function(){var t=Array.prototype.slice.call(arguments,0);B.apply(null,[this.event].concat(t))})),a.on("statusReceived",(function(){l&&S.makeInvalidatingChange((function(){m=l.liveValue}))})),a.on("controlEnabled",(function(){b=!0})),a.on("controlDisabled",(function(){b=!1})),n=new qn({metadata:ya,setters:{},unitsDefinition:ba,initialProperties:t,usePlaybackSupport:!1}),i=n.propertySupport,(r=n.dispatchSupport).addEventTypes("tick","play","stop","tickStart","tickEnd"),n.mixInto(S),O(),S.properties.useRandomClientId&&(S.properties.clientId=Math.floor(4294967296*(1+Math.random())).toString(16)),S.addObserver("clientName",(function(){a.clientName=S.properties.clientName})),S.defineOutput("time",{label:k.t("sensor.measurements.time"),unitType:"time",format:".2f"},(function(){return p})),S.defineOutput("displayTime",{label:k.t("sensor.measurements.time"),unitType:"time",format:".1f"},(function(){return p})),T=S.getPropertyDescription("displayTime"),S.defineOutput("sensorReading",E,(function(){return null==f?f:f-S.properties.tareValue})),S.defineOutput("durationOptions",{},(function(){return[1,5,10,15,20,30,45,60]})),S.formatTime=function(t){return T.format(t)},S.defineOutput("actualUseDuration",{},n.computeActualUseDuration),S.defineOutput("actualDuration",{label:"Experiment duration",unitType:"time",format:"f"},n.computeActualDuration),S.defineOutput("liveSensorReading",E,(function(){return null==m?m:m-S.properties.tareValue})),S.defineOutput("sensorName",{label:"Sensor Name"},(function(){return c})),S.defineOutput("isStopped",{label:"Stopped?"},(function(){return h})),S.defineOutput("isPlayable",{label:"Startable?"},(function(){return v})),S.defineOutput("hasPlayed",{label:"Has successfully collected data?"},(function(){return g>0})),S.defineOutput("canTare",{label:"Can set a tare value?"},(function(){return y&&x})),S.defineOutput("canControl",{label:"Can remotely start/stop the Sensor Connector?"},(function(){return b})),S.defineOutput("hasMultipleSensors",{label:"Are multiple sensors connected to the Sensor Connector?"},(function(){return _})),S.defineOutput("needsReload",{label:"Needs Reload?"},(function(){return d})),S.defineOutput("message",{label:"User Message"},(function(){return w})),S.defineParameter("isNewRunInProgress",{initialValue:!1}),S.on("willReset.model",(function(){a.stopPolling(),a.isCollecting&&a.requestStop()})),S.addObserver("actualDuration",P),P(),S.updateAllOutputProperties(),o.gotoState("notConnected"),S}var xa=function(t,e,n){var i,r,o=d3.format(".2f"),a=fa(n);function s(){t.properties.canTare?Wt(r.$zeroButton):Ht(r.$zeroButton)}function l(){}function u(){t.properties.hasMultipleSensors&&t.properties.isPlayable?Wt(r.$selectSensorButton):Ht(r.$selectSensorButton)}function c(){r.$message.html(t.properties.message)}function h(){t.addObserver("canTare",s),s(),t.addObserver("canConnect",l),t.addObserver("hasMultipleSensors",u),t.addObserver("isPlayable",u),u(),t.addObserver("message",c),c()}function d(){var e,i,r,o=new Pt({width:"60%",dialogClass:"interactive-dialog no-close",closeOnEscape:!1,title:n.t("sensor.choose_sensor_title"),buttons:{OK:function(){console.log("OK Clicked"),$(this).dialog("close"),t.setSelectedSensor($(this).find("input:checked").val())},Cancel:function(){console.log("Cancel Clicked"),$(this).dialog("close")}}},n),s="",l=t.connectedSensors(),u=!0,c=t.getSelectedSensor();for(e=0;e<l.length;e++)"s"!==l[e].units&&(i="",l[e].name?r={measurementName:l[e].name}:(r=a[l[e].units])||(r={measurementName:"Unknown"}),(c==e||u&&-1==c)&&(i="checked "),s+="<input type='radio' name='selected-sensor-index' value='"+e+"' "+i+"/>"+(r.measurementName+" ("+l[e].units+")")+"<br/>",u=!1);o.setContent(s),o.open()}return r={$el:$("<div id='model-container' class='container sensor-model-container' />"),remoteAddress:null,bindModel:function(n,i){e=i||e,t=n||t,h()},getHeightForWidth:function(){return"2.8em"},setup:function(){r.$el.empty(),r.$controlsContainer=$("<div></div>"),r.$statusContainer=$("<div></div>"),i=new De({id:"sensor-value-view",label:n.t("sensor.reading"),units:t.getPropertyDescription("sensorReading").getUnitAbbreviation()}),r.$zeroButton=$("<div class='interactive-button'><button>"+n.t("sensor.zero")+"</button></div>"),r.$selectSensorButton=$("<div class='interactive-button'><button>"+n.t("sensor.select_sensor")+"</button></div>"),r.$message=$("<div class='message'></div>"),r.$sensorReading=i.render().addClass("horizontal"),r.$controlsContainer.append(r.$sensorReading).append(r.$zeroButton).append(r.$selectSensorButton),r.$statusContainer.append(r.$message),r.$el.css("zIndex",4).append(r.$controlsContainer).append(r.$statusContainer),r.$controlsContainer.find("div").addClass("component component-spacing"),r.$statusContainer.find("div").addClass("component component-spacing"),i.resize(),h(),r.$zeroButton.on("click","button",t.tare),r.$selectSensorButton.on("click","button",d)},resize:function(){i&&i.resize()},repaint:function(){},setFocus:function(){},updateUnits:function(e){i.updateUnits(e),null==t.properties.liveSensorReading&&i.hideUnits()},update:function(){null==t.properties.liveSensorReading?(i.update(""),i.hideUnits()):(i.update(o(t.properties.liveSensorReading)),i.showUnits())}}};function wa(t){return{resetModel:function(e){t.intController.resetModel(e)}}}var Ca={mainProperties:{type:{defaultValue:"labquest2",immutable:!0},sensorType:{defaultValue:null},tareValue:{defaultValue:0}},viewOptions:{showClock:{defaultValue:!0,propertyChangeInvalidates:!1},controlButtons:{defaultValue:"play_reset",propertyChangeInvalidates:!1},controlButtonStyle:{defaultValue:"video",propertyChangeInvalidates:!1,serialize:!1}}},Ta=n(8),Sa=n.n(Ta),ka={units:{time:{name:"second",pluralName:"seconds",symbol:"s"},distance:{name:"meter",pluralName:"meters",symbol:"m"},temperature:{name:"degree Celsius",pluaralName:"degrees Celsius",symbol:"°C"},light:{name:"lux",pluralName:"lux",symbol:"lux"},force:{name:"Newton",pluralName:"Newtons",symbol:"N"},ph:{name:"pH Unit",pluralName:"pH Units",symbol:"pH"},co2:{name:"part per million",pluralName:"parts per million",symbol:"ppm"},o2:{name:"part per million",pluralName:"parts per million",symbol:"ppm"}}};function Aa(t,e){var n,i,r,o,a,s,l,u,c,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E=e.i18n,M=new Xo(E),P={label:E.t("sensor.measurements.sensor_reading"),unitAbbreviation:"-",format:".2f",min:0,max:10},D=fa(E);function O(){var t,e;s?(t=D[s.units])?(e={label:t.measurementName,format:".2f",min:t.minReading,max:t.maxReading},ka.units[t.measurementType]?e.unitType=t.measurementType:e.unitAbbreviation=s.units,S=t.tareable,u=t.sensorName):(e={label:E.t("sensor.measurements.sensor_reading"),unitAbbreviation:s.units,format:".2f",min:0,max:10},S=!0,u=s.units+" sensor"):(e=P,S=!1,u="(no sensor)"),i.setPropertyDescription("sensorReading",new Bn(ka,e)),i.setPropertyDescription("liveSensorReading",new Bn(ka,e))}function I(){c=!0,_=!1,C=Sa.a.canControl,T=!1,null==l&&(l={index:-1}),y=0,p=0,f=void 0,m=void 0,g=0,v=0,a=void 0,s=void 0}function L(t,e){var n=t.columns[e];return!(!n||n.units!==l.units)&&(l.index=e,!0)}function R(){var t,e,n=Sa.a.datasets[0];T=n.columns.length>2,a=h.a.find(n.columns,(function(t){return"s"===t.units})),-1==(e=l.index)&&(t=h.a.find(n.columns,(function(t,n){return"s"!==t.units&&(l.index=n,l.units=t.units,e=n,!0)}))),e>=n.columns.length&&n.columns.length>1&&(e=n.columns.length-1),(t=n.columns[e])&&l.units&&t.units!==l.units&&(t=L(n,e+1)?n.columns[e+1]:e>1&&L(n,e-1)?n.columns[e-1]:h.a.find(n.columns,(function(t,n){return"s"!==t.units&&(l.index=n,l.units=t.units,e=n,!0)}))),(s=t)&&(l.units=s.units),O(),s||(m=void 0)}function N(){if(a&&s)for(var t=Math.min(a.data.length,s.data.length);y<t;y++)p=a.data[y],f=s.data[y],A.updateAllOutputProperties(),r.tick()}function F(t){return t.receivedValuesTimeStamp>=t.requestedValuesTimeStamp}function B(){return F(a)&&(!s||F(s))}function z(t){var e=Array.prototype.slice.call(arguments,0);A.makeInvalidatingChange((function(){o.handleEvent.apply(o,e)||"connectionTimedOut"!==t&&"sessionChanged"!==t||o.gotoState("disconnected")}))}return A={on:function(t,e){r.on(t,e)},connect:function(t){z("connect",t)},start:function(){z("start")},stop:function(){z("stop")},tare:function(){var t=b;b=!1,z("tare"),b=t},willReset:function(){r.willReset()},reset:function(){z("reset")},reload:function(){A.stop(),A.makeInvalidatingChange((function(){d=!0}))},isStopped:function(){return c},stepCounter:function(){return y},connectedSensors:function(){var t,e=[],n=Sa.a.datasets[0];for(t=0;t<n.columns.length;t++)e.push(n.columns[t].units);return e},getSelectedSensor:function(){return l.index},setSelectedSensor:function(t){l.index!==t&&(l.index=t,l.units=null,A.properties.tareValue=0,R())},serialize:function(){return""}},o=new ca({notConnected:{enterState:function(){k=E.t("sensor.messages.not_connected"),_=!0},leaveState:function(){_=!1},connect:function(t){Sa.a.startPolling(t),this.gotoState("connecting")}},connecting:{enterState:function(){k=E.t("sensor.messages.connecting"),Sa.a.isConnected&&this.gotoState("connected")},statusErrored:function(){this.gotoState("initialConnectionFailure")},connectionTimedOut:function(){this.gotoState("initialConnectionFailure")},statusReceived:function(){this.gotoState("connected")},sessionChanged:function(){Sa.a.stopPolling(),Sa.a.startPolling()}},initialConnectionFailure:{enterState:function(){Sa.a.stopPolling(),k=E.t("sensor.messages.connection_failed"),M.alert(E.t("sensor.messages.connection_failed_labquest2_alert"),{OK:function(){$(this).dialog("close"),z("dismiss")}})},dismiss:function(){this.gotoState("notConnected")}},connected:{enterState:function(){k=E.t("sensor.messages.connected"),x=!0,b=!0,c=!0,R(),C?this.controlEnabled():this.controlDisabled(),Sa.a.isCollecting&&this.gotoState("started")},leaveState:function(){x=!1,b=!1},columnAdded:R,columnRemoved:R,columnTypeChanged:R,columnMoved:R,tare:function(){s&&(w?A.properties.tareValue=s.liveValue:(x=!1,M.alert(E.t("sensor.messages.tare_labquest2_alert"),{OK:function(){$(this).dialog("close"),x=!0}})))},start:function(){Sa.a.requestStart().catch((function(){z("startRequestFailed")})),this.gotoState("starting")},controlEnabled:function(){k=E.t("sensor.messages.connected")},controlDisabled:function(){k=E.t("sensor.messages.connected_start_labquest2")},sessionChanged:function(){Sa.a.stopPolling(),Sa.a.startPolling(),this.gotoState("connecting")},collectionStarted:function(){this.gotoState("started")}},starting:{enterState:function(){k=E.t("sensor.messages.starting_data_collection"),c=!1;var t=this;this._startTimerId=setTimeout(3e3,(function(){t.gotoState("startRequestFailed")}))},leaveState:function(){clearTimeout(this._startTimerId)},startRequestFailed:function(){this.gotoState("errorStarting")},stop:function(){this.gotoState("canceling")},collectionStarted:function(){this.gotoState("started")}},errorStarting:{enterState:function(){k=E.t("sensor.messages.error_starting_data_collection"),c=!0,M.alert(E.t("sensor.messages.error_starting_data_collection_alert"),{OK:function(){$(this).dialog("close"),z("dismissErrorStarting")}})},collectionStarted:function(){this.gotoState("started")},dismissErrorStarting:function(){this.gotoState("connected")}},started:{enterState:function(){k=C?E.t("sensor.messages.collecting_data"):E.t("sensor.messages.collecting_data_stop_labquest2"),c=!1,R(),Sa.a.isCollecting||this.gotoState("stopped"),s||this.gotoState("startedWithNoDataColumn")},data:N,controlEnabled:function(){k=E.t("sensor.messages.collecting_data")},controlDisabled:function(){k=E.t("sensor.messages.collecting_data_stop_labquest2")},stop:function(){Sa.a.requestStop().catch((function(){z("stopRequestFailed")})),this.gotoState("stopping")},collectionStopped:function(){this.gotoState("collectionStopped")}},startedWithNoDataColumn:{enterState:function(){k=E.t("sensor.messages.no_data"),Sa.a.requestStop(),M.alert(E.t("sensor.messages.no_data_labquest2_alert"),{OK:function(){$(this).dialog("close")}})},collectionStopped:function(){this.gotoState("stoppedWithNoDataColumn")}},stoppedWithNoDataColumn:{enterState:function(){B()&&this.gotoState("connected")},data:function(){B()&&this.gotoState("connected")}},canceling:{enterState:function(){k=E.t("sensor.messages.canceling_data_collection"),c=!0},data:N,cancelRequestFailed:function(){this.gotoState("errorCanceling")},collectionStarted:function(){Sa.a.requestStop().catch((function(){z("cancelRequestFailed")}))},collectionStopped:function(){this.gotoState("collectionStopped")}},errorCanceling:{enterState:function(){k=E.t("sensor.messages.error_canceling_data_collection"),M.alert(E.t("sensor.messages.error_canceling_data_collection_alert"),{OK:function(){$(this).dialog("close"),z("dismissErrorStopping")}})},data:N,collectionStopped:function(){this.gotoState("collectionStopped")},dismissErrorStopping:function(){this.gotoState("started")}},stopping:{enterState:function(){k=E.t("sensor.messages.stopping_data_collection")},data:N,stopRequestFailed:function(){this.gotoState("errorStopping")},collectionStopped:function(){this.gotoState("collectionStopped")}},errorStopping:{enterState:function(){k=E.t("sensor.messages.error_stopping_data_collection"),M.alert(E.t("sensor.messages.error_stopping_data_collection_alert"),{OK:function(){$(this).dialog("close"),z("dismissErrorStopping")}})},data:N,collectionStopped:function(){this.gotoState("collectionStopped")},dismissErrorStopping:function(){this.gotoState("started")}},collectionStopped:{enterState:function(){k=E.t("sensor.messages.data_collection_stopped"),B()&&this.gotoState("collectionComplete")},data:function(){N(),B()&&this.gotoState("collectionComplete")}},collectionComplete:{enterState:function(){k=E.t("sensor.messages.data_collection_complete"),c=!0},reset:function(){I(),O(),this.gotoState("connecting"),r.reset()}},disconnected:{enterState:function(){k=E.t("sensor.messages.disconnected"),_=!0,Sa.a.stopPolling()},leaveState:function(){_=!1},connect:function(t){Sa.a.startPolling(t),this.gotoState("connecting")}}}),Sa.a.on("*",(function(){var t=Array.prototype.slice.call(arguments,0);z.apply(null,[this.event].concat(t))})),Sa.a.on("statusReceived",(function(){s&&A.makeInvalidatingChange((function(){var t=new Date;s.liveValueTimeStamp-g>0?(w=!0,g=s.liveValueTimeStamp,v=t):w=t-v<2e3,m=s.liveValue}))})),Sa.a.on("controlEnabled",(function(){C=!0})),Sa.a.on("controlDisabled",(function(){C=!1})),(n=new qn({metadata:Ca,setters:{},unitsDefinition:ka,initialProperties:t,usePlaybackSupport:!1})).mixInto(A),i=n.propertySupport,(r=n.dispatchSupport).addEventTypes("tick","play","stop","tickStart","tickEnd"),I(),A.defineOutput("time",{label:E.t("sensor.measurements.time"),unitType:"time",format:".2f"},(function(){return p})),A.defineOutput("displayTime",{label:E.t("sensor.measurements.time"),unitType:"time",format:".2f"},(function(){return p})),A.defineOutput("sensorReading",P,(function(){return null==f?f:f-A.properties.tareValue})),A.defineOutput("liveSensorReading",P,(function(){return null==m?m:m-A.properties.tareValue})),A.defineOutput("sensorName",{label:"Sensor Name"},(function(){return u})),A.defineOutput("isStopped",{label:"Stopped?"},(function(){return c})),A.defineOutput("isPlayable",{label:"Startable?"},(function(){return b})),A.defineOutput("hasPlayed",{label:"Has successfully collected data?"},(function(){return y>0})),A.defineOutput("canTare",{label:"Can set a tare value?"},(function(){return x&&S})),A.defineOutput("canConnect",{label:"Can begin connecting to the LabQuest2?"},(function(){return _})),A.defineOutput("canControl",{label:"Can remotely start/stop the LabQuest2?"},(function(){return C})),A.defineOutput("hasMultipleSensors",{label:"Are multiple sensors connected to the LabQuest2?"},(function(){return T})),A.defineOutput("needsReload",{label:"Needs Reload?"},(function(){return d})),A.defineOutput("message",{label:"User Message"},(function(){return k})),A.on("willReset.model",(function(){Sa.a.stopPolling(),Sa.a.requestStop()})),A.updateAllOutputProperties(),o.gotoState("notConnected"),A}var Ea=function(t,e,n){var i,r,o=d3.format(".2f"),a=fa(n);function s(){t.properties.canTare?Wt(r.$zeroButton):Ht(r.$zeroButton)}function l(){t.properties.canConnect?Wt(r.$connectButton):Ht(r.$connectButton)}function u(){t.properties.hasMultipleSensors&&t.properties.isPlayable?Wt(r.$selectSensorButton):Ht(r.$selectSensorButton)}function c(){r.$message.text(t.properties.message)}function h(){t.addObserver("canTare",s),s(),t.addObserver("canConnect",l),l(),t.addObserver("hasMultipleSensors",u),t.addObserver("isPlayable",u),u(),t.addObserver("message",c),c()}function d(){var e,i,r,o=new Pt({width:"60%",dialogClass:"interactive-dialog no-close",closeOnEscape:!1,title:n.t("sensor.choose_sensor_title"),buttons:{OK:function(){console.log("OK Clicked"),$(this).dialog("close"),t.setSelectedSensor($(this).find("input:checked").val())},Cancel:function(){console.log("Cancel Clicked"),$(this).dialog("close")}}},n),s="",l=t.connectedSensors(),u=!0,c=t.getSelectedSensor();for(e=0;e<l.length;e++)"s"!==l[e]&&(i="",(r=a[l[e]])||(r={measurementName:"Unknown"}),(c==e||u&&-1==c)&&(i="checked "),s+="<input type='radio' name='selected-sensor-index' value='"+e+"' "+i+"/>"+(r.measurementName+" ("+l[e]+")")+"<br/>",u=!1);o.setContent(s),o.open()}return r={$el:$("<div id='model-container' class='container sensor-model-container' />"),remoteAddress:null,bindModel:function(n,i){e=i||e,t=n||t,h()},getHeightForWidth:function(){return"2.8em"},setup:function(){r.$el.empty(),r.$controlsContainer=$("<div></div>"),r.$statusContainer=$("<div></div>"),r.$addressInput=$("<div class='address-input'><input type='text' name='address-input' placeholder='"+n.t("sensor.address_labquest2")+"'></input></div>"),i=new De({id:"sensor-value-view",label:n.t("sensor.reading"),units:t.getPropertyDescription("sensorReading").getUnitAbbreviation()}),r.$connectButton=$("<div class='interactive-button'><button>"+n.t("sensor.connect")+"</button></div>"),r.$zeroButton=$("<div class='interactive-button'><button>"+n.t("sensor.zero")+"</button></div>"),r.$selectSensorButton=$("<div class='interactive-button'><button>"+n.t("sensor.select_sensor")+"</button></div>"),r.$message=$("<div class='message'></div>"),r.$sensorReading=i.render().addClass("horizontal"),r.$controlsContainer.append(r.$addressInput).append(r.$connectButton).append(r.$sensorReading).append(r.$zeroButton).append(r.$selectSensorButton),r.$statusContainer.append(r.$message),r.$el.css("zIndex",4).append(r.$controlsContainer).append(r.$statusContainer),r.$controlsContainer.find("div").addClass("component component-spacing"),r.$statusContainer.find("div").addClass("component component-spacing"),i.resize(),h(),"string"==typeof r.remoteAddress&&r.$addressInput.find("input").val(r.remoteAddress),r.$addressInput.find("input").on("change",(function(){r.remoteAddress=$(this).val()})),r.$addressInput.find("input").on("keypress",(function(e){13==(e.keyCode||e.which||0)&&t.properties.canConnect&&(t.connect(r.$addressInput.find("input").val()),e.preventDefault())})),r.$connectButton.on("click","button",(function(){t.connect(r.$addressInput.find("input").val())})),r.$zeroButton.on("click","button",t.tare),r.$selectSensorButton.on("click","button",d)},resize:function(){i&&i.resize()},repaint:function(){},setFocus:function(){},updateUnits:function(e){i.updateUnits(e),null==t.properties.liveSensorReading&&i.hideUnits()},update:function(){null==t.properties.liveSensorReading?(i.update(""),i.hideUnits()):(i.update(o(t.properties.liveSensorReading)),i.showUnits())}}};function Ma(t){return{resetModel:function(e){t.intController.resetModel(e)}}}var Pa,Da,Oa,Ia=n(36),La=n.n(Ia),Ra={mainProperties:{type:{defaultValue:"energy2d",immutable:!0},use_WebGL:{defaultValue:!1},grid_width:{defaultValue:100,immutable:!0},grid_height:{defaultValue:100,immutable:!0},model_width:{defaultValue:10,immutable:!0},model_height:{defaultValue:10,immutable:!0},timeStep:{defaultValue:1},timeStepsPerTick:{defaultValue:4},ticksPerGPUSync:{defaultValue:30},convective:{defaultValue:!0},background_temperature:{defaultValue:0},background_conductivity:{defaultValue:La.a.AIR_THERMAL_CONDUCTIVITY},background_specific_heat:{defaultValue:La.a.AIR_SPECIFIC_HEAT},background_density:{defaultValue:La.a.AIR_DENSITY},background_viscosity:{defaultValue:La.a.AIR_VISCOSITY},thermal_buoyancy:{defaultValue:25e-5},buoyancy_approximation:{defaultValue:1},boundary:{defaultValue:{type:"temperature",upper:0,lower:0,left:0,right:0}},sunny:{defaultValue:!1},sun_angle:{defaultValue:1.5707964},solar_power_density:{defaultValue:2e3},solar_ray_count:{defaultValue:24},solar_ray_speed:{defaultValue:.1},photon_emission_interval:{defaultValue:20}},viewOptions:{showClock:{defaultValue:!0,propertyChangeInvalidates:!1},controlButtons:{defaultValue:"play_reset",propertyChangeInvalidates:!1},controlButtonStyle:{defaultValue:"video",propertyChangeInvalidates:!1,serialize:!1},color_palette_type:{defaultValue:0},velocity:{defaultValue:!1},minimum_temperature:{defaultValue:0},maximum_temperature:{defaultValue:40},enableKeyboardHandlers:{defaultValue:!0}},part:{shapeType:{required:!0,immutable:!0},x:{defaultValue:0},y:{defaultValue:0},width:{},height:{},a:{},b:{},inner:{},outer:{},vertices:{},raw_x_coords:{serialize:!1},raw_y_coords:{serialize:!1},thermal_conductivity:{defaultValue:1},specific_heat:{defaultValue:1300},density:{defaultValue:25},transmission:{defaultValue:0},reflection:{defaultValue:0},absorption:{defaultValue:1},emissivity:{defaultValue:0},temperature:{defaultValue:0},constant_temperature:{defaultValue:!1},power:{defaultValue:0},wind_speed:{defaultValue:0},wind_angle:{defaultValue:0},visible:{defaultValue:!0},filled:{defaultValue:!0},color:{defaultValue:"auto"},label:{defaultValue:""},texture:{defaultValue:!1},draggable:{defaultValue:!0}},sensor:{type:{required:!0,immutable:!0},x:{required:!0,unitType:"length"},y:{required:!0,unitType:"length"},angle:{immutable:!0},label:{defaultValue:""},value:{readOnly:!0,serialize:!1}}},Na=function(t){var e=t.getModelOptions(),n=e.grid_width,i=e.grid_height,r=t.getConductivityArray(),o=t.getCapacityArray(),a=t.getDensityArray(),l=t.getUVelocityArray(),u=t.getVVelocityArray(),c=t.getBoundaryTemperatureArray(),h=t.getFluidityArray(),d=s.a.create(n*i,0,t.getArrayType()),p=n-1,f=i-1,m=n-2,g=i-2,v=e.model_width/e.grid_width,y=e.model_height/e.grid_height,b=function(t){var o,a,s,l,u=e.boundary,c=u.upper,h=u.lower,d=u.left,b=u.right;if("temperature"===u.type){for(o=0;o<n;o+=1)t[s=o*n]=c,t[s+f]=h;for(a=0;a<i;a+=1)t[a]=d,t[p*n+a]=b}else if("flux"===u.type){for(o=0;o<n;o+=1)l=(s=o*n)+f,t[s]=t[s+1]+c*y/r[s],t[l]=t[s+g]-h*y/r[l];for(a=0;a<i;a+=1)t[a]=t[n+a]-d*v/r[a],t[p*n+a]=t[m*n+a]+b*v/r[p*n+a]}};return{solve:function(t,i,m){var g,_,x,w,C,T,S,k,A,E,M,P,D,O,I,L=e.timeStep,R=.5/(v*v),N=.5/(y*y),F=1/L;for(s.a.copy(i,d),S=0;S<5;S+=1){for(k=1;k<p;k+=1)for(E=k*n,A=1;A<f;A+=1)M=E+A,isNaN(c[M])?(D=M-n,P=M+n,I=M-1,O=M+1,_=o[M]*a[M]*F,x=R*((g=r[M])+r[D]),w=R*(g+r[P]),C=N*(g+r[I]),T=N*(g+r[O]),i[M]=(d[M]*_+m[M]+x*i[D]+w*i[P]+C*i[I]+T*i[O])/(_+x+w+C+T)):i[M]=c[M];b(i)}t&&function(t){var i,r,o,a,s,c,m,g,_=e.timeStep,x=.5*_/v,w=.5*_/y;for(i=1;i<p;i+=1)for(o=i*n,r=1;r<f;r+=1)c=(a=o+r)-n,s=a+n,g=a-1,m=a+1,h[a]&&(d[a]=t[a]-x*(l[s]*t[s]-l[c]*t[c])-w*(u[m]*t[m]-u[g]*t[g]));for(b(d),i=1;i<p;i+=1)for(o=i*n,r=1;r<f;r+=1)h[a=o+r]&&(c=a-n,s=a+n,g=a-1,m=a+1,t[a]=.5*(t[a]+d[a])-.5*x*l[a]*(d[s]-d[c])-.5*w*u[a]*(d[m]-d[g]));b(t)}(i)}}},Fa={getWebGLContext:function(){if(!Pa){var t=document.createElement("canvas");try{Pa=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(t){}if(!Pa)throw new Error("GL: WebGL not supported.")}return Pa},get error(){if(!Pa)return"WebGL unavailable";var t=Pa.getError();return t===Pa.NO_ERROR?void 0:t}},Ba=function(t,e,n){for(var i;null!==(i=t.exec(e));)n(i)},za=function(t){var e=Object.prototype.toString.call(t);return"[object Number]"===e||"[object Boolean]"===e};(Oa=function(t,e){var n=function(t,e){var n,i={};return n=/^((\s*\/\/.*\n|\s*#extension.*\n)+)[^]*$/.exec(e),e=n?n[1]+t+e.substr(n[1].length):t+e,Ba(/\bgl_\w+\b/g,t,(function(t){void 0===i[t]&&(e=e.replace(new RegExp("\\b"+t+"\\b","g"),"_"+t),i[t]=!0)})),e},i={};function r(t,e){var n=Da.createShader(t);if(Da.shaderSource(n,e),Da.compileShader(n),!Da.getShaderParameter(n,Da.COMPILE_STATUS))throw new Error("Shader: compile error.\n"+Da.getShaderInfoLog(n)+"\nSource:\n"+e);return n}if(Da=Fa.getWebGLContext(),t=n("      attribute vec4 gl_Vertex;      attribute vec4 gl_TexCoord;      attribute vec3 gl_Normal;      attribute vec4 gl_Color;      ",t),e=n("      precision highp float;      ",e),this.program=Da.createProgram(),Da.attachShader(this.program,r(Da.VERTEX_SHADER,t)),Da.attachShader(this.program,r(Da.FRAGMENT_SHADER,e)),Da.linkProgram(this.program),!Da.getProgramParameter(this.program,Da.LINK_STATUS))throw new Error("Shader: link error.\n"+Da.getProgramInfoLog(this.program)+"\nSource:\n"+t+"\n\n"+e);this.attributes={},this.uniformLocations={},Ba(/uniform\s+sampler(1D|2D|3D|Cube)\s+(\w+)\s*;/g,t+e,(function(t){i[t[2]]=1})),this.isSampler=i}).prototype.uniforms=function(t){var e,n,i,r,o;for(e in Da.useProgram(this.program),t)if(t.hasOwnProperty(e)){if(void 0===this.uniformLocations[e]&&(this.uniformLocations[e]=Da.getUniformLocation(this.program,e)),null===(n=this.uniformLocations[e])){$n.a.warn("Shader: name "+e+" does not correspond to an active uniform variable.");continue}if(i=t[e],r=i,o=void 0,"[object Array]"===(o=Object.prototype.toString.call(r))||"[object Float32Array]"===o)switch(i.length){case 1:Da.uniform1fv(n,new Float32Array(i));break;case 2:Da.uniform2fv(n,new Float32Array(i));break;case 3:Da.uniform3fv(n,new Float32Array(i));break;case 4:Da.uniform4fv(n,new Float32Array(i));break;case 9:Da.uniformMatrix3fv(n,!1,new Float32Array([i[0],i[3],i[6],i[1],i[4],i[7],i[2],i[5],i[8]]));break;case 16:Da.uniformMatrix4fv(n,!1,new Float32Array([i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14],i[3],i[7],i[11],i[15]]));break;default:throw new Error("Shader: don't know how to load uniform \""+e+'" of length '+i.length)}else{if(!za(i))throw new Error('Shader: attempted to set uniform "'+e+'" to invalid value '+i);(this.isSampler[e]?Da.uniform1i:Da.uniform1f).call(Da,n,i)}}return this},Oa.prototype.draw=function(t,e){Da.useProgram(this.program),this.drawBuffers(t.vertexBuffers,t.indexBuffers[e===Da.LINES?"lines":"triangles"],arguments.length<2?Da.TRIANGLES:e)},Oa.prototype.drawBuffers=function(t,e,n){var i,r,o,a=0;for(i in t)if(t.hasOwnProperty(i)){if(r=t[i],void 0===this.attributes[i]&&(this.attributes[i]=Da.getAttribLocation(this.program,i.replace(/^gl_/,"_gl_"))),-1===(o=this.attributes[i])||!r.buffer)continue;Da.bindBuffer(Da.ARRAY_BUFFER,r.buffer),Da.enableVertexAttribArray(o),Da.vertexAttribPointer(o,r.buffer.spacing,Da.FLOAT,!1,0,0),a=r.buffer.length/r.buffer.spacing}for(i in this.attributes)this.attributes.hasOwnProperty(i)&&void 0===t[i]&&Da.disableVertexAttribArray(this.attributes[i]);!a||e&&!e.buffer||(e?(Da.bindBuffer(Da.ELEMENT_ARRAY_BUFFER,e.buffer),Da.drawElements(n,e.buffer.length,Da.UNSIGNED_SHORT,0)):Da.drawArrays(n,0,a))};var ja,Va,Ha=Oa;(Va=function(t,e,n){ja=Fa.getWebGLContext(),n=n||{},this.id=ja.createTexture(),this.width=t,this.height=e,this.format=n.format||ja.RGBA,this.type=n.type||ja.UNSIGNED_BYTE,this.tex_unit=null,this.fbo=null,ja.bindTexture(ja.TEXTURE_2D,this.id),ja.texParameteri(ja.TEXTURE_2D,ja.TEXTURE_MAG_FILTER,n.mag_filter||n.filter||ja.LINEAR),ja.texParameteri(ja.TEXTURE_2D,ja.TEXTURE_MIN_FILTER,n.min_filter||n.filter||ja.LINEAR),ja.texParameteri(ja.TEXTURE_2D,ja.TEXTURE_WRAP_S,n.wrap||n.wrap_s||ja.CLAMP_TO_EDGE),ja.texParameteri(ja.TEXTURE_2D,ja.TEXTURE_WRAP_T,n.wrap||n.wrap_t||ja.CLAMP_TO_EDGE),ja.texImage2D(ja.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null)}).prototype.setAsRenderTarget=function(){null===this.fbo?(this.fbo=ja.createFramebuffer(),ja.bindFramebuffer(ja.FRAMEBUFFER,this.fbo),ja.framebufferTexture2D(ja.FRAMEBUFFER,ja.COLOR_ATTACHMENT0,ja.TEXTURE_2D,this.id,0),ja.viewport(0,0,this.width,this.height)):(ja.bindFramebuffer(ja.FRAMEBUFFER,this.fbo),ja.viewport(0,0,this.width,this.height))},Va.prototype.bind=function(t){this.tex_unit=t||0,ja.activeTexture(ja.TEXTURE0+this.tex_unit),ja.bindTexture(ja.TEXTURE_2D,this.id)},Va.prototype.unbind=function(t){null!==this.tex_unit&&(ja.activeTexture(ja.TEXTURE0+this.tex_unit),ja.bindTexture(ja.TEXTURE_2D,null),this.tex_unit=null)},Va.prototype.drawTo=function(t){if(null===this.fbo)throw new Error("Texture: call setupAsRenderTarget() method first.");ja.bindFramebuffer(ja.FRAMEBUFFER,this.fbo),ja.viewport(0,0,this.width,this.height),t(),ja.bindFramebuffer(ja.FRAMEBUFFER,null)},Va.prototype.swapWith=function(t){var e;e=t.id,t.id=this.id,this.id=e,e=t.tex_unit,t.tex_unit=this.tex_unit,this.tex_unit=e,e=t.fbo,t.fbo=this.fbo,this.fbo=e};var Wa,Ua,$a,Ga=Va;(Ua=function(t,e){Wa=Fa.getWebGLContext(),this.buffer=null,this.target=t,this.type=e,this.data=[]}).prototype.compile=function(t){var e,n,i=[];for(e=0,1e4;e<this.data.length;e+=1e4)i=Array.prototype.concat.apply(i,this.data.slice(e,e+1e4));if((n=this.data.length?i.length/this.data.length:0)!==Math.round(n))throw new Error("Mesh: buffer elements not of consistent size, average size is "+n);this.buffer=this.buffer||Wa.createBuffer(),this.buffer.length=i.length,this.buffer.spacing=n,Wa.bindBuffer(this.target,this.buffer),Wa.bufferData(this.target,new this.type(i),t||Wa.STATIC_DRAW)},($a=function(t){Wa=Fa.getWebGLContext(),t=t||{},this.vertexBuffers={},this.indexBuffers={},this.addVertexBuffer("vertices","gl_Vertex"),t.coords&&this.addVertexBuffer("coords","gl_TexCoord"),t.normals&&this.addVertexBuffer("normals","gl_Normal"),t.colors&&this.addVertexBuffer("colors","gl_Color"),(void 0===t.lines||t.triangles)&&this.addIndexBuffer("triangles"),t.lines&&this.addIndexBuffer("lines")}).prototype.addVertexBuffer=function(t,e){(this.vertexBuffers[e]=new Ua(Wa.ARRAY_BUFFER,Float32Array)).name=t,this[t]=[]},$a.prototype.addIndexBuffer=function(t){this.indexBuffers[t]=new Ua(Wa.ELEMENT_ARRAY_BUFFER,Uint16Array);this[t]=[]},$a.prototype.compile=function(){var t,e,n;for(t in this.vertexBuffers)this.vertexBuffers.hasOwnProperty(t)&&((n=this.vertexBuffers[t]).data=this[n.name],n.compile());for(e in this.indexBuffers)this.indexBuffers.hasOwnProperty(e)&&((n=this.indexBuffers[e]).data=this[e],n.compile())},$a.plane=function(t){var e,n,i,r,o,a,s,l;for(e=new $a(t=t||{}),n=t.detailX||t.detail||1,i=t.detailY||t.detail||1,o=0;o<=i;o+=1)for(a=o/i,r=0;r<=n;r+=1)s=r/n,e.vertices.push([2*s-1,2*a-1,0]),e.coords&&e.coords.push([s,a]),e.normals&&e.normals.push([0,0,1]),r<n&&o<i&&(l=r+o*(n+1),e.triangles.push([l,l+1,l+n+1]),e.triangles.push([l+n+1,l+1,l+n+2]));return e.compile(),e};var qa,Ya,Xa,Qa,Ka,Ja,Za,ts,es,ns=$a,is=!1,rs=!1,os="    varying vec2 coord;    void main() {      coord = gl_Vertex.xy * 0.5 + 0.5;      gl_Position = vec4(gl_Vertex.xyz, 1.0);    }",as="GPGPU: call init(grid_width, grid_height) with proper dimensions first!",ss={WebGLContext:{required:!0,available:!1},OES_texture_float:{required:!0,available:!1},"FLOAT texture as render target":{required:!0,available:!1},OES_texture_float_linear:{required:!1,available:!1}},ls=function(){if(!(qa=Fa.getWebGLContext()))throw ss.WebGLContext.available=!1,new Error("GPGPU: WebGL is not supported!");if(ss.WebGLContext.available=!0,!qa.getExtension("OES_texture_float"))throw ss.OES_texture_float.available=!1,new Error("GPGPU: OES_texture_float is not supported!");if(ss.OES_texture_float.available=!0,qa.getExtension("OES_texture_float_linear")?ss.OES_texture_float_linear.available=!0:(ss.OES_texture_float_linear.available=!1,console.warn("GPGPU: OES_texture_float_linear is not supported. Renering quality will be affected.")),(Qa=new Ga(1,1,{type:qa.FLOAT,format:qa.RGBA,filter:ss.OES_texture_float_linear.available?qa.LINEAR:qa.NEAREST})).setAsRenderTarget(),qa.checkFramebufferStatus(qa.FRAMEBUFFER)!==qa.FRAMEBUFFER_COMPLETE)throw qa.bindFramebuffer(qa.FRAMEBUFFER,null),ss["FLOAT texture as render target"].available=!1,new Error("GPGPU: FLOAT texture as render target is not supported!");ss["FLOAT texture as render target"].available=!0,qa.bindFramebuffer(qa.FRAMEBUFFER,null),qa.disable(qa.DEPTH_TEST),Za=ns.plane(),ts=new Ha(os,"    uniform sampler2D texture;    uniform float channel;    varying vec2 coord;    float shift_right(float v, float amt) {      v = floor(v) + 0.5;      return floor(v / exp2(amt));    }    float shift_left(float v, float amt) {      return floor(v * exp2(amt) + 0.5);    }        float mask_last(float v, float bits) {      return mod(v, shift_left(1.0, bits));    }    float extract_bits(float num, float from, float to) {      from = floor(from + 0.5);      to = floor(to + 0.5);      return mask_last(shift_right(num, from), to - from);    }    vec4 encode_float(float val) {      if (val == 0.0)        return vec4(0, 0, 0, 0);      float sign = val > 0.0 ? 0.0 : 1.0;      val = abs(val);      float exponent = floor(log2(val));      float biased_exponent = exponent + 127.0;      float fraction = ((val / exp2(exponent)) - 1.0) * 8388608.0;            float t = biased_exponent / 2.0;      float last_bit_of_biased_exponent = fract(t) * 2.0;      float remaining_bits_of_biased_exponent = floor(t);            float byte4 = extract_bits(fraction, 0.0, 8.0) / 255.0;      float byte3 = extract_bits(fraction, 8.0, 16.0) / 255.0;      float byte2 = (last_bit_of_biased_exponent * 128.0 + extract_bits(fraction, 16.0, 23.0)) / 255.0;      float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;      return vec4(byte4, byte3, byte2, byte1);    }    void main() {      vec4 data = texture2D(texture, coord);      if (channel == 0.0)        gl_FragColor = encode_float(data.r);      else if (channel == 1.0)        gl_FragColor = encode_float(data.g);      else if (channel == 2.0)        gl_FragColor = encode_float(data.b);      else        gl_FragColor = encode_float(data.a);    }"),es=new Ha(os,"    uniform sampler2D texture;    varying vec2 coord;    void main() {      gl_FragColor = texture2D(texture, coord);    }"),rs=!0},us={init:function(t,e){var n;rs||ls(),Ya=t,Xa=e,n=ss.OES_texture_float_linear.available?qa.LINEAR:qa.NEAREST,Qa=new Ga(Ya,Xa,{type:qa.FLOAT,format:qa.RGBA,filter:n}),Ka=new Ga(Ya,Xa,{type:qa.UNSIGNED_BYTE,format:qa.RGBA,filter:n}),Ja=new Float32Array(Ya*Xa*4)},get featuresInfo(){if(!rs)try{ls()}catch(t){}return ss},getWebGLContext:function(){return void 0===qa&&ls(),qa},createTexture:function(){return Ya&&Xa?new Ga(Ya,Xa,{type:qa.FLOAT,format:qa.RGBA,filter:ss.OES_texture_float_linear.available?qa.LINEAR:qa.NEAREST}):new Error(as)},convertToRGBA:function(t,e,n){var i,r,o,a;if(t.length!==Ya*Xa)throw new Error("GPGPU: Invalid input data length.");for(i=void 0===n?new Float32Array(4*t.length):n,void 0===e&&(e=0),r=0,o=t.length;r<o;r+=1)i[a=4*r]=i[a+1]=i[a+2]=i[a+3]=0,i[a+e]=t[r];return i},writeTexture:function(t,e){var n=this.convertToRGBA(e,0,Ja);qa.bindTexture(qa.TEXTURE_2D,t.id),qa.texImage2D(qa.TEXTURE_2D,0,t.format,t.width,t.height,0,t.format,t.type,n)},writeRGBATexture:function(t,e,n,i,r){!function(t,e,n,i,r){var o,a,s;if(t.length!==e.length||t.length!==n.length||t.length!==i.length||r.length!==4*t.length)throw new Error("GPGPU: Invalid input data length.");for(o=0,s=t.length;o<s;o+=1)r[a=4*o]=t[o],r[a+1]=e[o],r[a+2]=n[o],r[a+3]=i[o]}(e,n,i,r,Ja),qa.bindTexture(qa.TEXTURE_2D,t.id),qa.texImage2D(qa.TEXTURE_2D,0,t.format,t.width,t.height,0,t.format,t.type,Ja)},readTexture:function(t,e,n){var i;if(!qa||t.width!==Ya||t.height!==Xa)return new Error(as);void 0===n&&(n=0),i=new Uint8Array(e.buffer),t.bind(),Ka.setAsRenderTarget(),ts.uniforms({channel:n}),ts.draw(Za),qa.readPixels(0,0,Ka.width,Ka.height,Ka.format,Ka.type,i)},copyTexture:function(t,e){t.bind(),e.setAsRenderTarget(),es.draw(Za)},executeProgram:function(t,e,n){var i,r;for(i=0,r=e.length;i<r;i+=1)e[i].bind(i);for(Qa.setAsRenderTarget(),t.draw(Za),i=0,r=e.length;i<r;i+=1)e[i].unbind(i);n.swapWith(Qa)},setSynchronizationAllowed:function(t){is=t},tryFinish:function(){is&&qa.finish()}},cs="varying vec2 coord;\n\nvoid main() {\n  coord = gl_Vertex.xy * 0.5 + 0.5;\n  gl_Position = vec4(gl_Vertex.xy, 0.0, 1.0);\n}\n",hs=function(t){var e,n=new Ha(cs,'// texture 0:\n// - R: t\n// - G: t0\n// - B: tb\n// - A: conductivity\nuniform sampler2D data0_tex;\n// texture 1:\n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n\nuniform vec2 grid;\nuniform float hx;\nuniform float hy;\nuniform float inv_timeStep;\n\n// Boundary conditions uniforms\nuniform float enforce_temp;\nuniform float vN;\nuniform float vS;\nuniform float vW;\nuniform float vE;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data0 = texture2D(data0_tex, coord);\n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y) {\n    vec2 dx = vec2(grid.x, 0.0);\n    vec2 dy = vec2(0.0, grid.y);\n    float tb = data0.b;\n    // Check if tb is NaN. isnan() function is not available\n    // in OpenGL ES GLSL, so use some tricks. IEEE 754 spec defines\n    // that NaN != NaN, however this seems to not work on Windows.\n    // So, also check if the value is outside [-3.4e38, 3.4e38] (3.4e38\n    // is close to 32Float max value), as such values are not expected.\n    if (tb != tb || tb < -3.4e38 || tb > 3.4e38) {\n      vec4 data1 = texture2D(data1_tex, coord);\n      vec4 data0_m_dy = texture2D(data0_tex, coord - dy);\n      vec4 data0_p_dy = texture2D(data0_tex, coord + dy);\n      vec4 data0_m_dx = texture2D(data0_tex, coord - dx);\n      vec4 data0_p_dx = texture2D(data0_tex, coord + dx);\n      float sij = data1.g * data1.b * inv_timeStep;\n      float rij = data0.a;\n      float axij = hx * (rij + data0_m_dy.a);\n      float bxij = hx * (rij + data0_p_dy.a);\n      float ayij = hy * (rij + data0_m_dx.a);\n      float byij = hy * (rij + data0_p_dx.a);\n      data0.r = (data0.g * sij + data1.r\n                 + axij * data0_m_dy.r\n                 + bxij * data0_p_dy.r\n                 + ayij * data0_m_dx.r\n                 + byij * data0_p_dx.r)\n                 / (sij + axij + bxij + ayij + byij);\n    } else {\n      data0.r = tb;\n    }\n  } else if (enforce_temp == 1.0) {\n    // "temperature at border" boundary conditions are\n    // integrated into this shader.\n    if (coord.x < grid.x) {\n      data0.r = vN;\n    } else if (coord.x > 1.0 - grid.x) {\n      data0.r = vS;\n    } else if (coord.y < grid.y) {\n      data0.r = vW;\n    } else if (coord.y > 1.0 - grid.y) {\n      data0.r = vE;\n    }\n  }\n  gl_FragColor = data0;\n}\n'),i=new Ha(cs,"// texture 0: \n// - R: t\n// - G: t0\n// - B: tb\n// - A: conductivity\nuniform sampler2D data0_tex;\n\nuniform vec2 grid;\nuniform float vN;\nuniform float vS;\nuniform float vW;\nuniform float vE;\nuniform float delta_x;\nuniform float delta_y;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data0 = texture2D(data0_tex, coord);\n  vec2 dx = vec2(grid.x, 0.0);\n  vec2 dy = vec2(0.0, grid.y);\n  if (coord.x < grid.x) {\n    data0.r = texture2D(data0_tex, coord + dx).r\n            + vN * delta_y / data0.a;\n  } else if (coord.x > 1.0 - grid.x) {\n    data0.r = texture2D(data0_tex, coord - dx).r\n            - vS * delta_y / data0.a;\n  } else if (coord.y < grid.y) {\n    data0.r = texture2D(data0_tex, coord + dy).r\n            - vW * delta_x / data0.a;\n  } else if (coord.y > 1.0 - grid.y) {\n    data0.r = texture2D(data0_tex, coord - dy).r\n            + vE * delta_x / data0.a;\n  }\n  gl_FragColor = data0;\n}\n"),r=new Ha(cs,force_flux_t0_fs),o=new Ha(cs,"// texture 0: \n// - R: t\n// - G: t0\n// - B: tb\n// - A: conductivity\nuniform sampler2D data0_tex;\n\nvarying vec2 coord;\n\nvoid main() {\n\tvec4 data0 = texture2D(data0_tex, coord);\n\tdata0.g = data0.r;\n\tgl_FragColor = data0;\n}\n"),a=new Ha(cs,'// texture 0: \n// - R: t\n// - G: t0\n// - B: tb\n// - A: conductivity\nuniform sampler2D data0_tex;\n// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\nuniform float tx;\nuniform float ty;\n\n// Boundary conditions uniforms.\nuniform float enforce_temp;\nuniform float vN;\nuniform float vS;\nuniform float vW;\nuniform float vE;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data0 = texture2D(data0_tex, coord);\n  \n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y) {\n    \n    float fluidity = texture2D(data1_tex, coord).a;\n    if (fluidity == 1.0) {\n      vec2 dx = vec2(grid.x, 0.0);\n      vec2 dy = vec2(0.0, grid.y);\n\n      // Temperature.\n      float t_m_dy = texture2D(data0_tex, coord - dy).r;\n      float t_p_dy = texture2D(data0_tex, coord + dy).r;\n      float t_m_dx = texture2D(data0_tex, coord - dx).r;\n      float t_p_dx = texture2D(data0_tex, coord + dx).r;\n      // Velocity.\n      float u_m_dy = texture2D(data2_tex, coord - dy).r;\n      float u_p_dy = texture2D(data2_tex, coord + dy).r;\n      float v_m_dx = texture2D(data2_tex, coord - dx).g;\n      float v_p_dx = texture2D(data2_tex, coord + dx).g;\n      // Update T0.\n      data0.g = data0.r - tx * (u_p_dy * t_p_dy - u_m_dy * t_m_dy)\n                        - ty * (v_p_dx * t_p_dx - v_m_dx * t_m_dx);\n    }\n  } else if (enforce_temp == 1.0) {\n    // "temperature at border" boundary conditions are\n    // integrated into this shader.\n    if (coord.x < grid.x) {\n      data0.g = vN;\n    } else if (coord.x > 1.0 - grid.x) {\n      data0.g = vS;\n    } else if (coord.y < grid.y) {\n      data0.g = vW;\n    } else if (coord.y > 1.0 - grid.y) {\n      data0.g = vE;\n    }\n  }\n  gl_FragColor = data0;\n}\n'),s=new Ha(cs,'// texture 0: \n// - R: t\n// - G: t0\n// - B: tb\n// - A: conductivity\nuniform sampler2D data0_tex;\n// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\nuniform float tx;\nuniform float ty;\n\n// Boundary conditions uniforms.\nuniform float enforce_temp;\nuniform float vN;\nuniform float vS;\nuniform float vW;\nuniform float vE;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data0 = texture2D(data0_tex, coord);\n  \n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y) {\n    \n    float fluidity = texture2D(data1_tex, coord).a;\n    if (fluidity == 1.0) {\n      vec2 dx = vec2(grid.x, 0.0);\n      vec2 dy = vec2(0.0, grid.y);\n\n      // Temperature t0.\n      float t0_m_dy = texture2D(data0_tex, coord - dy).g;\n      float t0_p_dy = texture2D(data0_tex, coord + dy).g;\n      float t0_m_dx = texture2D(data0_tex, coord - dx).g;\n      float t0_p_dx = texture2D(data0_tex, coord + dx).g;\n      // Velocity.\n      float u = texture2D(data2_tex, coord).r;\n      float v = texture2D(data2_tex, coord).g;\n      // Update T.\n      data0.r = 0.5 * (data0.r + data0.g)\n              - 0.5 * tx * u * (t0_p_dy - t0_m_dy)\n              - 0.5 * ty * v * (t0_p_dx - t0_m_dx);\n    }\n  } else if (enforce_temp == 1.0) {\n    // "temperature at border" boundary conditions are\n    // integrated into this shader.\n    if (coord.x < grid.x) {\n      data0.r = vN;\n    } else if (coord.x > 1.0 - grid.x) {\n      data0.r = vS;\n    } else if (coord.y < grid.y) {\n      data0.r = vW;\n    } else if (coord.y > 1.0 - grid.y) {\n      data0.r = vE;\n    }\n  }\n  gl_FragColor = data0;\n}\n'),l=t.getModelOptions(),u=l.grid_width,c=l.grid_height,h=l.timeStep,d=l.boundary,p=l.model_width/l.grid_width,f=l.model_height/l.grid_height,m=t.getSimulationTexture(0),g=t.getSimulationTexture(1),v=t.getSimulationTexture(2),y=[m,g,v],b=[m,g],_=[m],x=[1/c,1/u],w={solve:function(t){var e;for(us.executeProgram(o,_,m),e=0;e<10;e+=1)us.executeProgram(n,b,m),"flux"===d.type&&us.executeProgram(i,_,m);t&&(us.executeProgram(a,y,m),"flux"===d.type&&us.executeProgram(r,_,m),us.executeProgram(s,y,m),"flux"===d.type&&us.executeProgram(i,_,m))}};return e={data0_tex:0,data1_tex:1,grid:x,enforce_temp:0,hx:.5/(p*p),hy:.5/(f*f),inv_timeStep:1/h},n.uniforms(e),e={data0_tex:0,data1_tex:1,data2_tex:2,grid:x,enforce_temp:0,tx:.5*h/p,ty:.5*h/f},a.uniforms(e),s.uniforms(e),"temperature"===d.type?(e={enforce_temp:1,vN:d.upper,vS:d.lower,vW:d.left,vE:d.right},n.uniforms(e),a.uniforms(e),s.uniforms(e)):"flux"===d.type&&(e={data0_tex:0,grid:x,vN:d.upper,vS:d.lower,vW:d.left,vE:d.right,delta_x:p,delta_y:f},i.uniforms(e),r.uniforms(e)),w},ds=function(t){var e=t.getModelOptions(),n=e.grid_width,i=e.grid_height,r=t.getTemperatureArray(),o=t.getFluidityArray(),a=t.getUWindArray(),l=t.getVWindArray(),u=t.getArrayType(),c=s.a.create(n*i,0,u),h=s.a.create(n*i,0,u),d=n-1,p=i-1,f=n-2,m=i-2,g=e.model_width/e.grid_width,v=e.model_height/e.grid_height,y=.5/g,b=.5/v,_=1/(g*g),x=1/(v*v),w=function(t,e){var i,r,o,a,s,l,u,c=1===t,h=2===t,g=d*n,v=f*n;for(i=1;i<d;i+=1)a=(o=i*n)+1,s=o+p,l=o+m,e[o]=h?-e[a]:e[a],e[s]=h?-e[l]:e[l];for(r=1;r<p;r+=1)u=n+r,e[r]=c?-e[u]:e[u],e[g+r]=c?-e[v+r]:e[v+r];e[0]=.5*(e[n]+e[1]),e[g]=.5*(e[v]+e[g+1]),e[p]=.5*(e[n+p]+e[m]),e[g+p]=.5*(e[v+p]+e[g+m])},C=function(t,e){var i,r,s,u,c,h,f,m,g,v,y=0;for(s=1;s<d;s+=1)for(c=s*n,u=1;u<p;u+=1)m=(h=c+u)-n,f=h+n,v=h-1,g=h+1,o[h]||(i=a[h],r=l[h],y=0,o[m]?(y+=1,t[h]=i-t[m],e[h]=r+e[m]):o[f]&&(y+=1,t[h]=i-t[f],e[h]=r+e[f]),o[v]?(y+=1,t[h]=i+t[v],e[h]=r-e[v]):o[g]&&(y+=1,t[h]=i+t[g],e[h]=r-e[g]),0===y&&(t[h]=i,e[h]=r))},T=function(t){var e,i,r,a,s,l,u,c;for(e=1;e<d;e+=1)for(r=e*n,i=1;i<p;i+=1)o[a=r+i]||(s=a+n,c=a-1,u=a+1,o[l=a-n]?t[a]=t[l]:o[s]&&(t[a]=t[s]),o[c]?t[a]=t[c]:o[u]&&(t[a]=t[u]))},S=function(t,e){var a,s=0,l=i,u=0;for(a=e-1;a>0;a-=1)if(!o[t*n+a]){s=a;break}for(a=e+1;a<i;a+=1)if(!o[t*n+a]){l=a;break}for(a=s;a<l;a+=1)u+=r[t*n+a];return u/(l-s)},k=function(t,e,i,r){var a,s,l,u,c,h,f,m,g,v=.5/(_+x);for(s=1;s<d;s+=1)for(u=s*n,l=1;l<p;l+=1)o[c=u+l]&&(f=c-n,h=c+n,g=c-1,m=c+1,r[c]=(t[h]-t[f])*y+(e[m]-e[g])*b,i[c]=0);for(w(0,r),w(0,i),T(r),T(i),a=0;a<5;a+=1)for(s=1;s<d;s+=1)for(u=s*n,l=1;l<p;l+=1)o[c=u+l]&&(f=c-n,h=c+n,g=c-1,m=c+1,i[c]=v*((i[f]+i[h])*_+(i[g]+i[m])*x-r[c]));for(s=1;s<d;s+=1)for(u=s*n,l=1;l<p;l+=1)o[c=u+l]&&(f=c-n,h=c+n,g=c-1,m=c+1,t[c]-=(i[h]-i[f])*y,e[c]-=(i[m]-i[g])*b);w(1,t),w(2,e)},A=function(t,i,r){var a,l,u,c,h,f,m,g,v,y=e.timeStep,b=e.background_viscosity,C=y*b*_,T=y*b*x,S=1/(1+2*(C+T));for(s.a.copy(r,i),a=0;a<5;a+=1){for(l=1;l<d;l+=1)for(c=l*n,u=1;u<p;u+=1)o[h=c+u]&&(m=h-n,f=h+n,v=h-1,g=h+1,r[h]=(i[h]+C*(r[m]+r[f])+T*(r[v]+r[g]))*S);w(t,r)}},E=function(t,i,r){!function(t,i,r){var a,l,u,f,m,y,b,_,x=e.timeStep,C=.5*x/g,T=.5*x/v;for(a=1;a<d;a+=1)for(u=a*n,l=1;l<p;l+=1)o[f=u+l]&&(y=f-n,m=f+n,_=f-1,b=f+1,r[f]=i[f]-C*(c[m]*i[m]-c[y]*i[y])-T*(h[b]*i[b]-h[_]*i[_]));for(w(t,r),a=1;a<d;a+=1)for(u=a*n,l=1;l<p;l+=1)o[f=u+l]&&(y=f-n,m=f+n,_=f-1,b=f+1,i[f]=.5*(i[f]+r[f])-.5*C*c[f]*(r[m]-r[y])-.5*T*h[f]*(r[b]-r[_]));s.a.copy(i,r),w(t,r)}(t,i,r)};return{solve:function(t,i){0!==e.thermal_buoyancy&&function(t){var i,a,s,l,u,c=0*e.timeStep,h=e.thermal_buoyancy*e.timeStep;switch(e.buoyancy_approximation){case 0:for(i=function(t){var e,n=0,i=t.length;for(e=0;e<i;e+=1)n+=t[e];return n/i}(r),a=1;a<d;a+=1)for(l=a*n,s=1;s<p;s+=1)o[u=l+s]&&(t[u]+=(c-h)*r[u]+h*i);break;case 1:for(a=1;a<d;a+=1)for(l=a*n,s=1;s<p;s+=1)o[u=l+s]&&(i=S(a,s),t[u]+=(c-h)*r[u]+h*i)}}(i),C(t,i),e.background_viscosity>0&&(A(1,c,t),A(2,h,i),k(t,i,c,h),C(t,i)),s.a.copy(t,c),s.a.copy(i,h),E(1,c,t),E(2,h,i),k(t,i,c,h),C(t,i)}}},ps="varying vec2 coord;\n\nvoid main() {\n  coord = gl_Vertex.xy * 0.5 + 0.5;\n  gl_Position = vec4(gl_Vertex.xy, 0.0, 1.0);\n}\n",fs=function(t){var e,n=new Ha(ps,"// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\nuniform float tx;\nuniform float ty;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  float fluidity = texture2D(data1_tex, coord).a;\n  \n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y &&\n      fluidity == 1.0) {\n    \n    vec2 dx = vec2(grid.x, 0.0);\n    vec2 dy = vec2(0.0, grid.y);\n    \n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    // Update velocity UV components.\n    data2.rg = data2.ba - tx * (data2_p_dy.bb * data2_p_dy.ba - data2_m_dy.bb * data2_m_dy.ba)\n              - ty * (data2_p_dx.aa * data2_p_dx.ba - data2_m_dx.aa * data2_m_dx.ba);\n  }\n\n  gl_FragColor = data2;\n}\n"),i=new Ha(ps,"// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\nuniform float tx;\nuniform float ty;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  float fluidity = texture2D(data1_tex, coord).a;\n  \n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y &&\n      fluidity == 1.0) {\n    \n    vec2 dx = vec2(grid.x, 0.0);\n    vec2 dy = vec2(0.0, grid.y);\n    \n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    // Update velocity UV components.\n    data2.rg = 0.5 * (data2.ba + data2.rg) \n            - 0.5 * tx * data2.bb * (data2_p_dy.rg - data2_m_dy.rg)\n            - 0.5 * ty * data2.aa * (data2_p_dx.rg - data2_m_dx.rg);\n  }\n\n  gl_FragColor = data2;\n}\n"),r=new Ha(ps,"// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  vec2 dx = vec2(grid.x, 0.0);\n  vec2 dy = vec2(0.0, grid.y);\n  // Process corners.\n  // TODO: values from previous step are used for corners.\n  if (coord.x < grid.x && coord.y < grid.y) {  \n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    data2.rg = 0.5 * (data2_p_dy.rg + data2_p_dx.rg);\n  }\n  else if (coord.x > 1.0 - grid.x && coord.y < grid.y) {  \n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    data2.rg = 0.5 * (data2_p_dy.rg + data2_m_dx.rg);\n  }\n  else if (coord.x > 1.0 - grid.x && coord.y > 1.0 - grid.y) {  \n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    data2.rg = 0.5 * (data2_m_dy.rg + data2_m_dx.rg);\n  }\n  else if (coord.x < grid.x && coord.y > 1.0 - grid.y) {  \n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    data2.rg = 0.5 * (data2_m_dy.rg + data2_p_dx.rg);\n  }\n  // Process boundaries.\n  // Left.\n  else if (coord.x < grid.x) {\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    data2.rg = vec2(data2_p_dx.r, -data2_p_dx.g);\n  }\n  // Right.\n  else if (coord.x > 1.0 - grid.x) {\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    data2.rg = vec2(data2_m_dx.r, -data2_m_dx.g);\n  }\n  // Down.\n  else if (coord.y < grid.y) {\n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    data2.rg = vec2(-data2_p_dy.r, data2_p_dy.g);\n  }\n  // Up.\n  else if (coord.y > 1.0 - grid.y) {\n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    data2.rg = vec2(-data2_m_dy.r, data2_m_dy.g);\n  }\n  \n  gl_FragColor = data2;\n}\n"),o=new Ha(ps,"// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  vec2 dx = vec2(grid.x, 0.0);\n  vec2 dy = vec2(0.0, grid.y);\n  // Process corners.\n  // TODO: values from previous step are used for corners.\n  if (coord.x < grid.x && coord.y < grid.y) {  \n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    data2.ba = 0.5 * (data2_p_dy.ba + data2_p_dx.ba);\n  }\n  else if (coord.x > 1.0 - grid.x && coord.y < grid.y) {  \n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    data2.ba = 0.5 * (data2_p_dy.ba + data2_m_dx.ba);\n  }\n  else if (coord.x > 1.0 - grid.x && coord.y > 1.0 - grid.y) {  \n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    data2.ba = 0.5 * (data2_m_dy.ba + data2_m_dx.ba);\n  }\n  else if (coord.x < grid.x && coord.y > 1.0 - grid.y) {  \n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    data2.ba = 0.5 * (data2_m_dy.ba + data2_p_dx.ba);\n  }\n  // Process boundaries.\n  // Left.\n  else if (coord.x < grid.x) {\n    data2.ba = texture2D(data2_tex, coord + dx).ba;\n  }\n  // Right.\n  else if (coord.x > 1.0 - grid.x) {\n    data2.ba = texture2D(data2_tex, coord - dx).ba;\n  }\n  // Down.\n  else if (coord.y < grid.y) {\n    data2.ba = texture2D(data2_tex, coord + dy).ba;\n  }\n  // Up.\n  else if (coord.y > 1.0 - grid.y) {\n    data2.ba = texture2D(data2_tex, coord - dy).ba;\n  }\n  \n  gl_FragColor = data2;\n}\n"),a=new Ha(ps,"// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  float fluidity = texture2D(data1_tex, coord).a;\n  \n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y &&\n      fluidity == 0.0) {\n    \n    vec2 dx = vec2(grid.x, 0.0);\n    vec2 dy = vec2(0.0, grid.y);\n\n    if (texture2D(data1_tex, coord - dy).a == 1.0) {\n      data2.ba = texture2D(data2_tex, coord - dy).ba;\n    } \n    else if (texture2D(data1_tex, coord + dy).a == 1.0) {\n      data2.ba = texture2D(data2_tex, coord + dy).ba;\n    } \n\n    if (texture2D(data1_tex, coord - dx).a == 1.0) {\n      data2.ba = texture2D(data2_tex, coord - dx).ba;\n    } \n    else if (texture2D(data1_tex, coord + dx).a == 1.0) {\n      data2.ba = texture2D(data2_tex, coord + dx).ba;\n    } \n  }\n\n  gl_FragColor = data2;\n}\n"),s=new Ha(ps,"// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n// texture 3: \n// - R: uWind\n// - G: vWind\n// - B: undefined\n// - A: undefined\nuniform sampler2D data3_tex;\n\nuniform vec2 grid;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  float fluidity = texture2D(data1_tex, coord).a;\n\n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y &&\n      fluidity == 0.0) {\n    \n    vec2 dx = vec2(grid.x, 0.0);\n    vec2 dy = vec2(0.0, grid.y);\n\n    int count = 0;\n\n    if (texture2D(data1_tex, coord - dy).a == 1.0) {\n      count += 1;\n      vec2 data2_m_dy = texture2D(data2_tex, coord - dy).rg;\n      data2.rg = texture2D(data3_tex, coord).rg + vec2(-data2_m_dy.r, data2_m_dy.g);\n    } \n    else if (texture2D(data1_tex, coord + dy).a == 1.0) {\n      count += 1;\n      vec2 data2_p_dy = texture2D(data2_tex, coord + dy).rg;\n      data2.rg = texture2D(data3_tex, coord).rg + vec2(-data2_p_dy.r, data2_p_dy.g);\n    } \n\n    if (texture2D(data1_tex, coord - dx).a == 1.0) {\n      count += 1;\n      vec2 data2_m_dx = texture2D(data2_tex, coord - dx).rg;\n      data2.rg = texture2D(data3_tex, coord).rg + vec2(data2_m_dx.r, -data2_m_dx.g);\n    } \n    else if (texture2D(data1_tex, coord + dx).a == 1.0) {\n      count += 1;\n      vec2 data2_p_dx = texture2D(data2_tex, coord + dx).rg;\n      data2.rg = texture2D(data3_tex, coord).rg + vec2(data2_p_dx.r, -data2_p_dx.g);\n    } \n\n    if (count == 0) {\n      data2.rg = texture2D(data3_tex, coord).rg;\n    }\n  }\n  \n  gl_FragColor = data2;\n}\n"),l=new Ha(ps,"// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nvarying vec2 coord;\n\nvoid main() {\n\tvec4 data2 = texture2D(data2_tex, coord);\n\tdata2.ba = data2.rg;\n\tgl_FragColor = data2;\n}\n"),u=new Ha(ps,"// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\nuniform float i2dx;\nuniform float i2dy;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  float fluidity = texture2D(data1_tex, coord).a;\n  \n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y &&\n      fluidity == 1.0) {\n    \n    vec2 dx = vec2(grid.x, 0.0);\n    vec2 dy = vec2(0.0, grid.y);\n    \n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    \n    // Phi.\n    data2.b = 0.0;\n    // Div.\n    data2.a = (data2_p_dy.r - data2_m_dy.r) * i2dx + (data2_p_dx.g - data2_m_dx.g) * i2dy;\n  }\n\n  gl_FragColor = data2;\n}\n"),c=new Ha(ps,"// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\nuniform float s;\nuniform float idxsq;\nuniform float idysq;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  float fluidity = texture2D(data1_tex, coord).a;\n  \n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y &&\n      fluidity == 1.0) {\n    \n    vec2 dx = vec2(grid.x, 0.0);\n    vec2 dy = vec2(0.0, grid.y);\n    \n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    \n    // Phi.\n    data2.b = s * ((data2_m_dy.b + data2_p_dy.b) * idxsq + (data2_m_dx.b + data2_p_dx.b) * idysq - data2.a);\n  }\n\n  gl_FragColor = data2;\n}\n"),h=new Ha(ps,"// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\nuniform float i2dx;\nuniform float i2dy;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  float fluidity = texture2D(data1_tex, coord).a;\n  \n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y &&\n      fluidity == 1.0) {\n    \n    vec2 dx = vec2(grid.x, 0.0);\n    vec2 dy = vec2(0.0, grid.y);\n    \n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    \n    // U.\n    data2.r -= (data2_p_dy.b - data2_m_dy.b) * i2dx;\n    // V.\n    data2.g -= (data2_p_dx.b - data2_m_dx.b) * i2dy;\n  }\n\n  gl_FragColor = data2;\n}\n"),d=new Ha(ps,"// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\nuniform float hx;\nuniform float hy;\nuniform float dn;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  float fluidity = texture2D(data1_tex, coord).a;\n  \n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y &&\n      fluidity == 1.0) {\n    \n    vec2 dx = vec2(grid.x, 0.0);\n    vec2 dy = vec2(0.0, grid.y);\n    \n    vec4 data2_m_dy = texture2D(data2_tex, coord - dy);\n    vec4 data2_p_dy = texture2D(data2_tex, coord + dy);\n    vec4 data2_m_dx = texture2D(data2_tex, coord - dx);\n    vec4 data2_p_dx = texture2D(data2_tex, coord + dx);\n    // Update velocity UV components.\n    data2.rg = (data2.ba + hx * (data2_m_dy.rg + data2_p_dy.rg)\n                         + hy * (data2_m_dx.rg + data2_p_dx.rg)) * dn;\n  }\n\n  gl_FragColor = data2;\n}\n"),p=new Ha(ps,"// texture 0: \n// - R: t\n// - G: t0\n// - B: tb\n// - A: conductivity\nuniform sampler2D data0_tex;\n// texture 1: \n// - R: q\n// - G: capacity\n// - B: density\n// - A: fluidity\nuniform sampler2D data1_tex;\n// texture 2: \n// - R: u\n// - G: v\n// - B: u0\n// - A: v0\nuniform sampler2D data2_tex;\n\nuniform vec2 grid;\nuniform float g;\nuniform float b;\n\nvarying vec2 coord;\n\nvoid main() {\n  vec4 data2 = texture2D(data2_tex, coord);\n  float fluidity = texture2D(data1_tex, coord).a;\n  \n  if (coord.x > grid.x && coord.x < 1.0 - grid.x &&\n      coord.y > grid.y && coord.y < 1.0 - grid.y &&\n      fluidity == 1.0) {\n    \n    vec2 dx = vec2(grid.x, 0.0);\n    vec2 dy = vec2(0.0, grid.y);\n    \n    float t = texture2D(data0_tex, coord).r;\n    // Get average column temperature.\n\n    float avg_t = t;\n    float count = 1.0;\n    vec2 n_coord = coord - dx;\n    // Silly while(true) loop (almost).\n    // While loops are not allowed.\n    // For loops with non-constant expressions also.\n    for (int i = 1; i != 0; i++) {\n      if (n_coord.x > 0.0 && texture2D(data1_tex, n_coord).a == 1.0) {\n        avg_t += texture2D(data0_tex, n_coord).r;\n        count += 1.0;\n        n_coord -= dx;\n      } else {\n        break;\n      }\n    }\n    n_coord = coord + dx;\n    // Silly while(true) loop (almost).\n    // While loops are not allowed.\n    // For loops with non-constant expressions also.\n    for (int i = 1; i != 0; i++) {\n      if (n_coord.x < 1.0 && texture2D(data1_tex, n_coord).a == 1.0) {\n        avg_t += texture2D(data0_tex, n_coord).r;\n        count += 1.0;\n        n_coord += dx;\n      } else {\n        break;\n      }\n    }\n    avg_t /= count;\n\n    // Update velocity V component.\n    data2.g += (g - b) * t + b * avg_t;\n  }\n\n  gl_FragColor = data2;\n}\n"),f=t.getSimulationTexture(0),m=t.getSimulationTexture(1),g=t.getSimulationTexture(2),v=t.getSimulationTexture(3),y=t.getModelOptions(),b=y.grid_width,_=y.grid_height,x=y.timeStep,w=y.thermal_buoyancy,C=y.background_viscosity,T=y.model_width/y.grid_width,S=y.model_height/y.grid_height,k=.5/T,A=.5/S,E=1/(T*T),M=1/(S*S),P=.5/(E+M),D=x*C*E,O=x*C*M,I=1/(1+2*(D+O)),L=0*x,R=w*x,N=[1/_,1/b],F=[g],B=[m,g],z=[f,m,g],j=[m,g,v],V=function(){var t;for(us.executeProgram(u,B,g),us.executeProgram(o,F,g),us.executeProgram(a,B,g),t=0;t<10;t+=1)us.executeProgram(c,B,g);us.executeProgram(h,B,g),us.executeProgram(r,F,g)},H=function(){us.executeProgram(s,j,g)},W={solve:function(){0!==w&&us.executeProgram(p,z,g),H(),C>0&&(!function(){var t;for(us.executeProgram(l,F,g),t=0;t<10;t+=1)us.executeProgram(d,B,g),us.executeProgram(r,F,g)}(),V(),H()),us.executeProgram(l,F,g),us.executeProgram(n,B,g),us.executeProgram(r,F,g),us.executeProgram(i,B,g),us.executeProgram(r,F,g),V(),H()}};return e={data1_tex:0,data2_tex:1,grid:N,tx:.5*x/T,ty:.5*x/S},n.uniforms(e),i.uniforms(e),e={data2_tex:0,grid:N},r.uniforms(e),o.uniforms(e),e={data1_tex:0,data2_tex:1,grid:N},a.uniforms(e),e={data1_tex:0,data2_tex:1,data3_tex:2,grid:N},s.uniforms(e),e={data1_tex:0,data2_tex:1,grid:N,i2dx:k,i2dy:A},u.uniforms(e),h.uniforms(e),e={data1_tex:0,data2_tex:1,grid:N,s:P,idxsq:E,idysq:M},c.uniforms(e),e={data1_tex:0,data2_tex:1,grid:N,hx:D,hy:O,dn:I},d.uniforms(e),e={data0_tex:0,data1_tex:1,data2_tex:2,grid:N,g:L,b:R},p.uniforms(e),W},ms=function(t,e){var n;return t=Math.abs(t),e=Math.abs(e),n=Math.min(t,e),0===(t=Math.max(t,e))?0:(n/=t,t*Math.sqrt(1+n*n))},gs=function(t,e,n,i,r){var o,a,s=0;for(o=0,a=t-1;o<t;a=o,o+=1)n[o]>r!=n[a]>r&&i<(e[a]-e[o])*(r-n[o])/(n[a]-n[o])+e[o]&&(s=!s);return!!s},vs=function(t,e,n,i){this.x1=t,this.y1=e,this.x2=n,this.y2=i};vs.prototype.intersectsLine=function(t){var e,n,i,r=this.x1,o=this.y1,a=this.x2,s=this.y2,l=t.x1,u=t.y1,c=t.x2,h=t.y2,d=(c-l)*(o-u)-(h-u)*(r-l),p=(a-r)*(o-u)-(s-o)*(r-l),f=(h-u)*(a-r)-(c-l)*(s-o);return 0!==f?(i=p/f,e=0<=(n=d/f)&&n<=1&&0<=i&&i<=1):e=0===d||0===p,e};var ys=function(t,e,n,i,r){this.count=t,this.raw_x_coords=e,this.raw_y_coords=n,this.x_coords=new Array(t),this.y_coords=new Array(t),this.x=i||0,this.y=r||0};Object.defineProperty(ys.prototype,"x",{get:function(){return this._x},set:function(t){var e,n;for(e=0,n=this.count;e<n;e++)this.x_coords[e]=this.raw_x_coords[e]+t;this._x=t}}),Object.defineProperty(ys.prototype,"y",{get:function(){return this._y},set:function(t){var e,n;for(e=0,n=this.count;e<n;e++)this.y_coords[e]=this.raw_y_coords[e]+t;this._y=t}}),ys.prototype.polygonize=function(){return this},ys.prototype.contains=function(t,e){var n,i,r=this.x_coords,o=this.y_coords,a=this.count,s=0;for(n=0,i=a-1;n<a;i=n,n+=1)o[n]>e!=o[i]>e&&t<(r[i]-r[n])*(e-o[n])/(o[i]-o[n])+r[n]&&(s=!s);return!!s};var bs=function(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i,this.polygon_cache=void 0};bs.prototype.polygonize=function(){var t,e,n,i;return this.polygon_cache||(t=this.x,e=this.y,n=this.width,i=this.height,this.polygon_cache=new ys(4,[t,t+n,t+n,t],[e,e,e+i,e+i])),this.polygon_cache},bs.prototype.contains=function(t,e){return t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height};var _s=function(t,e,n,i,r){var o,a,s=new Array(r),l=new Array(r),u=2*Math.PI/r;for(a=0;a<r;a+=1)o=u*a,s[a]=t+n*Math.cos(o),l[a]=e+i*Math.sin(o);return new ys(r,s,l)},xs=function(t,e,n,i){this.x=t,this.y=e,this.a=n,this.b=i,this.polygon_cache=void 0};xs.prototype.POLYGON_SEGMENTS=50,xs.prototype.polygonize=function(){return this.polygon_cache||(this.polygon_cache=_s(this.x,this.y,.5*this.a,.5*this.b,this.POLYGON_SEGMENTS)),this.polygon_cache},xs.prototype.contains=function(t,e){var n=t-this.x,i=e-this.y,r=.5*this.a,o=.5*this.b;return n*n/(r*r)+i*i/(o*o)<=1};var ws=function(t,e,n,i){this.x=t,this.y=e,this.inner=n,this.outer=i,this.polygon_cache=void 0};ws.prototype.POLYGON_SEGMENTS=50,ws.prototype.polygonize=function(){return this.polygon_cache||(this.polygon_cache=_s(this.x,this.y,.5*this.outer,.5*this.outer,this.POLYGON_SEGMENTS)),this.polygon_cache},ws.prototype.contains=function(t,e){var n=t-this.x,i=e-this.y,r=.5*this.outer,o=.5*this.outer,a=.5*this.inner,s=.5*this.inner;return n*n/(r*r)+i*i/(o*o)<=1&&n*n/(a*a)+i*i/(s*s)>=1};var Cs=function(t,e,n,i,r){this.x=t,this.y=e,this.energy=n,this.c=i,void 0!==r&&(this.vx=Math.cos(r)*i,this.vy=Math.sin(r)*i)};Cs.prototype.isContained=function(t,e,n,i){return this.x>=t&&this.x<=e&&this.y>=n&&this.y<=i},Cs.prototype.move=function(t){this.x+=this.vx*t,this.y+=this.vy*t},Cs.prototype.reflectFromLine=function(t,e){var n,i,r,o,a,s=this.x,l=this.y,u=this.x-this.vx*e,c=this.y-this.vy*e,h=new vs(s,l,u,c),d=this.vx,p=this.vy;return!!h.intersectsLine(t)&&(s=t.x1,l=t.y1,u=t.x2,c=t.y2,o=d*(r=(u-s)*(n=1/ms(s-u,l-c)))+p*(i=(c-l)*n),a=p*r-d*i,this.vx=o*r+a*i,this.vy=o*i-a*r,!0)},Cs.prototype.reflectFromRectangle=function(t,e){var n,i,r=t.x,o=t.y,a=t.x+t.width,s=t.y+t.height;n=this.vx*e,this.x-n<r?this.vx=-Math.abs(this.vx):this.x-n>a&&(this.vx=Math.abs(this.vx)),i=this.vy*e,this.y-i<o?this.vy=-Math.abs(this.vy):this.y-i>s&&(this.vy=Math.abs(this.vy))},Cs.prototype.reflectFromPolygon=function(t,e){var n,i,r=new vs;for(n=0,i=t.count-1;n<i;n+=1)if(r.x1=t.x_coords[n],r.y1=t.y_coords[n],r.x2=t.x_coords[n+1],r.y2=t.y_coords[n+1],this.reflectFromLine(r,e))return;r.x1=t.x_coords[t.count-1],r.y1=t.y_coords[t.count-1],r.x2=t.x_coords[0],r.y2=t.y_coords[0],this.reflectFromLine(r,e)},Cs.prototype.reflect=function(t,e){return!!t.contains(this.x,this.y)&&(t instanceof bs?this.reflectFromRectangle(t,e):this.reflectFromPolygon(t.polygonize(),e),!0)};var Ts=function(t){var e=t.getModelOptions(),n=t.getPowerArray(),i=t.getPartsArray(),r=t.getPhotonsArray(),o=e.model_width,a=e.model_height,s=e.grid_width,l=e.grid_height,u=s-1,c=l-1,h=e.model_width/e.grid_width,d=e.model_height/e.grid_height,p=function(){return Math.PI-e.sun_angle},f=function(){for(var t=0;t<r.length;)void 0===r[t]?r.splice(t,1):t+=1},m=function(t,e){var n,r;for(n=0,r=i.length;n<r;n+=1)if(i[n].contains(t,e))return!0;return!1};return{solve:function(){var t,s,p,m,g,v,y,b,_=e.timeStep,x=1/(_*e.photon_emission_interval),w=1/h,C=1/d;for(g=0,y=r.length;g<y;g+=1)for((t=r[g]).move(_),v=0,b=i.length;v<b&&!(s=i[v]).reflect(t,_);v+=1)if(s.absorb(t)){p=Math.max(Math.min(Math.round(t.x*w),u),0),m=Math.max(Math.min(Math.round(t.y*C),c),0),n[p*l+m]=t.energy*x,r[g]=void 0;break}f(),function(){var t,e;for(t=0,e=r.length;t<e;t+=1)r[t].isContained(0,o,0,a)||(r[t]=void 0);f()}()},radiate:function(){var e,n,r;for(n=0,r=i.length;n<r;n+=1)(e=i[n]).emissivity>0&&e.radiate(t)},sunShine:function(){var t,n,i,s=p();s<0||(t=Math.abs(Math.sin(s)),n=Math.abs(Math.cos(s)),i=t*a<n*o?a/n:o/t,function(t,n){var i,s,l,u=p(),c=e.solar_power_density,h=e.solar_ray_speed,d=Math.floor(o/t),f=Math.floor(a/n);if(u>=0&&u<.5*Math.PI){for(s=0,l=1;l<=d;l+=1)m(i=t*l,s)||r.push(new Cs(i,s,c,h,u));for(i=0,l=0;l<=f;l+=1)m(i,s=n*l)||r.push(new Cs(i,s,c,h,u))}else if(u<0&&u>=-.5*Math.PI){for(s=a,l=1;l<=d;l+=1)m(i=t*l,s)||r.push(new Cs(i,s,c,h,u));for(i=0,l=0;l<=f;l+=1)m(i,s=a-n*l)||r.push(new Cs(i,s,c,h,u))}else if(u<Math.PI+.001&&u>=.5*Math.PI){for(s=0,l=0;l<=d;l+=1)m(i=o-t*l,s)||r.push(new Cs(i,s,c,h,u));for(i=o,l=1;l<=f;l+=1)m(i,s=n*l)||r.push(new Cs(i,s,c,h,u))}else if(u>=-Math.PI&&u<-.5*Math.PI){for(s=a,l=0;l<=d;l+=1)m(i=o-t*l,s)||r.push(new Cs(i,s,c,h,u));for(i=o,l=1;l<=f;l+=1)m(i,s=a-n*l)||r.push(new Cs(i,s,c,h,u))}}((i/=e.solar_ray_count)/t,i/n))}}},Ss=Math.sin(Math.PI/6),ks=Math.cos(Math.PI/6),As=Math.sin(Math.PI/3),Es=Math.cos(Math.PI/3),Ms=function(t){var e,n,i;if(this._options=t,"rectangle"===t.shapeType)this.shape=new bs(t.x,t.y,t.width,t.height);else if("ellipse"===t.shapeType)this.shape=new xs(t.x,t.y,t.a,t.b);else if("ring"===t.shapeType)this.shape=new ws(t.x,t.y,t.inner,t.outer);else{if("polygon"!==t.shapeType)throw new Error("Part: shape not defined or not supported.");for(e=t.vertices.split(", "),this.x_coords=[],this.y_coords=[],i=0,n=.5*e.length;i<n;i+=1)this.x_coords[i]=Number(e[2*i]),this.y_coords[i]=Number(e[2*i+1]);this.shape=new ys(n,this.x_coords,this.y_coords,t.x,t.y)}};Object.defineProperty(Ms.prototype,"shapeType",{get:function(){return this._options.shapeType}}),["x","y","width","height","inner","outer","a","b","raw_x_coords","raw_y_coords"].forEach((function(t){Object.defineProperty(Ms.prototype,t,{get:function(){return this.shape[t]},set:function(e){this.shape[t]=e,this.polygon_cache=void 0}})})),Object.defineProperty(Ms.prototype,"vertices",{get:function(){if("polygon"===this.shapeType){var t,e,n=this.shape.raw_x_coords,i=this.shape.raw_y_coords,r=[];for(t=0,e=n.length;t<e;t++)r.push(n[t]),r.push(i[t]);return r.join(", ")}}}),["thermal_conductivity","specific_heat","density","temperature","constant_temperature","power","wind_speed","wind_angle","transmission","reflection","absorption","emissivity","visible","filled","color","texture","label","draggable"].forEach((function(t){Object.defineProperty(Ms.prototype,t,{get:function(){return this._options[t]},set:function(e){this._options[t]=e}})})),Ms.prototype.getLabel=function(){var t,e=this.label;function n(t,e){return(t>=100?t.toFixed():t>=10?t.toFixed(1):t.toFixed(2))+e}return"%temperature"===e?t=n(this.temperature," °C"):"%density"===e?t=n(this.density," kg/m³"):"%specific_heat"===e?t=n(this.specific_heat," J/(kg×°C)"):"%thermal_conductivity"===e?t=n(this.thermal_conductivity," W/(m×°C)"):"%power_density"===e?t=n(this.power," W/m³"):"%area"===e?"rectangle"===this.shapeType?t=n(this.width*this.height," m²"):"ellipse"===this.shapeType&&(t=n(this.a*this.b*.25*Math.PI," m²")):"%width"===e?"rectangle"===this.shapeType?t=n(this.width," m"):"ellipse"===this.shapeType&&(t=n(this.a," m")):"%height"===e?"rectangle"===this.shapeType?t=n(this.height," m"):"ellipse"===this.shapeType&&(t=n(this.b," m")):t=e,t},Ms.prototype.getGridCells=function(t,e,n,i){var r=t-1,o=e-1,a=t/n,s=e/i;if("rectangle"===this.shapeType)return function(t){var n,i,l,u,c,h,d,p=[];for(l=Math.min(Math.max(Math.ceil(t.x*a),0),r),u=Math.min(Math.max(Math.ceil(t.y*s),0),o),c=Math.min(Math.max(Math.floor((t.x+t.width)*a),0),r),h=Math.min(Math.max(Math.floor((t.y+t.height)*s),0),o),p=new Array((c-l+1)*(h-u+1)),d=0,n=l;n<=c;n+=1)for(i=u;i<=h;i+=1)p[d+=1]=n*e+i;return p}(this.shape);if("ellipse"===this.shapeType)return function(t){var n,i,l,u,c,h,d,p,f=t.x*a,m=t.y*s,g=.5*t.a*a,v=.5*t.b*s,y=[];for(l=Math.min(Math.max(Math.ceil(f-g),0),r),u=Math.min(Math.max(Math.floor(f+g),0),r),y=[],p=0,i=l;i<=u;i+=1)for(n=Math.sqrt(1-(i-f)*(i-f)/(g*g)),h=Math.min(Math.max(Math.ceil(m-v*n),0),o),d=Math.min(Math.max(Math.floor(m+v*n),0),o),c=h;c<=d;c+=1)y[p+=1]=i*e+c;return y}(this.shape);if("ring"===this.shapeType)return function(t){var n,i,l,u,c,h,d,p,f,m,g=t.x*a,v=t.y*s,y=.5*t.outer*a,b=.5*t.outer*s,_=.5*t.inner*a,x=.5*t.inner*s,w=[];for(i=Math.min(Math.max(Math.ceil(g-y),0),r),l=Math.min(Math.max(Math.floor(g+y),0),r),n=i;n<=l;n+=1)if(f=Math.sqrt(1-(n-g)*(n-g)/(y*y)),c=Math.min(Math.max(Math.ceil(v-b*f),0),o),p=Math.min(Math.max(Math.floor(v+b*f),0),o),Math.abs(n-g)<_){for(f=Math.sqrt(1-(n-g)*(n-g)/(_*_)),h=Math.min(Math.max(Math.ceil(v-x*f),0),o),d=Math.min(Math.max(Math.floor(v+x*f),0),o),u=c;u<=h;u+=1)w[m+=1]=n*e+u;for(u=d;u<=p;u+=1)w[m+=1]=n*e+u}else for(u=c;u<=p;u+=1)w[m+=1]=n*e+u;return w}(this.shape);if("polygon"===this.shapeType)return function(t){var n,i,l,u,c,h,d,p=t.x_coords.length,f=new Array(p),m=new Array(p),g=Number.MAX_VALUE,v=Number.MIN_VALUE,y=Number.MAX_VALUE,b=Number.MIN_VALUE,_=[];for(n=0;n<p;n+=1)f[n]=t.x_coords[n]*a,m[n]=t.y_coords[n]*s,f[n]<g&&(g=f[n]),f[n]>v&&(v=f[n]),m[n]<y&&(y=m[n]),m[n]>b&&(b=m[n]);for(i=Math.min(Math.max(Math.round(g),0),r),c=Math.min(Math.max(Math.round(y),0),o),l=Math.min(Math.max(Math.round(v),0),r),h=Math.min(Math.max(Math.round(b),0),o),_=[],d=0,n=i;n<=l;n+=1)for(u=c;u<=h;u+=1)gs(p,f,m,n,u)&&(_[d+=1]=n*e+u);return _}(this.shape);throw new Error("Part: unknown shape.")},Ms.prototype.contains=function(t,e){return this.shape.contains(t,e)},Ms.prototype.reflect=function(t,e){return Math.abs(this.reflection-1)<.001&&t.reflect(this.shape,e)},Ms.prototype.absorb=function(t){return Math.abs(this.absorption-1)<.001&&this.shape.contains(t.x,t.y)},Ms.prototype.getIrradiance=function(t){var e;return 0===this.emissivity?0:(e=273+t,e*=e,this.emissivity*La.a.STEFAN_CONSTANT*100*e*e)},Ms.prototype.radiate=function(t){var e,n,i=this.shape.polygonize(),r=new vs;if(0!==this.emissivity){for(e=0,n=i.count-1;e<n;e+=1)r.x1=i.x_coords[e],r.y1=i.y_coords[e],r.x2=i.x_coords[e+1],r.y2=i.y_coords[e+1],this.radiateFromLine(t,r);r.x1=i.x_coords[i.count-1],r.y1=i.y_coords[i.count-1],r.x2=i.x_coords[0],r.y2=i.y_coords[0],this.radiateFromLine(t,r)}},Ms.prototype.radiateFromLine=function(t,e){var n,i,r,o,a,s,l,u,c,h,d,p,f,m,g,v,y;if(0!==this.emissivity)if(n=t.getModelOptions(),i=ms(e.x1-e.x2,e.y1-e.y2),r=(e.x2-e.x1)/i,o=(e.y2-e.y1)/i,a=Math.max(1,Math.round(i/.5)),h=n.solar_ray_speed*o,d=-n.solar_ray_speed*r,1===a)c=.5*i,s=e.x1+c*r,l=e.y1+c*o,(c=t.getAverageTemperatureAt(s,l))>20&&(c=t.getTemperatureAt(s,l),(u=new Cs(s,l,this.getIrradiance(c),n.solar_ray_speed)).vx=h,u.vy=d,t.addPhoton(u),this.constant_temperature||t.setTemperatureAt(s,l,c-u.energy/this.specific_heat));else for(p=new Array(4),f=new Array(4),p[0]=h*ks-d*Ss,f[0]=h*Ss+d*ks,p[1]=d*Ss+h*ks,f[1]=d*ks-h*Ss,p[2]=h*Es-d*As,f[2]=h*As+d*Es,p[3]=d*As+h*Es,f[3]=d*Es-h*As,m=1+p.length,v=0;v<a;v+=1)if(c=.5*(v+.5),s=e.x1+c*r,l=e.y1+c*o,c=t.getAverageTemperatureAt(s,l),g=this.getIrradiance(c)/m,c>20){for((u=new Cs(s,l,g,n.solar_ray_speed)).vx=h,u.vy=d,t.addPhoton(u),y=0;y<m-1;y+=1)(u=new Cs(s,l,g,n.solar_ray_speed)).vx=p[y],u.vy=f[y],t.addPhoton(u);this.constant_temperature||t.changeAverageTemperatureAt(s,l,-g*m/this.specific_heat)}};var Ps=function(){try{new Float32Array}catch(t){return"regular"}return"Float32Array"}(),Ds=function(t,e){var n,i,r,o,a,l,u,c=t.grid_width,h=t.grid_height,d=c*h,p=t.model_width/c,f=t.model_height/h,m=0,g=!1,v={start:function(){},stop:function(){},startFPS:function(){},updateFPS:function(){},stopFPS:function(){}},y=s.a.create(d,t.background_temperature,Ps),b=s.a.create(d,NaN,Ps),_=s.a.create(d,0,Ps),x=s.a.create(d,0,Ps),w=s.a.create(d,0,Ps),C=s.a.create(d,0,Ps),T=s.a.create(d,0,Ps),S=s.a.create(d,t.background_conductivity,Ps),k=s.a.create(d,t.background_specific_heat,Ps),A=s.a.create(d,t.background_density,Ps),E=s.a.create(d,!0,Ps),M=[],P=[],D=function(){var t,n,i=[];if(e)for(s.a.isArray(e)||(e=[e]),i=new Array(e.length),t=0,n=e.length;t<n;t+=1)i[t]=new Ms(e[t]);return i}(),O=function(){us.writeRGBATexture(P[0],y,y,b,S),us.writeRGBATexture(P[1],w,k,A,E),us.writeRGBATexture(P[2],_,x,_,x),us.writeRGBATexture(P[3],C,T,C,T)},I=function(){l=function(){var e,n;if(t.sunny)return!0;for(e=0,n=D.length;e<n;e+=1)if(D[e].emissivity>0)return!0;return!1}(),u=function(){var t,e;for(t=0,e=D.length;t<e;t+=1)if(D[t].power>0)return!0;return!1}()},L=function(e,n){var i,r,o,a,s=t.model_width,l=t.model_height;for(o=0,a=(i=e.getGridCells(c,h,s,l)).length;o<a;o+=1)r=i[o],n||(y[r]=e.temperature),E[r]=!1,S[r]=e.thermal_conductivity,k[r]=e.specific_heat,A[r]=e.density,0!==e.wind_speed&&(C[r]=e.wind_speed*Math.cos(e.wind_angle),T[r]=e.wind_speed*Math.sin(e.wind_angle)),e.constant_temperature&&(b[r]=e.temperature)},R=function(e){e||(s.a.fill(y,t.background_temperature),s.a.fill(_,0),s.a.fill(x,0)),s.a.fill(b,NaN),s.a.fill(w,0),s.a.fill(C,0),s.a.fill(T,0),s.a.fill(S,t.background_conductivity),s.a.fill(k,t.background_specific_heat),s.a.fill(A,t.background_density),s.a.fill(E,!0)},N=function(t){var e;if(D&&0!==D.length)for(e=D.length-1;e>=0;e-=1)L(D[e],t)},F=function(){var t,e,n,i,r,o,a,s,l;for(i=0;i<c;i+=1)for(e=i*p,r=i*h,o=0;o<h;o+=1)if(n=o*f,w[r+o]=0,l=0,u){for(a=0,s=D.length;a<s;a+=1)(t=D[a]).shape.contains(e,n)&&(w[r+o]+=t.power,l++);l>0&&(w[r+o]/=l)}},B=function(t,e){return.5*((_[t*h+e+1]-_[t*h+e-1])/p-(x[(t+1)*h+e]-x[(t-1)*h+e])/f)},z={nextStep:function(){v.start("Core model step"),g?(t.convective&&(v.start("Fluid solver GPU"),a.solve(),v.stop("Fluid solver GPU")),v.start("Heat solver GPU"),o.solve(t.convective),v.stop("Heat solver GPU")):(l&&(v.start("Ray solver CPU"),m%t.photon_emission_interval==0&&(F(),t.sunny&&r.sunShine(),r.radiate()),r.solve(),v.stop("Ray solver CPU")),t.convective&&(v.start("Fluid solver CPU"),i.solve(_,x),v.stop("Fluid solver CPU")),v.start("Heat solver CPU"),n.solve(t.convective,y,w),v.stop("Heat solver CPU")),m+=1,v.stop("Core model step")},setPerformanceTools:function(t){v=t},reset:function(){m=0,R(),I(),N(),F(),g&&O()},partsChanged:function(t,e){R(!0),I(),N(!0),F(),"temperature"===e&&L(t)},addPart:function(t){var e=new Ms(t);D.push(e),L(e)},removePart:function(t){D.splice(t,1),z.partsChanged()},useWebGL:function(t){g!==t&&(z.isWebGLCompatible()?t?function(){if(g=!1,"undefined"==typeof window)throw new Error("Core model: WebGL GPGPU unavailable in the node.js environment.");us.init(h,c),P[0]=us.createTexture(),P[1]=us.createTexture(),P[2]=us.createTexture(),P[3]=us.createTexture(),O(),o=hs(z),a=fs(z),g=!0}():(z.syncTemperature(),z.syncVelocity(),g=!1):g=!1)},isWebGLActive:function(){return g},isWebGLCompatible:function(){return!l},getWebGLError:function(){},syncTemperature:function(){g&&us.readTexture(P[0],y)},syncVelocity:function(){g&&(us.readTexture(P[2],_,0),us.readTexture(P[2],x,1))},getIndexOfStep:function(){return m},getModelOptions:function(){return t},getTemperatureAt:function(t,e){var n=Math.max(Math.min(c-1,Math.round(t/p)),0),i=Math.max(Math.min(h-1,Math.round(e/f)),0);return y[n*h+i]},setTemperatureAt:function(t,e,n){var i=Math.max(Math.min(c-1,Math.round(t/p)),0),r=Math.max(Math.min(h-1,Math.round(e/f)),0);y[i*h+r]=n},getAverageTemperatureAt:function(t,e){var n,i,r=0,o=c-1,a=h-1,s=Math.round(t/p),l=Math.round(e/f);return n=Math.max(Math.min(o,s),0),i=Math.max(Math.min(a,l),0),r+=y[n*h+i],n=Math.max(Math.min(o,s+1),0),i=Math.max(Math.min(a,l),0),r+=y[n*h+i],n=Math.max(Math.min(o,s-1),0),i=Math.max(Math.min(a,l),0),r+=y[n*h+i],n=Math.max(Math.min(o,s),0),i=Math.max(Math.min(a,l+1),0),r+=y[n*h+i],n=Math.max(Math.min(o,s),0),i=Math.max(Math.min(a,l-1),0),.2*(r+=y[n*h+i])},changeAverageTemperatureAt:function(t,e,n){var i,r,o=c-1,a=h-1,s=Math.round(t/p),l=Math.round(e/f);n*=.2,i=Math.min(o,s),r=Math.min(a,l),i>=0&&r>=0&&(y[i*h+r]+=n),i=Math.min(o,s+1),r=Math.min(a,l),i>=0&&r>=0&&(y[i*h+r]+=n),i=Math.min(o,s-1),r=Math.min(a,l),i>=0&&r>=0&&(y[i*h+r]+=n),i=Math.min(o,s),r=Math.min(a,l+1),i>=0&&r>=0&&(y[i*h+r]+=n),i=Math.min(o,s),r=Math.min(a,l-1),i>=0&&r>=0&&(y[i*h+r]+=n)},getVorticityAt:function(t,e){var n=Math.max(Math.min(c-1,Math.round(t/p)),0),i=Math.max(Math.min(h-1,Math.round(e/f)),0);return B(n,i)},getAverageVorticityAt:function(t,e){var n=Math.max(Math.min(c-1,Math.round(t/p)),0),i=Math.max(Math.min(h-1,Math.round(e/f)),0),r=B(n,i);return r+=B(n-1,i),r+=B(n+1,i),r+=B(n,i-1),r+=B(n,i+1),r+=B(n-1,i-1),r+=B(n-1,i+1),r+=B(n+1,i-1),(r+=B(n+1,i+1))/9},getSpeedAt:function(t,e){var n=Math.max(Math.min(c-1,Math.round(t/p)),0),i=Math.max(Math.min(h-1,Math.round(e/f)),0);return ms(_[n*h+i],x[n*h+i])},getHeatFluxAt:function(t,e){var n=Math.max(Math.min(c-1,Math.round(t/p)),0),i=Math.max(Math.min(h-1,Math.round(e/f)),0);return[S[n*h+i]*(y[(n-1)*h+i]-y[(n+1)*h+i])/(2*p),S[n*h+i]*(y[n*h+i-1]-y[n*h+i+1])/(2*f)]},addPhoton:function(t){M.push(t)},removePhoton:function(t){var e=M.indexOf(t);-1!==e&&M.splice(e,1)},getArrayType:function(){return Ps},getPerformanceModel:function(){return v},getTemperatureArray:function(){return y},getUVelocityArray:function(){return _},getVVelocityArray:function(){return x},getUWindArray:function(){return C},getVWindArray:function(){return T},getBoundaryTemperatureArray:function(){return b},getPowerArray:function(){return w},getConductivityArray:function(){return S},getCapacityArray:function(){return k},getDensityArray:function(){return A},getFluidityArray:function(){return E},getPhotonsArray:function(){return M},getPartsArray:function(){return D},getTemperatureTexture:function(){return P[0]},getVelocityTexture:function(){return P[2]},getSimulationTexture:function(t){return P[t]}};return I(),N(),F(),n=Na(z),i=ds(z),r=Ts(z),z},Os={units:{time:{name:"second",pluralName:"seconds",symbol:"s"},temperature:{name:"degree Celsius",pluralName:"degrees Celsius",symbol:"°C"},length:{name:"meter",pluralName:"meters",symbol:"m"},velocity:{name:"meter per second",pluralName:"meters per second",symbol:"m/s"}}},Is=0;function Ls(t){var e,n,i="energy2dModel"+ ++Is,r=new qn({metadata:Ra,unitsDefinition:Os,initialProperties:t,setters:{use_WebGL:function(t){n&&m(t),s=e.properties.ticksPerGPUSync},ticksPerGPUSync:function(t){n&&g(),s=Number(t)}}}),o=r.propertySupport,a=r.dispatchSupport,s=0,l=[],u=[],c={parts:[],sensors:[]},h=function(){function t(t){Object.defineProperty(this,"_rawPart",{enumerable:!1,get:function(){return t}})}return Object.keys(Ra.part).forEach((function(i){Object.defineProperty(t.prototype,i,{enumerable:!0,get:function(){return this._rawPart[i]},set:function(t){var r=e.properties.use_WebGL;e.properties.use_WebGL=!1,o.invalidatingChangePreHook(),this._rawPart[i]=p.a.validateSingleProperty(Ra.part[i],i,t),e.isStopped()?n.reset():n.partsChanged(this._rawPart,i),o.invalidatingChangePostHook(),e.properties.use_WebGL=r,a.partsChanged()}})})),t.prototype.computeLabel=function(){return this._rawPart.getLabel()},function(){var e,i,r=n.getPartsArray(),o=c.parts;for(o.length=0,e=0,i=r.length;e<i;e++)o.push(new t(r[e]))}}(),f=function(){function t(t){Object.defineProperty(this,"_rawObj",{enumerable:!1,get:function(){return t}})}var n={x:function(t){return Math.max(0,Math.min(e.properties.model_width,t))},y:function(t){return Math.max(0,Math.min(e.properties.model_height,t))}};return Object.keys(Ra.sensor).forEach((function(e){Object.defineProperty(t.prototype,e,{enumerable:!0,get:function(){return this._rawObj[e]},set:function(t){o.invalidatingChangePreHook(),t=n[e]?n[e](t):t,this._rawObj[e]=p.a.validateSingleProperty(Ra.sensor[e],e,t),o.invalidatingChangePostHook(),a.sensorsChanged()}})})),function(){var e,n,i=c.sensors;for(i.length=0,e=0,n=l.length;e<n;e++)i.push(new t(l[e]))}}();function m(t){try{n.useWebGL(t)}catch(t){$n.a.warn("WebGL initialization failed. CPU solvers and rendering will be used."),$n.a.warn(t.message)}}function g(){n.syncTemperature(),n.syncVelocity()}function v(){var t,i,r=e.getTemperatureArray();for(t=0,i=r.length;t<i;t++)if(isNaN(r[t])||Math.abs(r[t])>1e10)return e.stop(),n.reset(),!0;return!1}function y(t){var e=[];return t.forEach((function(t){e.push(p.a.validateCompleteness(Ra.part,t))})),e}function b(t){var n={thermometer:function(){return e.getTemperatureAt(this.x,this.y)},anemometer:function(){return this._rot},heatFlux:function(){var t=e.getHeatFluxAt(this.x,this.y);return t[0]*this._sin+t[1]*this._cos}},i={thermometer:{label:"Temperature",unitType:"temperature",format:".1f"},anemometer:{},heatFlux:{label:"Heat Flux",unitName:"Watt Per Square Meter",unitPluralName:"Watts Per Square Meter",unitAbbreviation:"W/m²",format:".1f"}};l=[],t.forEach((function(t,r){"anemometer"===(t=p.a.validateCompleteness(Ra.sensor,t)).type&&(t._rot=0,u.push(t)),"heatFlux"===t.type&&(t.angle=t.angle||0,t._sin=Math.sin(-t.angle*Math.PI/180),t._cos=Math.cos(t.angle*Math.PI/180)),Object.defineProperty(t,"value",{enumerable:!0,get:n[t.type]}),l.push(t),e.defineOutput("sensor-"+r,i[t.type],(function(){return t.value}))}))}return e={namespace:i,tick:function(){var t,i,r;for(An.enterScope("engine"),t=0,i=e.properties.timeStepsPerTick;t<i;t++)n.nextStep();An.leaveScope("engine"),n.isWebGLActive()?s>0?s--:(g(),s=Number(e.properties.ticksPerGPUSync),r=v()):r=v(),function(){var t,n,i;for(n=0,i=u.length;n<i;n++)(t=u[n])._rot+=e.getSpeedAt(t.x,t.y)*(e.getVorticityAt(t.x,t.y)<0?-1:1)*e.properties.timeStep*700,t._rot=t._rot%360}(),e.updateAllOutputProperties(),a.tick(),r&&Object(d.a)("The model has diverged and has been reset!\n\nTry changing its parameters (e.g. 'timeStep', positions of parts etc.) or reload it to restore the initial configuration.")},syncTemperature:function(){o.invalidatingChangePreHook(),n.syncTemperature(),o.invalidatingChangePostHook()},syncVelocity:function(){o.invalidatingChangePreHook(),n.syncVelocity(),o.invalidatingChangePostHook()},addPart:function(t){var i=e.properties.use_WebGL;e.properties.use_WebGL=!1,t=p.a.validateCompleteness(Ra.part,t),o.invalidatingChangePreHook(),n.addPart(t),h(),o.invalidatingChangePostHook(),e.properties.use_WebGL=i,a.partsChanged()},removePart:function(t){var i=e.properties.use_WebGL;e.properties.use_WebGL=!1,o.invalidatingChangePreHook(),n.removePart(t),h(),o.invalidatingChangePostHook(),e.properties.use_WebGL=i,a.partsChanged()},reset:function(){var i;a.willReset(),o.invalidatingChangePreHook(),e.stop(),n.reset(),t.structure&&t.structure.part&&(i=y(t.structure.part)),n=Ds(e.properties,i),m(e.properties.use_WebGL),t.sensors&&b(t.sensors),h(),f(),o.invalidatingChangePostHook(),e.resetAllOutputProperties(),a.reset(),a.invalidation()},stepCounter:function(){return n.getIndexOfStep()},isNewStep:function(){return!0},stepBack:function(t){return n.getIndexOfStep()},stepForward:function(t){arguments.length||(t=1),this.isStopped()||this.stop();for(var i=-1;++i<t;)e.tick();return n.getIndexOfStep()},getTime:function(){return e.properties.timeStep*n.getIndexOfStep()},isWebGLActive:function(){return n.isWebGLActive()},isWebGLCompatible:function(){return n.isWebGLCompatible()},getWebGLError:function(){return n.getWebGLError()},getIndexOfStep:function(){return n.getIndexOfStep()},getTemperatureAt:function(t,e){return n.getTemperatureAt(t,e)},getAverageTemperatureAt:function(t,e){return n.getAverageTemperatureAt(t,e)},getVorticityAt:function(t,e){return n.getVorticityAt(t,e)},getHeatFluxAt:function(t,e){return n.getHeatFluxAt(t,e)},getAverageVorticityAt:function(t,e){return n.getAverageVorticityAt(t,e)},getSpeedAt:function(t,e){return n.getSpeedAt(t,e)},getTemperatureArray:function(){return n.getTemperatureArray()},getTemperatureTexture:function(){return n.getTemperatureTexture()},getUVelocityArray:function(){return n.getUVelocityArray()},getVVelocityArray:function(){return n.getVVelocityArray()},getVelocityTexture:function(){return n.getVelocityTexture()},getPhotonsArray:function(){return n.getPhotonsArray()},getPartsArray:function(){return c.parts},getSensorsArray:function(){return c.sensors},serialize:function(){var t={},e=o.rawValues;return(t=Dn(Ra.mainProperties,e)).viewOptions=Dn(Ra.viewOptions,e),t.structure={part:[]},c.parts.forEach((function(e){t.structure.part.push(Dn(Ra.part,e))})),t.sensors=[],c.sensors.forEach((function(e){t.sensors.push(Dn(Ra.sensor,e))})),t}},function(){var i,s,l;function u(){o.invalidatingChangePreHook(),o.invalidatingChangePostHook()}r.mixInto(e),a.addEventTypes("tick","partsChanged","sensorsChanged"),t.structure&&t.structure.part&&(i=y(t.structure.part)),n=Ds(e.properties,i),m(e.properties.use_WebGL),t.sensors&&b(t.sensors),h(),f(),e.on("play.model",u),e.on("stop.model",u),e.defineOutput("minX",{},(function(){return 0})),e.defineOutput("minY",{},(function(){return 0})),e.defineOutput("maxX",{},(function(){return e.properties.model_width})),e.defineOutput("maxY",{},(function(){return e.properties.model_height})),e.defineOutput("time",{label:"Time",unitType:"time",format:".2f"},(function(){return e.getTime()})),e.defineOutput("displayTime",{label:"Time"},(s=d3.format("02d"),function(){var t,n,i,r=e.getTime();return t=(r=Math.floor(r))%60,n=(r=Math.floor(r/60))%60,i=(r=Math.floor(r/60))%24,(r=Math.floor(r/24))+":"+s(i)+":"+s(n)+":"+s(t)})),l=!1,e.on("play.has-played-support",(function(){l=!0})),e.on("reset.has-played-support",(function(){l=!1})),e.defineOutput("hasPlayed",{label:"has Played"},(function(){return l}))}(),e}var Rs,Ns,Fs=function(t,e,n){var i,r,o,a,s,l,u,c;if(t=Math.max(0,Math.min(360,t)),e=Math.max(0,Math.min(100,e)),n=Math.max(0,Math.min(100,n)),n/=100,0===(e/=100))return i=r=o=n,[Math.round(255*i),Math.round(255*r),Math.round(255*o)];switch(l=n*(1-e),u=n*(1-e*(s=(t/=60)-(a=Math.floor(t)))),c=n*(1-e*(1-s)),a){case 0:i=n,r=c,o=l;break;case 1:i=u,r=n,o=l;break;case 2:i=l,r=n,o=c;break;case 3:i=l,r=u,o=n;break;case 4:i=c,r=l,o=n;break;default:i=n,r=l,o=u}return[Math.round(255*i),Math.round(255*r),Math.round(255*o)]};(Rs={})[0]=Rs.RAINBOW=[[0,0,128],[20,50,120],[20,100,200],[10,150,150],[120,180,50],[220,200,10],[240,160,36],[225,50,50],[230,85,110],[250,250,250],[255,255,255]],Rs[1]=Rs.IRON=[[40,20,100],[80,20,150],[150,20,150],[200,50,120],[220,80,80],[230,120,30],[240,200,20],[240,220,80],[255,255,125],[250,250,250],[255,255,255]],Rs[2]=Rs.GRAY=[[50,50,50],[75,75,75],[100,100,100],[125,125,125],[150,150,150],[175,175,175],[200,200,200],[225,225,225],[250,250,250],[255,255,255]],Rs[3]=Rs.RAINBOW2=function(){var t,e=new Array(256);for(t=0;t<256;t+=1)e[t]=Fs(255-t,100,90);return e}(),(Ns=function(t){void 0!==t&&"DEFAULT"!==t||(t="RAINBOW"),this.color_palette_id=t}).prototype.getRGBArray=function(){if(void 0!==Rs[this.color_palette_id])return Rs[this.color_palette_id]};var Bs=Ns;function zs(t){var e,n,i,r,o,a,s,l=0,u=50,c={renderHeatmap:function(){var t,e,c,h,d,p,f,m,g,v,y,b;if(!o)throw new Error("Heatmap: bind heatmap before rendering.");for(n.clearRect(0,0,a,s),n.fillStyle="rgb(0,0,0)",t=r/Math.max(1,u-l),f=(p=n.getImageData(0,0,a,s)).data,y=0,b=4*a,m=0;m<a;m+=1)for(v=m*s,y=4*m,g=0;g<s;g+=1)c=t*(o[v+g]-l),c-=e=Math.floor(c),e<0?(e=0,c=0):e>r-1&&(e=r-1,c=1),h=i[e],d=i[e+1],f[y]=h[0]*(1-c)+d[0]*c,f[y+1]=h[1]*(1-c)+d[1]*c,f[y+2]=h[2]*(1-c)+d[2]*c,f[y+3]=255,y+=b;n.putImageData(p,0,0)},bindHeatmap:function(t,e,n){if(e*n!==t.length)throw new Error("Heatmap: provided heatmap has wrong dimensions.");o=t,a=e,s=n,this.setCanvasSize(a,s)},getHTMLElement:function(){return e},resize:function(){},setCanvasSize:function(t,n){e.attr("width",t),e.attr("height",n)},setMinTemperature:function(t){l=t},setMaxTemperature:function(t){u=t},setColorPalette:function(t){i=new Bs(t).getRGBArray(),r=i.length-1}};return c.setColorPalette("DEFAULT"),(e=$("<canvas />")).attr("id",t||"energy2d-heatmap-view"),n=e[0].getContext("2d"),c}function js(t){var e,n,i,r,o,a=Fa.getWebGLContext(),s=new Ha("varying vec2 coord;\n\nvoid main() {\n  coord = gl_TexCoord.xy;\n  gl_Position = vec4(gl_Vertex.xyz, 1.0);\n}\n","// Provided textur contains temperature data in R channel.\nuniform sampler2D heatmap_tex;\nuniform sampler2D palette_tex;\n\nuniform float max_temp;\nuniform float min_temp;\n\nvarying vec2 coord;\n\nvoid main() {\n  float temp = texture2D(heatmap_tex, coord).r;\n  float scaled_temp = (temp - min_temp) / max(1.0, max_temp - min_temp);\n  gl_FragColor = texture2D(palette_tex, vec2(scaled_temp, 0.5));\n}\n"),l=ns.plane({coords:!0}),u=0,c=50,h={renderHeatmap:function(){if(!o)throw new Error("Heatmap: bind heatmap texture before rendering.");a.bindFramebuffer(a.FRAMEBUFFER,null),a.viewport(0,0,i,r),a.clear(a.COLOR_BUFFER_BIT),o.bind(0),e.bind(1),s.draw(l),e.unbind(1),o.unbind(0)},resize:function(){i=n.width(),r=n.height(),n.attr("width",i),n.attr("height",r)},bindHeatmapTexture:function(t){o=t},getHTMLElement:function(){return n},setMinTemperature:function(t){u=t,s.uniforms({min_temp:u})},setMaxTemperature:function(t){c=t,s.uniforms({max_temp:c})},setColorPalette:function(t){var n,i,r,o,s;for(i=(n=new Bs(t).getRGBArray()).length,r=new Uint8Array(4*i),o=0;o<i;o+=1)r[s=4*o]=n[o][0],r[s+1]=n[o][1],r[s+2]=n[o][2],r[s+3]=255;e=new Ga(i,1,{type:a.UNSIGNED_BYTE,format:a.RGBA,filter:a.LINEAR}),a.bindTexture(a.TEXTURE_2D,e.id),a.texImage2D(a.TEXTURE_2D,0,e.format,i,1,0,e.format,e.type,r)}};return h.setColorPalette("DEFAULT"),s.uniforms({heatmap_tex:0,palette_tex:1,min_temp:u,max_temp:c}),l.coords=[[1,0],[1,1],[0,0],[0,1]],l.compile(),(n=$(a.canvas)).attr("id",t||"energy2d-heatmap-webgl-view"),h}var Vs='<p><a href="http://get.webgl.org" target="_blank">Click to learn more about WebGL.</a></p>';function Hs(t,e){var n,i,r,o,a,s,l,u,c,h={getModel:function(){return e},getScriptingAPI:function(){return function(){}},getNextTabIndex:function(){return function(){}}};function d(){i.hide(),r.fadeIn()}function p(){i.fadeIn(),r.fadeOut()}return u={bindModel:function(t){l=t,h.getModel=function(){return t},a.modelLoadedCallback(h)},render:function(){var t,e=l.isWebGLCompatible(),n=us.featuresInfo,r=!0,a=!0,u=l.properties.use_WebGL&&!l.isWebGLActive();o.empty(),Object.keys(n).forEach((function(t){var e=n[t];e.required&&!e.available&&(r=!1),e.required||e.available||(a=!1)})),r&&a?o.append('<p>Your browser <span class="happy">supports</span> WebGL as well as all required and optional extensions!</p>'):r?(o.append('<p>Your browser <span class="happy">supports</span> WebGL and all required extensions! However some optional extensions are unavailable:</p>'),Object.keys(n).forEach((function(t){var e,i=n[t];i.required||(e=i.available?'<span class="happy"><i class="icon-ok"></i></span>':'<span class="sad"><i class="icon-remove"></i></span>',o.append('<p class="extension">'+e+" "+t+"</p>"))})),o.append("<p>WebGL rendering quality can be affected.</p>")):n.WebGL?(o.append('<p>Your browser <span class="happy">supports</span> WebGL, however not all required extensions are available:</p>'),Object.keys(n).forEach((function(t){var e,i=n[t];i.required&&(e=i.available?'<span class="happy"><i class="icon-ok"></i></span>':'<span class="sad"><i class="icon-remove"></i></span>',o.append('<p class="extension">'+e+" "+t+"</p>"))})),o.append(Vs)):(o.append('<p>Sorry, your browser <span class="sad">does not support</span> WebGL.'),o.append(Vs)),e?(t='This model is <span class="happy">compatible</span> with WebGL-accelerated physics engine',l.isWebGLActive()?t+=' and it is <span class="happy">active</span>.':(t+=', but it is <span class="sad">inactive</span>.',u?t+=' Unfortunately, its initialization <span class="sad">failed</span>. Check the browser console for details.':r&&(t+=" Enable it to speed up simulation:")),o.append("<p>"+t+"</p>")):o.append('<p>Unfortunately, some features used in this model are <span class="sad">incompatible</span> with WebGL-accelerated physics engine.</p>'),r&&e&&!u?s.show():s.hide(),u?(t="WebGL initialization failed.",i.removeClass("happy"),i.addClass("sad")):r&&e?l.isWebGLActive()?(t="WebGL available and active.",i.removeClass("sad"),i.addClass("happy")):(t="WebGL available, but inactive.",i.removeClass("happy"),i.removeClass("sad")):(t="WebGL unavailable.",i.removeClass("happy"),i.addClass("sad")),t+=" Click for detailed information.",i.attr("title",t),u&&d()},getHTMLElement:function(){return n}},a=new Jt({type:"checkbox",id:"webgl-status-checkbox",text:"WebGL-accelerated physics engine",property:"use_WebGL"},h),s=a.getViewContainer(),(n=$("<div />")).attr("id",t||"e2d-webgl-status"),(r=$('<div id="status-wrapper"/>')).appendTo(n),(o=$("<div />")).appendTo(r),(c=$('<a id="hide-webgl-status" class="button"><i class="icon-remove"></i></a>')).on("click",p),c.appendTo(r),s.appendTo(r),(i=$('<a id="show-webgl-status" class="button"><i class="icon-bolt"></i></a>')).on("click",d),i.appendTo(n),r.hide(),u}function Ws(t){var e,n,i,r,o,a,s,l,u,c=Math.cos(.523598776),h=Math.sin(.523598776),d=!0,p={renderVectormap:function(){if(d){var t,e,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E,M,P,D;if(!o||!a)throw new Error("Vectormap: bind vectormap before rendering.");for(t=i/s,e=r/l,n.clearRect(0,0,i,r),n.strokeStyle="rgb(175,175,175)",n.lineWidth=1,v=1;v<s-1;v+=u)for(b=v*l,p=(v+.5)*t,y=1;y<l-1;y+=u)f=(y+.5)*e,(m=o[_=b+y])*m+(g=a[_])*g>1e-15&&(x=p,w=f,C=m,T=g,S=void 0,k=void 0,A=void 0,E=void 0,M=void 0,P=void 0,D=void 0,S=1/Math.sqrt(C*C+T*T),E=x+8*(k=C*S)+100*C,M=w+8*(A=T*S)+100*T,P=4*(k*c+A*h),D=4*(A*c-k*h),n.beginPath(),n.moveTo(x,w),n.lineTo(E,M),n.lineTo(E-P,M-D),n.moveTo(E,M),P=4*(k*c-A*h),D=4*(A*c+k*h),n.lineTo(E-P,M-D),n.stroke())}},clear:function(){n.clearRect(0,0,i,r)},get enabled(){return d},set enabled(t){(d=t)||p.clear()},bindVectormap:function(t,e,n,i,r){if(n*i!==t.length)throw new Error("Heatmap: provided U component of vectormap has wrong dimensions.");if(n*i!==e.length)throw new Error("Heatmap: provided V component of vectormap has wrong dimensions.");o=t,a=e,s=n,l=i,u=Math.round(n/r)},getHTMLElement:function(){return e},resize:function(){i=e.width(),r=e.height(),e.attr("width",i),e.attr("height",r)}};return(e=$("<canvas />")).attr("id",t||"energy2d-vectormap-view"),n=e[0].getContext("2d"),p}function Us(t){var e,n,i,r,o,a,s,l=Fa.getWebGLContext(),u=new Ha("// Provided texture contains vector data in RG channels.\nattribute vec2 origin;\n\nuniform sampler2D vectormap_tex;\nuniform float base_length;\nuniform float vector_scale;\nuniform vec2 scale;\n\nvoid main() {\n  // Read vector which should be visualized.\n  vec2 vec = texture2D(vectormap_tex, gl_TexCoord.xy).xy;\n  vec.y = -vec.y;\n\n  if (length(vec) < 1e-15) {\n    // Do not draw to small vectors.\n    // Set position outside [-1, 1] region, which is rendered.\n    gl_Position = vec4(2.0);\n    return;\n  }\n\n  // Test which part of the vector arrow is being processed. \n  if (gl_Vertex.x == 0.0 && gl_Vertex.y == 0.0) {\n    // Origin of the arrow is being processed.\n    // Just transform its coordinates.\n    gl_Position = vec4(origin, 0.0, 1.0);\n  } else {\n    // Other parts of arrow are being processed.\n    // Set proper length of the arrow, rotate it, scale\n    // and finally transform.\n\n    // Calculate arrow length.\n    vec2 new_pos = gl_Vertex.xy;\n    new_pos.x += base_length + vector_scale * length(vec);\n\n    // Calculate angle between reference arrow (horizontal).\n    vec = normalize(vec);\n    float angle = acos(dot(vec, vec2(1.0, 0.0)));\n    if (vec.y < 0.0) {\n      angle = -angle;\n    }\n    // Prepare rotation matrix.\n    // See: http://en.wikipedia.org/wiki/Rotation_matrix\n    mat2 rot_m = mat2(\n      cos(angle), sin(angle),\n     -sin(angle), cos(angle)\n    );\n    // Rotate.\n    new_pos = rot_m * new_pos;\n    // Scale.\n    new_pos = new_pos * scale;\n    // Transform.\n    gl_Position = vec4(new_pos + origin, 0.0, 1.0);\n  }\n}\n","uniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"),c=new ns({coords:!0,lines:!0}),h=!0,d={renderVectormap:function(){if(h){if(!r)throw new Error("Vectormap: bind heatmap texture before rendering.");l.bindFramebuffer(l.FRAMEBUFFER,null),l.viewport(0,0,n,i),r.bind(0),u.draw(c,l.LINES),r.unbind(0)}},get enabled(){return h},set enabled(t){h=t},resize:function(){n=e.width(),i=e.height(),e.attr("width",n),e.attr("height",i),u.uniforms({scale:[2/n,2/i]})},bindVectormapTexture:function(t,e,n,i){r=t,o=e,a=n,s=Math.round(o/i),function(){var t,e,n,i,r,l=2/o,u=2/a,h=1/o,d=1/a;for(c.addVertexBuffer("origins","origin"),c.vertices=[],c.origins=[],c.coords=[],c.lines=[],n=0,t=1;t<o-1;t+=s)for(e=1;e<a-1;e+=s)c.vertices.push([0,0,0],[.01,0,0],[-3,2,0],[-3,-2,0]),i=[(t+.5)*l-1,1-(e+.5)*u,0],c.origins.push(i,i,i,i),r=[(e+.5)*d,(t+.5)*h],c.coords.push(r,r,r,r),c.lines.push([n,n+1],[n+1,n+2],[n+1,n+3]),n+=4;c.compile()}()},getHTMLElement:function(){return e}};return u.uniforms({vectormap_tex:0,base_length:8,vector_scale:100,color:[.7,.7,.7,1]}),(e=$(l.canvas)).attr("id",t||"energy2d-vectormap-webgl-view"),d}function $s(t){var e,n,i,r,o,a,s,l,u,c=function(){n.strokeStyle="rgba(255,255,255,128)",n.lineWidth=.5},h={renderPhotons:function(){var t,e,l,u,c,h;if(!o)throw new Error("Photons view: bind parts array before rendering.");for(n.clearRect(0,0,i,r),c=0,h=o.length;c<h;c+=1)e=(t=o[c]).x*a,l=t.y*s,u=1/Math.sqrt(t.vx*t.vx+t.vy*t.vy),n.beginPath(),n.moveTo(e,l),n.lineTo(e+10*t.vx*u,l+10*t.vy*u),n.stroke()},bindPhotonsArray:function(t,e,n){o=t,a=i/(l=e),s=r/(u=n)},getHTMLElement:function(){return e},resize:function(){i=e.width(),r=e.height(),a=i/l,s=r/u,e.attr("width",i),e.attr("height",r),c()}};return(e=$("<canvas />")).attr("id",t||"energy2d-photons-view"),e.addClass("energy2d-photons-view"),n=e[0].getContext("2d"),c(),h}function Gs(t,e){var n,i,r,o,a,s,l,u,c,h=t.model2px,d=t.model2pxInv,p={rect:function(t){return"rectangle"===t.shapeType?this:null},ellipse:function(t){return"ellipse"===t.shapeType?this:null},path:function(t){return"polygon"===t.shapeType||"ring"===t.shapeType?this:null}},f=d3.svg.arc().innerRadius((function(t){return h(.5*t.inner)})).outerRadius((function(t){return h(.5*t.outer)})).startAngle(0).endAngle(2*Math.PI),m=d3.behavior.drag().origin((function(t){return{x:h(t.x),y:d(t.y)}})).on("dragstart",(function(t){var e,n;t.draggable&&(r=o=null,e=h.range(),n=d.range(),a=Math.min(e[0],e[1]),s=Math.max(e[0],e[1]),l=Math.min(n[0],n[1]),u=Math.max(n[0],n[1]),(c=this.getBBox()).x0=c.x+10,c.y0=c.y+10,c.x1=c.x+c.width-10,c.y1=c.y+c.height-10,d3.select(this).style("opacity",.7))})).on("drag",(function(t){t.draggable&&(r=d3.event.x,o=d3.event.y,r-=Math.max(0,c.x0+r-s)+Math.min(0,c.x1+r-a),o-=Math.max(0,c.y0+o-u)+Math.min(0,c.y1+o-l),d3.select(this).attr("transform","translate("+r+","+o+")"))})).on("dragend",(function(t){t.draggable&&(d3.select(this).style("opacity",1),null!==r&&(t.x=h.invert(r),t.y=d.invert(o)))}));function g(t){return"translate("+h(t.x||0)+","+d(t.y||0)+")"}function v(t){return h(t.width)+2}function y(t){return h(t.height)+2}function b(t){return h(.5*t.a)}function _(t){return h(.5*t.b)}function x(t){return t.visible?"visible":"hidden"}function w(t){return t.texture?"url(#texture-1)":"none"}function C(t){return t.computeLabel()}function T(){return-this.getBBox().width/2}function S(t){if(!t.filled)return"rgba(0, 0, 0, 0)";var e;if("auto"===t.color)e=t.power>0?"#FFFF00":t.power<0?"#B0C4DE":t.constant_temperature?"rgba(0, 0, 0, 0)":"#999";else if(e=t.color,!isNaN(parseInt(e,16))){for(;e.length<6;)e="0"+e;e="#"+e}return e}function k(t){switch(t.shapeType){case"polygon":return function(t){var e,n,i=[],r=t.raw_x_coords,o=t.raw_y_coords;for(e=0,n=r.length;e<n;e++)i.push(h(r[e])),i.push(d(o[e]));return"M"+i.join(",")+"Z"}(t);case"ring":return f(t)}}function A(t){var e=t.shapeType;return"rectangle"===e||"polygon"===e?this.parentNode.firstElementChild.getBBox().width/2:0}function E(t){var e=t.shapeType;return"rectangle"===e||"polygon"===e?this.parentNode.firstElementChild.getBBox().height/2:0}function M(t,e,n){switch((e=e.select(p[t])).append(t).attr("class","e2d-part-shape"),e.append(t).attr("class","e2d-part-shape-outline").attr("fill",w),n.select(".e2d-part-shape"),n.select(".e2d-part-shape-outline"),t){case"rect":n.selectAll("rect").attr("x",1).attr("y",1).attr("width",v).attr("height",y);break;case"ellipse":n.selectAll("ellipse").attr("rx",b).attr("ry",_);break;case"path":n.selectAll("path").attr("d",k)}}return n={renderParts:function(){var t,n,r,o;i&&(M("rect",n=(t=e.selectAll(".e2d-part").data(i)).enter().append("g").attr("class","e2d-part part"),t),M("ellipse",n,t),M("path",n,t),o=t,(r=n).append("text").attr("class","e2d-part-label-shadow").attr("dy",".35em"),r.append("text").attr("class","e2d-part-label").attr("dy",".35em"),o.select(".e2d-part-label"),o.select(".e2d-part-label-shadow"),o.selectAll(".e2d-part-label, .e2d-part-label-shadow").text(C).attr("dx",T).attr("x",A).attr("y",E),n.call(m),t.attr("transform",g),t.select(".e2d-part-shape").attr("fill",S).style("visibility",x),t.exit().remove())},bindPartsArray:function(t){i=t}},function(){var t=e.append("defs").append("pattern").attr("id","texture-1").attr("patternUnits","userSpaceOnUse").attr("x",0).attr("y",0).attr("width","0.7em").attr("height","0.7em").attr("viewBox","0 0 16 16");t.append("path").attr("class","e2d-texture-path-shadow").attr("d","M0,0 L16,16 M-1,15 L1,17 M15,-1 L17,1"),t.append("path").attr("class","e2d-texture-path").attr("d","M0,0 L16,16 M-1,15 L1,17 M15,-1 L17,1")}(),n}function qs(t,e){var n,i,r,o,a,s=t.model2px,l=t.model2pxInv,u=d3.scale.linear().clamp(!0).domain([0,50]).range([4,0]),c=d3.behavior.drag().origin((function(t){return{x:s(t.x),y:l(t.y)}})).on("drag",(function(t){t.x=s.invert(d3.event.x),t.y=l.invert(d3.event.y)}));function h(t){return t+"%"}function d(t){return"translate("+s(t.x)+","+l(t.y)+")"}function p(){return-this.getBBox().width/2}function f(t){return t.label}function m(t){return t.value.toFixed(1)+" °C"}function g(t){return h(u(t.value))}function v(t){return"rotate("+t.value+")"}function y(t){return t.value.toFixed(1)+" W/m²"}function b(t){return"rotate("+t.angle+")"}function _(t){(t=t.append("g").attr("class","e2d-measuring-point")).append("line").attr("x1",0).attr("y1","-0.8%").attr("x2",0).attr("y2","0.8%"),t.append("line").attr("x1","-0.8%").attr("y1",0).attr("x2","0.8%").attr("y2",0),t.append("circle").attr("r","0.8%")}function x(t,e){t.append("text").attr("class","e2d-sensor-reading-shadow"),t.append("text").attr("class","e2d-sensor-reading"),t.append("text").attr("class","e2d-sensor-label-shadow"),t.append("text").attr("class","e2d-sensor-label"),e.select(".e2d-sensor-label"),e.select(".e2d-sensor-label-shadow"),e.select(".e2d-sensor-reading"),e.select(".e2d-sensor-reading-shadow")}return{update:function(){i.attr("height",g),r.text(m),o.attr("transform",v),a.text(y)},renderSensors:function(){var t,s,l;n&&(t=n,s=e.selectAll(".e2d-sensor.thermometer").data(t.filter((function(t){return"thermometer"===t.type}))),x(l=s.enter().append("g").attr("class","e2d-sensor sensor thermometer").call(c),s),l.append("rect").attr("class","e2d-thermometer-fill"),l.append("rect").attr("class","e2d-thermometer-background"),l.call(_),s.attr("transform",d),s.select(".e2d-thermometer-fill").attr("x",h(-1)).attr("y",h(-2)).attr("width",h(2)).attr("height",h(4)),i=s.select(".e2d-thermometer-background").attr("x",h(-1)).attr("y",h(-2)).attr("width",h(2)).attr("height",g),r=s.selectAll(".e2d-sensor-reading, .e2d-sensor-reading-shadow").text(m).attr("y",h(-2)).attr("dy","-.2em").attr("dx","-.7em"),s.selectAll(".e2d-sensor-label, .e2d-sensor-label-shadow").text(f).attr("dx",p).attr("dy","1em").attr("y",h(2)),s.exit().remove(),function(t){var n=e.selectAll(".e2d-sensor.anemometer").data(t.filter((function(t){return"anemometer"===t.type}))),i=n.enter().append("g").attr("class","e2d-sensor sensor anemometer").call(c);x(i,n),(i=i.append("svg").attr("class","e2d-anemometer-shape").attr("viewBox","-50 -50 100 100").attr("x","-3%").attr("y","-3%").attr("width","6%").attr("height","6%").append("g").attr("class","e2d-anemometer-rot")).append("path").attr("d","M-10,10 L0,50 L10,10 Z").attr("transform","rotate(0)"),i.append("path").attr("d","M-10,10 L0,50 L10,10 Z").attr("transform","rotate(120)"),i.append("path").attr("d","M-10,10 L0,50 L10,10 Z").attr("transform","rotate(240)"),i.append("circle").attr("r",12),n.attr("transform",d),o=n.select(".e2d-anemometer-rot").attr("transform",v),n.selectAll(".e2d-sensor-label, .e2d-sensor-label-shadow").text(f).attr("dx",p).attr("dy","0.7em").attr("y","3%"),n.exit().remove()}(n),function(t){var n=e.selectAll(".e2d-sensor.heatFlux").data(t.filter((function(t){return"heatFlux"===t.type}))),i=n.enter().append("g").attr("class","e2d-sensor sensor heatFlux").call(c);(i=i.append("g").attr("transform",b)).append("rect").attr("class","e2d-heatflux-shape").attr("x","-3%").attr("y","-1%").attr("width","6%").attr("height","2%"),i.append("svg").attr("viewBox","0 0 6 1").attr("x","-3%").attr("y","-1%").attr("width","6%").attr("height","2%").append("path").attr("class","e2d-heatflux-pattern").attr("d","M0,0L1,1L2,0L3,1L4,0L5,1L6,0"),i.call(_),x(i,n),n.attr("transform",d),a=n.selectAll(".e2d-sensor-reading, .e2d-sensor-reading-shadow").text(y).attr("y","-1%").attr("dy","-.2em").attr("dx","-1.8em"),n.selectAll(".e2d-sensor-label, .e2d-sensor-label-shadow").text(f).attr("dx",p).attr("dy","0.9em").attr("y","1%"),n.exit().remove()}(n))},bindSensorsArray:function(t){n=t},setMinMaxTemp:function(t,e){u.domain([t,e])}}}function Ys(t,e){var n,i,r,o,a,s,l,u=new Hs(null,e),c=u.getHTMLElement(),h=$("<div id='e2d-canvas-views'>"),d=0,p=!1;function f(t){var e=t.getHTMLElement();e.css("width","100%"),e.css("height","100%"),e.css("position","absolute"),e.css("top",0),e.css("left",0),e.css("z-index",d),d+=1,h.append(e)}function m(){var t=e.properties;h.empty(),d=0,e.isWebGLActive()?(i=new js,f(r=new Us)):(f(i=new zs),f(r=new Ws)),f(o=new $s),i.resize(),r.resize(),o.resize(),e.isWebGLActive()?(i.bindHeatmapTexture(e.getTemperatureTexture()),r.bindVectormapTexture(e.getVelocityTexture(),t.grid_width,t.grid_height,25)):(i.bindHeatmap(e.getTemperatureArray(),t.grid_width,t.grid_height),r.bindVectormap(e.getUVelocityArray(),e.getVVelocityArray(),t.grid_width,t.grid_height,25)),o.bindPhotonsArray(e.getPhotonsArray(),t.model_width,t.model_height)}function g(){var t=e.properties;r.enabled=t.velocity,i.setMinTemperature(t.minimum_temperature),i.setMaxTemperature(t.maximum_temperature),i.setColorPalette(t.color_palette_type),s.setMinMaxTemp(t.minimum_temperature,t.maximum_temperature)}return n={getHeightForWidth:function(t){return t*e.properties.grid_height/e.properties.grid_width},setup:function(t){p=!0,m(),a.bindPartsArray(t.getPartsArray()),s.bindSensorsArray(t.getSensorsArray()),u.bindModel(t),g(),a.renderParts(),s.renderSensors(),u.render(),n.update(),t.addPropertiesListener("use_WebGL",(function(){m(),g(),u.render(),n.update()})),t.addPropertiesListener(["color_palette_type","velocity","minimum_temperature","maximum_temperature"],(function(){g(),n.update()})),t.on("tick.view-update",n.update),t.on("partsChanged.view-update",(function(){a.renderParts()})),t.on("sensorsChanged.view-update",(function(){s.renderSensors()}))},update:function(){p&&(i.renderHeatmap(),r.renderVectormap(),o.renderPhotons(),s.update())},resize:function(){p&&(i.resize(),r.resize(),o.resize(),a.renderParts(),s.renderSensors(),n.update())},reset:function(){},setFocus:function(){e.get("enableKeyboardHandlers")&&this.$el.focus()},bindModel:function(t){e=t}},l=t.appendViewport(),a=new Gs(t,l.append("g")),s=new qs(t,l.append("g")),t.$el.append(h),t.$el.append(c),n}var Xs=function(t,e){return new Tr(t,e,Ys,{origin:"top-left"})};function Qs(t){var e;return[{name:"engine (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(n){t.model.start(),setTimeout((function(){t.model.stop(),t.model.properties.use_WebGL=!1,An.collectData(!0),e=t.model.get("time"),setTimeout((function(){t.model.start(),setTimeout((function(){t.model.stop(),An.collectData(!1),n(An.getAvgTime("engine"))}),5e3)}),100)}),1e3)}},{name:"JS rendering (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(t){t(An.getAvgTime("js-rendering"))}},{name:"tick (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(t){t(An.getAvgTime("tick"))}},{name:"gap b/w frames (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(t){t(An.getAvgTime("gap"))}},{name:"fps",numeric:!0,formatter:d3.format("5.1f"),run:function(n){n((t.model.get("time")-e)/(t.model.get("timeStepsPerTick")*t.model.get("timeStep"))*1e3/5e3)}},{name:"engine WebGL (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(n){t.model.start(),setTimeout((function(){t.model.stop(),t.model.properties.use_WebGL=!0,An.collectData(!0),e=t.model.get("time"),setTimeout((function(){t.model.start(),setTimeout((function(){t.model.stop(),An.collectData(!1),n(An.getAvgTime("engine"))}),5e3)}),100)}),1e3)}},{name:"JS rendering WebGL (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(t){t(An.getAvgTime("js-rendering"))}},{name:"tick WebGL (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(t){t(An.getAvgTime("tick"))}},{name:"gap b/w frames WebGL (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(t){t(An.getAvgTime("gap"))}},{name:"fps WebGL",numeric:!0,formatter:d3.format("5.1f"),run:function(n){n((t.model.get("time")-e)/(t.model.get("timeStepsPerTick")*t.model.get("timeStep"))*1e3/5e3)}}]}function Ks(t){return{getTemperatureAt:function(e,n){return t.model.getTemperatureAt(e,n)},getAverageTemperatureAt:function(e,n){return t.model.getAverageTemperatureAt(e,n)},getSensor:function(e){return t.model.getSensorsArray()[e]},getPart:function(e){return t.model.getPartsArray()[e]},addPart:function(e){t.model.addPart(e)},removePart:function(e){t.model.removePart(e)},getNumberOfParts:function(){return t.model.getPartsArray().length},syncTemperature:function(){t.model.syncTemperature()}}}var Js=0;function Zs(t,e){var n,i,r,o,a="dataset"+ ++Js;function s(){var t,n=[];for(n.push(e.get(r)),t=0;t<o.length;t++)n.push(e.get(o[t]));i.push(n)}return n={getData:function(e){var n,r,o,a,s,l,u=[];if(void 0===e)return l=[],i.forEach((function(t){l.push(t)})),l;for(n=0;n<i.length;n++){for(r=i[n],s=[],a=0;a<e.length;a++)o=t.properties.indexOf(e[a]),s.push(r[o]);u.push(s)}return[u]},reset:function(){i=$.extend(!0,[],t.tableData),0},appendPropertyRow:s,serialize:function(){var e=$.extend(!0,{},t);return e.tableData=i,e}},0,i=[],e.on("tick."+a,(function(){s()})),r=t.timeSeries.xProperty,o=t.timeSeries.properties,s(),n}function tl(t,e){var n,i,r,o,a,s,l,u,c,h,d,f,m,g,v,y,b;return n={setOnLoadScript:function(t){t},serialize:function(){return $.extend(!0,{},t)}},t=p.a.validateCompleteness(st.experiment,t),s=t.timeSeries,l=t.parameters.inputs,t.parameters.outputs,u=t.destinations,c=t.stateButtons,o=[],e.on("modelLoaded.experimentController",(function(){r=e.getScriptingAPI(),(i=e.getModel()).defineParameter("experimentCleared",{initialValue:!1},(function(){i.get("experimentCleared")&&(h.setDisabled(!1),d.setDisabled(!0),f.setDisabled(!0),m.setDisabled(!0),i.set("experimentCleared",!1),e.reloadModel({propertiesToRetain:l,cause:"new-run"}),function(){for(var t=0;t<l.length;t++)i.unfreeze(l[t])}(),function(){var t;if(b){for(t=0;t<o.length;t++)b.addDataSet(o[t].getData());b.update()}}(),i.set("experimentCleared",!1))})),i.defineParameter("experimentRunning",{initialValue:!1},(function(){i.get("experimentRunning")?(h.setDisabled(!0),d.setDisabled(!1),f.setDisabled(!0),m.setDisabled(!0),g.setDisabled(!1),function(){for(var t=0;t<l.length;t++)i.freeze(l[t])}(),a=new Zs({timeSeries:s},i),r.api.start()):(h.setDisabled(!0),d.setDisabled(!0),f.setDisabled(!1),m.setDisabled(!1),r.api.stop())}))})),h=e.getComponent(c.startRun),d=e.getComponent(c.stopRun),f=e.getComponent(c.saveRun),m=e.getComponent(c.nextRun),g=e.getComponent(c.clearAll),function(){var t,n,i,r;for(v=[],y=[],t=0;t<u.length;t++){for((i=u[t]).components=[],n=0;n<i.componentIds.length;n++)i.components.push(e.getComponent(i.componentIds[n]));switch(i.type){case"timeSeries":v.push(i);break;case"parameterSeries":y.push(i);break;default:throw new Error("Experiment destination: invalid destination type: "+i.type)}}for(b=void 0,t=0;t<v.length;t++)for(i=v[t],n=0;n<i.components.length;n++)if(void 0!==(r=i.components[n]).type&&"graph"===r.type)return void(b=r)}(),h.setAction("set('experimentRunning', true);"),d.setAction("set('experimentRunning', false);"),f.setAction((function(){var t,e,n;for(o.push(a),t=0;t<y.length;t++)for(n=y[t],e=0;e<n.components.length;e++)n.components[e].appendDataPropertiesToComponent();f.setDisabled(!0)})),m.setAction("set('experimentCleared', true);"),g.setAction((function(){e.reloadInteractive()})),n}function el(t){return(el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var nl={md2d:function(t,e,n){return new Mn(t,e,n,hr,Eo,Po,Do)},"signal-generator":function(t,e,n){return new Mn(t,e,n,Lo,Ro,No)},"iframe-model":function(t,e,n){return new Mn(t,e,n,jo,Vo,Ho)},sensor:function(t,e,n){var i=new Mn(t,e,n,Ko,Zo,ta);return n.on("modelLoaded.sensor-model-controller",(function(){var t=i.model;t.addObserver("isSensorInitializing",(function(){var e=i.modelContainer;t.properties.isSensorInitializing?e.showInitializationProgress():e.hideInitializationProgress()})),t.addObserver("sensorReading",(function(){t.isStopped()&&i.updateView()})),t.addObserver("needsReload",(function(){t.properties.needsReload&&n.reloadModel()})),t.addPropertyDescriptionObserver("sensorReading",(function(){var e=t.getPropertyDescription("sensorReading");i.modelContainer.updateUnits(e.getUnitAbbreviation())}))})),n.on("modelReset.sensor-model-controller",(function(){i.model.set("isNewRunInProgress",!1)})),n.on("willResetModel",(function(){i.model.set("isNewRunInProgress",!0)})),i},"dual-sensor":function(t,e,n){var i=new Mn(t,e,n,ra,aa,sa);return n.on("modelLoaded.dual-sensor-model-controller",(function(){var t=i.model;t.addObserver("isSensorInitializing",(function(){var e=i.modelContainer;t.properties.isSensorInitializing?e.showInitializationProgress():e.hideInitializationProgress()})),t.addObserver("sensorReading",(function(){t.isStopped()&&i.updateView()})),t.addObserver("sensorReading2",(function(){t.isStopped()&&i.updateView()})),t.addObserver("needsReload",(function(){t.properties.needsReload&&n.reloadModel()})),t.addPropertyDescriptionObserver("sensorReading",(function(){var e=t.getPropertyDescription("sensorReading");i.modelContainer.updateUnits(e.getUnitAbbreviation())})),t.addPropertyDescriptionObserver("sensorReading2",(function(){var e=t.getPropertyDescription("sensorReading2");i.modelContainer.updateUnits2(e.getUnitAbbreviation())}))})),n.on("modelReset.dual-sensor-model-controller",(function(){i.model.set("isNewRunInProgress",!1)})),n.on("willResetModel",(function(){i.model.set("isNewRunInProgress",!0)})),i},"dual-sensor-connector":function(t,e,n){var i=new Mn(t,e,n,ma,ga,va);return n.on("modelLoaded.dual-sensor-connector-model-controller",(function(){var t=i.model;t.addObserver("liveSensorReading",(function(){i.updateView()})),t.addObserver("liveSensorReading2",(function(){i.updateView()})),t.addObserver("needsReload",(function(){t.properties.needsReload&&n.reloadModel()})),t.addPropertyDescriptionObserver("sensorReading",(function(){var e=t.getPropertyDescription("sensorReading");i.modelContainer.updateUnits(e.getUnitAbbreviation())})),t.addPropertyDescriptionObserver("sensorReading2",(function(){var e=t.getPropertyDescription("sensorReading2");i.modelContainer.updateUnits2(e.getUnitAbbreviation())}))})),n.on("modelReset.dual-sensor-connector-model-controller",(function(){i.model.set("isNewRunInProgress",!1)})),n.on("willResetModel",(function(){i.model.set("isNewRunInProgress",!0),i.model.willReset()})),i},"sensor-connector":function(t,e,n){var i=new Mn(t,e,n,_a,xa,wa);return n.on("modelLoaded.sensor-connector-model-controller",(function(){var t=i.model;t.addObserver("liveSensorReading",(function(){i.updateView()})),t.addObserver("needsReload",(function(){t.properties.needsReload&&n.reloadModel()})),t.addPropertyDescriptionObserver("sensorReading",(function(){var e=t.getPropertyDescription("sensorReading");i.modelContainer.updateUnits(e.getUnitAbbreviation())}))})),n.on("modelReset.sensor-connector-model-controller",(function(){i.model.set("isNewRunInProgress",!1)})),n.on("willResetModel",(function(){i.model.set("isNewRunInProgress",!0),i.model.willReset()})),i},labquest2:function(t,e,n){var i=new Mn(t,e,n,Aa,Ea,Ma);return n.on("modelLoaded.labquest2-model-controller",(function(){var t=i.model;t.addObserver("liveSensorReading",(function(){i.updateView()})),t.addObserver("needsReload",(function(){t.properties.needsReload&&n.reloadModel()})),t.addPropertyDescriptionObserver("sensorReading",(function(){var e=t.getPropertyDescription("sensorReading");i.modelContainer.updateUnits(e.getUnitAbbreviation())}))})),n.on("modelReset.labquest2-model-controller",(function(){i.model.set("isNewRunInProgress",!1)})),n.on("willResetModel",(function(){i.model.set("isNewRunInProgress",!0),i.model.willReset()})),i},energy2d:function(t,e,n){return new Mn(t,e,n,Ls,Xs,Ks,Qs)}},il={text:ne,image:oe,button:Kt,checkbox:Jt,pulldown:function(t,e){var n,i,r,o,a,s,l;function u(){void 0!==t.property&&s.update(i.get(t.property))}function c(){var e=i.getPropertyDescription(t.property);n.setDisabled(e.getFrozen())}return n={modelLoadedCallback:function(){r=e.getScriptingAPI(),void 0!==t.property?(i&&(i.removeObserver(t.property,u),i.removePropertyDescriptionObserver(t.property,c)),(i=e.getModel()).addObserver(t.property,u),i.addPropertyDescriptionObserver(t.property,c)):i=e.getModel(),u()},enableLogging:function(t){o=t},getViewContainer:function(){return l},serialize:function(){var e,n,i;if(void 0===t.property)for(i=l.find("option"),e=0,n=a.length;e<n;e++)$(i[e]).prop("selected")?a[e].selected=!0:delete a[e].selected;return $.extend(!0,{},t)}},function(){var u,c,h=e.interactiveContainer;for(i=e.getModel(),r=e.getScriptingAPI(),t=p.a.validateCompleteness(st.pulldown,t),u=0,c=(a=t.options).length;u<c;u++)a[u]=p.a.validateCompleteness(st.pulldownOption,a[u]);s=new ae({id:t.id,options:a,label:t.label,labelOn:t.labelOn,onChange:function(e){e.action?r.makeFunctionInScriptContext(e.action)():void 0!==e.value&&r.api.set(t.property,e.value),function(e){if(o){var n={id:t.id,selected:e.text};t.label&&(n.label=t.label),t.property&&(n.property=t.property,n.value=e.value),o("PulldownChanged",n)}}(e)}}),(l=s.render(h)).addClass("interactive-pulldown").addClass("component"),t.tooltip&&l.attr("title",t.tooltip),Gt(n,t),_t(n,t,e.helpSystem)}(),n},radio:function(t,e){var n,i,r,o,a,s=[],l=[];function u(){if(void 0!==t.property)for(var e=o.get(t.property),n=0,i=r.length;n<i;n++)r[n].value===e?(s[n].attr("checked",!0),l[n].addClass("checked")):(s[n].removeAttr("checked"),l[n].removeClass("checked"))}function c(){var e=o.getPropertyDescription(t.property);n.setDisabled(e.getFrozen())}function h(t){var e,n,i=$(this),r=i.find("input");if(t.preventDefault(),void 0===r.attr("disabled")){for(e=0,n=s.length;e<n;e++)s[e].removeAttr("checked"),l[e].removeClass("checked");r.attr("checked","checked"),i.addClass("checked"),r.trigger("change")}}return n={modelLoadedCallback:function(){o&&void 0!==t.property&&(o.removeObserver(t.property,u),o.removePropertyDescriptionObserver(t.property,c)),o=e.getModel(),a=e.getScriptingAPI(),void 0!==t.property&&(o.addPropertiesListener([t.property],u),o.addPropertyDescriptionObserver(t.property,c)),u()},enableLogging:function(e){s.forEach((function(n,i){var o=r[i];n.off(".logging"),n.on("change.logging",(function(){var n={id:t.id,selected:o.text};t.label&&(n.label=t.label),t.property&&(n.property=t.property,n.value=o.value),e("RadioChanged",n)}))}))},getViewContainer:function(){return i},serialize:function(){var e,n;if(void 0===t.property)for(e=0,n=r.length;e<n;e++)s[e].attr("checked")?r[e].selected=!0:delete r[e].selected;return $.extend(!0,{},t)}},function(){var u,c,d,f,m,g,v;for(o=e.getModel(),a=e.getScriptingAPI(),t=p.a.validateCompleteness(st.radio,t),g=0,v=(r=t.options).length;g<v;g++)r[g]=p.a.validateCompleteness(st.radioOption,r[g]);for((i=$("<div>").attr("id",t.id)).addClass("interactive-radio"),i.addClass("component"),i.addClass(t.orientation),i.addClass(t.style),t.label&&((d=$("<span>").html(t.label)).addClass("label"),d.addClass("top"===t.labelOn?"on-top":"on-left"),i.append(d)),f=$("<span>").addClass("options").appendTo(i),g=0,v=r.length;g<v;g++)m=r[g],u=$("<input>").attr("type","radio").attr("name",t.id).attr("tabindex",e.getNextTabIndex()).attr("id",t.id+"-"+g),s.push(u),c=$("<span>").addClass("option").append(u),l.push(c),f.append(c),"radio"===t.style&&$('<div class="fakeCheckable">').appendTo(c),$("<label>").attr("for",t.id+"-"+g).html(m.text).appendTo(c),m.disabled&&(u.attr("disabled",m.disabled),c.addClass("lab-disabled")),m.selected&&(u.attr("checked",m.selected),c.addClass("checked")),c.on("touchstart click",h),u.change(function(e){return function(){e.action?a.makeFunctionInScriptContext(e.action)():void 0!==e.value&&o.set(t.property,e.value)}}(m));t.tooltip&&i.attr("title",t.tooltip),Gt(n,t),_t(n,t,e.helpSystem)}(),n},thermometer:function(t,e){var n,i,r,o,a,s,l,u,c,h,d,f,m,g=function(){var t,e=m.get("targetTemperature");c.css("height",o(r(e))),a&&(t=r(t=e),h.text(t.toFixed(i)+" "+n))};return f={modelLoadedCallback:function(){m&&m.removeObserver("targetTemperature",g),(m=e.getModel()).addPropertiesListener("targetTemperature",g),g()},getViewContainer:function(){return l},resize:function(){var t=l.height()-h.height();u.height(t),d.height(t),s&&u.width(l.width()-d.width())},serialize:function(){return t}},function(){var f,g,v,y,b,_,x,w,C,T,S;for(m=e.getModel(),f=(t=p.a.validateCompleteness(st.thermometer,t)).reading,n=f.units,g=f.offset,v=f.scale,i=f.digits,C=t.min,w=t.max,r=function(t){return v*t+g},o=function(t){return(t-C)/(w-C)*100+"%"},(a=t.labelIsReading)?"":"Thermometer",y={id:t.id,labelText:a?"":"Thermometer"},b=t.labels,x=-1/0,y.labels=[],T=0,S=b.length;T<S;T++)y.labels.push({label:b[T].label,position:o(r(b[T].value))}),b[T].label.length>x&&(x=b[T].label.length,_=T);l=$(qe.a.render('<div class="interactive-thermometer component" id="{{id}}">\n  <div class="thermometer-main-container">\n    <div class="thermometer">\n      <div class="thermometer-fill"></div>\n    </div>\n    <p class="label">{{labelText}}</p>\n  </div>\n  <div class="labels-container">\n    {{#labels}}\n      <span class="value-label" style="bottom: {{position}}">{{label}}</span>\n    {{/labels}}\n  </div>\n</div>',y)),u=l.find(".thermometer"),c=l.find(".thermometer-fill"),h=l.find(".label"),d=l.find(".labels-container"),x=l.measure((function(){return this.width()/parseFloat(this.css("font-size"))+"em"}),".value-label:eq("+_+")",e.interactiveContainer),d.css("width",x),l.css("height",t.height),s=!1,/%$/.test(t.width)?(l.css("width",t.width),s=!0):u.css("width",t.width)}(),f},barGraph:function(t,e){var n,i,r,o,a,s,l=function(){r.set({value:i.get(a)})},u=function(){r.set({secondValue:i.get(s)})};return n={modelLoadedCallback:function(){var n="";i&&(i.removeObserver(a,l),s&&i.removeObserver(s,u)),(i=e.getModel()).addPropertiesListener([a],l),void 0!==t.averagePeriod&&null!==t.averagePeriod&&(s=a+"-bargraph-"+t.id+"-average",i.defineFilteredOutput(s,{},a,"RunningAverage",t.averagePeriod)),s&&i.addPropertiesListener([s],u),!0===t.units?n=i.getPropertyDescription(a).getUnitAbbreviation():t.units&&(n=t.units),r.set({barWidth:t.barWidth,height:t.height,units:n}),o.render(),l()},getViewContainer:function(){return o.$el},resize:function(){o.render()},serialize:function(){return $.extend(!0,{},t)}},i=e.getModel(),t=p.a.validateCompleteness(st.barGraph,t),r=new yt.a(function(t){var e,n,i={};for(e in xt)xt.hasOwnProperty(e)&&(n=xt[e],void 0!==t[e]&&(i[n]=t[e]));return i}(t)),(o=new bt.a({model:r,id:t.id})).$el.addClass("component"),a=t.property,s=t.secondProperty,t.tooltip&&o.$el.attr("title",t.tooltip),_t(n,t,e.helpSystem),n},graph:function(t,e){var n,i,r,o,a,s,l,u,c=!1,h=!1,d="graphController"+ ++Ct;function f(){return e.getModel()}function m(t){return null!=t&&"auto"!==t}function g(){var e,n={};for(e in wt)wt.hasOwnProperty(e)&&(n[wt[e]]=t[e]);return t.syncXAxis&&v("x",t.syncXAxis,n),t.syncYAxis&&v("y",t.syncYAxis,n),n}function v(t,n,i){var r="on"+t.toUpperCase()+"DomainChange",o="set"+t.toUpperCase()+"Domain";"string"==typeof n&&(n=[n]),i[r]=function(t,i){h||n.forEach((function(n){e.getComponent(n)[o](t,i,!0)}))}}function y(t){var e;c||(e=t.data,i.updateOrRescale(e))}function b(){i?t.resetAxesOnReset&&S():(i=new ot.a(n[0],g(),void 0,e.getNextTabIndex())).addPointListener(O),x(o.getData()),D()}function _(){b()}function x(t){if(i){var e=[];s.forEach((function(n,i){for(var r=[],o=t[A(i)],a=t[n],s=0,l=Math.min(o.length,a.length);s<l;s++)r.push([o[s],a[s]]);e.push(r)})),e=e.concat(l),i.resetPoints(e),i.repaint()}}function w(t){c||x(t.data)}function C(t){c||x(t.data)}function T(e){if(!c){var n=!1;if(!m(t.ylabel)){var o=s[0],l=e[o]||e.data[o];i.yLabel(l),n=!0}if(!m(t.xlabel)){var u=a[0],h=e[u]||e.data[u];i.xLabel(h),n=!0}n&&r.syncAxisRangesToPropertyRanges()}}function S(){i.reset("#"+t.id,g())}function k(t){var e=t[0],n=t[1];return null!=e&&""!==e&&!isNaN(Number(e))&&null!=n&&""!==n&&!isNaN(Number(n))}function A(t){return a[t]||a[0]}function E(t){if(i&&!c){var e,n=t.data,r=[];s.forEach((function(t,i){e=[n[A(i)],n[t]],r.push(k(e)?e:null)})),i.addPoints(r)}}function M(t){if(i&&!c){var e,n=t.data.dataPoint,r=t.data.index,o=[];s.forEach((function(t,i){e=[n[A(i)],n[t]],o.push(k(e)?e:null)})),i.replacePoints(o,r)}}function P(t){if(i&&!c){var e=t.data.index,n=t.data.props;s.forEach((function(t,r){-1!==n.indexOf(t)&&i.deletePoint(e,r)}))}}function D(){T(o.getLabels())}function O(e){c=!0;var n=t.drawProperty||s[0],i=A(s.indexOf(n)),r={};if(r[i]=e.point[0],r[n]=e.point[1],"added"===e.action)o.appendDataPoint([i,n],r);else if("removed"===e.action){var a=o.dataPointIndex(r);o.removeDataPoint([n],a)}c=!1}return r={type:"graph",modelLoadedCallback:function(){f().on("reset",_),e.getScriptingAPI(),b(),i.repaint()},getDataSet:function(){return o},appendDataPropertiesToComponent:function(){o.appendDataPoint()},addDataSet:function(t){l.push(t)},clearDataSets:function(){l=[]},setAttributes:function(e){i&&($.extend(t,e),o.resetData(),e.dataPoints&&e.dataPoints,S(),D())},setXDomain:function(t,e,n){i&&(h=n,i.xDomain([t,e]),h=!1)},setYDomain:function(t,e,n){i&&(h=n,i.yDomain([t,e]),h=!1)},syncAxisRangesToPropertyRanges:function(){var t,e,n=f(),r=n.getPropertyDescription(a[0]),o=s.map((function(t){return n.getPropertyDescription(t)}));r&&null!=r.getMin()&&null!=r.getMax()&&i.xDomain([r.getMin(),r.getMax()]),t=1/0,e=-1/0,o.forEach((function(n){n&&(n.getMin()<t&&(t=n.getMin()),n.getMax()>e&&(e=n.getMax()))})),isFinite(t)&&isFinite(e)&&i.yDomain([t,e])},scrollXAxisToZero:function(){var t=i.xmin(),e=i.xmax();0!==t&&i.xDomain([0,e-t])},getView:function(){return i},getViewContainer:function(){return n},resize:function(){i&&i.resize()},reset:function(){i&&S()},update:function(){i&&i.update()},selectionDomain:function(){return i?i.selectionDomain.apply(i,arguments):null},selectionEnabled:function(){return i?i.selectionEnabled.apply(i,arguments):null},addAnnotation:function(t){i&&i.addAnnotation(t)},resetAnnotations:function(){i&&i.resetAnnotations()},serialize:function(){var e=$.extend(!0,{},t),n=i.xDomain(),r=i.yDomain(),o=t.xmin;return e.ymin=r[0],e.ymax=r[1],e.xmin=o,e.xmax=o+n[1]-n[0],e},enableLogging:function(t){n.off(".logging"),n.on("click.logging",".graph-button.legend",(function(){t("GraphKeyBtnClicked")})),n.on("click.logging",".graph-button.autoscale",(function(){t("GraphZoomBtnClicked")}))}},e.getScriptingAPI(),u=new dt(d),t=p.a.validateCompleteness(st.graph,t),s=t.properties.slice(),a=t.xProperty,$.isArray(a)||(a=[a]),function(){if(t.dataSet)o=e.getDataSet(t.dataSet);else{var n=t.properties.slice();a.forEach((function(t){-1===n.indexOf(t)&&n.push(t)})),o=new vt({properties:n,name:t.id+"-autoDataSet",streamDataFromModel:t.streamDataFromModel,clearOnModelReset:t.clearOnModelReset},e,!0)}u.listen(o,vt.Events.DATA_RESET,w),u.listen(o,vt.Events.SAMPLE_ADDED,E),u.listen(o,vt.Events.SAMPLE_CHANGED,M),u.listen(o,vt.Events.SAMPLE_REMOVED,P),u.listen(o,vt.Events.SELECTION_CHANGED,y),u.listen(o,vt.Events.DATA_TRUNCATED,C),u.listen(o,vt.Events.LABELS_CHANGED,T)}(),(n=$("<div>").attr("id",t.id).addClass("graph")).addClass("component"),n.css({width:t.width,height:t.height}),t.tooltip&&n.attr("title",t.tooltip),_t(r,t,e.helpSystem),l=[],t.drawProperty&&(t.drawIndex=s.indexOf(t.drawProperty),-1==t.drawIndex&&(t.drawProperty=s[0],t.drawIndex=0)),o.resetData(),r},slider:function(t,e){var n,i,r,o,a,s,l,u,c,h,d,f,m,g,v,y,b,_,x,w,C,T,S,k,A=null,E=function(){var t=e.getModel().get(o);x.slider("value",t),D(t),c&&w.text(h(t))},M=function(){var t=T.getPropertyDescription(o);k.setDisabled(t.getFrozen())};function P(){x.off(".componentAction"),t.action&&(a=S.makeFunctionInScriptContext("value",t.action),x.on("slide.componentAction",(function(t,e){a(e.value),c&&w.text(h(e.value))}))),o&&x.on("slide.componentAction",(function(t,e){var n={};n[o]=e.value,T&&T.set(n),c&&w.text(h(e.value))})),c&&(h=S.makeFunctionInScriptContext("value",c))}function D(t){if(m){var e=Math.round(100*(t-n)/(i-n)),r="",o="",a=[];null===A&&(C.css("background",""),A=C.css("background-color")),t===g?C.css("background",""):(r+=A+" 0%, ",o+="color-stop(0%,"+A+"), ",g<=t?(a.push(v),a.push(e)):(a.push(e),a.push(v)),r+=A+" "+a[0]+"%, ",o+="color-stop("+a[0]+"%,"+A+"), ",r+=m+" "+a[0]+"%, ",o+="color-stop("+a[0]+"%,"+m+"), ",r+=m+" "+a[1]+"%, ",o+="color-stop("+a[1]+"%,"+m+"), ",r+=A+" "+a[1]+"%, ",o+="color-stop("+a[1]+"%,"+A+"), ",r+=A+" 100%",o+="color-stop(100%,"+A+")",C.css("background","-webkit-gradient(linear, left top, right top, "+o+")"),C.css("background","-webkit-linear-gradient(left, "+r+")"),C.css("background","-moz-linear-gradient(left, "+r+")"),C.css("background","-o-linear-gradient(left, "+r+")"),C.css("background","linear-gradient(to right, "+r+")"))}}return k={modelLoadedCallback:function(){T&&o&&(T.removeObserver(o,E),T.removePropertyDescriptionObserver(o,M)),S=e.getScriptingAPI(),T=e.getModel(),o&&(T.addPropertiesListener([o],E),T.addPropertyDescriptionObserver(o,M)),P(),o&&E()},getViewContainer:function(){return y},resize:function(){var e,n=parseFloat(w.css("font-size"));"auto"!==t.height&&(e=y.height(),"top"!==t.titlePosition&&"bottom"!==t.titlePosition||(e-=b.outerHeight(!0)),void 0!==_&&(e-=_.outerHeight(!0)),C.css("height",e),x.css("top",.5*e),w.css("height",e+.4*n),w.css("top",-.5*e-.4*n)),"left"!==t.titlePosition&&"right"!==t.titlePosition||C.css({width:y.width()-b.outerWidth(!0)-.5*n})},enableLogging:function(e){var n,i={id:t.id,label:t.label};o&&(i.property=o),x.off(".logging"),x.on("slidestart.logging",(function(t,e){n=Date.now(),i.startVal=i.minVal=i.maxVal=e.value})),x.on("slide.logging",(function(t,e){i.minVal=Math.min(i.minVal,e.value),i.maxVal=Math.max(i.maxVal,e.value)})),x.on("slidestop.logging",(function(t,r){i.endVal=r.value,i.time=(Date.now()-n)/1e3,e("SliderChanged",i)}))},serialize:function(){var e=$.extend(!0,{},t);return o||(e.initialValue=x.slider("value")),e}},function(){S=e.getScriptingAPI(),T=e.getModel(),t=p.a.validateCompleteness(st.slider,t),n=t.min,i=t.max,r=t.steps,o=t.property,s=t.initialValue,l=t.title,u=t.labels,c=t.displayValue,m=t.fillColor,g=t.fillToValue,T=e.getModel(),void 0===n&&(n=0),void 0===i&&(i=10),void 0===r&&(r=10),void 0===g&&(g=n),v=Math.round(100*(g-n)/(i-n)),b=$('<div class="title '+t.titlePosition+'">'+l+"</div>"),C=$('<div class="container">'),(x=$('<div class="html-slider">').attr("id",t.id)).appendTo(C),x.slider({min:n,max:i,step:(i-n)/r}),m&&(x.addClass("has-fill"),x.on("slide",(function(t,e){D(e.value)}))),(w=x.find(".ui-slider-handle")).attr("tabindex",e.getNextTabIndex()),y=$('<div class="interactive-slider">'),"right"===t.titlePosition||"bottom"===t.titlePosition?y.append(C).append(b):y.append(b).append(C),"left"!==t.titlePosition&&"right"!==t.titlePosition||C.css({display:"inline-block"}),y.addClass("component"),y.css({width:t.width,height:t.height}),"auto"===t.width&&y.css("min-width","12em");var a=null,A=null,E=function(t){return y.measure((function(){return this.width()/parseFloat(this.parent().css("font-size"))}),t,e.interactiveContainer)};for(d=0;d<u.length;d++)f=u[d],_=$('<p class="label">'+f.label+"</p>"),C.append(_),"right"===f.value?(_.addClass("side right"),A=E(".label.side.right"),_.css({left:"100%","margin-left":"0.6em"})):"left"===f.value?(_.addClass("side left"),a=E(".label.side.left"),_.css({left:-a+"em","margin-left":"-0.8em"})):_.css("left",(f.value-n)/(i-n)*100+"%");a&&y.css("margin-left",a+"em"),A&&y.css("margin-right",A+"em"),P(),t.tooltip&&y.attr("title",t.tooltip),Gt(k,t),_t(k,t,e.helpSystem),w.on("keydown.slider-handle",(function(t){t.stopPropagation()})),k.resize(),null!=s&&(x.slider("value",s),D(s),c&&w.text(h(s)))}(),k},colorIndicator:function(t,e){var n,i,r,o,a,s,l,u,c,h=function(){var t=e.getModel().get(n),i=r(t);s.css("background-color",i)};return c={modelLoadedCallback:function(){l&&n&&l.removeObserver(n,h),u=e.getScriptingAPI(),l=e.getModel(),n&&l.addPropertiesListener([n],h),n&&h()},getViewContainer:function(){return o},resize:function(){},serialize:function(){return $.extend(!0,{},t)}},u=e.getScriptingAPI(),l=e.getModel(),t=p.a.validateCompleteness(st.colorIndicator,t),n=t.property,t.initialValue,i=t.title,r=u.makeFunctionInScriptContext("value",t.colorValue),l=e.getModel(),a=$('<div class="title">'+i+"</div>"),s=$('<div class="swatch"></div>'),(o=$('<div class="interactive-color-indicator">').append(a).append(s)).addClass("component"),t.tooltip&&o.attr("title",t.tooltip),_t(c,t,e.helpSystem),o.css({width:t.width,height:t.height}),c.resize(),c},joystick:function(t,e){var n,i,r,o,a,s,l,u,c,h,d,f,m,g,v,y,b,_,x,w,C,T=!1,S={},k={},A=function(t){var i=e.getModel().get(n);t&&D(i),s&&b.text(l(i))},E=function(){var t=_.getPropertyDescription(n);w.setDisabled(t.getFrozen())};function M(){y.draggable({revert:!1,create:function(){P()},drag:function(e,n){var i=function(t,e){if(i=[t,e],r=S.center,o=i[0],a=i[1],s=r[0],l=r[1],Math.sqrt(Math.pow(o-s,2)+Math.pow(a-l,2))<=S.radius-k.halfWidth)return null;t-=S.center[0],e-=S.center[1];var n=Math.atan2(e,t);return{x:Math.cos(n)*(S.radius-k.halfWidth)+S.center[0],y:Math.sin(n)*(S.radius-k.halfWidth)+S.center[1]};var i,r,o,a,s,l}(n.position.left+k.halfWidth,n.position.top+k.halfHeight);i&&(n.position.left=i.x-k.halfWidth,n.position.top=i.y-k.halfHeight);var r,o,a,s,l,u=(n.position.left-k.startLeft)/(S.radius-k.halfWidth),c=(k.startTop-n.position.top)/(S.radius-k.halfHeight);r=u,o=c,a=Math.sqrt(r*r+o*o)*t.scale,s=(Math.atan2(o,r)+2*Math.PI)%(2*Math.PI),l={magnitude:a,direction:s},C&&C(l)},stop:function(){}})}function P(){T||(T=!0,S.width=v[0].offsetWidth,S.height=v[0].offsetHeight,S.top=v[0].offsetTop,S.left=v[0].offsetLeft,S.center=[S.width/2,S.height/2],S.radius=S.width/2,k.startLeft=parseInt(y.css("left")),k.startTop=parseInt(y.css("top")),y.data("startLeft",k.startLeft),y.data("startTop",k.startTop),k.halfWidth=y[0].offsetWidth/2,k.halfHeight=y[0].offsetHeight/2)}function D(e){var n=(S.radius-k.halfWidth)*e.magnitude/t.scale,i=n*Math.cos(e.direction),r=n*Math.sin(e.direction),o=S.center[0]-k.halfWidth+i,a=S.center[1]-k.halfWidth-r;y.css({top:a,left:o})}return w={modelLoadedCallback:function(){_&&n&&(_.removeObserver(n,A),_.removePropertyDescriptionObserver(n,E)),x=e.getScriptingAPI(),_=e.getModel(),n&&(_.addPropertiesListener([n],A),_.addPropertyDescriptionObserver(n,E)),t.action&&(i=x.makeFunctionInScriptContext("value",t.action),C=function(t){i(t),s&&b.text(l(t))}),n&&(C=function(t){_&&(_.properties[n]=t),s&&b.text(l(t))}),s&&(l=x.makeFunctionInScriptContext("value",s)),M(),n&&A(!0)},getViewContainer:function(){return u},resize:function(t){if(!t){var i=u[0].clientWidth,r=u[0].clientHeight,o=parseFloat(u.css("font-size")),a=r-4.2*o,s=m.outerWidth(!0)+g.outerWidth(!0),l=i-s,h=0;l<2*o&&(h=Math.abs(2*o-l),l=2*o);var p,b=l<a?l:a,_=.3*b,x=b+2.2*o;if(h>0){var w=(s-h-.1*o)/s;p=g.outerWidth(!0)*w+.1*o+b/2}else p=g.outerWidth(!0)+.1*o+b/2;c.css({width:i,height:x}),m.css({left:p+b/2+.1*o}),g.css({left:p-b/2-.1*o-g[0].clientWidth}),d.css({left:p-d.outerWidth(!0)/2}),f.css({left:p-f.outerWidth(!0)/2}),v.css({height:b,width:b,left:p-b/2,top:1.1*o,borderRadius:b}),y.css({height:_,width:_,borderRadius:b,left:b/2-_/2,top:b/2-_/2}),T=!1,P(),D(e.getModel().get(n))}},serialize:function(){var e=$.extend(!0,{},t);return n||(e.initialValue={magnitude:0,direction:0}),e}},x=e.getScriptingAPI(),_=e.getModel(),t=p.a.validateCompleteness(st.joystick,t),n=t.property,r=t.initialValue,o=t.title,a=t.labels,s=t.displayValue,_=e.getModel(),void 0===n&&void 0===r&&(r={magnitude:0,direction:0}),c=$('<div class="container">'),h=$('<div class="title">'+o+"</div>"),v=$('<div class="base">').attr("id",t.id),(y=$('<div class="handle">')).appendTo(v),d=$('<div class="label n">'+a.n+"</div>"),f=$('<div class="label s">'+a.s+"</div>"),g=$('<div class="label w">'+a.w+"</div>"),m=$('<div class="label e">'+a.e+"</div>"),c.append(d).append(g).append(v).append(m).append(f),(u=$('<div class="interactive-joystick">').append(h).append(c)).addClass("component"),b=$('<div class="value"></div>'),u.append(b),t.tooltip&&u.attr("title",t.tooltip),Gt(w,t),_t(w,t,e.helpSystem),u.css({width:t.width,height:t.height}),w.resize(!0),null!=r&&(D(r),s&&b.text(l(r))),w},spectrometer:Te,numericOutput:function(t,e){var n,i,r,o,a,s,l,u,c,h;function d(){var t=c.properties[n];o&&(t=o(t)),a.update(t)}return c=e.getModel(),h=e.getScriptingAPI(),t=p.a.validateCompleteness(st.numericOutput,t),n=t.property,r=t.units,i=t.label,o=t.displayValue,a=new De({id:t.id,units:r,label:i}),(s=a.render()).addClass("component"),s.addClass(t.orientation),s.css({width:t.width,height:t.height}),o&&(o=h.makeFunctionInScriptContext("value",o)),t.tooltip&&s.attr("title",t.tooltip),_t(u={modelLoadedCallback:function(){c&&c.removeObserver(n,d),c=e.getModel(),h=e.getScriptingAPI(),n&&((l=c.getPropertyDescription(n))&&(i||a.updateLabel(l.getLabel()),r||a.updateUnits(l.getUnitAbbreviation())),d(),c.addObserver(n,d))},getViewContainer:function(){return s},resize:function(){a.resize(),d()},serialize:function(){return $.extend(!0,{},t)}},t,e.helpSystem),u},table:function(t,e){var n,i,r,o,a,s,l,u,c,h,d="tableController"+ ++Ie;function f(){var e,n,r,o,a,s,l,h;for(u=[],c=[],t.indexColumn&&(u.push({name:"#",editable:!1}),c.push(d3.format("f"))),e=0;e<t.propertyColumns.length;e++)a=null,l=!1,h=".3r",r="string"==typeof t.propertyColumns[e]?{name:t.propertyColumns[e]}:t.propertyColumns[e],void 0!==i&&(n=r.name,i.properties.hasOwnProperty(n)&&(o=i.getPropertyDescription(n))&&(a=o.getLabel(),(s=o.getUnitAbbreviation())&&(a+=" ("+s+")"))),a||(a=r.name,r.units&&(a+=" ("+r.units+")"),l=!r.hasOwnProperty("editable")||r.editable,h=r.hasOwnProperty("format")?r.format:h),u.push({name:a,editable:l}),c.push(d3.format(h))}function m(e){var n=e.data;if(t.addNewRows)a.clearSelection(),a.addSelection(n);else{var i=r.getData();a.replaceDataRow(v(i,n),0)}}function g(e,n){var i=[];return t.indexColumn&&(null==n&&(n=l),i.push(n)),h.forEach((function(t){i.push(e[t])})),i}function v(e,n){var i=[];return t.indexColumn&&i.push(n),h.forEach((function(t){i.push(e[t][n])})),i}function y(e){var n=g(e);(function(e){for(var n=t.indexColumn?1:0,i=e.length;n<i;n++)if(null!=e[n])return!1;return!0})(n)||(t.addNewRows?(a.appendDataRow(n,l),l++):(a.replaceDataRow(n,0),l++))}function b(t){y(t.data)}function _(e){var n=e.data.index,i=g(e.data.dataPoint,n);t.addNewRows?a.replaceDataRow(i,n):a.replaceDataRow(i,0)}function x(e){var n,i=e.data,o=r.maxLength(h);if(t.addNewRows){var s=[];for(l=0;l<o;l++)s.push(v(i,l));a.clear(),a.appendDataRows(s,0)}else n=v(i,o-1),a.replaceDataRow(n,0),l=o}function w(e){var n=r.maxLength(h);l=n,t.addNewRows?a.removeDataRows(n):a.replaceDataRow(v(e.data,n-1),0)}return n={modelLoadedCallback:function(){i=e.getModel(),f(),a.updateTable({columns:u,formatters:c})},resize:function(){a&&a.resize()},getData:function(t){var e=r.getData(),n={};return t.forEach((function(t){n[t]=e[t]})),n},appendDataPropertiesToComponent:function(){r.appendDataPoint()},addDataToCell:function(e,n,i){t.indexColumn&&n--;var o=h[n];if(e===l){if(""===i)return;var a={};return a[o]=i,void r.appendDataPoint(h,a)}r.editDataPoint(e,o,i)},getDataInCell:function(e,n){t.indexColumn&&n--;var i=h[n];return r.getPropertyValue(e,i)},getViewContainer:function(){return s},getView:function(){return a},serialize:function(){var e=$.extend(!0,{},t);return e.headerData=u,t.dataSet||(e.tableData=r.serializeData()),e}},function(){i=e.getModel(),t=p.a.validateCompleteness(st.table,t),h=t.propertyColumns.slice();for(var g=0;g<h.length;g++)h[g].name&&(h[g]=h[g].name);o=new dt(d),r=t.dataSet?e.getDataSet(t.dataSet):new vt({name:t.id+"-autoDataSet",properties:h.slice(),xProperty:t.xProperty,initialData:t.tableData,streamDataFromModel:t.streamDataFromModel,clearOnModelReset:t.clearOnModelReset},e,!0),o.listen(r,vt.Events.SAMPLE_ADDED,b),o.listen(r,vt.Events.SAMPLE_CHANGED,_),o.listen(r,vt.Events.DATA_RESET,x),o.listen(r,vt.Events.DATA_TRUNCATED,w),o.listen(r,vt.Events.SELECTION_CHANGED,m),f(),l=0,$.extend(!0,[],t.headerData),a=new Oe({id:t.id,title:t.title,columns:u,formatters:c,visibleRows:t.visibleRows,showBlankRow:t.showBlankRow,width:t.width,height:t.height,tooltip:t.tooltip,klasses:["interactive-table","component"]},n),s=a.render(),_t(n,t,e.helpSystem),r.resetData()}(),n},div:en,playback:Ze};function rl(t){var e;if(null==t||"object"!==el(t))return t;if(t instanceof Date)return(e=new Date).setTime(t.getTime()),e;if(t instanceof Array){e=[];for(var n=0,i=t.length;n<i;n++)e[n]=rl(t[n]);return e}if(t instanceof Object){for(var r in e={},t)t.hasOwnProperty(r)&&(e[r]=rl(t[r]));return e}throw new Error("Unable to copy obj! Its type isn't supported.")}var ol=["computationalInputs","computationalOutputs","studentInputs"];function al(t){return t.units?t.label+" ("+t.units+")":t.label}var sl={importRun:function(t,e){return"string"==typeof t&&(t=JSON.parse(t)),{perRunLabels:h.a.flatten(ol.map((function(e){return t.description[e]}))).map(al),perRunValues:h.a.flatten(ol.map((function(n){return t.runs[e][n]}))),perTickLabels:t.description.timeSeriesData.map(al),perTickValues:t.runs[e].timeSeriesData.map((function(t){return t.map(h.a.identity)}))}},numberOfRuns:function(t){return"string"==typeof t&&(t=JSON.parse(t)),t.runs.length},timeStamps:function(t){return"string"==typeof t&&(t=JSON.parse(t)),h.a.pluck(t.runs,"timeStamp")},runHavingTimeStamp:function(t,e){"string"==typeof t&&(t=JSON.parse(t));for(var n=0;n<t.runs.length;n++)if(t.runs[n].timeStamp===e)return n;return null}};n(83);window.Lab=window.Lab||{},window.Lab.version=i.a,window.Lab.config=r.a,window.Lab.InteractivesController=function(t,e){var n,i,o,l,c,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E,M,P,D,O,I={},L={},R=[],N={},F=[],B=!1,z={},j=[],V=[],H=new ft("modelLoaded","interactiveRendered","modelReset","resize","interactiveRequested","interactiveWillReload");function W(){void 0===(O=I.randomSeed)&&(O=Math.random().toString()),Math.seedrandom=a()(O)}function U(){D.isReady()&&D.layoutInteractive()}function G(){var t,e,n,i,r,o;for(n in t="string"==typeof I.template?Sn[I.template]:I.template,e=I.layout,i=(r=pn(L,I,P,E,M)).components)i.hasOwnProperty(n)&&(n=i[n]).modelLoadedCallback&&_.push($.proxy(n.modelLoadedCallback,n));(t=r.template.concat(t)).forEach((function(e,n){t[n]=$.extend({},e)})),e=$.extend({},e,r.layout),i=$.extend({},z,r.components),D.initialize({$mainContainer:g,$containersParent:v,containers:t,layout:e,components:i,aspectRatio:I.aspectRatio,fontScale:I.fontScale,padding:I.padding}),"BODY"===g.parent().prop("nodeName")&&($(window).off("resize.lab-resize-handler"),$(window).on("resize.lab-resize-handler",(function(){L.resize()}))),o=function(){L.resize(),setTimeout(L.resize,50)},$(document).off(".lab-fullscreen-change"),$(document).on("fullscreenchange.lab-fullscreen-change",o).on("mozfullscreenchange.lab-fullscreen-change",o).on("webkitfullscreenchange.lab-fullscreen-change",o)}function q(t){var e,n=t.type,i=t.id;if(!(e=new il[n](t,L)).getViewContainer().hasClass("component"))throw new Error("Invalid Interactive Component implementation. Each component has to have 'component' class.");z[i]=e,j.push(e),t.retainProperty&&null!=t.property&&V.push(t.property),e.modelLoadedCallback&&_.push($.proxy(e.modelLoadedCallback,e))}function Y(t){return"string"==typeof t?t:t.join("\n")}function X(t){var e,n,i,r,o,a;function s(t,e){var n,i,r;if(e)try{for(n=0,i=e.length;n<i;n++)e[n]=p.a.validateCompleteness(st[t],e[n])}catch(e){throw r="Incorrect "+t+" definition:\n"+e.message,Object(d.a)(r),new Error(r)}}try{t=p.a.validateCompleteness(st.interactive,t)}catch(t){throw a="Incorrect interactive definition:\n"+t.message,Object(d.a)(a),new Error(a)}for(s("model",t.models),s("parameter",t.parameters),s("output",t.outputs),s("dataSet",t.dataSets),s("filteredOutput",t.filteredOutputs),s("helpTip",t.helpTips),e=0,n=(i=t.models).length;e<n;e++)s("parameter",(r=i[e]).parameters),s("output",r.outputs),s("filteredOutput",r.filteredOutputs);t.experiment&&(l=t.experiment,p.a.validateCompleteness(st.experimentTimeSeries,l.timeSeries),s("experimentParameter",l.parameters),s("experimentDestination",l.destinations),s("experimentSavedRun",l.savedRuns)),o=t.components;try{for(e=0,n=o.length;e<n;e++)o[e]=p.a.validateCompleteness(st[o[e].type],o[e])}catch(t){throw a="Incorrect "+o[e].type+" component definition:\n"+t.message,Object(d.a)(a),new Error(a)}if(t.exports)try{t.exports=p.a.validateCompleteness(st.exports,t.exports)}catch(t){throw a="Incorrect exports definition:\n"+t.message,Object(d.a)(a),new Error(a)}if(t.logging)try{t.logging=p.a.validateCompleteness(st.logging,t.logging)}catch(t){throw a="Incorrect logging definition:\n"+t.message,Object(d.a)(a),new Error(a)}return t}function Q(t){var e;g.empty(),(v=$('<div class="lab-fastclick-container">')).appendTo(g),u.a.attach(v[0]),v.append('<div class="lab-dialog-container">'),w=!0,L.interactive=t,n=$.extend(!0,{},L.interactive),L.interactive=X(L.interactive),I=L.interactive,W(),e=I.theme,e=s.a.isArray(e)?e.map((function(t){return"lab-theme-"+t})).join(" "):e?"lab-theme-"+e:"",g.alterClass("lab-theme-*",e);for(var i=0,r=(R=I.models).length;i<r;i++)N[R[i].id]=R[i];var o=R[0];o&&o.url?(J(o.id),K()):o&&o.model&&(K(),J(o.id,o.model))}function K(){var t;j=[],z={},x=[],_=[],V=[],t=I.lang,it.init({lng:t,resources:at,fallbackLng:"en-US",initImmediate:!1,interpolation:{prefix:"__",suffix:"__",escapeValue:!1}}),ot.a.i18n.lang=t,b=it,ct("#lang-icon",L),P=new Cn(".lab-dialog-container",b,I),M=new bn(".lab-dialog-container",e,b,I),E=I.about||I.subtitle?new mn(".lab-dialog-container",b,I):P;var n=L.interactive.models[0];(c=function(t,e,n){var i=t||"md2d";if(null===nl[i])throw new Error("Couldn't understand modelType '"+i+"'!");return new nl[i](e,n,L)}(n.type,n.modelUrl,null)).on("modelReset",Z),T=new jt(L,null),c.ScriptingAPI&&T.extend(c.ScriptingAPI),T.exposeScriptingAPI(),C={},I.dataSets.forEach((function(t){new vt(t,L)})),I.helpTips.length>0&&(y=new on(I.helpTips,v)),(I.helpOnLoad||I.aboutOnLoad)&&L.on("interactiveRendered.helpOnLoad",(function(){L.on("interactiveRendered.helpOnLoad",null);var t=function(t){var e,n=0,i=t.length;if(0===i)return n;for(e=0;e<i;e++)n=(n<<5)-n+t.charCodeAt(e),n&=n;return n}(JSON.stringify(I));y&&I.helpOnLoad&&!cn("lab-help-"+t)&&(y.start(),un("lab-help-"+t,!0)),I.aboutOnLoad&&!cn("lab-about-"+t)&&(E.open(),un("lab-about-"+t,!0))})),ln(g);for(var i=L.interactive.components||[],r=0,a=i.length;r<a;r++)q(i[r]);S=new Ot(L),k=new Lt({config:I.logging||p.a.validateCompleteness(st.logging,{}),componentByID:z,additionalComponents:[E,M,P,y],boundProperties:lt(),interactivesController:L}),I.experiment&&(o=new tl(I.experiment,L)),G()}function J(t,e,n,a){var l,u,h,d=function(t){if(N[t])return N[t];throw new Error("No model found with id "+t)}(t);function p(t,e,n,r){i=$.extend(!0,{},e);var a=function(t,e,n){var i,r;function o(t,e){var n;for(n in t)void 0===e[n]?s.a.isArray(t[n])?e[n]=$.extend(!0,[],t[n]):null===t[n]?e[n]=null:"object"===el(t[n])?e[n]=$.extend(!0,{},t[n]):e[n]=t[n]:"object"!==el(e[n])||e[n]instanceof Array?e[n]instanceof Array&&t[n]instanceof Array&&(e[n]=$.extend(!0,t[n],e[n])):e[n]=o(t[n],e[n]);return e}return r=$.extend(!0,{},n),r=o(t.viewOptions||{},r),(i=o(t||{},i=$.extend(!0,{},e))).viewOptions=r,i}(e,u,l);if(!c)throw new Error("REF something went wrong");c.reload(t,a,!0),f=c.model,g.off("keydown.interactiveController"),c&&c.enableKeyboardHandlers()&&g.on("keydown.interactiveController",(function(t){switch(t.keycode||t.which){case 13:t.preventDefault(),T.api.start();break;case 32:t.preventDefault(),T.api.isStopped()?T.api.start():T.api.stop();break;case 37:t.preventDefault(),T.api.isStopped()?T.api.stepBack():T.api.stop();break;case 39:t.preventDefault(),T.api.isStopped()?T.api.stepForward():T.api.stop()}})),T.bindModel(f),T.exposeScriptingAPI(),A.bindModel(f),nt("basic",L.currentModel.outputs,I.outputs),function(t,e){if(t||e){var n,i,r,o,a={};for(n=(e||[]).concat(t||[]),i=0;i<n.length;i++)r=n[i],o=void 0,r.onChange&&(o=T.makeFunctionInScriptContext("value",Y(r.onChange))),f.defineParameter(r.name,{label:r.label,unitType:r.unitType,unitName:r.unitName,unitPluralName:r.unitPluralName,unitAbbreviation:r.unitAbbreviation},o),void 0!==r.initialValue&&(a[r.name]=rl(r.initialValue));f.set(a)}}(L.currentModel.parameters,I.parameters),nt("filtered",L.currentModel.filteredOutputs,I.filteredOutputs),n&&f.set(n);for(var h=0;h<x.length;h++)x[h]();for(h=0;h<_.length;h++)_[h](f,T);var d=null;L.currentModel.onLoad&&(d=T.makeFunctionInScriptContext(Y(L.currentModel.onLoad)))(),o&&o.setOnLoadScript(d),S.init(I.exports||ht()),S.on("canExportData.interactivesController",(function(){c.model.makeInvalidatingChange()})),S.modelCanExportData()&&(c.model.properties.controlButtonStyle="codap"),S.on("modelCanExportData.interactivesController",(function(){c.model.properties.controlButtonStyle="codap"})),H.modelLoaded(r||"initialLoad"),f.ready&&f.ready(),D.setupModel(c),U(),c.initializeView(),H.interactiveRendered(),w=!1}W(),w||(h=rt(n)),m=t,L.currentModel=d,l=d.viewOptions?$.extend(!0,{},d.viewOptions):{controlButtons:"play"},d.modelOptions&&(u=$.extend(!0,{},d.modelOptions)),e?p(d.url,e,h,a):d.model?p(d.url,d.model,h,a):d.url&&$.get(r.a.modelsRootUrl+d.url).done((function(t){t="string"==typeof t?JSON.parse(t):t,p(d.url,t,h,a)})).fail((function(){e={type:"md2d",width:2.5,height:1.5,viewOptions:{backgroundColor:"rgba(245,200,200,255)",showClock:!1,textBoxes:[{text:"Model could not be loaded:",x:0,y:1,width:2.5,height:.25,fontScale:1.4,layer:1,frame:"rectangle",textAlign:"center",strokeOpacity:0,backgroundColor:"rgb(232,231,231)"},{text:d.url,x:0,y:.8,width:2.5,height:.25,fontScale:.9,layer:1,frame:"rectangle",textAlign:"center",strokeOpacity:0,backgroundColor:"rgb(232,231,231)"}]}},p(d.url,e,h,a)}))}function Z(t){B||tt(t)}function tt(t){H.modelReset(t)}function et(t){0===F.length&&t();var e=F.length,n=0,i=!1;function r(){var r=!1;return{proceed:function(){r||(r=!0,n++,i||n!==e||t())},cancel:function(){r||(r=!0,i=!0)}}}F.forEach((function(t){var e=r();t(f,e)||e.proceed()}))}function nt(t,e,n){if(e||n){var i,r,o={};for(i in a(n),a(e),o)if(o.hasOwnProperty(i))switch(r=o[i],t){case"basic":f.defineOutput(r.name,{label:r.label,unitType:r.unitType,unitName:r.unitName,unitPluralName:r.unitPluralName,unitAbbreviation:r.unitAbbreviation},T.makeFunctionInScriptContext(Y(r.value)));break;case"filtered":f.defineFilteredOutput(r.name,{label:r.label,unitType:r.unitType,unitName:r.unitName,unitPluralName:r.unitPluralName,unitAbbreviation:r.unitAbbreviation},r.property,r.type,r.period)}}function a(t){if(t)for(var e=0;e<t.length;e++)o[t[e].name]=t[e]}}function rt(t){var e;I.propertiesToRetain?e=I.propertiesToRetain:S.canExportData()&&(e=lt().filter(ut));var n=["useDuration","requestedDuration"].filter((function(t){return void 0!==f.properties[t]}));t=(t||[]).concat(n);var i=h.a.uniq(h.a.flatten([e,V,t||[]])).filter(ut),r={};return i.forEach((function(t){r[t]=f.properties[t]})),r}function lt(){var t=h.a.pluck(I.components,"property"),e=h.a.pluck(h.a.where(I.components,{type:"graph"}),"properties");return h.a.without(h.a.uniq(h.a.flatten([t,e])),void 0)}function ut(t){return!!f&&!!f.isPropertyWritable&&f.isPropertyWritable(t)}function ht(){var t=lt(),e=[],n=t.filter(ut),i=h.a.difference(t,n);return f&&"md2d"===f.properties.type&&(e="md2d"===f.properties.unitsScheme?["kineticEnergy","potentialEnergy","temperature"]:["kineticEnergy","potentialEnergy"]),{perRun:n,perTick:i=h.a.uniq(i.concat(e))}}return L={get interactiveContainer(){return v},get scriptingAPI(){return T},get helpSystem(){return y},get i18n(){return b},get modelController(){return c},get randomSeed(){return O},get exportController(){return S},get defaultExports(){return ht()},get propertiesToRetain(){return rt()},get fontFamily(){return g.css("font-family")},getModel:function(){return f},getDataSet:function(t){return C[t]},addDataSet:function(t,e){x.push($.proxy(t.modelLoadedCallback,t)),e||(C[t.name]=t)},getScriptingAPI:function(){return T},getModelController:function(){return c},getComponent:function(t){return z[t]},getNextTabIndex:function(){var t=-1;return function(){return t++}},loadInteractive:Q,requestInteractiveAt:function(t){H.interactiveRequested(t)},reloadInteractive:function(){f.stop(),et((function(){H.interactiveWillReload(),L.loadInteractive(n)}))},loadModel:J,reloadModel:function(t){t||(t={}),t.cause||(t.cause="reload"),f.stop(),et((function(){W(),L.loadModel(m,i,t.propertiesToRetain,t.cause)}))},resetModel:function(t){f.stop(),et((function(){var e=rt((t=t||{}).propertiesToRetain);B=!0,c.reset(t.cause),f.set(e),tt(t.cause),B=!1}))},logAction:function(t,e){k&&k.logAction(t,e)},updateModelView:function(){c.updateView()},repaintModelView:function(){c.repaint()},resize:function(){U(),H.resize()},on:function(t,e){"willResetModel"===t?F.push(e):H.on(t,e)},get:function(t){return I[t]},serialize:function(){var t,e,n;if(t={title:I.title,publicationStatus:I.publicationStatus,labEnvironment:I.labEnvironment,subtitle:I.subtitle,category:I.category,subCategory:I.subCategory,screenshot:I.screenshot,aspectRatio:I.aspectRatio,fontScale:I.fontScale,lang:I.lang,i18nMetadata:I.i18nMetadata,credits:I.credits,helpOnLoad:I.helpOnLoad,aboutOnLoad:I.aboutOnLoad,about:s.a.isArray(I.about)?$.extend(!0,[],I.about):I.about,theme:I.theme,showTopBar:I.showTopBar,showBottomBar:I.showBottomBar,padding:I.padding,models:$.extend(!0,[],I.models),propertiesToRetain:$.extend(!0,[],I.propertiesToRetain),parameters:$.extend(!0,[],I.parameters),outputs:$.extend(!0,[],I.outputs),filteredOutputs:$.extend(!0,[],I.filteredOutputs),helpTips:$.extend(!0,[],I.helpTips)},void 0!==f&&void 0!==f.get){var i=function(){for(var e=0,n=t.models.length;e<n;e++)if(t.models[e].id===m)return t.models[e].parameters||[];return[]}(),r=t.parameters,o={};i.forEach((function(t){o[t.name]=!0;var e=f.get(t.name);void 0!==e&&(t.initialValue=rl(e))})),r.forEach((function(t){if(!o[t.name]){var e=f.get(t.name);void 0!==e&&(t.initialValue=rl(e))}}))}for(var a in void 0!==I.importedFrom&&(t.importedFrom=I.importedFrom),void 0!==I.exports&&(t.exports=$.extend(!0,{},I.exports)),void 0!==I.logging&&(t.logging=$.extend(!0,{},I.logging)),void 0!==I.experiment&&(t.experiment=$.extend(!0,{},I.experiment)),void 0!==I.randomSeed&&(t.randomSeed=I.randomSeed),t.dataSets=[],C)t.dataSets.push(C[a].serialize());for(t.components=[],e=0,n=j.length;e<n;e++)j[e].serialize&&t.components.push(j[e].serialize());return t.layout=$.extend(!0,{},I.layout),"string"==typeof I.template?t.template=I.template:t.template=$.extend(!0,[],I.template),t},benchmarks:[{name:"interactive",numeric:!1,run:function(t){t(window.location.pathname+window.location.hash)}},{name:"layout (iterations)",numeric:!0,formatter:d3.format("g"),run:function(t){t(D.layoutInteractive())}},{name:"layout (ms)",numeric:!0,formatter:d3.format("5.1f"),run:function(t){var e=+Date.now();D.layoutInteractive(),t(Date.now()-e)}}],getLoadedModelId:function(){return m},validateInteractive:X},(g=$(e)).addClass("lab-interactive-container"),D=new Tn.a,L.on("resize.share-dialog",(function(){M.updateIframeSize()})),A=new $e(L),null!=t&&Q(t),L},window.Lab.benchmark=We,window.Lab.importExport={codapInterface:At,netlogoImporter:sl}},42:function(t,e,n){"use strict";var i={vacuum:{forceType:0,dielectricConstant:1,color:"#eee"},oil:{forceType:-1,dielectricConstant:10,color:"#f5f1dd"},water:{forceType:1,dielectricConstant:80,color:"#B8EBF0"}};e.a=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e;var n=i[this.type];if(null==n)throw new Error("Solvent: unknown type. Use 'vacuum', 'oil' or 'water'.");for(var r in n){var o=n[r];this[r]=o}}},5:function(t,e,n){(function(t,n){var i;!function(){var r="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this||{},o=r._,a=Array.prototype,s=Object.prototype,l="undefined"!=typeof Symbol?Symbol.prototype:null,u=a.push,c=a.slice,h=s.toString,d=s.hasOwnProperty,p=Array.isArray,f=Object.keys,m=Object.create,g=function(){},v=function(t){return t instanceof v?t:this instanceof v?void(this._wrapped=t):new v(t)};e.nodeType?r._=v:(!n.nodeType&&n.exports&&(e=n.exports=v),e._=v),v.VERSION="1.9.2";var y,b=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return function(){return t.apply(e,arguments)}},_=function(t,e,n){return v.iteratee!==y?v.iteratee(t,e):null==t?v.identity:v.isFunction(t)?b(t,e,n):v.isObject(t)&&!v.isArray(t)?v.matcher(t):v.property(t)};v.iteratee=y=function(t,e){return _(t,e,1/0)};var x=function(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),i=Array(n),r=0;r<n;r++)i[r]=arguments[r+e];switch(e){case 0:return t.call(this,i);case 1:return t.call(this,arguments[0],i);case 2:return t.call(this,arguments[0],arguments[1],i)}var o=Array(e+1);for(r=0;r<e;r++)o[r]=arguments[r];return o[e]=i,t.apply(this,o)}},w=function(t){if(!v.isObject(t))return{};if(m)return m(t);g.prototype=t;var e=new g;return g.prototype=null,e},C=function(t){return function(e){return null==e?void 0:e[t]}},T=function(t,e){return null!=t&&d.call(t,e)},S=function(t,e){for(var n=e.length,i=0;i<n;i++){if(null==t)return;t=t[e[i]]}return n?t:void 0},k=Math.pow(2,53)-1,A=C("length"),E=function(t){var e=A(t);return"number"==typeof e&&e>=0&&e<=k};v.each=v.forEach=function(t,e,n){var i,r;if(e=b(e,n),E(t))for(i=0,r=t.length;i<r;i++)e(t[i],i,t);else{var o=v.keys(t);for(i=0,r=o.length;i<r;i++)e(t[o[i]],o[i],t)}return t},v.map=v.collect=function(t,e,n){e=_(e,n);for(var i=!E(t)&&v.keys(t),r=(i||t).length,o=Array(r),a=0;a<r;a++){var s=i?i[a]:a;o[a]=e(t[s],s,t)}return o};var M=function(t){var e=function(e,n,i,r){var o=!E(e)&&v.keys(e),a=(o||e).length,s=t>0?0:a-1;for(r||(i=e[o?o[s]:s],s+=t);s>=0&&s<a;s+=t){var l=o?o[s]:s;i=n(i,e[l],l,e)}return i};return function(t,n,i,r){var o=arguments.length>=3;return e(t,b(n,r,4),i,o)}};v.reduce=v.foldl=v.inject=M(1),v.reduceRight=v.foldr=M(-1),v.find=v.detect=function(t,e,n){var i=(E(t)?v.findIndex:v.findKey)(t,e,n);if(void 0!==i&&-1!==i)return t[i]},v.filter=v.select=function(t,e,n){var i=[];return e=_(e,n),v.each(t,(function(t,n,r){e(t,n,r)&&i.push(t)})),i},v.reject=function(t,e,n){return v.filter(t,v.negate(_(e)),n)},v.every=v.all=function(t,e,n){e=_(e,n);for(var i=!E(t)&&v.keys(t),r=(i||t).length,o=0;o<r;o++){var a=i?i[o]:o;if(!e(t[a],a,t))return!1}return!0},v.some=v.any=function(t,e,n){e=_(e,n);for(var i=!E(t)&&v.keys(t),r=(i||t).length,o=0;o<r;o++){var a=i?i[o]:o;if(e(t[a],a,t))return!0}return!1},v.contains=v.includes=v.include=function(t,e,n,i){return E(t)||(t=v.values(t)),("number"!=typeof n||i)&&(n=0),v.indexOf(t,e,n)>=0},v.invoke=x((function(t,e,n){var i,r;return v.isFunction(e)?r=e:v.isArray(e)&&(i=e.slice(0,-1),e=e[e.length-1]),v.map(t,(function(t){var o=r;if(!o){if(i&&i.length&&(t=S(t,i)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)}))})),v.pluck=function(t,e){return v.map(t,v.property(e))},v.where=function(t,e){return v.filter(t,v.matcher(e))},v.findWhere=function(t,e){return v.find(t,v.matcher(e))},v.max=function(t,e,n){var i,r,o=-1/0,a=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var s=0,l=(t=E(t)?t:v.values(t)).length;s<l;s++)null!=(i=t[s])&&i>o&&(o=i);else e=_(e,n),v.each(t,(function(t,n,i){((r=e(t,n,i))>a||r===-1/0&&o===-1/0)&&(o=t,a=r)}));return o},v.min=function(t,e,n){var i,r,o=1/0,a=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var s=0,l=(t=E(t)?t:v.values(t)).length;s<l;s++)null!=(i=t[s])&&i<o&&(o=i);else e=_(e,n),v.each(t,(function(t,n,i){((r=e(t,n,i))<a||r===1/0&&o===1/0)&&(o=t,a=r)}));return o},v.shuffle=function(t){return v.sample(t,1/0)},v.sample=function(t,e,n){if(null==e||n)return E(t)||(t=v.values(t)),t[v.random(t.length-1)];var i=E(t)?v.clone(t):v.values(t),r=A(i);e=Math.max(Math.min(e,r),0);for(var o=r-1,a=0;a<e;a++){var s=v.random(a,o),l=i[a];i[a]=i[s],i[s]=l}return i.slice(0,e)},v.sortBy=function(t,e,n){var i=0;return e=_(e,n),v.pluck(v.map(t,(function(t,n,r){return{value:t,index:i++,criteria:e(t,n,r)}})).sort((function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index})),"value")};var P=function(t,e){return function(n,i,r){var o=e?[[],[]]:{};return i=_(i,r),v.each(n,(function(e,r){var a=i(e,r,n);t(o,e,a)})),o}};v.groupBy=P((function(t,e,n){T(t,n)?t[n].push(e):t[n]=[e]})),v.indexBy=P((function(t,e,n){t[n]=e})),v.countBy=P((function(t,e,n){T(t,n)?t[n]++:t[n]=1}));var D=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;v.toArray=function(t){return t?v.isArray(t)?c.call(t):v.isString(t)?t.match(D):E(t)?v.map(t,v.identity):v.values(t):[]},v.size=function(t){return null==t?0:E(t)?t.length:v.keys(t).length},v.partition=P((function(t,e,n){t[n?0:1].push(e)}),!0),v.first=v.head=v.take=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[0]:v.initial(t,t.length-e)},v.initial=function(t,e,n){return c.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},v.last=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[t.length-1]:v.rest(t,Math.max(0,t.length-e))},v.rest=v.tail=v.drop=function(t,e,n){return c.call(t,null==e||n?1:e)},v.compact=function(t){return v.filter(t,Boolean)};var O=function(t,e,n,i){for(var r=(i=i||[]).length,o=0,a=A(t);o<a;o++){var s=t[o];if(E(s)&&(v.isArray(s)||v.isArguments(s)))if(e)for(var l=0,u=s.length;l<u;)i[r++]=s[l++];else O(s,e,n,i),r=i.length;else n||(i[r++]=s)}return i};v.flatten=function(t,e){return O(t,e,!1)},v.without=x((function(t,e){return v.difference(t,e)})),v.uniq=v.unique=function(t,e,n,i){v.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=_(n,i));for(var r=[],o=[],a=0,s=A(t);a<s;a++){var l=t[a],u=n?n(l,a,t):l;e&&!n?(a&&o===u||r.push(l),o=u):n?v.contains(o,u)||(o.push(u),r.push(l)):v.contains(r,l)||r.push(l)}return r},v.union=x((function(t){return v.uniq(O(t,!0,!0))})),v.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=A(t);i<r;i++){var o=t[i];if(!v.contains(e,o)){var a;for(a=1;a<n&&v.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},v.difference=x((function(t,e){return e=O(e,!0,!0),v.filter(t,(function(t){return!v.contains(e,t)}))})),v.unzip=function(t){for(var e=t&&v.max(t,A).length||0,n=Array(e),i=0;i<e;i++)n[i]=v.pluck(t,i);return n},v.zip=x(v.unzip),v.object=function(t,e){for(var n={},i=0,r=A(t);i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n};var I=function(t){return function(e,n,i){n=_(n,i);for(var r=A(e),o=t>0?0:r-1;o>=0&&o<r;o+=t)if(n(e[o],o,e))return o;return-1}};v.findIndex=I(1),v.findLastIndex=I(-1),v.sortedIndex=function(t,e,n,i){for(var r=(n=_(n,i,1))(e),o=0,a=A(t);o<a;){var s=Math.floor((o+a)/2);n(t[s])<r?o=s+1:a=s}return o};var L=function(t,e,n){return function(i,r,o){var a=0,s=A(i);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return i[o=n(i,r)]===r?o:-1;if(r!=r)return(o=e(c.call(i,a,s),v.isNaN))>=0?o+a:-1;for(o=t>0?a:s-1;o>=0&&o<s;o+=t)if(i[o]===r)return o;return-1}};v.indexOf=L(1,v.findIndex,v.sortedIndex),v.lastIndexOf=L(-1,v.findLastIndex),v.range=function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;o<i;o++,t+=n)r[o]=t;return r},v.chunk=function(t,e){if(null==e||e<1)return[];for(var n=[],i=0,r=t.length;i<r;)n.push(c.call(t,i,i+=e));return n};var R=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var o=w(t.prototype),a=t.apply(o,r);return v.isObject(a)?a:o};v.bind=x((function(t,e,n){if(!v.isFunction(t))throw new TypeError("Bind must be called on a function");var i=x((function(r){return R(t,i,e,this,n.concat(r))}));return i})),v.partial=x((function(t,e){var n=v.partial.placeholder,i=function(){for(var r=0,o=e.length,a=Array(o),s=0;s<o;s++)a[s]=e[s]===n?arguments[r++]:e[s];for(;r<arguments.length;)a.push(arguments[r++]);return R(t,i,this,this,a)};return i})),v.partial.placeholder=v,v.bindAll=x((function(t,e){var n=(e=O(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var i=e[n];t[i]=v.bind(t[i],t)}})),v.memoize=function(t,e){var n=function(i){var r=n.cache,o=""+(e?e.apply(this,arguments):i);return T(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return n.cache={},n},v.delay=x((function(t,e,n){return setTimeout((function(){return t.apply(null,n)}),e)})),v.defer=v.partial(v.delay,v,1),v.throttle=function(t,e,n){var i,r,o,a,s=0;n||(n={});var l=function(){s=!1===n.leading?0:v.now(),i=null,a=t.apply(r,o),i||(r=o=null)},u=function(){var u=v.now();s||!1!==n.leading||(s=u);var c=e-(u-s);return r=this,o=arguments,c<=0||c>e?(i&&(clearTimeout(i),i=null),s=u,a=t.apply(r,o),i||(r=o=null)):i||!1===n.trailing||(i=setTimeout(l,c)),a};return u.cancel=function(){clearTimeout(i),s=0,i=r=o=null},u},v.debounce=function(t,e,n){var i,r,o=function(e,n){i=null,n&&(r=t.apply(e,n))},a=x((function(a){if(i&&clearTimeout(i),n){var s=!i;i=setTimeout(o,e),s&&(r=t.apply(this,a))}else i=v.delay(o,e,this,a);return r}));return a.cancel=function(){clearTimeout(i),i=null},a},v.wrap=function(t,e){return v.partial(e,t)},v.negate=function(t){return function(){return!t.apply(this,arguments)}},v.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},v.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},v.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},v.once=v.partial(v.before,2),v.restArguments=x;var N=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],B=function(t,e){var n=F.length,i=t.constructor,r=v.isFunction(i)&&i.prototype||s,o="constructor";for(T(t,o)&&!v.contains(e,o)&&e.push(o);n--;)(o=F[n])in t&&t[o]!==r[o]&&!v.contains(e,o)&&e.push(o)};v.keys=function(t){if(!v.isObject(t))return[];if(f)return f(t);var e=[];for(var n in t)T(t,n)&&e.push(n);return N&&B(t,e),e},v.allKeys=function(t){if(!v.isObject(t))return[];var e=[];for(var n in t)e.push(n);return N&&B(t,e),e},v.values=function(t){for(var e=v.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},v.mapObject=function(t,e,n){e=_(e,n);for(var i=v.keys(t),r=i.length,o={},a=0;a<r;a++){var s=i[a];o[s]=e(t[s],s,t)}return o},v.pairs=function(t){for(var e=v.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i},v.invert=function(t){for(var e={},n=v.keys(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e},v.functions=v.methods=function(t){var e=[];for(var n in t)v.isFunction(t[n])&&e.push(n);return e.sort()};var z=function(t,e){return function(n){var i=arguments.length;if(e&&(n=Object(n)),i<2||null==n)return n;for(var r=1;r<i;r++)for(var o=arguments[r],a=t(o),s=a.length,l=0;l<s;l++){var u=a[l];e&&void 0!==n[u]||(n[u]=o[u])}return n}};v.extend=z(v.allKeys),v.extendOwn=v.assign=z(v.keys),v.findKey=function(t,e,n){e=_(e,n);for(var i,r=v.keys(t),o=0,a=r.length;o<a;o++)if(e(t[i=r[o]],i,t))return i};var j,V,H=function(t,e,n){return e in n};v.pick=x((function(t,e){var n={},i=e[0];if(null==t)return n;v.isFunction(i)?(e.length>1&&(i=b(i,e[1])),e=v.allKeys(t)):(i=H,e=O(e,!1,!1),t=Object(t));for(var r=0,o=e.length;r<o;r++){var a=e[r],s=t[a];i(s,a,t)&&(n[a]=s)}return n})),v.omit=x((function(t,e){var n,i=e[0];return v.isFunction(i)?(i=v.negate(i),e.length>1&&(n=e[1])):(e=v.map(O(e,!1,!1),String),i=function(t,n){return!v.contains(e,n)}),v.pick(t,i,n)})),v.defaults=z(v.allKeys,!0),v.create=function(t,e){var n=w(t);return e&&v.extendOwn(n,e),n},v.clone=function(t){return v.isObject(t)?v.isArray(t)?t.slice():v.extend({},t):t},v.tap=function(t,e){return e(t),t},v.isMatch=function(t,e){var n=v.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),o=0;o<i;o++){var a=n[o];if(e[a]!==r[a]||!(a in r))return!1}return!0},j=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var r=typeof t;return("function"===r||"object"===r||"object"==typeof e)&&V(t,e,n,i)},V=function(t,e,n,i){t instanceof v&&(t=t._wrapped),e instanceof v&&(e=e._wrapped);var r=h.call(t);if(r!==h.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return l.valueOf.call(t)===l.valueOf.call(e)}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!(v.isFunction(a)&&a instanceof a&&v.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}i=i||[];for(var u=(n=n||[]).length;u--;)if(n[u]===t)return i[u]===e;if(n.push(t),i.push(e),o){if((u=t.length)!==e.length)return!1;for(;u--;)if(!j(t[u],e[u],n,i))return!1}else{var c,d=v.keys(t);if(u=d.length,v.keys(e).length!==u)return!1;for(;u--;)if(c=d[u],!T(e,c)||!j(t[c],e[c],n,i))return!1}return n.pop(),i.pop(),!0},v.isEqual=function(t,e){return j(t,e)},v.isEmpty=function(t){return null==t||(E(t)&&(v.isArray(t)||v.isString(t)||v.isArguments(t))?0===t.length:0===v.keys(t).length)},v.isElement=function(t){return!(!t||1!==t.nodeType)},v.isArray=p||function(t){return"[object Array]"===h.call(t)},v.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},v.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],(function(t){v["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}})),v.isArguments(arguments)||(v.isArguments=function(t){return T(t,"callee")});var W=r.document&&r.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof W&&(v.isFunction=function(t){return"function"==typeof t||!1}),v.isFinite=function(t){return!v.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},v.isNaN=function(t){return v.isNumber(t)&&isNaN(t)},v.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===h.call(t)},v.isNull=function(t){return null===t},v.isUndefined=function(t){return void 0===t},v.has=function(t,e){if(!v.isArray(e))return T(t,e);for(var n=e.length,i=0;i<n;i++){var r=e[i];if(null==t||!d.call(t,r))return!1;t=t[r]}return!!n},v.noConflict=function(){return r._=o,this},v.identity=function(t){return t},v.constant=function(t){return function(){return t}},v.noop=function(){},v.property=function(t){return v.isArray(t)?function(e){return S(e,t)}:C(t)},v.propertyOf=function(t){return null==t?function(){}:function(e){return v.isArray(e)?S(t,e):t[e]}},v.matcher=v.matches=function(t){return t=v.extendOwn({},t),function(e){return v.isMatch(e,t)}},v.times=function(t,e,n){var i=Array(Math.max(0,t));e=b(e,n,1);for(var r=0;r<t;r++)i[r]=e(r);return i},v.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},v.now=Date.now||function(){return(new Date).getTime()};var U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},$=v.invert(U),G=function(t){var e=function(e){return t[e]},n="(?:"+v.keys(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}};v.escape=G(U),v.unescape=G($),v.result=function(t,e,n){v.isArray(e)||(e=[e]);var i=e.length;if(!i)return v.isFunction(n)?n.call(t):n;for(var r=0;r<i;r++){var o=null==t?void 0:t[e[r]];void 0===o&&(o=n,r=i),t=v.isFunction(o)?o.call(t):o}return t};var q=0;v.uniqueId=function(t){var e=++q+"";return t?t+e:e},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Y=/(.)^/,X={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Q=/\\|'|\r|\n|\u2028|\u2029/g,K=function(t){return"\\"+X[t]};v.template=function(t,e,n){!e&&n&&(e=n),e=v.defaults({},e,v.templateSettings);var i,r=RegExp([(e.escape||Y).source,(e.interpolate||Y).source,(e.evaluate||Y).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(r,(function(e,n,i,r,s){return a+=t.slice(o,s).replace(Q,K),o=s+e.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?a+="'+\n((__t=("+i+"))==null?'':__t)+\n'":r&&(a+="';\n"+r+"\n__p+='"),e})),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(e.variable||"obj","_",a)}catch(t){throw t.source=a,t}var s=function(t){return i.call(this,t,v)},l=e.variable||"obj";return s.source="function("+l+"){\n"+a+"}",s},v.chain=function(t){var e=v(t);return e._chain=!0,e};var J=function(t,e){return t._chain?v(e).chain():e};v.mixin=function(t){return v.each(v.functions(t),(function(e){var n=v[e]=t[e];v.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),J(this,n.apply(v,t))}})),v},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=a[t];v.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],J(this,n)}})),v.each(["concat","join","slice"],(function(t){var e=a[t];v.prototype[t]=function(){return J(this,e.apply(this._wrapped,arguments))}})),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return String(this._wrapped)},void 0===(i=function(){return v}.apply(e,[]))||(n.exports=i)}()}).call(this,n(15),n(14)(t))},55:function(t,e){e.getWindowedAverager=function(t){null==t&&(t=1e3);var e=0,n=[],i=0;return function(r){return i-=n[e]||0,i+=r,n[e]=r,++e===t&&(e=0),n.length===t?i/t:NaN}},e.getAngleBetweenVec=function(t,e,n,i,r,o){var a=t-r,s=n-r,l=e-o,u=i-o,c=a*a+l*l,h=s*s+u*u,d=(a*s+l*u)/(Math.sqrt(c)*Math.sqrt(h));return d>1?d=1:d<-1&&(d=-1),Math.acos(d)}},56:function(t,e,n){!function(){"use strict";var e="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=t.exports,i="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,r=function(){for(var t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,r=n.length,o={};i<r;i++)if((t=n[i])&&t[1]in e){for(i=0;i<t.length;i++)o[n[0][i]]=t[i];return o}return!1}(),o={change:r.fullscreenchange,error:r.fullscreenerror},a={request:function(t){return new Promise(function(n,o){var a,s=r.requestFullscreen,l=function(){this.off("change",l),n()}.bind(this);this.on("change",l),t=t||e.documentElement,a=/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?t[s]():t[s](i?Element.ALLOW_KEYBOARD_INPUT:{}),Promise.resolve(a).catch(o)}.bind(this))},exit:function(){return new Promise(function(t){if(this.isFullscreen){var n=function(){this.off("change",n),t()}.bind(this);e[r.exitFullscreen](),this.on("change",n)}else t()}.bind(this))},toggle:function(t){return this.isFullscreen?this.exit():this.request(t)},onchange:function(t){this.on("change",t)},onerror:function(t){this.on("error",t)},on:function(t,n){var i=o[t];i&&e.addEventListener(i,n,!1)},off:function(t,n){var i=o[t];i&&e.removeEventListener(i,n,!1)},raw:r};r?(Object.defineProperties(a,{isFullscreen:{get:function(){return Boolean(e[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return e[r.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(e[r.fullscreenEnabled])}}}),n?(t.exports=a,t.exports.default=a):window.screenfull=a):n?t.exports=!1:window.screenfull=!1}()},57:function(t,e,n){var i,r,o;r="undefined"!=typeof window?window:this,o=function(n,r){var o=[],a=n.document,s=o.slice,l=o.concat,u=o.push,c=o.indexOf,h={},d=h.toString,p=h.hasOwnProperty,f={},m=function(t,e){return new m.fn.init(t,e)},g=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,v=/^-ms-/,y=/-([\da-z])/gi,b=function(t,e){return e.toUpperCase()};function _(t){var e=!!t&&"length"in t&&t.length,n=m.type(t);return"function"!==n&&!m.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}m.fn=m.prototype={jquery:"2.2.4",constructor:m,selector:"",length:0,toArray:function(){return s.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:s.call(this)},pushStack:function(t){var e=m.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return m.each(this,t)},map:function(t){return this.pushStack(m.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:o.sort,splice:o.splice},m.extend=m.fn.extend=function(){var t,e,n,i,r,o,a=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[s]||{},s++),"object"==typeof a||m.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(t=arguments[s]))for(e in t)n=a[e],a!==(i=t[e])&&(u&&i&&(m.isPlainObject(i)||(r=m.isArray(i)))?(r?(r=!1,o=n&&m.isArray(n)?n:[]):o=n&&m.isPlainObject(n)?n:{},a[e]=m.extend(u,o,i)):void 0!==i&&(a[e]=i));return a},m.extend({expando:"jQuery"+("2.2.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===m.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=t&&t.toString();return!m.isArray(t)&&e-parseFloat(e)+1>=0},isPlainObject:function(t){var e;if("object"!==m.type(t)||t.nodeType||m.isWindow(t))return!1;if(t.constructor&&!p.call(t,"constructor")&&!p.call(t.constructor.prototype||{},"isPrototypeOf"))return!1;for(e in t);return void 0===e||p.call(t,e)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?h[d.call(t)]||"object":typeof t},globalEval:function(t){var e,n=eval;(t=m.trim(t))&&(1===t.indexOf("use strict")?((e=a.createElement("script")).text=t,a.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(v,"ms-").replace(y,b)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var n,i=0;if(_(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},trim:function(t){return null==t?"":(t+"").replace(g,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(_(Object(t))?m.merge(n,"string"==typeof t?[t]:t):u.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:c.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,a=!n;r<o;r++)!e(t[r],r)!==a&&i.push(t[r]);return i},map:function(t,e,n){var i,r,o=0,a=[];if(_(t))for(i=t.length;o<i;o++)null!=(r=e(t[o],o,n))&&a.push(r);else for(o in t)null!=(r=e(t[o],o,n))&&a.push(r);return l.apply([],a)},guid:1,proxy:function(t,e){var n,i,r;if("string"==typeof e&&(n=t[e],e=t,t=n),m.isFunction(t))return i=s.call(arguments,2),(r=function(){return t.apply(e||this,i.concat(s.call(arguments)))}).guid=t.guid=t.guid||m.guid++,r},now:Date.now,support:f}),"function"==typeof Symbol&&(m.fn[Symbol.iterator]=o[Symbol.iterator]),m.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){h["[object "+e+"]"]=e.toLowerCase()}));var x=function(t){var e,n,i,r,o,a,s,l,u,c,h,d,p,f,m,g,v,y,b,_="sizzle"+1*new Date,x=t.document,w=0,C=0,T=rt(),S=rt(),k=rt(),A=function(t,e){return t===e&&(h=!0),0},E={}.hasOwnProperty,M=[],P=M.pop,D=M.push,O=M.push,I=M.slice,L=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",B="\\["+N+"*("+F+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+N+"*\\]",z=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",j=new RegExp(N+"+","g"),V=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g"),H=new RegExp("^"+N+"*,"+N+"*"),W=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),U=new RegExp("="+N+"*([^\\]'\"]*?)"+N+"*\\]","g"),$=new RegExp(z),G=new RegExp("^"+F+"$"),q={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,J=/[+~]/,Z=/'|\\/g,tt=new RegExp("\\\\([\\da-f]{1,6}"+N+"?|("+N+")|.)","ig"),et=function(t,e,n){var i="0x"+e-65536;return i!=i||n?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},nt=function(){d()};try{O.apply(M=I.call(x.childNodes),x.childNodes),M[x.childNodes.length].nodeType}catch(t){O={apply:M.length?function(t,e){D.apply(t,I.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function it(t,e,i,r){var o,s,u,c,h,f,v,y,w=e&&e.ownerDocument,C=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==C&&9!==C&&11!==C)return i;if(!r&&((e?e.ownerDocument||e:x)!==p&&d(e),e=e||p,m)){if(11!==C&&(f=K.exec(t)))if(o=f[1]){if(9===C){if(!(u=e.getElementById(o)))return i;if(u.id===o)return i.push(u),i}else if(w&&(u=w.getElementById(o))&&b(e,u)&&u.id===o)return i.push(u),i}else{if(f[2])return O.apply(i,e.getElementsByTagName(t)),i;if((o=f[3])&&n.getElementsByClassName&&e.getElementsByClassName)return O.apply(i,e.getElementsByClassName(o)),i}if(n.qsa&&!k[t+" "]&&(!g||!g.test(t))){if(1!==C)w=e,y=t;else if("object"!==e.nodeName.toLowerCase()){for((c=e.getAttribute("id"))?c=c.replace(Z,"\\$&"):e.setAttribute("id",c=_),s=(v=a(t)).length,h=G.test(c)?"#"+c:"[id='"+c+"']";s--;)v[s]=h+" "+ft(v[s]);y=v.join(","),w=J.test(t)&&dt(e.parentNode)||e}if(y)try{return O.apply(i,w.querySelectorAll(y)),i}catch(t){}finally{c===_&&e.removeAttribute("id")}}}return l(t.replace(V,"$1"),e,i,r)}function rt(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function ot(t){return t[_]=!0,t}function at(t){var e=p.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function st(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function lt(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||1<<31)-(~t.sourceIndex||1<<31);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ut(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ct(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function ht(t){return ot((function(e){return e=+e,ot((function(n,i){for(var r,o=t([],n.length,e),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))}))}))}function dt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=it.support={},o=it.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},d=it.setDocument=function(t){var e,r,a=t?t.ownerDocument||t:x;return a!==p&&9===a.nodeType&&a.documentElement?(f=(p=a).documentElement,m=!o(p),(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",nt,!1):r.attachEvent&&r.attachEvent("onunload",nt)),n.attributes=at((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=at((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=Q.test(p.getElementsByClassName),n.getById=at((function(t){return f.appendChild(t).id=_,!p.getElementsByName||!p.getElementsByName(_).length})),n.getById?(i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n=e.getElementById(t);return n?[n]:[]}},i.filter.ID=function(t){var e=t.replace(tt,et);return function(t){return t.getAttribute("id")===e}}):(delete i.find.ID,i.filter.ID=function(t){var e=t.replace(tt,et);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&m)return e.getElementsByClassName(t)},v=[],g=[],(n.qsa=Q.test(p.querySelectorAll))&&(at((function(t){f.appendChild(t).innerHTML="<a id='"+_+"'></a><select id='"+_+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+N+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+N+"*(?:value|"+R+")"),t.querySelectorAll("[id~="+_+"-]").length||g.push("~="),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+_+"+*").length||g.push(".#.+[+~]")})),at((function(t){var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+N+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")}))),(n.matchesSelector=Q.test(y=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&at((function(t){n.disconnectedMatch=y.call(t,"div"),y.call(t,"[s!='']:x"),v.push("!=",z)})),g=g.length&&new RegExp(g.join("|")),v=v.length&&new RegExp(v.join("|")),e=Q.test(f.compareDocumentPosition),b=e||Q.test(f.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},A=e?function(t,e){if(t===e)return h=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t===p||t.ownerDocument===x&&b(x,t)?-1:e===p||e.ownerDocument===x&&b(x,e)?1:c?L(c,t)-L(c,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,a=[t],s=[e];if(!r||!o)return t===p?-1:e===p?1:r?-1:o?1:c?L(c,t)-L(c,e):0;if(r===o)return lt(t,e);for(n=t;n=n.parentNode;)a.unshift(n);for(n=e;n=n.parentNode;)s.unshift(n);for(;a[i]===s[i];)i++;return i?lt(a[i],s[i]):a[i]===x?-1:s[i]===x?1:0},p):p},it.matches=function(t,e){return it(t,null,null,e)},it.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&d(t),e=e.replace(U,"='$1']"),n.matchesSelector&&m&&!k[e+" "]&&(!v||!v.test(e))&&(!g||!g.test(e)))try{var i=y.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return it(e,p,null,[t]).length>0},it.contains=function(t,e){return(t.ownerDocument||t)!==p&&d(t),b(t,e)},it.attr=function(t,e){(t.ownerDocument||t)!==p&&d(t);var r=i.attrHandle[e.toLowerCase()],o=r&&E.call(i.attrHandle,e.toLowerCase())?r(t,e,!m):void 0;return void 0!==o?o:n.attributes||!m?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},it.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},it.uniqueSort=function(t){var e,i=[],r=0,o=0;if(h=!n.detectDuplicates,c=!n.sortStable&&t.slice(0),t.sort(A),h){for(;e=t[o++];)e===t[o]&&(r=i.push(o));for(;r--;)t.splice(i[r],1)}return c=null,t},r=it.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},(i=it.selectors={cacheLength:50,createPseudo:ot,match:q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(tt,et),t[3]=(t[3]||t[4]||t[5]||"").replace(tt,et),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||it.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&it.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return q.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&$.test(n)&&(e=a(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(tt,et).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=T[t+" "];return e||(e=new RegExp("(^|"+N+")"+t+"("+N+"|$)"))&&T(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(i){var r=it.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r.replace(j," ")+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,l){var u,c,h,d,p,f,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!l&&!s,b=!1;if(g){if(o){for(;m;){for(d=e;d=d[m];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&y){for(b=(p=(u=(c=(h=(d=g)[_]||(d[_]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&u[1])&&u[2],d=p&&g.childNodes[p];d=++p&&d&&d[m]||(b=p=0)||f.pop();)if(1===d.nodeType&&++b&&d===e){c[t]=[w,p,b];break}}else if(y&&(b=p=(u=(c=(h=(d=e)[_]||(d[_]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&u[1]),!1===b)for(;(d=++p&&d&&d[m]||(b=p=0)||f.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++b||(y&&((c=(h=d[_]||(d[_]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[w,b]),d!==e)););return(b-=r)===i||b%i==0&&b/i>=0}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||it.error("unsupported pseudo: "+t);return r[_]?r(e):r.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?ot((function(t,n){for(var i,o=r(t,e),a=o.length;a--;)t[i=L(t,o[a])]=!(n[i]=o[a])})):function(t){return r(t,0,n)}):r}},pseudos:{not:ot((function(t){var e=[],n=[],i=s(t.replace(V,"$1"));return i[_]?ot((function(t,e,n,r){for(var o,a=i(t,null,r,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))})):function(t,r,o){return e[0]=t,i(e,null,o,n),e[0]=null,!n.pop()}})),has:ot((function(t){return function(e){return it(t,e).length>0}})),contains:ot((function(t){return t=t.replace(tt,et),function(e){return(e.textContent||e.innerText||r(e)).indexOf(t)>-1}})),lang:ot((function(t){return G.test(t||"")||it.error("unsupported lang: "+t),t=t.replace(tt,et).toLowerCase(),function(e){var n;do{if(n=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return X.test(t.nodeName)},input:function(t){return Y.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ht((function(){return[0]})),last:ht((function(t,e){return[e-1]})),eq:ht((function(t,e,n){return[n<0?n+e:n]})),even:ht((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:ht((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:ht((function(t,e,n){for(var i=n<0?n+e:n;--i>=0;)t.push(i);return t})),gt:ht((function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t}))}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=ut(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ct(e);function pt(){}function ft(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function mt(t,e,n){var i=e.dir,r=n&&"parentNode"===i,o=C++;return e.first?function(e,n,o){for(;e=e[i];)if(1===e.nodeType||r)return t(e,n,o)}:function(e,n,a){var s,l,u,c=[w,o];if(a){for(;e=e[i];)if((1===e.nodeType||r)&&t(e,n,a))return!0}else for(;e=e[i];)if(1===e.nodeType||r){if((s=(l=(u=e[_]||(e[_]={}))[e.uniqueID]||(u[e.uniqueID]={}))[i])&&s[0]===w&&s[1]===o)return c[2]=s[2];if(l[i]=c,c[2]=t(e,n,a))return!0}}}function gt(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function vt(t,e,n,i,r){for(var o,a=[],s=0,l=t.length,u=null!=e;s<l;s++)(o=t[s])&&(n&&!n(o,i,r)||(a.push(o),u&&e.push(s)));return a}function yt(t,e,n,i,r,o){return i&&!i[_]&&(i=yt(i)),r&&!r[_]&&(r=yt(r,o)),ot((function(o,a,s,l){var u,c,h,d=[],p=[],f=a.length,m=o||function(t,e,n){for(var i=0,r=e.length;i<r;i++)it(t,e[i],n);return n}(e||"*",s.nodeType?[s]:s,[]),g=!t||!o&&e?m:vt(m,d,t,s,l),v=n?r||(o?t:f||i)?[]:a:g;if(n&&n(g,v,s,l),i)for(u=vt(v,p),i(u,[],s,l),c=u.length;c--;)(h=u[c])&&(v[p[c]]=!(g[p[c]]=h));if(o){if(r||t){if(r){for(u=[],c=v.length;c--;)(h=v[c])&&u.push(g[c]=h);r(null,v=[],u,l)}for(c=v.length;c--;)(h=v[c])&&(u=r?L(o,h):d[c])>-1&&(o[u]=!(a[u]=h))}}else v=vt(v===a?v.splice(f,v.length):v),r?r(null,a,v,l):O.apply(a,v)}))}function bt(t){for(var e,n,r,o=t.length,a=i.relative[t[0].type],s=a||i.relative[" "],l=a?1:0,c=mt((function(t){return t===e}),s,!0),h=mt((function(t){return L(e,t)>-1}),s,!0),d=[function(t,n,i){var r=!a&&(i||n!==u)||((e=n).nodeType?c(t,n,i):h(t,n,i));return e=null,r}];l<o;l++)if(n=i.relative[t[l].type])d=[mt(gt(d),n)];else{if((n=i.filter[t[l].type].apply(null,t[l].matches))[_]){for(r=++l;r<o&&!i.relative[t[r].type];r++);return yt(l>1&&gt(d),l>1&&ft(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(V,"$1"),n,l<r&&bt(t.slice(l,r)),r<o&&bt(t=t.slice(r)),r<o&&ft(t))}d.push(n)}return gt(d)}return pt.prototype=i.filters=i.pseudos,i.setFilters=new pt,a=it.tokenize=function(t,e){var n,r,o,a,s,l,u,c=S[t+" "];if(c)return e?0:c.slice(0);for(s=t,l=[],u=i.preFilter;s;){for(a in n&&!(r=H.exec(s))||(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),n=!1,(r=W.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(V," ")}),s=s.slice(n.length)),i.filter)!(r=q[a].exec(s))||u[a]&&!(r=u[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return e?s.length:s?it.error(t):S(t,l).slice(0)},s=it.compile=function(t,e){var n,r=[],o=[],s=k[t+" "];if(!s){for(e||(e=a(t)),n=e.length;n--;)(s=bt(e[n]))[_]?r.push(s):o.push(s);(s=k(t,function(t,e){var n=e.length>0,r=t.length>0,o=function(o,a,s,l,c){var h,f,g,v=0,y="0",b=o&&[],_=[],x=u,C=o||r&&i.find.TAG("*",c),T=w+=null==x?1:Math.random()||.1,S=C.length;for(c&&(u=a===p||a||c);y!==S&&null!=(h=C[y]);y++){if(r&&h){for(f=0,a||h.ownerDocument===p||(d(h),s=!m);g=t[f++];)if(g(h,a||p,s)){l.push(h);break}c&&(w=T)}n&&((h=!g&&h)&&v--,o&&b.push(h))}if(v+=y,n&&y!==v){for(f=0;g=e[f++];)g(b,_,a,s);if(o){if(v>0)for(;y--;)b[y]||_[y]||(_[y]=P.call(l));_=vt(_)}O.apply(l,_),c&&!o&&_.length>0&&v+e.length>1&&it.uniqueSort(l)}return c&&(w=T,u=x),b};return n?ot(o):o}(o,r))).selector=t}return s},l=it.select=function(t,e,r,o){var l,u,c,h,d,p="function"==typeof t&&t,f=!o&&a(t=p.selector||t);if(r=r||[],1===f.length){if((u=f[0]=f[0].slice(0)).length>2&&"ID"===(c=u[0]).type&&n.getById&&9===e.nodeType&&m&&i.relative[u[1].type]){if(!(e=(i.find.ID(c.matches[0].replace(tt,et),e)||[])[0]))return r;p&&(e=e.parentNode),t=t.slice(u.shift().value.length)}for(l=q.needsContext.test(t)?0:u.length;l--&&(c=u[l],!i.relative[h=c.type]);)if((d=i.find[h])&&(o=d(c.matches[0].replace(tt,et),J.test(u[0].type)&&dt(e.parentNode)||e))){if(u.splice(l,1),!(t=o.length&&ft(u)))return O.apply(r,o),r;break}}return(p||s(t,f))(o,e,!m,r,!e||J.test(t)&&dt(e.parentNode)||e),r},n.sortStable=_.split("").sort(A).join("")===_,n.detectDuplicates=!!h,d(),n.sortDetached=at((function(t){return 1&t.compareDocumentPosition(p.createElement("div"))})),at((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||st("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&at((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||st("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),at((function(t){return null==t.getAttribute("disabled")}))||st(R,(function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),it}(n);m.find=x,m.expr=x.selectors,m.expr[":"]=m.expr.pseudos,m.uniqueSort=m.unique=x.uniqueSort,m.text=x.getText,m.isXMLDoc=x.isXML,m.contains=x.contains;var w=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&m(t).is(n))break;i.push(t)}return i},C=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},T=m.expr.match.needsContext,S=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,k=/^.[^:#\[\.,]*$/;function A(t,e,n){if(m.isFunction(e))return m.grep(t,(function(t,i){return!!e.call(t,i,t)!==n}));if(e.nodeType)return m.grep(t,(function(t){return t===e!==n}));if("string"==typeof e){if(k.test(e))return m.filter(e,t,n);e=m.filter(e,t)}return m.grep(t,(function(t){return c.call(e,t)>-1!==n}))}m.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?m.find.matchesSelector(i,t)?[i]:[]:m.find.matches(t,m.grep(e,(function(t){return 1===t.nodeType})))},m.fn.extend({find:function(t){var e,n=this.length,i=[],r=this;if("string"!=typeof t)return this.pushStack(m(t).filter((function(){for(e=0;e<n;e++)if(m.contains(r[e],this))return!0})));for(e=0;e<n;e++)m.find(t,r[e],i);return(i=this.pushStack(n>1?m.unique(i):i)).selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(A(this,t||[],!1))},not:function(t){return this.pushStack(A(this,t||[],!0))},is:function(t){return!!A(this,"string"==typeof t&&T.test(t)?m(t):t||[],!1).length}});var E,M=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(m.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||E,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:M.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof m?e[0]:e,m.merge(this,m.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:a,!0)),S.test(i[1])&&m.isPlainObject(e))for(i in e)m.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=a.getElementById(i[2]))&&r.parentNode&&(this.length=1,this[0]=r),this.context=a,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):m.isFunction(t)?void 0!==n.ready?n.ready(t):t(m):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),m.makeArray(t,this))}).prototype=m.fn,E=m(a);var P=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};function O(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}m.fn.extend({has:function(t){var e=m(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(m.contains(this,e[t]))return!0}))},closest:function(t,e){for(var n,i=0,r=this.length,o=[],a=T.test(t)||"string"!=typeof t?m(t,e||this.context):0;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&m.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?m.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?c.call(m(t),this[0]):c.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(m.uniqueSort(m.merge(this.get(),m(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),m.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return w(t,"parentNode")},parentsUntil:function(t,e,n){return w(t,"parentNode",n)},next:function(t){return O(t,"nextSibling")},prev:function(t){return O(t,"previousSibling")},nextAll:function(t){return w(t,"nextSibling")},prevAll:function(t){return w(t,"previousSibling")},nextUntil:function(t,e,n){return w(t,"nextSibling",n)},prevUntil:function(t,e,n){return w(t,"previousSibling",n)},siblings:function(t){return C((t.parentNode||{}).firstChild,t)},children:function(t){return C(t.firstChild)},contents:function(t){return t.contentDocument||m.merge([],t.childNodes)}},(function(t,e){m.fn[t]=function(n,i){var r=m.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=m.filter(i,r)),this.length>1&&(D[t]||m.uniqueSort(r),P.test(t)&&r.reverse()),this.pushStack(r)}}));var I,L=/\S+/g;function R(){a.removeEventListener("DOMContentLoaded",R),n.removeEventListener("load",R),m.ready()}m.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return m.each(t.match(L)||[],(function(t,n){e[n]=!0})),e}(t):m.extend({},t);var e,n,i,r,o=[],a=[],s=-1,l=function(){for(r=t.once,i=e=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&t.stopOnFalse&&(s=o.length,n=!1);t.memory||(n=!1),e=!1,r&&(o=n?[]:"")},u={add:function(){return o&&(n&&!e&&(s=o.length-1,a.push(n)),function e(n){m.each(n,(function(n,i){m.isFunction(i)?t.unique&&u.has(i)||o.push(i):i&&i.length&&"string"!==m.type(i)&&e(i)}))}(arguments),n&&!e&&l()),this},remove:function(){return m.each(arguments,(function(t,e){for(var n;(n=m.inArray(e,o,n))>-1;)o.splice(n,1),n<=s&&s--})),this},has:function(t){return t?m.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=a=[],n||(o=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],a.push(n),e||l()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},m.extend({Deferred:function(t){var e=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return m.Deferred((function(n){m.each(e,(function(e,o){var a=m.isFunction(t[e])&&t[e];r[o[1]]((function(){var t=a&&a.apply(this,arguments);t&&m.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[o[0]+"With"](this===i?n.promise():this,a?[t]:arguments)}))})),t=null})).promise()},promise:function(t){return null!=t?m.extend(t,i):i}},r={};return i.pipe=i.then,m.each(e,(function(t,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add((function(){n=s}),e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith})),i.promise(r),t&&t.call(r,r),r},when:function(t){var e,n,i,r=0,o=s.call(arguments),a=o.length,l=1!==a||t&&m.isFunction(t.promise)?a:0,u=1===l?t:m.Deferred(),c=function(t,n,i){return function(r){n[t]=this,i[t]=arguments.length>1?s.call(arguments):r,i===e?u.notifyWith(n,i):--l||u.resolveWith(n,i)}};if(a>1)for(e=new Array(a),n=new Array(a),i=new Array(a);r<a;r++)o[r]&&m.isFunction(o[r].promise)?o[r].promise().progress(c(r,n,e)).done(c(r,i,o)).fail(u.reject):--l;return l||u.resolveWith(i,o),u.promise()}}),m.fn.ready=function(t){return m.ready.promise().done(t),this},m.extend({isReady:!1,readyWait:1,holdReady:function(t){t?m.readyWait++:m.ready(!0)},ready:function(t){(!0===t?--m.readyWait:m.isReady)||(m.isReady=!0,!0!==t&&--m.readyWait>0||(I.resolveWith(a,[m]),m.fn.triggerHandler&&(m(a).triggerHandler("ready"),m(a).off("ready"))))}}),m.ready.promise=function(t){return I||(I=m.Deferred(),"complete"===a.readyState||"loading"!==a.readyState&&!a.documentElement.doScroll?n.setTimeout(m.ready):(a.addEventListener("DOMContentLoaded",R),n.addEventListener("load",R))),I.promise(t)},m.ready.promise();var N=function(t,e,n,i,r,o,a){var s=0,l=t.length,u=null==n;if("object"===m.type(n))for(s in r=!0,n)N(t,e,s,n[s],!0,o,a);else if(void 0!==i&&(r=!0,m.isFunction(i)||(a=!0),u&&(a?(e.call(t,i),e=null):(u=e,e=function(t,e,n){return u.call(m(t),n)})),e))for(;s<l;s++)e(t[s],n,a?i:i.call(t[s],s,e(t[s],n)));return r?t:u?e.call(t):l?e(t[0],n):o},F=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function B(){this.expando=m.expando+B.uid++}B.uid=1,B.prototype={register:function(t,e){var n=e||{};return t.nodeType?t[this.expando]=n:Object.defineProperty(t,this.expando,{value:n,writable:!0,configurable:!0}),t[this.expando]},cache:function(t){if(!F(t))return{};var e=t[this.expando];return e||(e={},F(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[e]=n;else for(i in e)r[i]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][e]},access:function(t,e,n){var i;return void 0===e||e&&"string"==typeof e&&void 0===n?void 0!==(i=this.get(t,e))?i:this.get(t,m.camelCase(e)):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i,r,o=t[this.expando];if(void 0!==o){if(void 0===e)this.register(t);else{m.isArray(e)?i=e.concat(e.map(m.camelCase)):(r=m.camelCase(e),i=e in o?[e,r]:(i=r)in o?[i]:i.match(L)||[]),n=i.length;for(;n--;)delete o[i[n]]}(void 0===e||m.isEmptyObject(o))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!m.isEmptyObject(e)}};var z=new B,j=new B,V=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,H=/[A-Z]/g;function W(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(H,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:V.test(n)?m.parseJSON(n):n)}catch(t){}j.set(t,e,n)}else n=void 0;return n}m.extend({hasData:function(t){return j.hasData(t)||z.hasData(t)},data:function(t,e,n){return j.access(t,e,n)},removeData:function(t,e){j.remove(t,e)},_data:function(t,e,n){return z.access(t,e,n)},_removeData:function(t,e){z.remove(t,e)}}),m.fn.extend({data:function(t,e){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(r=j.get(o),1===o.nodeType&&!z.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(i=a[n].name).indexOf("data-")&&(i=m.camelCase(i.slice(5)),W(o,i,r[i]));z.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){j.set(this,t)})):N(this,(function(e){var n,i;if(o&&void 0===e)return void 0!==(n=j.get(o,t)||j.get(o,t.replace(H,"-$&").toLowerCase()))?n:(i=m.camelCase(t),void 0!==(n=j.get(o,i))?n:void 0!==(n=W(o,i,void 0))?n:void 0);i=m.camelCase(t),this.each((function(){var n=j.get(this,i);j.set(this,i,e),t.indexOf("-")>-1&&void 0!==n&&j.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){j.remove(this,t)}))}}),m.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=z.get(t,e),n&&(!i||m.isArray(n)?i=z.access(t,e,m.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=m.queue(t,e),i=n.length,r=n.shift(),o=m._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,(function(){m.dequeue(t,e)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return z.get(t,n)||z.access(t,n,{empty:m.Callbacks("once memory").add((function(){z.remove(t,[e+"queue",n])}))})}}),m.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?m.queue(this[0],t):void 0===e?this:this.each((function(){var n=m.queue(this,t,e);m._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&m.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){m.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=m.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=z.get(o[a],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(e)}});var U=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,$=new RegExp("^(?:([+-])=|)("+U+")([a-z%]*)$","i"),G=["Top","Right","Bottom","Left"],q=function(t,e){return t=e||t,"none"===m.css(t,"display")||!m.contains(t.ownerDocument,t)};function Y(t,e,n,i){var r,o=1,a=20,s=i?function(){return i.cur()}:function(){return m.css(t,e,"")},l=s(),u=n&&n[3]||(m.cssNumber[e]?"":"px"),c=(m.cssNumber[e]||"px"!==u&&+l)&&$.exec(m.css(t,e));if(c&&c[3]!==u){u=u||c[3],n=n||[],c=+l||1;do{c/=o=o||".5",m.style(t,e,c+u)}while(o!==(o=s()/l)&&1!==o&&--a)}return n&&(c=+c||+l||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=u,i.start=c,i.end=r)),r}var X=/^(?:checkbox|radio)$/i,Q=/<([\w:-]+)/,K=/^$|\/(?:java|ecma)script/i,J={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Z(t,e){var n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&m.nodeName(t,e)?m.merge([t],n):n}function tt(t,e){for(var n=0,i=t.length;n<i;n++)z.set(t[n],"globalEval",!e||z.get(e[n],"globalEval"))}J.optgroup=J.option,J.tbody=J.tfoot=J.colgroup=J.caption=J.thead,J.th=J.td;var et,nt,it=/<|&#?\w+;/;function rt(t,e,n,i,r){for(var o,a,s,l,u,c,h=e.createDocumentFragment(),d=[],p=0,f=t.length;p<f;p++)if((o=t[p])||0===o)if("object"===m.type(o))m.merge(d,o.nodeType?[o]:o);else if(it.test(o)){for(a=a||h.appendChild(e.createElement("div")),s=(Q.exec(o)||["",""])[1].toLowerCase(),l=J[s]||J._default,a.innerHTML=l[1]+m.htmlPrefilter(o)+l[2],c=l[0];c--;)a=a.lastChild;m.merge(d,a.childNodes),(a=h.firstChild).textContent=""}else d.push(e.createTextNode(o));for(h.textContent="",p=0;o=d[p++];)if(i&&m.inArray(o,i)>-1)r&&r.push(o);else if(u=m.contains(o.ownerDocument,o),a=Z(h.appendChild(o),"script"),u&&tt(a),n)for(c=0;o=a[c++];)K.test(o.type||"")&&n.push(o);return h}et=a.createDocumentFragment().appendChild(a.createElement("div")),(nt=a.createElement("input")).setAttribute("type","radio"),nt.setAttribute("checked","checked"),nt.setAttribute("name","t"),et.appendChild(nt),f.checkClone=et.cloneNode(!0).cloneNode(!0).lastChild.checked,et.innerHTML="<textarea>x</textarea>",f.noCloneChecked=!!et.cloneNode(!0).lastChild.defaultValue;var ot=/^key/,at=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,st=/^([^.]*)(?:\.(.+)|)/;function lt(){return!0}function ut(){return!1}function ct(){try{return a.activeElement}catch(t){}}function ht(t,e,n,i,r,o){var a,s;if("object"==typeof e){for(s in"string"!=typeof n&&(i=i||n,n=void 0),e)ht(t,s,n,i,e[s],o);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=ut;else if(!r)return t;return 1===o&&(a=r,(r=function(t){return m().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=m.guid++)),t.each((function(){m.event.add(this,e,r,i,n)}))}m.event={global:{},add:function(t,e,n,i,r){var o,a,s,l,u,c,h,d,p,f,g,v=z.get(t);if(v)for(n.handler&&(n=(o=n).handler,r=o.selector),n.guid||(n.guid=m.guid++),(l=v.events)||(l=v.events={}),(a=v.handle)||(a=v.handle=function(e){return void 0!==m&&m.event.triggered!==e.type?m.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(L)||[""]).length;u--;)p=g=(s=st.exec(e[u])||[])[1],f=(s[2]||"").split(".").sort(),p&&(h=m.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,h=m.event.special[p]||{},c=m.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&m.expr.match.needsContext.test(r),namespace:f.join(".")},o),(d=l[p])||((d=l[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,f,a)||t.addEventListener&&t.addEventListener(p,a)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),m.event.global[p]=!0)},remove:function(t,e,n,i,r){var o,a,s,l,u,c,h,d,p,f,g,v=z.hasData(t)&&z.get(t);if(v&&(l=v.events)){for(u=(e=(e||"").match(L)||[""]).length;u--;)if(p=g=(s=st.exec(e[u])||[])[1],f=(s[2]||"").split(".").sort(),p){for(h=m.event.special[p]||{},d=l[p=(i?h.delegateType:h.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)c=d[o],!r&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(t,c));a&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,f,v.handle)||m.removeEvent(t,p,v.handle),delete l[p])}else for(p in l)m.event.remove(t,p+e[u],n,i,!0);m.isEmptyObject(l)&&z.remove(t,"handle events")}},dispatch:function(t){t=m.event.fix(t);var e,n,i,r,o,a=[],l=s.call(arguments),u=(z.get(this,"events")||{})[t.type]||[],c=m.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){for(a=m.event.handlers.call(this,t,u),e=0;(r=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(o.namespace)||(t.handleObj=o,t.data=o.data,void 0!==(i=((m.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,l))&&!1===(t.result=i)&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,i,r,o,a=[],s=e.delegateCount,l=t.target;if(s&&l.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==t.type)){for(i=[],n=0;n<s;n++)void 0===i[r=(o=e[n]).selector+" "]&&(i[r]=o.needsContext?m(r,this).index(l)>-1:m.find(r,this,null,[l]).length),i[r]&&i.push(o);i.length&&a.push({elem:l,handlers:i})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,i,r,o=e.button;return null==t.pageX&&null!=e.clientX&&(i=(n=t.target.ownerDocument||a).documentElement,r=n.body,t.pageX=e.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),t.pageY=e.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(t){if(t[m.expando])return t;var e,n,i,r=t.type,o=t,s=this.fixHooks[r];for(s||(this.fixHooks[r]=s=at.test(r)?this.mouseHooks:ot.test(r)?this.keyHooks:{}),i=s.props?this.props.concat(s.props):this.props,t=new m.Event(o),e=i.length;e--;)t[n=i[e]]=o[n];return t.target||(t.target=a),3===t.target.nodeType&&(t.target=t.target.parentNode),s.filter?s.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ct()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===ct()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&m.nodeName(this,"input"))return this.click(),!1},_default:function(t){return m.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},m.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},m.Event=function(t,e){if(!(this instanceof m.Event))return new m.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?lt:ut):this.type=t,e&&m.extend(this,e),this.timeStamp=t&&t.timeStamp||m.now(),this[m.expando]=!0},m.Event.prototype={constructor:m.Event,isDefaultPrevented:ut,isPropagationStopped:ut,isImmediatePropagationStopped:ut,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=lt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=lt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=lt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){m.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===i||m.contains(i,r))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}})),m.fn.extend({on:function(t,e,n,i){return ht(this,t,e,n,i)},one:function(t,e,n,i){return ht(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,m(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=ut),this.each((function(){m.event.remove(this,t,n,e)}))}});var dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,pt=/<script|<style|<link/i,ft=/checked\s*(?:[^=]|=\s*.checked.)/i,mt=/^true\/(.*)/,gt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function vt(t,e){return m.nodeName(t,"table")&&m.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function yt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function bt(t){var e=mt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function _t(t,e){var n,i,r,o,a,s,l,u;if(1===e.nodeType){if(z.hasData(t)&&(o=z.access(t),a=z.set(e,o),u=o.events))for(r in delete a.handle,a.events={},u)for(n=0,i=u[r].length;n<i;n++)m.event.add(e,r,u[r][n]);j.hasData(t)&&(s=j.access(t),l=m.extend({},s),j.set(e,l))}}function xt(t,e,n,i){e=l.apply([],e);var r,o,a,s,u,c,h=0,d=t.length,p=d-1,g=e[0],v=m.isFunction(g);if(v||d>1&&"string"==typeof g&&!f.checkClone&&ft.test(g))return t.each((function(r){var o=t.eq(r);v&&(e[0]=g.call(this,r,o.html())),xt(o,e,n,i)}));if(d&&(o=(r=rt(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(s=(a=m.map(Z(r,"script"),yt)).length;h<d;h++)u=r,h!==p&&(u=m.clone(u,!0,!0),s&&m.merge(a,Z(u,"script"))),n.call(t[h],u,h);if(s)for(c=a[a.length-1].ownerDocument,m.map(a,bt),h=0;h<s;h++)u=a[h],K.test(u.type||"")&&!z.access(u,"globalEval")&&m.contains(c,u)&&(u.src?m._evalUrl&&m._evalUrl(u.src):m.globalEval(u.textContent.replace(gt,"")))}return t}function wt(t,e,n){for(var i,r=e?m.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||m.cleanData(Z(i)),i.parentNode&&(n&&m.contains(i.ownerDocument,i)&&tt(Z(i,"script")),i.parentNode.removeChild(i));return t}m.extend({htmlPrefilter:function(t){return t.replace(dt,"<$1></$2>")},clone:function(t,e,n){var i,r,o,a,s,l,u,c=t.cloneNode(!0),h=m.contains(t.ownerDocument,t);if(!(f.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||m.isXMLDoc(t)))for(a=Z(c),i=0,r=(o=Z(t)).length;i<r;i++)s=o[i],l=a[i],u=void 0,"input"===(u=l.nodeName.toLowerCase())&&X.test(s.type)?l.checked=s.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=s.defaultValue);if(e)if(n)for(o=o||Z(t),a=a||Z(c),i=0,r=o.length;i<r;i++)_t(o[i],a[i]);else _t(t,c);return(a=Z(c,"script")).length>0&&tt(a,!h&&Z(t,"script")),c},cleanData:function(t){for(var e,n,i,r=m.event.special,o=0;void 0!==(n=t[o]);o++)if(F(n)){if(e=n[z.expando]){if(e.events)for(i in e.events)r[i]?m.event.remove(n,i):m.removeEvent(n,i,e.handle);n[z.expando]=void 0}n[j.expando]&&(n[j.expando]=void 0)}}}),m.fn.extend({domManip:xt,detach:function(t){return wt(this,t,!0)},remove:function(t){return wt(this,t)},text:function(t){return N(this,(function(t){return void 0===t?m.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return xt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||vt(this,t).appendChild(t)}))},prepend:function(){return xt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=vt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return xt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return xt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(m.cleanData(Z(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return m.clone(this,t,e)}))},html:function(t){return N(this,(function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!pt.test(t)&&!J[(Q.exec(t)||["",""])[1].toLowerCase()]){t=m.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(m.cleanData(Z(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return xt(this,arguments,(function(e){var n=this.parentNode;m.inArray(this,t)<0&&(m.cleanData(Z(this)),n&&n.replaceChild(e,this))}),t)}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){m.fn[t]=function(t){for(var n,i=[],r=m(t),o=r.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),m(r[a])[e](n),u.apply(i,n.get());return this.pushStack(i)}}));var Ct,Tt={HTML:"block",BODY:"block"};function St(t,e){var n=m(e.createElement(t)).appendTo(e.body),i=m.css(n[0],"display");return n.detach(),i}function kt(t){var e=a,n=Tt[t];return n||("none"!==(n=St(t,e))&&n||((e=(Ct=(Ct||m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),n=St(t,e),Ct.detach()),Tt[t]=n),n}var At=/^margin/,Et=new RegExp("^("+U+")(?!px)[a-z%]+$","i"),Mt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=n),e.getComputedStyle(t)},Pt=function(t,e,n,i){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];for(o in r=n.apply(t,i||[]),e)t.style[o]=a[o];return r},Dt=a.documentElement;function Ot(t,e,n){var i,r,o,a,s=t.style;return""!==(a=(n=n||Mt(t))?n.getPropertyValue(e)||n[e]:void 0)&&void 0!==a||m.contains(t.ownerDocument,t)||(a=m.style(t,e)),n&&!f.pixelMarginRight()&&Et.test(a)&&At.test(e)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o),void 0!==a?a+"":a}function It(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){var t,e,i,r,o=a.createElement("div"),s=a.createElement("div");function l(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",s.innerHTML="",Dt.appendChild(o);var a=n.getComputedStyle(s);t="1%"!==a.top,r="2px"===a.marginLeft,e="4px"===a.width,s.style.marginRight="50%",i="4px"===a.marginRight,Dt.removeChild(o)}s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",f.clearCloneStyle="content-box"===s.style.backgroundClip,o.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",o.appendChild(s),m.extend(f,{pixelPosition:function(){return l(),t},boxSizingReliable:function(){return null==e&&l(),e},pixelMarginRight:function(){return null==e&&l(),i},reliableMarginLeft:function(){return null==e&&l(),r},reliableMarginRight:function(){var t,e=s.appendChild(a.createElement("div"));return e.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",s.style.width="1px",Dt.appendChild(o),t=!parseFloat(n.getComputedStyle(e).marginRight),Dt.removeChild(o),s.removeChild(e),t}}))}();var Lt=/^(none|table(?!-c[ea]).+)/,Rt={position:"absolute",visibility:"hidden",display:"block"},Nt={letterSpacing:"0",fontWeight:"400"},Ft=["Webkit","O","Moz","ms"],Bt=a.createElement("div").style;function zt(t){if(t in Bt)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=Ft.length;n--;)if((t=Ft[n]+e)in Bt)return t}function jt(t,e,n){var i=$.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function Vt(t,e,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===e?1:0,a=0;o<4;o+=2)"margin"===n&&(a+=m.css(t,n+G[o],!0,r)),i?("content"===n&&(a-=m.css(t,"padding"+G[o],!0,r)),"margin"!==n&&(a-=m.css(t,"border"+G[o]+"Width",!0,r))):(a+=m.css(t,"padding"+G[o],!0,r),"padding"!==n&&(a+=m.css(t,"border"+G[o]+"Width",!0,r)));return a}function Ht(t,e,n){var i=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=Mt(t),a="border-box"===m.css(t,"boxSizing",!1,o);if(r<=0||null==r){if(((r=Ot(t,e,o))<0||null==r)&&(r=t.style[e]),Et.test(r))return r;i=a&&(f.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+Vt(t,e,n||(a?"border":"content"),i,o)+"px"}function Wt(t,e){for(var n,i,r,o=[],a=0,s=t.length;a<s;a++)(i=t[a]).style&&(o[a]=z.get(i,"olddisplay"),n=i.style.display,e?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&q(i)&&(o[a]=z.access(i,"olddisplay",kt(i.nodeName)))):(r=q(i),"none"===n&&r||z.set(i,"olddisplay",r?n:m.css(i,"display"))));for(a=0;a<s;a++)(i=t[a]).style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?o[a]||"":"none"));return t}function Ut(t,e,n,i,r){return new Ut.prototype.init(t,e,n,i,r)}m.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Ot(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=m.camelCase(e),l=t.style;if(e=m.cssProps[s]||(m.cssProps[s]=zt(s)||s),a=m.cssHooks[e]||m.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(r=a.get(t,!1,i))?r:l[e];"string"==(o=typeof n)&&(r=$.exec(n))&&r[1]&&(n=Y(t,e,r),o="number"),null!=n&&n==n&&("number"===o&&(n+=r&&r[3]||(m.cssNumber[s]?"":"px")),f.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,i))||(l[e]=n))}},css:function(t,e,n,i){var r,o,a,s=m.camelCase(e);return e=m.cssProps[s]||(m.cssProps[s]=zt(s)||s),(a=m.cssHooks[e]||m.cssHooks[s])&&"get"in a&&(r=a.get(t,!0,n)),void 0===r&&(r=Ot(t,e,i)),"normal"===r&&e in Nt&&(r=Nt[e]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),m.each(["height","width"],(function(t,e){m.cssHooks[e]={get:function(t,n,i){if(n)return Lt.test(m.css(t,"display"))&&0===t.offsetWidth?Pt(t,Rt,(function(){return Ht(t,e,i)})):Ht(t,e,i)},set:function(t,n,i){var r,o=i&&Mt(t),a=i&&Vt(t,e,i,"border-box"===m.css(t,"boxSizing",!1,o),o);return a&&(r=$.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=m.css(t,e)),jt(0,n,a)}}})),m.cssHooks.marginLeft=It(f.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Ot(t,"marginLeft"))||t.getBoundingClientRect().left-Pt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),m.cssHooks.marginRight=It(f.reliableMarginRight,(function(t,e){if(e)return Pt(t,{display:"inline-block"},Ot,[t,"marginRight"])})),m.each({margin:"",padding:"",border:"Width"},(function(t,e){m.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+G[i]+e]=o[i]||o[i-2]||o[0];return r}},At.test(t)||(m.cssHooks[t+e].set=jt)})),m.fn.extend({css:function(t,e){return N(this,(function(t,e,n){var i,r,o={},a=0;if(m.isArray(e)){for(i=Mt(t),r=e.length;a<r;a++)o[e[a]]=m.css(t,e[a],!1,i);return o}return void 0!==n?m.style(t,e,n):m.css(t,e)}),t,e,arguments.length>1)},show:function(){return Wt(this,!0)},hide:function(){return Wt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){q(this)?m(this).show():m(this).hide()}))}}),m.Tween=Ut,Ut.prototype={constructor:Ut,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||m.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(m.cssNumber[n]?"":"px")},cur:function(){var t=Ut.propHooks[this.prop];return t&&t.get?t.get(this):Ut.propHooks._default.get(this)},run:function(t){var e,n=Ut.propHooks[this.prop];return this.options.duration?this.pos=e=m.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ut.propHooks._default.set(this),this}},Ut.prototype.init.prototype=Ut.prototype,Ut.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=m.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){m.fx.step[t.prop]?m.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[m.cssProps[t.prop]]&&!m.cssHooks[t.prop]?t.elem[t.prop]=t.now:m.style(t.elem,t.prop,t.now+t.unit)}}},Ut.propHooks.scrollTop=Ut.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},m.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},m.fx=Ut.prototype.init,m.fx.step={};var $t,Gt,qt=/^(?:toggle|show|hide)$/,Yt=/queueHooks$/;function Xt(){return n.setTimeout((function(){$t=void 0})),$t=m.now()}function Qt(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=G[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function Kt(t,e,n){for(var i,r=(Jt.tweeners[e]||[]).concat(Jt.tweeners["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,e,t))return i}function Jt(t,e,n){var i,r,o=0,a=Jt.prefilters.length,s=m.Deferred().always((function(){delete l.elem})),l=function(){if(r)return!1;for(var e=$t||Xt(),n=Math.max(0,u.startTime+u.duration-e),i=1-(n/u.duration||0),o=0,a=u.tweens.length;o<a;o++)u.tweens[o].run(i);return s.notifyWith(t,[u,i,n]),i<1&&a?n:(s.resolveWith(t,[u]),!1)},u=s.promise({elem:t,props:m.extend({},e),opts:m.extend(!0,{specialEasing:{},easing:m.easing._default},n),originalProperties:e,originalOptions:n,startTime:$t||Xt(),duration:n.duration,tweens:[],createTween:function(e,n){var i=m.Tween(t,u.opts,e,n,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(i),i},stop:function(e){var n=0,i=e?u.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)u.tweens[n].run(1);return e?(s.notifyWith(t,[u,1,0]),s.resolveWith(t,[u,e])):s.rejectWith(t,[u,e]),this}}),c=u.props;for(function(t,e){var n,i,r,o,a;for(n in t)if(r=e[i=m.camelCase(n)],o=t[n],m.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(a=m.cssHooks[i])&&"expand"in a)for(n in o=a.expand(o),delete t[i],o)n in t||(t[n]=o[n],e[n]=r);else e[i]=r}(c,u.opts.specialEasing);o<a;o++)if(i=Jt.prefilters[o].call(u,t,c,u.opts))return m.isFunction(i.stop)&&(m._queueHooks(u.elem,u.opts.queue).stop=m.proxy(i.stop,i)),i;return m.map(c,Kt,u),m.isFunction(u.opts.start)&&u.opts.start.call(t,u),m.fx.timer(m.extend(l,{elem:t,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}m.Animation=m.extend(Jt,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return Y(n.elem,t,$.exec(e),n),n}]},tweener:function(t,e){m.isFunction(t)?(e=t,t=["*"]):t=t.match(L);for(var n,i=0,r=t.length;i<r;i++)n=t[i],Jt.tweeners[n]=Jt.tweeners[n]||[],Jt.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,r,o,a,s,l,u,c=this,h={},d=t.style,p=t.nodeType&&q(t),f=z.get(t,"fxshow");for(i in n.queue||(null==(s=m._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,c.always((function(){c.always((function(){s.unqueued--,m.queue(t,"fx").length||s.empty.fire()}))}))),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===("none"===(u=m.css(t,"display"))?z.get(t,"olddisplay")||kt(t.nodeName):u)&&"none"===m.css(t,"float")&&(d.display="inline-block")),n.overflow&&(d.overflow="hidden",c.always((function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}))),e)if(r=e[i],qt.exec(r)){if(delete e[i],o=o||"toggle"===r,r===(p?"hide":"show")){if("show"!==r||!f||void 0===f[i])continue;p=!0}h[i]=f&&f[i]||m.style(t,i)}else u=void 0;if(m.isEmptyObject(h))"inline"===("none"===u?kt(t.nodeName):u)&&(d.display=u);else for(i in f?"hidden"in f&&(p=f.hidden):f=z.access(t,"fxshow",{}),o&&(f.hidden=!p),p?m(t).show():c.done((function(){m(t).hide()})),c.done((function(){var e;for(e in z.remove(t,"fxshow"),h)m.style(t,e,h[e])})),h)a=Kt(p?f[i]:0,i,c),i in f||(f[i]=a.start,p&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}],prefilter:function(t,e){e?Jt.prefilters.unshift(t):Jt.prefilters.push(t)}}),m.speed=function(t,e,n){var i=t&&"object"==typeof t?m.extend({},t):{complete:n||!n&&e||m.isFunction(t)&&t,duration:t,easing:n&&e||e&&!m.isFunction(e)&&e};return i.duration=m.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in m.fx.speeds?m.fx.speeds[i.duration]:m.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){m.isFunction(i.old)&&i.old.call(this),i.queue&&m.dequeue(this,i.queue)},i},m.fn.extend({fadeTo:function(t,e,n,i){return this.filter(q).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=m.isEmptyObject(t),o=m.speed(e,n,i),a=function(){var e=Jt(this,m.extend({},t),o);(r||z.get(this,"finish"))&&e.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){var e=!0,r=null!=t&&t+"queueHooks",o=m.timers,a=z.get(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&Yt.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||m.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=z.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=m.timers,a=i?i.length:0;for(n.finish=!0,m.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<a;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish}))}}),m.each(["toggle","show","hide"],(function(t,e){var n=m.fn[e];m.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(Qt(e,!0),t,i,r)}})),m.each({slideDown:Qt("show"),slideUp:Qt("hide"),slideToggle:Qt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){m.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}})),m.timers=[],m.fx.tick=function(){var t,e=0,n=m.timers;for($t=m.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||m.fx.stop(),$t=void 0},m.fx.timer=function(t){m.timers.push(t),t()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){Gt||(Gt=n.setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){n.clearInterval(Gt),Gt=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(t,e){return t=m.fx&&m.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,i){var r=n.setTimeout(e,t);i.stop=function(){n.clearTimeout(r)}}))},function(){var t=a.createElement("input"),e=a.createElement("select"),n=e.appendChild(a.createElement("option"));t.type="checkbox",f.checkOn=""!==t.value,f.optSelected=n.selected,e.disabled=!0,f.optDisabled=!n.disabled,(t=a.createElement("input")).value="t",t.type="radio",f.radioValue="t"===t.value}();var Zt,te=m.expr.attrHandle;m.fn.extend({attr:function(t,e){return N(this,m.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){m.removeAttr(this,t)}))}}),m.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?m.prop(t,e,n):(1===o&&m.isXMLDoc(t)||(e=e.toLowerCase(),r=m.attrHooks[e]||(m.expr.match.bool.test(e)?Zt:void 0)),void 0!==n?null===n?void m.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=m.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!f.radioValue&&"radio"===e&&m.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i,r=0,o=e&&e.match(L);if(o&&1===t.nodeType)for(;n=o[r++];)i=m.propFix[n]||n,m.expr.match.bool.test(n)&&(t[i]=!1),t.removeAttribute(n)}}),Zt={set:function(t,e,n){return!1===e?m.removeAttr(t,n):t.setAttribute(n,n),n}},m.each(m.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=te[e]||m.find.attr;te[e]=function(t,e,i){var r,o;return i||(o=te[e],te[e]=r,r=null!=n(t,e,i)?e.toLowerCase():null,te[e]=o),r}}));var ee=/^(?:input|select|textarea|button)$/i,ne=/^(?:a|area)$/i;m.fn.extend({prop:function(t,e){return N(this,m.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[m.propFix[t]||t]}))}}),m.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&m.isXMLDoc(t)||(e=m.propFix[e]||e,r=m.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=m.find.attr(t,"tabindex");return e?parseInt(e,10):ee.test(t.nodeName)||ne.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),f.optSelected||(m.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){m.propFix[this.toLowerCase()]=this}));var ie=/[\t\r\n\f]/g;function re(t){return t.getAttribute&&t.getAttribute("class")||""}m.fn.extend({addClass:function(t){var e,n,i,r,o,a,s,l=0;if(m.isFunction(t))return this.each((function(e){m(this).addClass(t.call(this,e,re(this)))}));if("string"==typeof t&&t)for(e=t.match(L)||[];n=this[l++];)if(r=re(n),i=1===n.nodeType&&(" "+r+" ").replace(ie," ")){for(a=0;o=e[a++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");r!==(s=m.trim(i))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,i,r,o,a,s,l=0;if(m.isFunction(t))return this.each((function(e){m(this).removeClass(t.call(this,e,re(this)))}));if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(L)||[];n=this[l++];)if(r=re(n),i=1===n.nodeType&&(" "+r+" ").replace(ie," ")){for(a=0;o=e[a++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");r!==(s=m.trim(i))&&n.setAttribute("class",s)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):m.isFunction(t)?this.each((function(n){m(this).toggleClass(t.call(this,n,re(this),e),e)})):this.each((function(){var e,i,r,o;if("string"===n)for(i=0,r=m(this),o=t.match(L)||[];e=o[i++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==n||((e=re(this))&&z.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":z.get(this,"__className__")||""))}))},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+re(n)+" ").replace(ie," ").indexOf(e)>-1)return!0;return!1}});var oe=/\r/g,ae=/[\x20\t\r\n\f]+/g;m.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=m.isFunction(t),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,m(this).val()):t)?r="":"number"==typeof r?r+="":m.isArray(r)&&(r=m.map(r,(function(t){return null==t?"":t+""}))),(e=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=m.valHooks[r.type]||m.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(oe,""):null==n?"":n:void 0}}),m.extend({valHooks:{option:{get:function(t){var e=m.find.attr(t,"value");return null!=e?e:m.trim(m.text(t)).replace(ae," ")}},select:{get:function(t){for(var e,n,i=t.options,r=t.selectedIndex,o="select-one"===t.type||r<0,a=o?null:[],s=o?r+1:i.length,l=r<0?s:o?r:0;l<s;l++)if(((n=i[l]).selected||l===r)&&(f.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!m.nodeName(n.parentNode,"optgroup"))){if(e=m(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=m.makeArray(e),a=r.length;a--;)((i=r[a]).selected=m.inArray(m.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),m.each(["radio","checkbox"],(function(){m.valHooks[this]={set:function(t,e){if(m.isArray(e))return t.checked=m.inArray(m(t).val(),e)>-1}},f.checkOn||(m.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}));var se=/^(?:focusinfocus|focusoutblur)$/;m.extend(m.event,{trigger:function(t,e,i,r){var o,s,l,u,c,h,d,f=[i||a],g=p.call(t,"type")?t.type:t,v=p.call(t,"namespace")?t.namespace.split("."):[];if(s=l=i=i||a,3!==i.nodeType&&8!==i.nodeType&&!se.test(g+m.event.triggered)&&(g.indexOf(".")>-1&&(v=g.split("."),g=v.shift(),v.sort()),c=g.indexOf(":")<0&&"on"+g,(t=t[m.expando]?t:new m.Event(g,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=v.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:m.makeArray(e,[t]),d=m.event.special[g]||{},r||!d.trigger||!1!==d.trigger.apply(i,e))){if(!r&&!d.noBubble&&!m.isWindow(i)){for(u=d.delegateType||g,se.test(u+g)||(s=s.parentNode);s;s=s.parentNode)f.push(s),l=s;l===(i.ownerDocument||a)&&f.push(l.defaultView||l.parentWindow||n)}for(o=0;(s=f[o++])&&!t.isPropagationStopped();)t.type=o>1?u:d.bindType||g,(h=(z.get(s,"events")||{})[t.type]&&z.get(s,"handle"))&&h.apply(s,e),(h=c&&s[c])&&h.apply&&F(s)&&(t.result=h.apply(s,e),!1===t.result&&t.preventDefault());return t.type=g,r||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(f.pop(),e)||!F(i)||c&&m.isFunction(i[g])&&!m.isWindow(i)&&((l=i[c])&&(i[c]=null),m.event.triggered=g,i[g](),m.event.triggered=void 0,l&&(i[c]=l)),t.result}},simulate:function(t,e,n){var i=m.extend(new m.Event,n,{type:t,isSimulated:!0});m.event.trigger(i,null,e)}}),m.fn.extend({trigger:function(t,e){return this.each((function(){m.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return m.event.trigger(t,e,n,!0)}}),m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(t,e){m.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}})),m.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),f.focusin="onfocusin"in n,f.focusin||m.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){m.event.simulate(e,t.target,m.event.fix(t))};m.event.special[e]={setup:function(){var i=this.ownerDocument||this,r=z.access(i,e);r||i.addEventListener(t,n,!0),z.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=z.access(i,e)-1;r?z.access(i,e,r):(i.removeEventListener(t,n,!0),z.remove(i,e))}}}));var le=n.location,ue=m.now(),ce=/\?/;m.parseJSON=function(t){return JSON.parse(t+"")},m.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new n.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+t),e};var he=/#.*$/,de=/([?&])_=[^&]*/,pe=/^(.*?):[ \t]*([^\r\n]*)$/gm,fe=/^(?:GET|HEAD)$/,me=/^\/\//,ge={},ve={},ye="*/".concat("*"),be=a.createElement("a");function _e(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(L)||[];if(m.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function xe(t,e,n,i){var r={},o=t===ve;function a(s){var l;return r[s]=!0,m.each(t[s]||[],(function(t,s){var u=s(e,n,i);return"string"!=typeof u||o||r[u]?o?!(l=u):void 0:(e.dataTypes.unshift(u),a(u),!1)})),l}return a(e.dataTypes[0])||!r["*"]&&a("*")}function we(t,e){var n,i,r=m.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&m.extend(!0,t,i),t}be.href=le.href,m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:le.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(le.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ye,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?we(we(t,m.ajaxSettings),e):we(m.ajaxSettings,t)},ajaxPrefilter:_e(ge),ajaxTransport:_e(ve),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,r,o,s,l,u,c,h,d=m.ajaxSetup({},e),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?m(p):m.event,g=m.Deferred(),v=m.Callbacks("once memory"),y=d.statusCode||{},b={},_={},x=0,w="canceled",C={readyState:0,getResponseHeader:function(t){var e;if(2===x){if(!s)for(s={};e=pe.exec(o);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===x?o:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return x||(t=_[n]=_[n]||t,b[t]=e),this},overrideMimeType:function(t){return x||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(x<2)for(e in t)y[e]=[y[e],t[e]];else C.always(t[C.status]);return this},abort:function(t){var e=t||w;return i&&i.abort(e),T(0,e),this}};if(g.promise(C).complete=v.add,C.success=C.done,C.error=C.fail,d.url=((t||d.url||le.href)+"").replace(he,"").replace(me,le.protocol+"//"),d.type=e.method||e.type||d.method||d.type,d.dataTypes=m.trim(d.dataType||"*").toLowerCase().match(L)||[""],null==d.crossDomain){u=a.createElement("a");try{u.href=d.url,u.href=u.href,d.crossDomain=be.protocol+"//"+be.host!=u.protocol+"//"+u.host}catch(t){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=m.param(d.data,d.traditional)),xe(ge,d,e,C),2===x)return C;for(h in(c=m.event&&d.global)&&0==m.active++&&m.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!fe.test(d.type),r=d.url,d.hasContent||(d.data&&(r=d.url+=(ce.test(r)?"&":"?")+d.data,delete d.data),!1===d.cache&&(d.url=de.test(r)?r.replace(de,"$1_="+ue++):r+(ce.test(r)?"&":"?")+"_="+ue++)),d.ifModified&&(m.lastModified[r]&&C.setRequestHeader("If-Modified-Since",m.lastModified[r]),m.etag[r]&&C.setRequestHeader("If-None-Match",m.etag[r])),(d.data&&d.hasContent&&!1!==d.contentType||e.contentType)&&C.setRequestHeader("Content-Type",d.contentType),C.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+ye+"; q=0.01":""):d.accepts["*"]),d.headers)C.setRequestHeader(h,d.headers[h]);if(d.beforeSend&&(!1===d.beforeSend.call(p,C,d)||2===x))return C.abort();for(h in w="abort",{success:1,error:1,complete:1})C[h](d[h]);if(i=xe(ve,d,e,C)){if(C.readyState=1,c&&f.trigger("ajaxSend",[C,d]),2===x)return C;d.async&&d.timeout>0&&(l=n.setTimeout((function(){C.abort("timeout")}),d.timeout));try{x=1,i.send(b,T)}catch(t){if(!(x<2))throw t;T(-1,t)}}else T(-1,"No Transport");function T(t,e,a,s){var u,h,b,_,w,T=e;2!==x&&(x=2,l&&n.clearTimeout(l),i=void 0,o=s||"",C.readyState=t>0?4:0,u=t>=200&&t<300||304===t,a&&(_=function(t,e,n){for(var i,r,o,a,s=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||t.converters[r+" "+l[0]]){o=r;break}a||(a=r)}o=o||a}if(o)return o!==l[0]&&l.unshift(o),n[o]}(d,C,a)),_=function(t,e,n,i){var r,o,a,s,l,u={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)u[a.toLowerCase()]=t.converters[a];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=u[l+" "+o]||u["* "+o]))for(r in u)if((s=r.split(" "))[1]===o&&(a=u[l+" "+s[0]]||u["* "+s[0]])){!0===a?a=u[r]:!0!==u[r]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(d,_,C,u),u?(d.ifModified&&((w=C.getResponseHeader("Last-Modified"))&&(m.lastModified[r]=w),(w=C.getResponseHeader("etag"))&&(m.etag[r]=w)),204===t||"HEAD"===d.type?T="nocontent":304===t?T="notmodified":(T=_.state,h=_.data,u=!(b=_.error))):(b=T,!t&&T||(T="error",t<0&&(t=0))),C.status=t,C.statusText=(e||T)+"",u?g.resolveWith(p,[h,T,C]):g.rejectWith(p,[C,T,b]),C.statusCode(y),y=void 0,c&&f.trigger(u?"ajaxSuccess":"ajaxError",[C,d,u?h:b]),v.fireWith(p,[C,T]),c&&(f.trigger("ajaxComplete",[C,d]),--m.active||m.event.trigger("ajaxStop")))}return C},getJSON:function(t,e,n){return m.get(t,e,n,"json")},getScript:function(t,e){return m.get(t,void 0,e,"script")}}),m.each(["get","post"],(function(t,e){m[e]=function(t,n,i,r){return m.isFunction(n)&&(r=r||i,i=n,n=void 0),m.ajax(m.extend({url:t,type:e,dataType:r,data:n,success:i},m.isPlainObject(t)&&t))}})),m._evalUrl=function(t){return m.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},m.fn.extend({wrapAll:function(t){var e;return m.isFunction(t)?this.each((function(e){m(this).wrapAll(t.call(this,e))})):(this[0]&&(e=m(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this)},wrapInner:function(t){return m.isFunction(t)?this.each((function(e){m(this).wrapInner(t.call(this,e))})):this.each((function(){var e=m(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=m.isFunction(t);return this.each((function(n){m(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(){return this.parent().each((function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)})).end()}}),m.expr.filters.hidden=function(t){return!m.expr.filters.visible(t)},m.expr.filters.visible=function(t){return t.offsetWidth>0||t.offsetHeight>0||t.getClientRects().length>0};var Ce=/%20/g,Te=/\[\]$/,Se=/\r?\n/g,ke=/^(?:submit|button|image|reset|file)$/i,Ae=/^(?:input|select|textarea|keygen)/i;function Ee(t,e,n,i){var r;if(m.isArray(e))m.each(e,(function(e,r){n||Te.test(t)?i(t,r):Ee(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)}));else if(n||"object"!==m.type(e))i(t,e);else for(r in e)Ee(t+"["+r+"]",e[r],n,i)}m.param=function(t,e){var n,i=[],r=function(t,e){e=m.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(t)||t.jquery&&!m.isPlainObject(t))m.each(t,(function(){r(this.name,this.value)}));else for(n in t)Ee(n,t[n],e,r);return i.join("&").replace(Ce,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=m.prop(this,"elements");return t?m.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!m(this).is(":disabled")&&Ae.test(this.nodeName)&&!ke.test(t)&&(this.checked||!X.test(t))})).map((function(t,e){var n=m(this).val();return null==n?null:m.isArray(n)?m.map(n,(function(t){return{name:e.name,value:t.replace(Se,"\r\n")}})):{name:e.name,value:n.replace(Se,"\r\n")}})).get()}}),m.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(t){}};var Me={0:200,1223:204},Pe=m.ajaxSettings.xhr();f.cors=!!Pe&&"withCredentials"in Pe,f.ajax=Pe=!!Pe,m.ajaxTransport((function(t){var e,i;if(f.cors||Pe&&!t.crossDomain)return{send:function(r,o){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];for(a in t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)s.setRequestHeader(a,r[a]);e=function(t){return function(){e&&(e=i=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Me[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=e(),i=s.onerror=e("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&n.setTimeout((function(){e&&i()}))},e=e("abort");try{s.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}})),m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return m.globalEval(t),t}}}),m.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),m.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain)return{send:function(i,r){e=m("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),a.head.appendChild(e[0])},abort:function(){n&&n()}}}));var De=[],Oe=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=De.pop()||m.expando+"_"+ue++;return this[t]=!0,t}}),m.ajaxPrefilter("json jsonp",(function(t,e,i){var r,o,a,s=!1!==t.jsonp&&(Oe.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Oe.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=m.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Oe,"$1"+r):!1!==t.jsonp&&(t.url+=(ce.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||m.error(r+" was not called"),a[0]},t.dataTypes[0]="json",o=n[r],n[r]=function(){a=arguments},i.always((function(){void 0===o?m(n).removeProp(r):n[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,De.push(r)),a&&m.isFunction(o)&&o(a[0]),a=o=void 0})),"script"})),m.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||a;var i=S.exec(t),r=!n&&[];return i?[e.createElement(i[1])]:(i=rt([t],e,r),r&&r.length&&m(r).remove(),m.merge([],i.childNodes))};var Ie=m.fn.load;function Le(t){return m.isWindow(t)?t:9===t.nodeType&&t.defaultView}m.fn.load=function(t,e,n){if("string"!=typeof t&&Ie)return Ie.apply(this,arguments);var i,r,o,a=this,s=t.indexOf(" ");return s>-1&&(i=m.trim(t.slice(s)),t=t.slice(0,s)),m.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),a.length>0&&m.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done((function(t){o=arguments,a.html(i?m("<div>").append(m.parseHTML(t)).find(i):t)})).always(n&&function(t,e){a.each((function(){n.apply(this,o||[t.responseText,e,t])}))}),this},m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){m.fn[e]=function(t){return this.on(e,t)}})),m.expr.filters.animated=function(t){return m.grep(m.timers,(function(e){return t===e.elem})).length},m.offset={setOffset:function(t,e,n){var i,r,o,a,s,l,u=m.css(t,"position"),c=m(t),h={};"static"===u&&(t.style.position="relative"),s=c.offset(),o=m.css(t,"top"),l=m.css(t,"left"),("absolute"===u||"fixed"===u)&&(o+l).indexOf("auto")>-1?(a=(i=c.position()).top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(l)||0),m.isFunction(e)&&(e=e.call(t,n,m.extend({},s))),null!=e.top&&(h.top=e.top-s.top+a),null!=e.left&&(h.left=e.left-s.left+r),"using"in e?e.using.call(t,h):c.css(h)}},m.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){m.offset.setOffset(this,t,e)}));var e,n,i=this[0],r={top:0,left:0},o=i&&i.ownerDocument;return o?(e=o.documentElement,m.contains(e,i)?(r=i.getBoundingClientRect(),n=Le(o),{top:r.top+n.pageYOffset-e.clientTop,left:r.left+n.pageXOffset-e.clientLeft}):r):void 0},position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===m.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),m.nodeName(t[0],"html")||(i=t.offset()),i.top+=m.css(t[0],"borderTopWidth",!0),i.left+=m.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-m.css(n,"marginTop",!0),left:e.left-i.left-m.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===m.css(t,"position");)t=t.offsetParent;return t||Dt}))}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;m.fn[t]=function(i){return N(this,(function(t,i,r){var o=Le(t);if(void 0===r)return o?o[e]:t[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r}),t,i,arguments.length)}})),m.each(["top","left"],(function(t,e){m.cssHooks[e]=It(f.pixelPosition,(function(t,n){if(n)return n=Ot(t,e),Et.test(n)?m(t).position()[e]+"px":n}))})),m.each({Height:"height",Width:"width"},(function(t,e){m.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,i){m.fn[i]=function(i,r){var o=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===r?"margin":"border");return N(this,(function(e,n,i){var r;return m.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===i?m.css(e,n,a):m.style(e,n,i,a)}),e,o?i:void 0,o,null)}}))})),m.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},size:function(){return this.length}}),m.fn.andSelf=m.fn.addBack,void 0===(i=function(){return m}.apply(e,[]))||(t.exports=i);var Re=n.jQuery,Ne=n.$;return m.noConflict=function(t){return n.$===m&&(n.$=Ne),t&&n.jQuery===m&&(n.jQuery=Re),m},r||(n.jQuery=n.$=m),m},"object"==typeof t.exports?t.exports=r.document?o(r,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return o(t)}:o(r)},6:function(t,e,n){"use strict";var i,r,o=n(4),a=function(){};"undefined"==typeof console&&(console={},window&&(window.console=console)),void 0===(r=console).log&&(r.log=a),void 0===r.info&&(r.info=a),void 0===r.warn&&(r.warn=a),void 0===r.error&&(r.error=a),void 0===r.time&&(r.time=a),void 0===r.timeEnd&&(r.timeEnd=a),void 0===r.log.apply&&(r.log=Function.prototype.bind.call(console.log,console)),void 0===r.info.apply&&(r.info=Function.prototype.bind.call(console.info,console)),void 0===r.warn.apply&&(r.warn=Function.prototype.bind.call(console.warn,console)),void 0===r.error.apply&&(r.error=Function.prototype.bind.call(console.error,console)),void 0===r.time.apply&&(r.time=Function.prototype.bind.call(console.time,console)),void 0===r.timeEnd.apply&&(r.timeEnd=Function.prototype.bind.call(console.timeEnd,console)),i={log:function(){o.a.logging&&r.log.apply(r,arguments)},info:function(){o.a.logging&&r.info.apply(r,arguments)},warn:function(){o.a.logging&&r.warn.apply(r,arguments)},error:function(){o.a.logging&&r.error.apply(r,arguments)},time:function(){o.a.tracing&&r.time.apply(r,arguments)},timeEnd:function(){o.a.tracing&&r.timeEnd.apply(r,arguments)}},e.a=i},7:function(t,e,n){(function(){var n=n||{};n.WEBGL_RENDERER=0,n.CANVAS_RENDERER=1,n.VERSION="v1.6.1",n.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},n.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},n._UID=0,"undefined"!=typeof Float32Array?(n.Float32Array=Float32Array,n.Uint16Array=Uint16Array):(n.Float32Array=Array,n.Uint16Array=Array),n.INTERACTION_FREQUENCY=30,n.AUTO_PREVENT_DEFAULT=!0,n.RAD_TO_DEG=180/Math.PI,n.DEG_TO_RAD=Math.PI/180,n.dontSayHello=!1,n.sayHello=function(t){if(!n.dontSayHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["%c %c %c Pixi.js "+n.VERSION+" - "+t+"  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];console.log.apply(console,e)}else window.console&&console.log("Pixi.js "+n.VERSION+" - http://www.pixijs.com/");n.dontSayHello=!0}},n.Point=function(t,e){this.x=t||0,this.y=e||0},n.Point.prototype.clone=function(){return new n.Point(this.x,this.y)},n.Point.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},n.Point.prototype.constructor=n.Point,n.Rectangle=function(t,e,n,i){this.x=t||0,this.y=e||0,this.width=n||0,this.height=i||0},n.Rectangle.prototype.clone=function(){return new n.Rectangle(this.x,this.y,this.width,this.height)},n.Rectangle.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=this.x;if(t>=n&&t<=n+this.width){var i=this.y;if(e>=i&&e<=i+this.height)return!0}return!1},n.Rectangle.prototype.constructor=n.Rectangle,n.EmptyRectangle=new n.Rectangle(0,0,0,0),n.Polygon=function(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),"number"==typeof t[0]){for(var e=[],i=0,r=t.length;r>i;i+=2)e.push(new n.Point(t[i],t[i+1]));t=e}this.points=t},n.Polygon.prototype.clone=function(){for(var t=[],e=0;e<this.points.length;e++)t.push(this.points[e].clone());return new n.Polygon(t)},n.Polygon.prototype.contains=function(t,e){for(var n=!1,i=0,r=this.points.length-1;i<this.points.length;r=i++){var o=this.points[i].x,a=this.points[i].y,s=this.points[r].x,l=this.points[r].y;a>e!=l>e&&(s-o)*(e-a)/(l-a)+o>t&&(n=!n)}return n},n.Polygon.prototype.constructor=n.Polygon,n.Circle=function(t,e,n){this.x=t||0,this.y=e||0,this.radius=n||0},n.Circle.prototype.clone=function(){return new n.Circle(this.x,this.y,this.radius)},n.Circle.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.x-t,i=this.y-e;return this.radius*this.radius>=(n*=n)+(i*=i)},n.Circle.prototype.getBounds=function(){return new n.Rectangle(this.x-this.radius,this.y-this.radius,this.width,this.height)},n.Circle.prototype.constructor=n.Circle,n.Ellipse=function(t,e,n,i){this.x=t||0,this.y=e||0,this.width=n||0,this.height=i||0},n.Ellipse.prototype.clone=function(){return new n.Ellipse(this.x,this.y,this.width,this.height)},n.Ellipse.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,i=(e-this.y)/this.height;return 1>=(n*=n)+(i*=i)},n.Ellipse.prototype.getBounds=function(){return new n.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},n.Ellipse.prototype.constructor=n.Ellipse,n.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},n.Matrix.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},n.Matrix.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));var e=this.array;return t?(e[0]=this.a,e[1]=this.c,e[2]=0,e[3]=this.b,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty,e[8]=1):(e[0]=this.a,e[1]=this.b,e[2]=this.tx,e[3]=this.c,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0,e[8]=1),e},n.identityMatrix=new n.Matrix,n.determineMatrixArrayType=function(){return"undefined"!=typeof Float32Array?Float32Array:Array},n.Matrix2=n.determineMatrixArrayType(),n.DisplayObject=function(){this.position=new n.Point,this.scale=new n.Point(1,1),this.pivot=new n.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=new n.Matrix,this.color=[],this.dynamic=!0,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new n.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},n.DisplayObject.prototype.constructor=n.DisplayObject,n.DisplayObject.prototype.setInteractive=function(t){this.interactive=t},Object.defineProperty(n.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(t){this._interactive=t,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(n.DisplayObject.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}}),Object.defineProperty(n.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(n.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(t){if(t){for(var e=[],n=0;n<t.length;n++)for(var i=t[n].passes,r=0;r<i.length;r++)e.push(i[r]);this._filterBlock={target:this,filterPasses:e}}this._filters=t}}),Object.defineProperty(n.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}),n.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var t=this.parent.worldTransform,e=this.worldTransform,n=this.pivot.x,i=this.pivot.y,r=this._cr*this.scale.x,o=-this._sr*this.scale.y,a=this._sr*this.scale.x,s=this._cr*this.scale.y,l=this.position.x-r*n-i*o,u=this.position.y-s*i-n*a,c=t.a,h=t.b,d=t.c,p=t.d;e.a=c*r+h*a,e.b=c*o+h*s,e.tx=c*l+h*u+t.tx,e.c=d*r+p*a,e.d=d*o+p*s,e.ty=d*l+p*u+t.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha},n.DisplayObject.prototype.getBounds=function(t){return t=t,n.EmptyRectangle},n.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(n.identityMatrix)},n.DisplayObject.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0)},n.DisplayObject.prototype.generateTexture=function(t){var e=this.getLocalBounds(),i=new n.RenderTexture(0|e.width,0|e.height,t);return i.render(this,new n.Point(-e.x,-e.y)),i},n.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},n.DisplayObject.prototype._renderCachedSprite=function(t){this._cachedSprite.worldAlpha=this.worldAlpha,t.gl?n.Sprite.prototype._renderWebGL.call(this._cachedSprite,t):n.Sprite.prototype._renderCanvas.call(this._cachedSprite,t)},n.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|t.width,0|t.height);else{var e=new n.RenderTexture(0|t.width,0|t.height);this._cachedSprite=new n.Sprite(e),this._cachedSprite.worldTransform=this.worldTransform}var i=this._filters;this._filters=null,this._cachedSprite.filters=i,this._cachedSprite.texture.render(this,new n.Point(-t.x,-t.y)),this._cachedSprite.anchor.x=-t.x/t.width,this._cachedSprite.anchor.y=-t.y/t.height,this._filters=i,this._cacheAsBitmap=!0},n.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},n.DisplayObject.prototype._renderWebGL=function(t){t=t},n.DisplayObject.prototype._renderCanvas=function(t){t=t},Object.defineProperty(n.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(n.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),n.DisplayObjectContainer=function(){n.DisplayObject.call(this),this.children=[]},n.DisplayObjectContainer.prototype=Object.create(n.DisplayObject.prototype),n.DisplayObjectContainer.prototype.constructor=n.DisplayObjectContainer,Object.defineProperty(n.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/(e/this.scale.x):1,this._width=t}}),Object.defineProperty(n.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/(e/this.scale.y):1,this._height=t}}),n.DisplayObjectContainer.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)},n.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this.stage&&t.setStageReference(this.stage),t;throw new Error(t+" The index "+e+" supplied is out of bounds "+this.children.length)},n.DisplayObjectContainer.prototype.swapChildren=function(t,e){if(t!==e){var n=this.children.indexOf(t),i=this.children.indexOf(e);if(0>n||0>i)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[n]=e,this.children[i]=t}},n.DisplayObjectContainer.prototype.getChildAt=function(t){if(t>=0&&t<this.children.length)return this.children[t];throw new Error("Supplied index does not exist in the child list, or the supplied DisplayObject must be a child of the caller")},n.DisplayObjectContainer.prototype.removeChild=function(t){return this.removeChildAt(this.children.indexOf(t))},n.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return this.stage&&e.removeStageReference(),e.parent=void 0,this.children.splice(t,1),e},n.DisplayObjectContainer.prototype.removeChildren=function(t,e){var n=t||0,i="number"==typeof e?e:this.children.length,r=i-n;if(r>0&&i>=r){for(var o=this.children.splice(n,r),a=0;a<o.length;a++){var s=o[a];this.stage&&s.removeStageReference(),s.parent=void 0}return o}throw new Error("Range Error, numeric values are outside the acceptable range")},n.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(n.DisplayObject.prototype.updateTransform.call(this),!this._cacheAsBitmap))for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform()},n.DisplayObjectContainer.prototype.getBounds=function(t){if(0===this.children.length)return n.EmptyRectangle;if(t){var e=this.worldTransform;this.worldTransform=t,this.updateTransform(),this.worldTransform=e}for(var i,r,o,a=1/0,s=1/0,l=-1/0,u=-1/0,c=!1,h=0,d=this.children.length;d>h;h++){this.children[h].visible&&(c=!0,a=a<(i=this.children[h].getBounds(t)).x?a:i.x,s=s<i.y?s:i.y,l=l>(r=i.width+i.x)?l:r,u=u>(o=i.height+i.y)?u:o)}if(!c)return n.EmptyRectangle;var p=this._bounds;return p.x=a,p.y=s,p.width=l-a,p.height=u-s,p},n.DisplayObjectContainer.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=n.identityMatrix;for(var e=0,i=this.children.length;i>e;e++)this.children[e].updateTransform();var r=this.getBounds();return this.worldTransform=t,r},n.DisplayObjectContainer.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0);for(var e=0,n=this.children.length;n>e;e++){this.children[e].setStageReference(t)}},n.DisplayObjectContainer.prototype.removeStageReference=function(){for(var t=0,e=this.children.length;e>t;t++){this.children[t].removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},n.DisplayObjectContainer.prototype._renderWebGL=function(t){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(t);var e,n;if(this._mask||this._filters){for(this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),e=0,n=this.children.length;n>e;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._mask&&t.maskManager.popMask(this._mask,t),this._filters&&t.filterManager.popFilter(),t.spriteBatch.start()}else for(e=0,n=this.children.length;n>e;e++)this.children[e]._renderWebGL(t)}},n.DisplayObjectContainer.prototype._renderCanvas=function(t){if(!1!==this.visible&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(t);this._mask&&t.maskManager.pushMask(this._mask,t.context);for(var e=0,n=this.children.length;n>e;e++){this.children[e]._renderCanvas(t)}this._mask&&t.maskManager.popMask(t.context)}},n.Sprite=function(t){n.DisplayObjectContainer.call(this),this.anchor=new n.Point,this.texture=t,this._width=0,this._height=0,this.tint=16777215,this.blendMode=n.blendModes.NORMAL,t.baseTexture.hasLoaded?this.onTextureUpdate():(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},n.Sprite.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Sprite.prototype.constructor=n.Sprite,Object.defineProperty(n.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(n.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),n.Sprite.prototype.setTexture=function(t){this.texture=t,this.cachedTint=16777215},n.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},n.Sprite.prototype.getBounds=function(t){var e=this.texture.frame.width,n=this.texture.frame.height,i=e*(1-this.anchor.x),r=e*-this.anchor.x,o=n*(1-this.anchor.y),a=n*-this.anchor.y,s=t||this.worldTransform,l=s.a,u=s.c,c=s.b,h=s.d,d=s.tx,p=s.ty,f=l*r+c*a+d,m=h*a+u*r+p,g=l*i+c*a+d,v=h*a+u*i+p,y=l*i+c*o+d,b=h*o+u*i+p,_=l*r+c*o+d,x=h*o+u*r+p,w=-1/0,C=-1/0,T=1/0,S=1/0;T=(T=(T=(T=T>f?f:T)>g?g:T)>y?y:T)>_?_:T,S=(S=(S=(S=S>m?m:S)>v?v:S)>b?b:S)>x?x:S,w=_>(w=y>(w=g>(w=f>w?f:w)?g:w)?y:w)?_:w,C=x>(C=b>(C=v>(C=m>C?m:C)?v:C)?b:C)?x:C;var k=this._bounds;return k.x=T,k.width=w-T,k.y=S,k.height=C-S,this._currentBounds=k,k},n.Sprite.prototype._renderWebGL=function(t){var e,n;if(this.visible&&!(this.alpha<=0))if(this._mask||this._filters){var i=t.spriteBatch;for(this._filters&&(i.flush(),t.filterManager.pushFilter(this._filterBlock)),this._mask&&(i.stop(),t.maskManager.pushMask(this.mask,t),i.start()),i.render(this),e=0,n=this.children.length;n>e;e++)this.children[e]._renderWebGL(t);i.stop(),this._mask&&t.maskManager.popMask(this._mask,t),this._filters&&t.filterManager.popFilter(),i.start()}else for(t.spriteBatch.render(this),e=0,n=this.children.length;n>e;e++)this.children[e]._renderWebGL(t)},n.Sprite.prototype._renderCanvas=function(t){if(!1!==this.visible&&0!==this.alpha){if(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t.context),this.texture.valid){t.context.globalAlpha=this.worldAlpha,t.roundPixels?t.context.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,0|this.worldTransform.tx,0|this.worldTransform.ty):t.context.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,this.worldTransform.tx,this.worldTransform.ty),t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,t.context[t.smoothProperty]=t.scaleMode===n.scaleModes.LINEAR);var e=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,i=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=n.CanvasTinter.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,e,i,this.texture.crop.width,this.texture.crop.height)):t.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,e,i,this.texture.crop.width,this.texture.crop.height)}for(var r=0,o=this.children.length;o>r;r++)this.children[r]._renderCanvas(t);this._mask&&t.maskManager.popMask(t.context)}},n.Sprite.fromFrame=function(t){var e=n.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new n.Sprite(e)},n.Sprite.fromImage=function(t,e,i){var r=n.Texture.fromImage(t,e,i);return new n.Sprite(r)},n.SpriteBatch=function(t){n.DisplayObjectContainer.call(this),this.textureThing=t,this.ready=!1},n.SpriteBatch.prototype=Object.create(n.DisplayObjectContainer.prototype),n.SpriteBatch.constructor=n.SpriteBatch,n.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new n.WebGLFastSpriteBatch(t),this.ready=!0},n.SpriteBatch.prototype.updateTransform=function(){n.DisplayObject.prototype.updateTransform.call(this)},n.SpriteBatch.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(t.gl),t.spriteBatch.stop(),t.shaderManager.setShader(t.shaderManager.fastShader),this.fastSpriteBatch.begin(this,t),this.fastSpriteBatch.render(this),t.spriteBatch.start())},n.SpriteBatch.prototype._renderCanvas=function(t){var e=t.context;e.globalAlpha=this.worldAlpha,n.DisplayObject.prototype.updateTransform.call(this);for(var i=this.worldTransform,r=!0,o=0;o<this.children.length;o++){var a=this.children[o];if(a.visible){var s=a.texture,l=s.frame;if(e.globalAlpha=this.worldAlpha*a.alpha,a.rotation%(2*Math.PI)==0)r&&(e.setTransform(i.a,i.c,i.b,i.d,i.tx,i.ty),r=!1),e.drawImage(s.baseTexture.source,l.x,l.y,l.width,l.height,a.anchor.x*-l.width*a.scale.x+a.position.x+.5|0,a.anchor.y*-l.height*a.scale.y+a.position.y+.5|0,l.width*a.scale.x,l.height*a.scale.y);else{r||(r=!0),n.DisplayObject.prototype.updateTransform.call(a);var u=a.worldTransform;t.roundPixels?e.setTransform(u.a,u.c,u.b,u.d,0|u.tx,0|u.ty):e.setTransform(u.a,u.c,u.b,u.d,u.tx,u.ty),e.drawImage(s.baseTexture.source,l.x,l.y,l.width,l.height,a.anchor.x*-l.width+.5|0,a.anchor.y*-l.height+.5|0,l.width,l.height)}}}},n.MovieClip=function(t){n.Sprite.call(this,t[0]),this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1},n.MovieClip.prototype=Object.create(n.Sprite.prototype),n.MovieClip.prototype.constructor=n.MovieClip,Object.defineProperty(n.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),n.MovieClip.prototype.stop=function(){this.playing=!1},n.MovieClip.prototype.play=function(){this.playing=!0},n.MovieClip.prototype.gotoAndStop=function(t){this.playing=!1,this.currentFrame=t;var e=this.currentFrame+.5|0;this.setTexture(this.textures[e%this.textures.length])},n.MovieClip.prototype.gotoAndPlay=function(t){this.currentFrame=t,this.playing=!0},n.MovieClip.prototype.updateTransform=function(){if(n.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var t=this.currentFrame+.5|0;this.currentFrame=this.currentFrame%this.textures.length,this.loop||t<this.textures.length?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},n.MovieClip.fromFrames=function(t){for(var e=[],i=0;i<t.length;i++)e.push(new n.Texture.fromFrame(t[i]));return new n.MovieClip(e)},n.MovieClip.fromImages=function(t){for(var e=[],i=0;i<t.length;i++)e.push(new n.Texture.fromImage(t[i]));return new n.MovieClip(e)},n.FilterBlock=function(){this.visible=!0,this.renderable=!0},n.Text=function(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),n.Sprite.call(this,n.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(e)},n.Text.prototype=Object.create(n.Sprite.prototype),n.Text.prototype.constructor=n.Text,Object.defineProperty(n.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(n.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),n.Text.prototype.setStyle=function(t){(t=t||{}).font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowAngle=t.dropShadowAngle||Math.PI/6,t.dropShadowDistance=t.dropShadowDistance||4,t.dropShadowColor=t.dropShadowColor||"black",this.style=t,this.dirty=!0},n.Text.prototype.setText=function(t){this.text=t.toString()||" ",this.dirty=!0},n.Text.prototype.updateText=function(){this.context.font=this.style.font;var t=this.text;this.style.wordWrap&&(t=this.wordWrap(this.text));for(var e=t.split(/(?:\r\n|\r|\n)/),n=[],i=0,r=0;r<e.length;r++){var o=this.context.measureText(e[r]).width;n[r]=o,i=Math.max(i,o)}var a=i+this.style.strokeThickness;this.style.dropShadow&&(a+=this.style.dropShadowDistance),this.canvas.width=a+this.context.lineWidth;var s,l,u=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness,c=u*e.length;if(this.style.dropShadow&&(c+=this.style.dropShadowDistance),this.canvas.height=c,navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top",this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var h=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,d=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(r=0;r<e.length;r++)s=this.style.strokeThickness/2,l=this.style.strokeThickness/2+r*u,"right"===this.style.align?s+=i-n[r]:"center"===this.style.align&&(s+=(i-n[r])/2),this.style.fill&&this.context.fillText(e[r],s+h,l+d)}for(this.context.fillStyle=this.style.fill,r=0;r<e.length;r++)s=this.style.strokeThickness/2,l=this.style.strokeThickness/2+r*u,"right"===this.style.align?s+=i-n[r]:"center"===this.style.align&&(s+=(i-n[r])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(e[r],s,l),this.style.fill&&this.context.fillText(e[r],s,l);this.updateTexture()},n.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.crop.width=this.texture.frame.width=this.canvas.width,this.texture.crop.height=this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,this.requiresUpdate=!0},n.Text.prototype._renderWebGL=function(t){this.requiresUpdate&&(this.requiresUpdate=!1,n.updateWebGLTexture(this.texture.baseTexture,t.gl)),n.Sprite.prototype._renderWebGL.call(this,t)},n.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),n.Sprite.prototype.updateTransform.call(this)},n.Text.prototype.determineFontHeight=function(t){var e=n.Text.heightCache[t];if(!e){var i=document.getElementsByTagName("body")[0],r=document.createElement("div"),o=document.createTextNode("M");r.appendChild(o),r.setAttribute("style",t+";position:absolute;top:0;left:0"),i.appendChild(r),e=r.offsetHeight,n.Text.heightCache[t]=e,i.removeChild(r)}return e},n.Text.prototype.wordWrap=function(t){for(var e="",n=t.split("\n"),i=0;i<n.length;i++){for(var r=this.style.wordWrapWidth,o=n[i].split(" "),a=0;a<o.length;a++){var s=this.context.measureText(o[a]).width,l=s+this.context.measureText(" ").width;0===a||l>r?(a>0&&(e+="\n"),e+=o[a],r=this.style.wordWrapWidth-s):(r-=l,e+=" "+o[a])}i<n.length-1&&(e+="\n")}return e},n.Text.prototype.destroy=function(t){this.context=null,this.canvas=null,this.texture.destroy(void 0===t||t)},n.Text.heightCache={},n.BitmapText=function(t,e){n.DisplayObjectContainer.call(this),this._pool=[],this.setText(t),this.setStyle(e),this.updateText(),this.dirty=!1},n.BitmapText.prototype=Object.create(n.DisplayObjectContainer.prototype),n.BitmapText.prototype.constructor=n.BitmapText,n.BitmapText.prototype.setText=function(t){this.text=t||" ",this.dirty=!0},n.BitmapText.prototype.setStyle=function(t){(t=t||{}).align=t.align||"left",this.style=t;var e=t.font.split(" ");this.fontName=e[e.length-1],this.fontSize=e.length>=2?parseInt(e[e.length-2],10):n.BitmapText.fonts[this.fontName].size,this.dirty=!0,this.tint=t.tint},n.BitmapText.prototype.updateText=function(){for(var t=n.BitmapText.fonts[this.fontName],e=new n.Point,i=null,r=[],o=0,a=[],s=0,l=this.fontSize/t.size,u=0;u<this.text.length;u++){var c=this.text.charCodeAt(u);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(u)))a.push(e.x),o=Math.max(o,e.x),s++,e.x=0,e.y+=t.lineHeight,i=null;else{var h=t.chars[c];h&&(i&&h[i]&&(e.x+=h.kerning[i]),r.push({texture:h.texture,line:s,charCode:c,position:new n.Point(e.x+h.xOffset,e.y+h.yOffset)}),e.x+=h.xAdvance,i=c)}}a.push(e.x),o=Math.max(o,e.x);var d=[];for(u=0;s>=u;u++){var p=0;"right"===this.style.align?p=o-a[u]:"center"===this.style.align&&(p=(o-a[u])/2),d.push(p)}var f=this.children.length,m=r.length,g=this.tint||16777215;for(u=0;m>u;u++){var v=f>u?this.children[u]:this._pool.pop();v?v.setTexture(r[u].texture):v=new n.Sprite(r[u].texture),v.position.x=(r[u].position.x+d[r[u].line])*l,v.position.y=r[u].position.y*l,v.scale.x=v.scale.y=l,v.tint=g,v.parent||this.addChild(v)}for(;this.children.length>m;){var y=this.getChildAt(this.children.length-1);this._pool.push(y),this.removeChild(y)}this.textWidth=o*l,this.textHeight=(e.y+t.lineHeight)*l},n.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),n.DisplayObjectContainer.prototype.updateTransform.call(this)},n.BitmapText.fonts={},n.InteractionData=function(){this.global=new n.Point,this.target=null,this.originalEvent=null},n.InteractionData.prototype.getLocalPosition=function(t){var e=t.worldTransform,i=this.global,r=e.a,o=e.b,a=e.tx,s=e.c,l=e.d,u=e.ty,c=1/(r*l+o*-s);return new n.Point(l*c*i.x+-o*c*i.y+(u*o-a*l)*c,r*c*i.y+-s*c*i.x+(-u*r+a*s)*c)},n.InteractionData.prototype.constructor=n.InteractionData,n.InteractionManager=function(t){this.stage=t,this.mouse=new n.InteractionData,this.touchs={},this.tempPoint=new n.Point,this.mouseoverEnabled=!0,this.pool=[],this.interactiveItems=[],this.interactionDOMElement=null,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this.mouseOut=!1},n.InteractionManager.prototype.constructor=n.InteractionManager,n.InteractionManager.prototype.collectInteractiveSprite=function(t,e){for(var n=t.children,i=n.length-1;i>=0;i--){var r=n[i];r._interactive?(e.interactiveChildren=!0,this.interactiveItems.push(r),r.children.length>0&&this.collectInteractiveSprite(r,r)):(r.__iParent=null,r.children.length>0&&this.collectInteractiveSprite(r,e))}},n.InteractionManager.prototype.setTarget=function(t){this.target=t,null===this.interactionDOMElement&&this.setTargetDomElement(t.view)},n.InteractionManager.prototype.setTargetDomElement=function(t){this.removeEvents(),window.navigator.msPointerEnabled&&(t.style["-ms-content-zooming"]="none",t.style["-ms-touch-action"]="none"),this.interactionDOMElement=t,t.addEventListener("mousemove",this.onMouseMove,!0),t.addEventListener("mousedown",this.onMouseDown,!0),t.addEventListener("mouseout",this.onMouseOut,!0),t.addEventListener("touchstart",this.onTouchStart,!0),t.addEventListener("touchend",this.onTouchEnd,!0),t.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0)},n.InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0))},n.InteractionManager.prototype.update=function(){if(this.target){var t=Date.now(),e=t-this.last;if(!(1>(e=e*n.INTERACTION_FREQUENCY/1e3))){this.last=t;var i=0;this.dirty&&this.rebuildInteractiveGraph();var r=this.interactiveItems.length,o="inherit",a=!1;for(i=0;r>i;i++){var s=this.interactiveItems[i];s.__hit=this.hitTest(s,this.mouse),this.mouse.target=s,s.__hit&&!a?(s.buttonMode&&(o=s.defaultCursor),s.interactiveChildren||(a=!0),s.__isOver||(s.mouseover&&s.mouseover(this.mouse),s.__isOver=!0)):s.__isOver&&(s.mouseout&&s.mouseout(this.mouse),s.__isOver=!1)}this.currentCursorStyle!==o&&(this.currentCursorStyle=o,this.interactionDOMElement.style.cursor=o)}}},n.InteractionManager.prototype.rebuildInteractiveGraph=function(){this.dirty=!1;for(var t=this.interactiveItems.length,e=0;t>e;e++)this.interactiveItems[e].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)},n.InteractionManager.prototype.onMouseMove=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t||window.event;var e=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(t.clientX-e.left)*(this.target.width/e.width),this.mouse.global.y=(t.clientY-e.top)*(this.target.height/e.height);for(var n=this.interactiveItems.length,i=0;n>i;i++){var r=this.interactiveItems[i];r.mousemove&&r.mousemove(this.mouse)}},n.InteractionManager.prototype.onMouseDown=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t||window.event,n.AUTO_PREVENT_DEFAULT&&this.mouse.originalEvent.preventDefault();for(var e=this.interactiveItems.length,i=0;e>i;i++){var r=this.interactiveItems[i];if((r.mousedown||r.click)&&(r.__mouseIsDown=!0,r.__hit=this.hitTest(r,this.mouse),r.__hit&&(r.mousedown&&r.mousedown(this.mouse),r.__isDown=!0,!r.interactiveChildren)))break}},n.InteractionManager.prototype.onMouseOut=function(){this.dirty&&this.rebuildInteractiveGraph();var t=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var e=0;t>e;e++){var n=this.interactiveItems[e];n.__isOver&&(this.mouse.target=n,n.mouseout&&n.mouseout(this.mouse),n.__isOver=!1)}this.mouseOut=!0,this.mouse.global.x=-1e4,this.mouse.global.y=-1e4},n.InteractionManager.prototype.onMouseUp=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t||window.event;for(var e=this.interactiveItems.length,n=!1,i=0;e>i;i++){var r=this.interactiveItems[i];r.__hit=this.hitTest(r,this.mouse),r.__hit&&!n?(r.mouseup&&r.mouseup(this.mouse),r.__isDown&&r.click&&r.click(this.mouse),r.interactiveChildren||(n=!0)):r.__isDown&&r.mouseupoutside&&r.mouseupoutside(this.mouse),r.__isDown=!1}},n.InteractionManager.prototype.hitTest=function(t,e){var i=e.global;if(!t.worldVisible)return!1;var r=t instanceof n.Sprite,o=t.worldTransform,a=o.a,s=o.b,l=o.tx,u=o.c,c=o.d,h=o.ty,d=1/(a*c+s*-u),p=c*d*i.x+-s*d*i.y+(h*s-l*c)*d,f=a*d*i.y+-u*d*i.x+(-h*a+l*u)*d;if(e.target=t,t.hitArea&&t.hitArea.contains)return!!t.hitArea.contains(p,f)&&(e.target=t,!0);if(r){var m,g=t.texture.frame.width,v=t.texture.frame.height,y=-g*t.anchor.x;if(p>y&&y+g>p&&(f>(m=-v*t.anchor.y)&&m+v>f))return e.target=t,!0}for(var b=t.children.length,_=0;b>_;_++){var x=t.children[_];if(this.hitTest(x,e))return e.target=t,!0}return!1},n.InteractionManager.prototype.onTouchMove=function(t){this.dirty&&this.rebuildInteractiveGraph();var e,n=this.interactionDOMElement.getBoundingClientRect(),i=t.changedTouches,r=0;for(r=0;r<i.length;r++){var o=i[r];(e=this.touchs[o.identifier]).originalEvent=t||window.event,e.global.x=(o.clientX-n.left)*(this.target.width/n.width),e.global.y=(o.clientY-n.top)*(this.target.height/n.height),navigator.isCocoonJS&&(e.global.x=o.clientX,e.global.y=o.clientY);for(var a=0;a<this.interactiveItems.length;a++){var s=this.interactiveItems[a];s.touchmove&&s.__touchData&&s.__touchData[o.identifier]&&s.touchmove(e)}}},n.InteractionManager.prototype.onTouchStart=function(t){this.dirty&&this.rebuildInteractiveGraph();var e=this.interactionDOMElement.getBoundingClientRect();n.AUTO_PREVENT_DEFAULT&&t.preventDefault();for(var i=t.changedTouches,r=0;r<i.length;r++){var o=i[r],a=this.pool.pop();a||(a=new n.InteractionData),a.originalEvent=t||window.event,this.touchs[o.identifier]=a,a.global.x=(o.clientX-e.left)*(this.target.width/e.width),a.global.y=(o.clientY-e.top)*(this.target.height/e.height),navigator.isCocoonJS&&(a.global.x=o.clientX,a.global.y=o.clientY);for(var s=this.interactiveItems.length,l=0;s>l;l++){var u=this.interactiveItems[l];if((u.touchstart||u.tap)&&(u.__hit=this.hitTest(u,a),u.__hit&&(u.touchstart&&u.touchstart(a),u.__isDown=!0,u.__touchData=u.__touchData||{},u.__touchData[o.identifier]=a,!u.interactiveChildren)))break}}},n.InteractionManager.prototype.onTouchEnd=function(t){this.dirty&&this.rebuildInteractiveGraph();for(var e=this.interactionDOMElement.getBoundingClientRect(),n=t.changedTouches,i=0;i<n.length;i++){var r=n[i],o=this.touchs[r.identifier],a=!1;o.global.x=(r.clientX-e.left)*(this.target.width/e.width),o.global.y=(r.clientY-e.top)*(this.target.height/e.height),navigator.isCocoonJS&&(o.global.x=r.clientX,o.global.y=r.clientY);for(var s=this.interactiveItems.length,l=0;s>l;l++){var u=this.interactiveItems[l];u.__touchData&&u.__touchData[r.identifier]&&(u.__hit=this.hitTest(u,u.__touchData[r.identifier]),o.originalEvent=t||window.event,(u.touchend||u.tap)&&(u.__hit&&!a?(u.touchend&&u.touchend(o),u.__isDown&&u.tap&&u.tap(o),u.interactiveChildren||(a=!0)):u.__isDown&&u.touchendoutside&&u.touchendoutside(o),u.__isDown=!1),u.__touchData[r.identifier]=null)}this.pool.push(o),this.touchs[r.identifier]=null}},n.Stage=function(t){n.DisplayObjectContainer.call(this),this.worldTransform=new n.Matrix,this.interactive=!0,this.interactionManager=new n.InteractionManager(this),this.dirty=!0,this.stage=this,this.stage.hitArea=new n.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(t)},n.Stage.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Stage.prototype.constructor=n.Stage,n.Stage.prototype.setInteractionDelegate=function(t){this.interactionManager.setTargetDomElement(t)},n.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},n.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0,this.backgroundColorSplit=n.hex2rgb(this.backgroundColor);var e=this.backgroundColor.toString(16);e="000000".substr(0,6-e.length)+e,this.backgroundColorString="#"+e},n.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};for(var i=0,r=["ms","moz","webkit","o"],o=0;o<r.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[r[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[r[o]+"CancelAnimationFrame"]||window[r[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-i)),r=window.setTimeout((function(){t(e+n)}),n);return i=e+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.requestAnimFrame=window.requestAnimationFrame,n.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},n.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var t=Array.prototype.slice;return function(e){function n(){var o=r.concat(t.call(arguments));i.apply(this instanceof n?this:e,o)}var i=this,r=t.call(arguments,1);if("function"!=typeof i)throw new TypeError;return n.prototype=function t(e){return e&&(t.prototype=e),this instanceof t?void 0:new t}(i.prototype),n}}()),n.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return!!window.XMLHttpRequest&&new window.XMLHttpRequest;for(var e=0;e<t.length;e++)try{return new window.ActiveXObject(t[e])}catch(t){}},n.canUseNewCanvasBlendModes=function(){var t=document.createElement("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply",e.fillStyle="#fff",e.fillRect(0,0,1,1),0===e.getImageData(0,0,1,1).data[0]},n.getNextPowerOfTwo=function(t){if(t>0&&0==(t&t-1))return t;for(var e=1;t>e;)e<<=1;return e},n.EventTarget=function(){var t={};this.addEventListener=this.on=function(e,n){void 0===t[e]&&(t[e]=[]),-1===t[e].indexOf(n)&&t[e].unshift(n)},this.dispatchEvent=this.emit=function(e){if(t[e.type]&&t[e.type].length)for(var n=t[e.type].length-1;n>=0;n--)t[e.type][n](e)},this.removeEventListener=this.off=function(e,n){if(void 0!==t[e]){var i=t[e].indexOf(n);-1!==i&&t[e].splice(i,1)}},this.removeAllEventListeners=function(e){var n=t[e];n&&(n.length=0)}},n.autoDetectRenderer=function(t,e,i,r,o){return t||(t=800),e||(e=600),function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(t){return!1}}()?new n.WebGLRenderer(t,e,i,r,o):new n.CanvasRenderer(t,e,i,r)},n.autoDetectRecommendedRenderer=function(t,e,i,r,o){t||(t=800),e||(e=600);var a=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(t){return!1}}(),s=/Android/i.test(navigator.userAgent);return a&&!s?new n.WebGLRenderer(t,e,i,r,o):new n.CanvasRenderer(t,e,i,r)},n.PolyK={},n.PolyK.Triangulate=function(t){var e=!0,i=t.length>>1;if(3>i)return[];for(var r=[],o=[],a=0;i>a;a++)o.push(a);a=0;for(var s=i;s>3;){var l=o[(a+0)%s],u=o[(a+1)%s],c=o[(a+2)%s],h=t[2*l],d=t[2*l+1],p=t[2*u],f=t[2*u+1],m=t[2*c],g=t[2*c+1],v=!1;if(n.PolyK._convex(h,d,p,f,m,g,e)){v=!0;for(var y=0;s>y;y++){var b=o[y];if(b!==l&&b!==u&&b!==c&&n.PolyK._PointInTriangle(t[2*b],t[2*b+1],h,d,p,f,m,g)){v=!1;break}}}if(v)r.push(l,u,c),o.splice((a+1)%s,1),s--,a=0;else if(a++>3*s){if(!e)return window.console.log("PIXI Warning: shape too complex to fill"),[];for(r=[],o=[],a=0;i>a;a++)o.push(a);a=0,s=i,e=!1}}return r.push(o[0],o[1],o[2]),r},n.PolyK._PointInTriangle=function(t,e,n,i,r,o,a,s){var l=a-n,u=s-i,c=r-n,h=o-i,d=t-n,p=e-i,f=l*l+u*u,m=l*c+u*h,g=l*d+u*p,v=c*c+h*h,y=c*d+h*p,b=1/(f*v-m*m),_=(v*g-m*y)*b,x=(f*y-m*g)*b;return _>=0&&x>=0&&1>_+x},n.PolyK._convex=function(t,e,n,i,r,o,a){return(e-i)*(r-n)+(n-t)*(o-i)>=0===a},n.initDefaultShaders=function(){},n.CompileVertexShader=function(t,e){return n._CompileShader(t,e,t.VERTEX_SHADER)},n.CompileFragmentShader=function(t,e){return n._CompileShader(t,e,t.FRAGMENT_SHADER)},n._CompileShader=function(t,e,n){var i=e.join("\n"),r=t.createShader(n);return t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(window.console.log(t.getShaderInfoLog(r)),null)},n.compileProgram=function(t,e,i){var r=n.CompileFragmentShader(t,i),o=n.CompileVertexShader(t,e),a=t.createProgram();return t.attachShader(a,o),t.attachShader(a,r),t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS)||window.console.log("Could not initialise shaders"),a},n.PixiShader=function(t){this._UID=n._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.attributes=[],this.init()},n.PixiShader.prototype.init=function(){var t=this.gl,e=n.compileProgram(t,this.vertexSrc||n.PixiShader.defaultVertexSrc,this.fragmentSrc);for(var i in t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.dimensions=t.getUniformLocation(e,"dimensions"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(e,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute],this.uniforms)this.uniforms[i].uniformLocation=t.getUniformLocation(e,i);this.initUniforms(),this.program=e},n.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var t,e=this.gl;for(var n in this.uniforms){var i=(t=this.uniforms[n]).type;"sampler2D"===i?(t._init=!1,null!==t.value&&this.initSampler2D(t)):"mat2"===i||"mat3"===i||"mat4"===i?(t.glMatrix=!0,t.glValueLength=1,"mat2"===i?t.glFunc=e.uniformMatrix2fv:"mat3"===i?t.glFunc=e.uniformMatrix3fv:"mat4"===i&&(t.glFunc=e.uniformMatrix4fv)):(t.glFunc=e["uniform"+i],t.glValueLength="2f"===i||"2i"===i?2:"3f"===i||"3i"===i?3:"4f"===i||"4i"===i?4:1)}},n.PixiShader.prototype.initSampler2D=function(t){if(t.value&&t.value.baseTexture&&t.value.baseTexture.hasLoaded){var e=this.gl;if(e.activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,t.value.baseTexture._glTextures[e.id]),t.textureData){var n=t.textureData,i=n.magFilter?n.magFilter:e.LINEAR,r=n.minFilter?n.minFilter:e.LINEAR,o=n.wrapS?n.wrapS:e.CLAMP_TO_EDGE,a=n.wrapT?n.wrapT:e.CLAMP_TO_EDGE,s=n.luminance?e.LUMINANCE:e.RGBA;if(n.repeat&&(o=e.REPEAT,a=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!n.flipY),n.width){var l=n.width?n.width:512,u=n.height?n.height:2,c=n.border?n.border:0;e.texImage2D(e.TEXTURE_2D,0,s,l,u,c,s,e.UNSIGNED_BYTE,null)}else e.texImage2D(e.TEXTURE_2D,0,s,e.RGBA,e.UNSIGNED_BYTE,t.value.baseTexture.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,a)}e.uniform1i(t.uniformLocation,this.textureCount),t._init=!0,this.textureCount++}},n.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var t,e=this.gl;for(var i in this.uniforms)1===(t=this.uniforms[i]).glValueLength?!0===t.glMatrix?t.glFunc.call(e,t.uniformLocation,t.transpose,t.value):t.glFunc.call(e,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):"sampler2D"===t.type&&(t._init?(e.activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,t.value.baseTexture._glTextures[e.id]||n.createWebGLTexture(t.value.baseTexture,e)),e.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))},n.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},n.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec2 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"],n.PixiFastShader=function(t){this._UID=n._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},n.PixiFastShader.prototype.init=function(){var t=this.gl,e=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.dimensions=t.getUniformLocation(e,"dimensions"),this.uMatrix=t.getUniformLocation(e,"uMatrix"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aPositionCoord=t.getAttribLocation(e,"aPositionCoord"),this.aScale=t.getAttribLocation(e,"aScale"),this.aRotation=t.getAttribLocation(e,"aRotation"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(e,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=e},n.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},n.StripShader=function(t){this._UID=n._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.init()},n.StripShader.prototype.init=function(){var t=this.gl,e=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.colorAttribute=t.getAttribLocation(e,"aColor"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.attributes=[this.aVertexPosition,this.aTextureCoord],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},n.PrimitiveShader=function(t){this._UID=n._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},n.PrimitiveShader.prototype.init=function(){var t=this.gl,e=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.tintColor=t.getUniformLocation(e,"tint"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.colorAttribute=t.getAttribLocation(e,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},n.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},n.ComplexPrimitiveShader=function(t){this._UID=n._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"],this.init()},n.ComplexPrimitiveShader.prototype.init=function(){var t=this.gl,e=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.tintColor=t.getUniformLocation(e,"tint"),this.color=t.getUniformLocation(e,"color"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},n.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},n.WebGLGraphics=function(){},n.WebGLGraphics.renderGraphics=function(t,e){var i,r=e.gl,o=e.projection,a=e.offset,s=e.shaderManager.primitiveShader;t.dirty&&n.WebGLGraphics.updateGraphics(t,r);for(var l=t._webGL[r.id],u=0;u<l.data.length;u++)1===l.data[u].mode?(i=l.data[u],e.stencilManager.pushStencil(t,i,e),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(i.indices.length-4)),e.stencilManager.popStencil(t,i,e),this.last=i.mode):(i=l.data[u],e.shaderManager.setShader(s),s=e.shaderManager.primitiveShader,r.uniformMatrix3fv(s.translationMatrix,!1,t.worldTransform.toArray(!0)),r.uniform2f(s.projectionVector,o.x,-o.y),r.uniform2f(s.offsetVector,-a.x,-a.y),r.uniform3fv(s.tintColor,n.hex2rgb(t.tint)),r.uniform1f(s.alpha,t.worldAlpha),r.bindBuffer(r.ARRAY_BUFFER,i.buffer),r.vertexAttribPointer(s.aVertexPosition,2,r.FLOAT,!1,24,0),r.vertexAttribPointer(s.colorAttribute,4,r.FLOAT,!1,24,8),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,i.indexBuffer),r.drawElements(r.TRIANGLE_STRIP,i.indices.length,r.UNSIGNED_SHORT,0))},n.WebGLGraphics.updateGraphics=function(t,e){var i,r,o=t._webGL[e.id];if(o||(o=t._webGL[e.id]={lastIndex:0,data:[],gl:e}),t.dirty=!1,t.clearDirty){for(t.clearDirty=!1,i=0;i<o.data.length;i++){var a=o.data[i];a.reset(),n.WebGLGraphics.graphicsDataPool.push(a)}o.data=[],o.lastIndex=0}for(i=o.lastIndex;i<t.graphicsData.length;i++){var s=t.graphicsData[i];s.type===n.Graphics.POLY?(s.fill&&s.points.length>6&&(s.points.length>10?(r=n.WebGLGraphics.switchMode(o,1),n.WebGLGraphics.buildComplexPoly(s,r)):(r=n.WebGLGraphics.switchMode(o,0),n.WebGLGraphics.buildPoly(s,r))),s.lineWidth>0&&(r=n.WebGLGraphics.switchMode(o,0),n.WebGLGraphics.buildLine(s,r))):(r=n.WebGLGraphics.switchMode(o,0),s.type===n.Graphics.RECT?n.WebGLGraphics.buildRectangle(s,r):s.type===n.Graphics.CIRC||s.type===n.Graphics.ELIP?n.WebGLGraphics.buildCircle(s,r):s.type===n.Graphics.RREC&&n.WebGLGraphics.buildRoundedRectangle(s,r)),o.lastIndex++}for(i=0;i<o.data.length;i++)(r=o.data[i]).dirty&&r.upload()},n.WebGLGraphics.switchMode=function(t,e){var i;return t.data.length?((i=t.data[t.data.length-1]).mode!==e||1===e)&&((i=n.WebGLGraphics.graphicsDataPool.pop()||new n.WebGLGraphicsData(t.gl)).mode=e,t.data.push(i)):((i=n.WebGLGraphics.graphicsDataPool.pop()||new n.WebGLGraphicsData(t.gl)).mode=e,t.data.push(i)),i.dirty=!0,i},n.WebGLGraphics.buildRectangle=function(t,e){var i=t.points,r=i[0],o=i[1],a=i[2],s=i[3];if(t.fill){var l=n.hex2rgb(t.fillColor),u=t.fillAlpha,c=l[0]*u,h=l[1]*u,d=l[2]*u,p=e.points,f=e.indices,m=p.length/6;p.push(r,o),p.push(c,h,d,u),p.push(r+a,o),p.push(c,h,d,u),p.push(r,o+s),p.push(c,h,d,u),p.push(r+a,o+s),p.push(c,h,d,u),f.push(m,m,m+1,m+2,m+3,m+3)}if(t.lineWidth){var g=t.points;t.points=[r,o,r+a,o,r+a,o+s,r,o+s,r,o],n.WebGLGraphics.buildLine(t,e),t.points=g}},n.WebGLGraphics.buildRoundedRectangle=function(t,e){var i=t.points,r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],u=[];if(u.push(r,o+l),u=(u=(u=(u=u.concat(n.WebGLGraphics.quadraticBezierCurve(r,o+s-l,r,o+s,r+l,o+s))).concat(n.WebGLGraphics.quadraticBezierCurve(r+a-l,o+s,r+a,o+s,r+a,o+s-l))).concat(n.WebGLGraphics.quadraticBezierCurve(r+a,o+l,r+a,o,r+a-l,o))).concat(n.WebGLGraphics.quadraticBezierCurve(r+l,o,r,o,r,o+l)),t.fill){var c=n.hex2rgb(t.fillColor),h=t.fillAlpha,d=c[0]*h,p=c[1]*h,f=c[2]*h,m=e.points,g=e.indices,v=m.length/6,y=n.PolyK.Triangulate(u),b=0;for(b=0;b<y.length;b+=3)g.push(y[b]+v),g.push(y[b]+v),g.push(y[b+1]+v),g.push(y[b+2]+v),g.push(y[b+2]+v);for(b=0;b<u.length;b++)m.push(u[b],u[++b],d,p,f,h)}if(t.lineWidth){var _=t.points;t.points=u,n.WebGLGraphics.buildLine(t,e),t.points=_}},n.WebGLGraphics.quadraticBezierCurve=function(t,e,n,i,r,o){function a(t,e,n){return t+(e-t)*n}for(var s,l,u,c,h,d,p=[],f=0,m=0;20>=m;m++)s=a(t,n,f=m/20),l=a(e,i,f),u=a(n,r,f),c=a(i,o,f),h=a(s,u,f),d=a(l,c,f),p.push(h,d);return p},n.WebGLGraphics.buildCircle=function(t,e){var i=t.points,r=i[0],o=i[1],a=i[2],s=i[3],l=2*Math.PI/40,u=0;if(t.fill){var c=n.hex2rgb(t.fillColor),h=t.fillAlpha,d=c[0]*h,p=c[1]*h,f=c[2]*h,m=e.points,g=e.indices,v=m.length/6;for(g.push(v),u=0;41>u;u++)m.push(r,o,d,p,f,h),m.push(r+Math.sin(l*u)*a,o+Math.cos(l*u)*s,d,p,f,h),g.push(v++,v++);g.push(v-1)}if(t.lineWidth){var y=t.points;for(t.points=[],u=0;41>u;u++)t.points.push(r+Math.sin(l*u)*a,o+Math.cos(l*u)*s);n.WebGLGraphics.buildLine(t,e),t.points=y}},n.WebGLGraphics.buildLine=function(t,e){var i=0,r=t.points;if(0!==r.length){if(t.lineWidth%2)for(i=0;i<r.length;i++)r[i]+=.5;var o=new n.Point(r[0],r[1]),a=new n.Point(r[r.length-2],r[r.length-1]);if(o.x===a.x&&o.y===a.y){(r=r.slice()).pop(),r.pop();var s=(a=new n.Point(r[r.length-2],r[r.length-1])).x+.5*(o.x-a.x),l=a.y+.5*(o.y-a.y);r.unshift(s,l),r.push(s,l)}var u,c,h,d,p,f,m,g,v,y,b,_,x,w,C,T,S,k,A,E,M,P,D=e.points,O=e.indices,I=r.length/2,L=r.length,R=D.length/6,N=t.lineWidth/2,F=n.hex2rgb(t.lineColor),B=t.lineAlpha,z=F[0]*B,j=F[1]*B,V=F[2]*B;for(h=r[0],d=r[1],p=r[2],v=-(d-(f=r[3])),y=h-p,v/=P=Math.sqrt(v*v+y*y),y/=P,v*=N,y*=N,D.push(h-v,d-y,z,j,V,B),D.push(h+v,d+y,z,j,V,B),i=1;I-1>i;i++)h=r[2*(i-1)],d=r[2*(i-1)+1],p=r[2*i],f=r[2*i+1],m=r[2*(i+1)],g=r[2*(i+1)+1],v=-(d-f),y=h-p,v/=P=Math.sqrt(v*v+y*y),y/=P,v*=N,y*=N,b=-(f-g),_=p-m,b/=P=Math.sqrt(b*b+_*_),_/=P,S=(-v+h)*(-y+f)-(-v+p)*(-y+d),E=(-(b*=N)+m)*(-(_*=N)+f)-(-b+p)*(-_+g),M=(C=-y+d-(-y+f))*(A=-b+p-(-b+m))-(k=-_+g-(-_+f))*(T=-v+p-(-v+h)),Math.abs(M)<.1?(M+=10.1,D.push(p-v,f-y,z,j,V,B),D.push(p+v,f+y,z,j,V,B)):((u=(T*E-A*S)/M)-p)*(u-p)+((c=(k*S-C*E)/M)-f)+(c-f)>19600?(x=v-b,w=y-_,x/=P=Math.sqrt(x*x+w*w),w/=P,x*=N,w*=N,D.push(p-x,f-w),D.push(z,j,V,B),D.push(p+x,f+w),D.push(z,j,V,B),D.push(p-x,f-w),D.push(z,j,V,B),L++):(D.push(u,c),D.push(z,j,V,B),D.push(p-(u-p),f-(c-f)),D.push(z,j,V,B));for(h=r[2*(I-2)],d=r[2*(I-2)+1],p=r[2*(I-1)],v=-(d-(f=r[2*(I-1)+1])),y=h-p,v/=P=Math.sqrt(v*v+y*y),y/=P,v*=N,y*=N,D.push(p-v,f-y),D.push(z,j,V,B),D.push(p+v,f+y),D.push(z,j,V,B),O.push(R),i=0;L>i;i++)O.push(R++);O.push(R-1)}},n.WebGLGraphics.buildComplexPoly=function(t,e){var i=t.points.slice();if(!(i.length<6)){var r=e.indices;e.points=i,e.alpha=t.fillAlpha,e.color=n.hex2rgb(t.fillColor);for(var o,a,s=1/0,l=-1/0,u=1/0,c=-1/0,h=0;h<i.length;h+=2)s=s>(o=i[h])?o:s,l=o>l?o:l,u=u>(a=i[h+1])?a:u,c=a>c?a:c;i.push(s,u,l,u,l,c,s,c);var d=i.length/2;for(h=0;d>h;h++)r.push(h)}},n.WebGLGraphics.buildPoly=function(t,e){var i=t.points;if(!(i.length<6)){var r=e.points,o=e.indices,a=i.length/2,s=n.hex2rgb(t.fillColor),l=t.fillAlpha,u=s[0]*l,c=s[1]*l,h=s[2]*l,d=n.PolyK.Triangulate(i),p=r.length/6,f=0;for(f=0;f<d.length;f+=3)o.push(d[f]+p),o.push(d[f]+p),o.push(d[f+1]+p),o.push(d[f+2]+p),o.push(d[f+2]+p);for(f=0;a>f;f++)r.push(i[2*f],i[2*f+1],u,c,h,l)}},n.WebGLGraphics.graphicsDataPool=[],n.WebGLGraphicsData=function(t){this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.lastIndex=0,this.buffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0},n.WebGLGraphicsData.prototype.reset=function(){this.points=[],this.indices=[],this.lastIndex=0},n.WebGLGraphicsData.prototype.upload=function(){var t=this.gl;this.glPoints=new Float32Array(this.points),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW),this.glIndicies=new Uint16Array(this.indices),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndicies,t.STATIC_DRAW),this.dirty=!1},n.glContexts=[],n.WebGLRenderer=function(t,e,i,r,o,a){n.defaultRenderer||(n.sayHello("webGL"),n.defaultRenderer=this),this.type=n.WEBGL_RENDERER,this.transparent=!!r,this.preserveDrawingBuffer=a,this.width=t||800,this.height=e||600,this.view=i||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,this.contextLost=this.handleContextLost.bind(this),this.contextRestoredLost=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.contextLost,!1),this.view.addEventListener("webglcontextrestored",this.contextRestoredLost,!1),this.options={alpha:this.transparent,antialias:!!o,premultipliedAlpha:!!r,stencil:!0,preserveDrawingBuffer:a};var s=null;if(["experimental-webgl","webgl"].forEach((function(t){try{s=s||this.view.getContext(t,this.options)}catch(t){}}),this),!s)throw new Error("This browser does not support webGL. Try using the canvas renderer"+this);this.gl=s,this.glContextId=s.id=n.WebGLRenderer.glContextId++,n.glContexts[this.glContextId]=s,n.blendModesWebGL||(n.blendModesWebGL=[],n.blendModesWebGL[n.blendModes.NORMAL]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.ADD]=[s.SRC_ALPHA,s.DST_ALPHA],n.blendModesWebGL[n.blendModes.MULTIPLY]=[s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.SCREEN]=[s.SRC_ALPHA,s.ONE],n.blendModesWebGL[n.blendModes.OVERLAY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.DARKEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.LIGHTEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.COLOR_DODGE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.COLOR_BURN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.HARD_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.SOFT_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.DIFFERENCE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.EXCLUSION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.HUE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.SATURATION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.COLOR]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.LUMINOSITY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA]),this.projection=new n.Point,this.projection.x=this.width/2,this.projection.y=-this.height/2,this.offset=new n.Point(0,0),this.resize(this.width,this.height),this.contextLost=!1,this.shaderManager=new n.WebGLShaderManager(s),this.spriteBatch=new n.WebGLSpriteBatch(s),this.maskManager=new n.WebGLMaskManager(s),this.filterManager=new n.WebGLFilterManager(s,this.transparent),this.stencilManager=new n.WebGLStencilManager(s),this.blendModeManager=new n.WebGLBlendModeManager(s),this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.stencilManager=this.stencilManager,this.renderSession.renderer=this,s.useProgram(this.shaderManager.defaultShader.program),s.disable(s.DEPTH_TEST),s.disable(s.CULL_FACE),s.enable(s.BLEND),s.colorMask(!0,!0,!0,this.transparent)},n.WebGLRenderer.prototype.constructor=n.WebGLRenderer,n.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(t.interactive&&t.interactionManager.removeEvents(),this.__stage=t),n.WebGLRenderer.updateTextures(),t.updateTransform(),t._interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)));var e=this.gl;e.viewport(0,0,this.width,this.height),e.bindFramebuffer(e.FRAMEBUFFER,null),this.transparent?e.clearColor(0,0,0,0):e.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],1),e.clear(e.COLOR_BUFFER_BIT),this.renderDisplayObject(t,this.projection),t.interactive?t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)):t._interactiveEventsAdded&&(t._interactiveEventsAdded=!1,t.interactionManager.setTarget(this))}},n.WebGLRenderer.prototype.renderDisplayObject=function(t,e,i){this.renderSession.blendModeManager.setBlendMode(n.blendModes.NORMAL),this.renderSession.drawCount=0,this.renderSession.currentBlendMode=9999,this.renderSession.projection=e,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,i),t._renderWebGL(this.renderSession),this.spriteBatch.end()},n.WebGLRenderer.updateTextures=function(){var t=0;for(t=0;t<n.Texture.frameUpdates.length;t++)n.WebGLRenderer.updateTextureFrame(n.Texture.frameUpdates[t]);for(t=0;t<n.texturesToDestroy.length;t++)n.WebGLRenderer.destroyTexture(n.texturesToDestroy[t]);n.texturesToUpdate.length=0,n.texturesToDestroy.length=0,n.Texture.frameUpdates.length=0},n.WebGLRenderer.destroyTexture=function(t){for(var e=t._glTextures.length-1;e>=0;e--){var i=t._glTextures[e],r=n.glContexts[e];r&&i&&r.deleteTexture(i)}t._glTextures.length=0},n.WebGLRenderer.updateTextureFrame=function(t){t._updateWebGLuvs()},n.WebGLRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e,this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2,this.projection.y=-this.height/2},n.createWebGLTexture=function(t,e){return t.hasLoaded&&(t._glTextures[e.id]=e.createTexture(),e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===n.scaleModes.LINEAR?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===n.scaleModes.LINEAR?e.LINEAR:e.NEAREST),t._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),e.bindTexture(e.TEXTURE_2D,null),t._dirty[e.id]=!1),t._glTextures[e.id]},n.updateWebGLTexture=function(t,e){t._glTextures[e.id]&&(e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===n.scaleModes.LINEAR?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===n.scaleModes.LINEAR?e.LINEAR:e.NEAREST),t._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),t._dirty[e.id]=!1)},n.WebGLRenderer.prototype.handleContextLost=function(t){t.preventDefault(),this.contextLost=!0},n.WebGLRenderer.prototype.handleContextRestored=function(){try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(t){try{this.gl=this.view.getContext("webgl",this.options)}catch(t){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}var t=this.gl;for(var e in t.id=n.WebGLRenderer.glContextId++,this.shaderManager.setContext(t),this.spriteBatch.setContext(t),this.primitiveBatch.setContext(t),this.maskManager.setContext(t),this.filterManager.setContext(t),this.renderSession.gl=this.gl,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,this.transparent),this.gl.viewport(0,0,this.width,this.height),n.TextureCache){n.TextureCache[e].baseTexture._glTextures=[]}this.contextLost=!1},n.WebGLRenderer.prototype.destroy=function(){this.view.removeEventListener("webglcontextlost",this.contextLost),this.view.removeEventListener("webglcontextrestored",this.contextRestoredLost),n.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.primitiveBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null},n.WebGLRenderer.glContextId=0,n.WebGLBlendModeManager=function(t){this.gl=t,this.currentBlendMode=99999},n.WebGLBlendModeManager.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;var e=n.blendModesWebGL[this.currentBlendMode];return this.gl.blendFunc(e[0],e[1]),!0},n.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},n.WebGLMaskManager=function(t){this.maskStack=[],this.maskPosition=0,this.setContext(t),this.reverse=!1,this.count=0},n.WebGLMaskManager.prototype.setContext=function(t){this.gl=t},n.WebGLMaskManager.prototype.pushMask=function(t,e){var i=e.gl;t.dirty&&n.WebGLGraphics.updateGraphics(t,i),t._webGL[i.id].data.length&&e.stencilManager.pushStencil(t,t._webGL[i.id].data[0],e)},n.WebGLMaskManager.prototype.popMask=function(t,e){var n=this.gl;e.stencilManager.popStencil(t,t._webGL[n.id].data[0],e)},n.WebGLMaskManager.prototype.destroy=function(){this.maskStack=null,this.gl=null},n.WebGLStencilManager=function(t){this.stencilStack=[],this.setContext(t),this.reverse=!0,this.count=0},n.WebGLStencilManager.prototype.setContext=function(t){this.gl=t},n.WebGLStencilManager.prototype.pushStencil=function(t,e,n){var i=this.gl;this.bindGraphics(t,e,n),0===this.stencilStack.length&&(i.enable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(e);var r=this.count;i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.ALWAYS,0,255),i.stencilOp(i.KEEP,i.KEEP,i.INVERT),1===e.mode?(i.drawElements(i.TRIANGLE_FAN,e.indices.length-4,i.UNSIGNED_SHORT,0),this.reverse?(i.stencilFunc(i.EQUAL,255-r,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)):(i.stencilFunc(i.EQUAL,r,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)),i.drawElements(i.TRIANGLE_FAN,4,i.UNSIGNED_SHORT,2*(e.indices.length-4)),this.reverse?i.stencilFunc(i.EQUAL,255-(r+1),255):i.stencilFunc(i.EQUAL,r+1,255),this.reverse=!this.reverse):(this.reverse?(i.stencilFunc(i.EQUAL,r,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,255-r,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),i.drawElements(i.TRIANGLE_STRIP,e.indices.length,i.UNSIGNED_SHORT,0),this.reverse?i.stencilFunc(i.EQUAL,r+1,255):i.stencilFunc(i.EQUAL,255-(r+1),255)),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),this.count++},n.WebGLStencilManager.prototype.bindGraphics=function(t,e,i){this._currentGraphics=t;var r,o=this.gl,a=i.projection,s=i.offset;1===e.mode?(r=i.shaderManager.complexPrimativeShader,i.shaderManager.setShader(r),o.uniformMatrix3fv(r.translationMatrix,!1,t.worldTransform.toArray(!0)),o.uniform2f(r.projectionVector,a.x,-a.y),o.uniform2f(r.offsetVector,-s.x,-s.y),o.uniform3fv(r.tintColor,n.hex2rgb(t.tint)),o.uniform3fv(r.color,e.color),o.uniform1f(r.alpha,t.worldAlpha*e.alpha),o.bindBuffer(o.ARRAY_BUFFER,e.buffer),o.vertexAttribPointer(r.aVertexPosition,2,o.FLOAT,!1,8,0),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e.indexBuffer)):(r=i.shaderManager.primitiveShader,i.shaderManager.setShader(r),o.uniformMatrix3fv(r.translationMatrix,!1,t.worldTransform.toArray(!0)),o.uniform2f(r.projectionVector,a.x,-a.y),o.uniform2f(r.offsetVector,-s.x,-s.y),o.uniform3fv(r.tintColor,n.hex2rgb(t.tint)),o.uniform1f(r.alpha,t.worldAlpha),o.bindBuffer(o.ARRAY_BUFFER,e.buffer),o.vertexAttribPointer(r.aVertexPosition,2,o.FLOAT,!1,24,0),o.vertexAttribPointer(r.colorAttribute,4,o.FLOAT,!1,24,8),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e.indexBuffer))},n.WebGLStencilManager.prototype.popStencil=function(t,e,n){var i=this.gl;if(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)i.disable(i.STENCIL_TEST);else{var r=this.count;this.bindGraphics(t,e,n),i.colorMask(!1,!1,!1,!1),1===e.mode?(this.reverse=!this.reverse,this.reverse?(i.stencilFunc(i.EQUAL,255-(r+1),255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,r+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),i.drawElements(i.TRIANGLE_FAN,4,i.UNSIGNED_SHORT,2*(e.indices.length-4)),i.stencilFunc(i.ALWAYS,0,255),i.stencilOp(i.KEEP,i.KEEP,i.INVERT),i.drawElements(i.TRIANGLE_FAN,e.indices.length-4,i.UNSIGNED_SHORT,0),this.reverse?i.stencilFunc(i.EQUAL,r,255):i.stencilFunc(i.EQUAL,255-r,255)):(this.reverse?(i.stencilFunc(i.EQUAL,r+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)):(i.stencilFunc(i.EQUAL,255-(r+1),255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)),i.drawElements(i.TRIANGLE_STRIP,e.indices.length,i.UNSIGNED_SHORT,0),this.reverse?i.stencilFunc(i.EQUAL,r,255):i.stencilFunc(i.EQUAL,255-r,255)),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}},n.WebGLStencilManager.prototype.destroy=function(){this.maskStack=null,this.gl=null},n.WebGLShaderManager=function(t){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[],this.shaderMap=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.setContext(t)},n.WebGLShaderManager.prototype.setContext=function(t){this.gl=t,this.primitiveShader=new n.PrimitiveShader(t),this.complexPrimativeShader=new n.ComplexPrimitiveShader(t),this.defaultShader=new n.PixiShader(t),this.fastShader=new n.PixiFastShader(t),this.stripShader=new n.StripShader(t),this.setShader(this.defaultShader)},n.WebGLShaderManager.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(e=0;e<t.length;e++){var n=t[e];this.tempAttribState[n]=!0}var i=this.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?i.enableVertexAttribArray(e):i.disableVertexAttribArray(e))},n.WebGLShaderManager.prototype.setShader=function(t){return this._currentId!==t._UID&&(this._currentId=t._UID,this.currentShader=t,this.gl.useProgram(t.program),this.setAttribs(t.attributes),!0)},n.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.stripShader.destroy(),this.gl=null},n.WebGLSpriteBatch=function(t){this.vertSize=6,this.size=2e3;var e=4*this.size*this.vertSize,n=6*this.size;this.vertices=new Float32Array(e),this.indices=new Uint16Array(n),this.lastIndexCount=0;for(var i=0,r=0;n>i;i+=6,r+=4)this.indices[i+0]=r+0,this.indices[i+1]=r+1,this.indices[i+2]=r+2,this.indices[i+3]=r+0,this.indices[i+4]=r+2,this.indices[i+5]=r+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.setContext(t),this.dirty=!0,this.textures=[],this.blendModes=[]},n.WebGLSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},n.WebGLSpriteBatch.prototype.begin=function(t){this.renderSession=t,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},n.WebGLSpriteBatch.prototype.end=function(){this.flush()},n.WebGLSpriteBatch.prototype.render=function(t){var e=t.texture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=e.baseTexture);var n=e._uvs;if(n){var i,r,o,a,s=t.worldAlpha,l=t.tint,u=this.vertices,c=t.anchor.x,h=t.anchor.y;if(e.trim){var d=e.trim;i=(r=d.x-c*d.width)+e.crop.width,o=(a=d.y-h*d.height)+e.crop.height}else i=e.frame.width*(1-c),r=e.frame.width*-c,o=e.frame.height*(1-h),a=e.frame.height*-h;var p=4*this.currentBatchSize*this.vertSize,f=t.worldTransform,m=f.a,g=f.c,v=f.b,y=f.d,b=f.tx,_=f.ty;u[p++]=m*r+v*a+b,u[p++]=y*a+g*r+_,u[p++]=n.x0,u[p++]=n.y0,u[p++]=s,u[p++]=l,u[p++]=m*i+v*a+b,u[p++]=y*a+g*i+_,u[p++]=n.x1,u[p++]=n.y1,u[p++]=s,u[p++]=l,u[p++]=m*i+v*o+b,u[p++]=y*o+g*i+_,u[p++]=n.x2,u[p++]=n.y2,u[p++]=s,u[p++]=l,u[p++]=m*r+v*o+b,u[p++]=y*o+g*r+_,u[p++]=n.x3,u[p++]=n.y3,u[p++]=s,u[p++]=l,this.textures[this.currentBatchSize]=t.texture.baseTexture,this.blendModes[this.currentBatchSize]=t.blendMode,this.currentBatchSize++}},n.WebGLSpriteBatch.prototype.renderTilingSprite=function(t){var e=t.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=e.baseTexture),t._uvs||(t._uvs=new n.TextureUvs);var i=t._uvs;t.tilePosition.x%=e.baseTexture.width*t.tileScaleOffset.x,t.tilePosition.y%=e.baseTexture.height*t.tileScaleOffset.y;var r=t.tilePosition.x/(e.baseTexture.width*t.tileScaleOffset.x),o=t.tilePosition.y/(e.baseTexture.height*t.tileScaleOffset.y),a=t.width/e.baseTexture.width/(t.tileScale.x*t.tileScaleOffset.x),s=t.height/e.baseTexture.height/(t.tileScale.y*t.tileScaleOffset.y);i.x0=0-r,i.y0=0-o,i.x1=1*a-r,i.y1=0-o,i.x2=1*a-r,i.y2=1*s-o,i.x3=0-r,i.y3=1*s-o;var l=t.worldAlpha,u=t.tint,c=this.vertices,h=t.width,d=t.height,p=t.anchor.x,f=t.anchor.y,m=h*(1-p),g=h*-p,v=d*(1-f),y=d*-f,b=4*this.currentBatchSize*this.vertSize,_=t.worldTransform,x=_.a,w=_.c,C=_.b,T=_.d,S=_.tx,k=_.ty;c[b++]=x*g+C*y+S,c[b++]=T*y+w*g+k,c[b++]=i.x0,c[b++]=i.y0,c[b++]=l,c[b++]=u,c[b++]=x*m+C*y+S,c[b++]=T*y+w*m+k,c[b++]=i.x1,c[b++]=i.y1,c[b++]=l,c[b++]=u,c[b++]=x*m+C*v+S,c[b++]=T*v+w*m+k,c[b++]=i.x2,c[b++]=i.y2,c[b++]=l,c[b++]=u,c[b++]=x*g+C*v+S,c[b++]=T*v+w*g+k,c[b++]=i.x3,c[b++]=i.y3,c[b++]=l,c[b++]=u,this.textures[this.currentBatchSize]=e.baseTexture,this.blendModes[this.currentBatchSize]=t.blendMode,this.currentBatchSize++},n.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(this.renderSession.shaderManager.setShader(this.renderSession.shaderManager.defaultShader),this.dirty){this.dirty=!1,t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,e.x,e.y);var n=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,n,0),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,n,8),t.vertexAttribPointer(this.shader.colorAttribute,2,t.FLOAT,!1,n,16)}if(this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var i=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,i)}for(var r,o,a=0,s=0,l=null,u=this.renderSession.blendModeManager.currentBlendMode,c=0,h=this.currentBatchSize;h>c;c++)r=this.textures[c],o=this.blendModes[c],(l!==r||u!==o)&&(this.renderBatch(l,a,s),s=c,a=0,l=r,u=o,this.renderSession.blendModeManager.setBlendMode(u)),a++;this.renderBatch(l,a,s),this.currentBatchSize=0}},n.WebGLSpriteBatch.prototype.renderBatch=function(t,e,i){if(0!==e){var r=this.gl;r.bindTexture(r.TEXTURE_2D,t._glTextures[r.id]||n.createWebGLTexture(t,r)),t._dirty[r.id]&&n.updateWebGLTexture(this.currentBaseTexture,r),r.drawElements(r.TRIANGLES,6*e,r.UNSIGNED_SHORT,6*i*2),this.renderSession.drawCount++}},n.WebGLSpriteBatch.prototype.stop=function(){this.flush()},n.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0},n.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},n.WebGLFastSpriteBatch=function(t){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var e=4*this.size*this.vertSize,n=6*this.maxSize;this.vertices=new Float32Array(e),this.indices=new Uint16Array(n),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var i=0,r=0;n>i;i+=6,r+=4)this.indices[i+0]=r+0,this.indices[i+1]=r+1,this.indices[i+2]=r+2,this.indices[i+3]=r+0,this.indices[i+4]=r+2,this.indices[i+5]=r+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(t)},n.WebGLFastSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW)},n.WebGLFastSpriteBatch.prototype.begin=function(t,e){this.renderSession=e,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=t.worldTransform.toArray(!0),this.start()},n.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},n.WebGLFastSpriteBatch.prototype.render=function(t){var e=t.children,n=e[0];if(n.texture._uvs){this.currentBaseTexture=n.texture.baseTexture,n.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(n.blendMode));for(var i=0,r=e.length;r>i;i++)this.renderSprite(e[i]);this.flush()}},n.WebGLFastSpriteBatch.prototype.renderSprite=function(t){if(t.visible&&(t.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=t.texture.baseTexture,t.texture._uvs))){var e,n,i,r,o,a,s=this.vertices;if(e=t.texture._uvs,t.texture.frame.width,t.texture.frame.height,t.texture.trim){var l=t.texture.trim;n=(i=l.x-t.anchor.x*l.width)+t.texture.crop.width,r=(o=l.y-t.anchor.y*l.height)+t.texture.crop.height}else n=t.texture.frame.width*(1-t.anchor.x),i=t.texture.frame.width*-t.anchor.x,r=t.texture.frame.height*(1-t.anchor.y),o=t.texture.frame.height*-t.anchor.y;a=4*this.currentBatchSize*this.vertSize,s[a++]=i,s[a++]=o,s[a++]=t.position.x,s[a++]=t.position.y,s[a++]=t.scale.x,s[a++]=t.scale.y,s[a++]=t.rotation,s[a++]=e.x0,s[a++]=e.y1,s[a++]=t.alpha,s[a++]=n,s[a++]=o,s[a++]=t.position.x,s[a++]=t.position.y,s[a++]=t.scale.x,s[a++]=t.scale.y,s[a++]=t.rotation,s[a++]=e.x1,s[a++]=e.y1,s[a++]=t.alpha,s[a++]=n,s[a++]=r,s[a++]=t.position.x,s[a++]=t.position.y,s[a++]=t.scale.x,s[a++]=t.scale.y,s[a++]=t.rotation,s[a++]=e.x2,s[a++]=e.y2,s[a++]=t.alpha,s[a++]=i,s[a++]=r,s[a++]=t.position.x,s[a++]=t.position.y,s[a++]=t.scale.x,s[a++]=t.scale.y,s[a++]=t.rotation,s[a++]=e.x3,s[a++]=e.y3,s[a++]=t.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},n.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(this.currentBaseTexture._glTextures[t.id]||n.createWebGLTexture(this.currentBaseTexture,t),t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]),this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var e=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,e)}t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},n.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},n.WebGLFastSpriteBatch.prototype.start=function(){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,e.x,e.y),t.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var n=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,n,0),t.vertexAttribPointer(this.shader.aPositionCoord,2,t.FLOAT,!1,n,8),t.vertexAttribPointer(this.shader.aScale,2,t.FLOAT,!1,n,16),t.vertexAttribPointer(this.shader.aRotation,1,t.FLOAT,!1,n,24),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,n,28),t.vertexAttribPointer(this.shader.colorAttribute,1,t.FLOAT,!1,n,36)},n.WebGLFilterManager=function(t,e){this.transparent=e,this.filterStack=[],this.offsetX=0,this.offsetY=0,this.setContext(t)},n.WebGLFilterManager.prototype.setContext=function(t){this.gl=t,this.texturePool=[],this.initShaderBuffers()},n.WebGLFilterManager.prototype.begin=function(t,e){this.renderSession=t,this.defaultShader=t.shaderManager.defaultShader;var n=this.renderSession.projection;this.width=2*n.x,this.height=2*-n.y,this.buffer=e},n.WebGLFilterManager.prototype.pushFilter=function(t){var e=this.gl,i=this.renderSession.projection,r=this.renderSession.offset;t._filterArea=t.target.filterArea||t.target.getBounds(),this.filterStack.push(t);var o=t.filterPasses[0];this.offsetX+=t._filterArea.x,this.offsetY+=t._filterArea.y;var a=this.texturePool.pop();a?a.resize(this.width,this.height):a=new n.FilterTexture(this.gl,this.width,this.height),e.bindTexture(e.TEXTURE_2D,a.texture);var s=t._filterArea,l=o.padding;s.x-=l,s.y-=l,s.width+=2*l,s.height+=2*l,s.x<0&&(s.x=0),s.width>this.width&&(s.width=this.width),s.y<0&&(s.y=0),s.height>this.height&&(s.height=this.height),e.bindFramebuffer(e.FRAMEBUFFER,a.frameBuffer),e.viewport(0,0,s.width,s.height),i.x=s.width/2,i.y=-s.height/2,r.x=-s.x,r.y=-s.y,this.renderSession.shaderManager.setShader(this.defaultShader),e.uniform2f(this.defaultShader.projectionVector,s.width/2,-s.height/2),e.uniform2f(this.defaultShader.offsetVector,-s.x,-s.y),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),t._glFilterTexture=a},n.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,e=this.filterStack.pop(),i=e._filterArea,r=e._glFilterTexture,o=this.renderSession.projection,a=this.renderSession.offset;if(e.filterPasses.length>1){t.viewport(0,0,i.width,i.height),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=i.height,this.vertexArray[2]=i.width,this.vertexArray[3]=i.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=i.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);var s=r,l=this.texturePool.pop();l||(l=new n.FilterTexture(this.gl,this.width,this.height)),l.resize(this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,l.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND);for(var u=0;u<e.filterPasses.length-1;u++){var c=e.filterPasses[u];t.bindFramebuffer(t.FRAMEBUFFER,l.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,s.texture),this.applyFilterPass(c,i,i.width,i.height);var h=s;s=l,l=h}t.enable(t.BLEND),r=s,this.texturePool.push(l)}var d=e.filterPasses[e.filterPasses.length-1];this.offsetX-=i.x,this.offsetY-=i.y;var p=this.width,f=this.height,m=0,g=0,v=this.buffer;if(0===this.filterStack.length)t.colorMask(!0,!0,!0,!0);else{var y=this.filterStack[this.filterStack.length-1];p=(i=y._filterArea).width,f=i.height,m=i.x,g=i.y,v=y._glFilterTexture.frameBuffer}o.x=p/2,o.y=-f/2,a.x=m,a.y=g;var b=(i=e._filterArea).x-m,_=i.y-g;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=b,this.vertexArray[1]=_+i.height,this.vertexArray[2]=b+i.width,this.vertexArray[3]=_+i.height,this.vertexArray[4]=b,this.vertexArray[5]=_,this.vertexArray[6]=b+i.width,this.vertexArray[7]=_,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),t.viewport(0,0,p,f),t.bindFramebuffer(t.FRAMEBUFFER,v),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r.texture),this.applyFilterPass(d,i,p,f),this.renderSession.shaderManager.setShader(this.defaultShader),t.uniform2f(this.defaultShader.projectionVector,p/2,-f/2),t.uniform2f(this.defaultShader.offsetVector,-m,-g),this.texturePool.push(r),e._glFilterTexture=null},n.WebGLFilterManager.prototype.applyFilterPass=function(t,e,i,r){var o=this.gl,a=t.shaders[o.id];a||((a=new n.PixiShader(o)).fragmentSrc=t.fragmentSrc,a.uniforms=t.uniforms,a.init(),t.shaders[o.id]=a),this.renderSession.shaderManager.setShader(a),o.uniform2f(a.projectionVector,i/2,-r/2),o.uniform2f(a.offsetVector,0,0),t.uniforms.dimensions&&(t.uniforms.dimensions.value[0]=this.width,t.uniforms.dimensions.value[1]=this.height,t.uniforms.dimensions.value[2]=this.vertexArray[0],t.uniforms.dimensions.value[3]=this.vertexArray[5]),a.syncUniforms(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexBuffer),o.vertexAttribPointer(a.aVertexPosition,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,this.uvBuffer),o.vertexAttribPointer(a.aTextureCoord,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,this.colorBuffer),o.vertexAttribPointer(a.colorAttribute,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.indexBuffer),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0),this.renderSession.drawCount++},n.WebGLFilterManager.prototype.initShaderBuffers=function(){var t=this.gl;this.vertexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW),this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvArray,t.STATIC_DRAW),this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),t.STATIC_DRAW)},n.WebGLFilterManager.prototype.destroy=function(){var t=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var e=0;e<this.texturePool.length;e++)this.texturePool[e].destroy();this.texturePool=null,t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.uvBuffer),t.deleteBuffer(this.colorBuffer),t.deleteBuffer(this.indexBuffer)},n.FilterTexture=function(t,e,i,r){this.gl=t,this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),r=r||n.scaleModes.DEFAULT,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r===n.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,r===n.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),this.renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.renderBuffer),this.resize(e,i)},n.FilterTexture.prototype.clear=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},n.FilterTexture.prototype.resize=function(t,e){if(this.width!==t||this.height!==e){this.width=t,this.height=e;var n=this.gl;n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t,e,0,n.RGBA,n.UNSIGNED_BYTE,null),n.bindRenderbuffer(n.RENDERBUFFER,this.renderBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t,e)}},n.FilterTexture.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},n.CanvasMaskManager=function(){},n.CanvasMaskManager.prototype.pushMask=function(t,e){e.save();var i=t.alpha,r=t.worldTransform;e.setTransform(r.a,r.c,r.b,r.d,r.tx,r.ty),n.CanvasGraphics.renderGraphicsMask(t,e),e.clip(),t.worldAlpha=i},n.CanvasMaskManager.prototype.popMask=function(t){t.restore()},n.CanvasTinter=function(){},n.CanvasTinter.getTintedTexture=function(t,e){var i=t.texture,r="#"+("00000"+(0|(e=n.CanvasTinter.roundColor(e))).toString(16)).substr(-6);if(i.tintCache=i.tintCache||{},i.tintCache[r])return i.tintCache[r];var o=n.CanvasTinter.canvas||document.createElement("canvas");if(n.CanvasTinter.tintMethod(i,e,o),n.CanvasTinter.convertTintToImage){var a=new Image;a.src=o.toDataURL(),i.tintCache[r]=a}else i.tintCache[r]=o,n.CanvasTinter.canvas=null;return o},n.CanvasTinter.tintWithMultiply=function(t,e,n){var i=n.getContext("2d"),r=t.frame;n.width=r.width,n.height=r.height,i.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),i.fillRect(0,0,r.width,r.height),i.globalCompositeOperation="multiply",i.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),i.globalCompositeOperation="destination-atop",i.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},n.CanvasTinter.tintWithOverlay=function(t,e,n){var i=n.getContext("2d"),r=t.frame;n.width=r.width,n.height=r.height,i.globalCompositeOperation="copy",i.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),i.fillRect(0,0,r.width,r.height),i.globalCompositeOperation="destination-atop",i.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},n.CanvasTinter.tintWithPerPixel=function(t,e,i){var r=i.getContext("2d"),o=t.frame;i.width=o.width,i.height=o.height,r.globalCompositeOperation="copy",r.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height);for(var a=n.hex2rgb(e),s=a[0],l=a[1],u=a[2],c=r.getImageData(0,0,o.width,o.height),h=c.data,d=0;d<h.length;d+=4)h[d+0]*=s,h[d+1]*=l,h[d+2]*=u;r.putImageData(c,0,0)},n.CanvasTinter.roundColor=function(t){var e=n.CanvasTinter.cacheStepsPerColorChannel,i=n.hex2rgb(t);return i[0]=Math.min(255,i[0]/e*e),i[1]=Math.min(255,i[1]/e*e),i[2]=Math.min(255,i[2]/e*e),n.rgb2hex(i)},n.CanvasTinter.cacheStepsPerColorChannel=8,n.CanvasTinter.convertTintToImage=!1,n.CanvasTinter.canUseMultiply=n.canUseNewCanvasBlendModes(),n.CanvasTinter.tintMethod=n.CanvasTinter.canUseMultiply?n.CanvasTinter.tintWithMultiply:n.CanvasTinter.tintWithPerPixel,n.CanvasRenderer=function(t,e,i,r){n.defaultRenderer||(n.sayHello("Canvas"),n.defaultRenderer=this),this.type=n.CANVAS_RENDERER,this.clearBeforeRender=!0,this.transparent=!!r,n.blendModesCanvas||(n.blendModesCanvas=[],n.canUseNewCanvasBlendModes()?(n.blendModesCanvas[n.blendModes.NORMAL]="source-over",n.blendModesCanvas[n.blendModes.ADD]="lighter",n.blendModesCanvas[n.blendModes.MULTIPLY]="multiply",n.blendModesCanvas[n.blendModes.SCREEN]="screen",n.blendModesCanvas[n.blendModes.OVERLAY]="overlay",n.blendModesCanvas[n.blendModes.DARKEN]="darken",n.blendModesCanvas[n.blendModes.LIGHTEN]="lighten",n.blendModesCanvas[n.blendModes.COLOR_DODGE]="color-dodge",n.blendModesCanvas[n.blendModes.COLOR_BURN]="color-burn",n.blendModesCanvas[n.blendModes.HARD_LIGHT]="hard-light",n.blendModesCanvas[n.blendModes.SOFT_LIGHT]="soft-light",n.blendModesCanvas[n.blendModes.DIFFERENCE]="difference",n.blendModesCanvas[n.blendModes.EXCLUSION]="exclusion",n.blendModesCanvas[n.blendModes.HUE]="hue",n.blendModesCanvas[n.blendModes.SATURATION]="saturation",n.blendModesCanvas[n.blendModes.COLOR]="color",n.blendModesCanvas[n.blendModes.LUMINOSITY]="luminosity"):(n.blendModesCanvas[n.blendModes.NORMAL]="source-over",n.blendModesCanvas[n.blendModes.ADD]="lighter",n.blendModesCanvas[n.blendModes.MULTIPLY]="source-over",n.blendModesCanvas[n.blendModes.SCREEN]="source-over",n.blendModesCanvas[n.blendModes.OVERLAY]="source-over",n.blendModesCanvas[n.blendModes.DARKEN]="source-over",n.blendModesCanvas[n.blendModes.LIGHTEN]="source-over",n.blendModesCanvas[n.blendModes.COLOR_DODGE]="source-over",n.blendModesCanvas[n.blendModes.COLOR_BURN]="source-over",n.blendModesCanvas[n.blendModes.HARD_LIGHT]="source-over",n.blendModesCanvas[n.blendModes.SOFT_LIGHT]="source-over",n.blendModesCanvas[n.blendModes.DIFFERENCE]="source-over",n.blendModesCanvas[n.blendModes.EXCLUSION]="source-over",n.blendModesCanvas[n.blendModes.HUE]="source-over",n.blendModesCanvas[n.blendModes.SATURATION]="source-over",n.blendModesCanvas[n.blendModes.COLOR]="source-over",n.blendModesCanvas[n.blendModes.LUMINOSITY]="source-over")),this.width=t||800,this.height=e||600,this.view=i||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width,this.view.height=this.height,this.count=0,this.maskManager=new n.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:!1},"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="oImageSmoothingEnabled")},n.CanvasRenderer.prototype.constructor=n.CanvasRenderer,n.CanvasRenderer.prototype.render=function(t){n.texturesToUpdate.length=0,n.texturesToDestroy.length=0,t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),!this.transparent&&this.clearBeforeRender?(this.context.fillStyle=t.backgroundColorString,this.context.fillRect(0,0,this.width,this.height)):this.transparent&&this.clearBeforeRender&&this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),n.Texture.frameUpdates.length>0&&(n.Texture.frameUpdates.length=0)},n.CanvasRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e},n.CanvasRenderer.prototype.renderDisplayObject=function(t,e){this.renderSession.context=e||this.context,t._renderCanvas(this.renderSession)},n.CanvasRenderer.prototype.renderStripFlat=function(t){var e=this.context,n=t.verticies,i=n.length/2;this.count++,e.beginPath();for(var r=1;i-2>r;r++){var o=2*r,a=n[o],s=n[o+2],l=n[o+4],u=n[o+1],c=n[o+3],h=n[o+5];e.moveTo(a,u),e.lineTo(s,c),e.lineTo(l,h)}e.fillStyle="#FF0000",e.fill(),e.closePath()},n.CanvasRenderer.prototype.renderStrip=function(t){var e=this.context,n=t.verticies,i=t.uvs,r=n.length/2;this.count++;for(var o=1;r-2>o;o++){var a=2*o,s=n[a],l=n[a+2],u=n[a+4],c=n[a+1],h=n[a+3],d=n[a+5],p=i[a]*t.texture.width,f=i[a+2]*t.texture.width,m=i[a+4]*t.texture.width,g=i[a+1]*t.texture.height,v=i[a+3]*t.texture.height,y=i[a+5]*t.texture.height;e.save(),e.beginPath(),e.moveTo(s,c),e.lineTo(l,h),e.lineTo(u,d),e.closePath(),e.clip();var b=p*v+g*m+f*y-v*m-g*f-p*y,_=s*v+g*u+l*y-v*u-g*l-s*y,x=p*l+s*m+f*u-l*m-s*f-p*u,w=p*v*u+g*l*m+s*f*y-s*v*m-g*f*u-p*l*y,C=c*v+g*d+h*y-v*d-g*h-c*y,T=p*h+c*m+f*d-h*m-c*f-p*d,S=p*v*d+g*h*m+c*f*y-c*v*m-g*f*d-p*h*y;e.transform(_/b,C/b,x/b,T/b,w/b,S/b),e.drawImage(t.texture.baseTexture.source,0,0),e.restore()}},n.CanvasBuffer=function(t,e){this.width=t,this.height=e,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e},n.CanvasBuffer.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},n.CanvasBuffer.prototype.resize=function(t,e){this.width=this.canvas.width=t,this.height=this.canvas.height=e},n.CanvasGraphics=function(){},n.CanvasGraphics.renderGraphics=function(t,e){for(var i=t.worldAlpha,r=0;r<t.graphicsData.length;r++){var o=t.graphicsData[r],a=o.points;if(e.strokeStyle="#"+("00000"+(0|o.lineColor).toString(16)).substr(-6),e.lineWidth=o.lineWidth,o.type===n.Graphics.POLY){e.beginPath(),e.moveTo(a[0],a[1]);for(var s=1;s<a.length/2;s++)e.lineTo(a[2*s],a[2*s+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*i,e.fillStyle="#"+("00000"+(0|o.fillColor).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*i,e.stroke())}else if(o.type===n.Graphics.RECT)(o.fillColor||0===o.fillColor)&&(e.globalAlpha=o.fillAlpha*i,e.fillStyle="#"+("00000"+(0|o.fillColor).toString(16)).substr(-6),e.fillRect(a[0],a[1],a[2],a[3])),o.lineWidth&&(e.globalAlpha=o.lineAlpha*i,e.strokeRect(a[0],a[1],a[2],a[3]));else if(o.type===n.Graphics.CIRC)e.beginPath(),e.arc(a[0],a[1],a[2],0,2*Math.PI),e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*i,e.fillStyle="#"+("00000"+(0|o.fillColor).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*i,e.stroke());else if(o.type===n.Graphics.ELIP){var l=o.points,u=2*l[2],c=2*l[3],h=l[0]-u/2,d=l[1]-c/2;e.beginPath();var p=.5522848,f=u/2*p,m=c/2*p,g=h+u,v=d+c,y=h+u/2,b=d+c/2;e.moveTo(h,b),e.bezierCurveTo(h,b-m,y-f,d,y,d),e.bezierCurveTo(y+f,d,g,b-m,g,b),e.bezierCurveTo(g,b+m,y+f,v,y,v),e.bezierCurveTo(y-f,v,h,b+m,h,b),e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*i,e.fillStyle="#"+("00000"+(0|o.fillColor).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*i,e.stroke())}else if(o.type===n.Graphics.RREC){var _=a[0],x=a[1],w=a[2],C=a[3],T=a[4],S=Math.min(w,C)/2|0;T=T>S?S:T,e.beginPath(),e.moveTo(_,x+T),e.lineTo(_,x+C-T),e.quadraticCurveTo(_,x+C,_+T,x+C),e.lineTo(_+w-T,x+C),e.quadraticCurveTo(_+w,x+C,_+w,x+C-T),e.lineTo(_+w,x+T),e.quadraticCurveTo(_+w,x,_+w-T,x),e.lineTo(_+T,x),e.quadraticCurveTo(_,x,_,x+T),e.closePath(),(o.fillColor||0===o.fillColor)&&(e.globalAlpha=o.fillAlpha*i,e.fillStyle="#"+("00000"+(0|o.fillColor).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*i,e.stroke())}}},n.CanvasGraphics.renderGraphicsMask=function(t,e){var i=t.graphicsData.length;if(0!==i){i>1&&(i=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));for(var r=0;1>r;r++){var o=t.graphicsData[r],a=o.points;if(o.type===n.Graphics.POLY){e.beginPath(),e.moveTo(a[0],a[1]);for(var s=1;s<a.length/2;s++)e.lineTo(a[2*s],a[2*s+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath()}else if(o.type===n.Graphics.RECT)e.beginPath(),e.rect(a[0],a[1],a[2],a[3]),e.closePath();else if(o.type===n.Graphics.CIRC)e.beginPath(),e.arc(a[0],a[1],a[2],0,2*Math.PI),e.closePath();else if(o.type===n.Graphics.ELIP){var l=o.points,u=2*l[2],c=2*l[3],h=l[0]-u/2,d=l[1]-c/2;e.beginPath();var p=.5522848,f=u/2*p,m=c/2*p,g=h+u,v=d+c,y=h+u/2,b=d+c/2;e.moveTo(h,b),e.bezierCurveTo(h,b-m,y-f,d,y,d),e.bezierCurveTo(y+f,d,g,b-m,g,b),e.bezierCurveTo(g,b+m,y+f,v,y,v),e.bezierCurveTo(y-f,v,h,b+m,h,b),e.closePath()}else if(o.type===n.Graphics.RREC){var _=a[0],x=a[1],w=a[2],C=a[3],T=a[4],S=Math.min(w,C)/2|0;T=T>S?S:T,e.beginPath(),e.moveTo(_,x+T),e.lineTo(_,x+C-T),e.quadraticCurveTo(_,x+C,_+T,x+C),e.lineTo(_+w-T,x+C),e.quadraticCurveTo(_+w,x+C,_+w,x+C-T),e.lineTo(_+w,x+T),e.quadraticCurveTo(_+w,x,_+w-T,x),e.lineTo(_+T,x),e.quadraticCurveTo(_,x,_,x+T),e.closePath()}}}},n.Graphics=function(){n.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor="black",this.graphicsData=[],this.tint=16777215,this.blendMode=n.blendModes.NORMAL,this.currentPath={points:[]},this._webGL=[],this.isMask=!1,this.bounds=null,this.boundsPadding=10,this.dirty=!0},n.Graphics.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Graphics.prototype.constructor=n.Graphics,Object.defineProperty(n.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}}),n.Graphics.prototype.lineStyle=function(t,e,i){return this.currentPath.points.length||this.graphicsData.pop(),this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=arguments.length<3?1:i,this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:n.Graphics.POLY},this.graphicsData.push(this.currentPath),this},n.Graphics.prototype.moveTo=function(t,e){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:n.Graphics.POLY},this.currentPath.points.push(t,e),this.graphicsData.push(this.currentPath),this},n.Graphics.prototype.lineTo=function(t,e){return this.currentPath.points.push(t,e),this.dirty=!0,this},n.Graphics.prototype.quadraticCurveTo=function(t,e,n,i){0===this.currentPath.points.length&&this.moveTo(0,0);var r,o,a=this.currentPath.points;0===a.length&&this.moveTo(0,0);for(var s=a[a.length-2],l=a[a.length-1],u=0,c=1;20>=c;c++)r=s+(t-s)*(u=c/20),o=l+(e-l)*u,a.push(r+(t+(n-t)*u-r)*u,o+(e+(i-e)*u-o)*u);return this.dirty=!0,this},n.Graphics.prototype.bezierCurveTo=function(t,e,n,i,r,o){0===this.currentPath.points.length&&this.moveTo(0,0);for(var a,s,l,u,c,h=this.currentPath.points,d=h[h.length-2],p=h[h.length-1],f=0,m=1;20>m;m++)l=(s=(a=1-(f=m/20))*a)*a,c=(u=f*f)*f,h.push(l*d+3*s*f*t+3*a*u*n+c*r,l*p+3*s*f*e+3*a*u*i+c*o);return this.dirty=!0,this},n.Graphics.prototype.arcTo=function(t,e,n,i,r){0===this.currentPath.points.length&&this.moveTo(t,e);var o=this.currentPath.points,a=o[o.length-2],s=o[o.length-1]-e,l=a-t,u=i-e,c=n-t,h=Math.abs(s*c-l*u);if(1e-8>h||0===r)o.push(t,e);else{var d=s*s+l*l,p=u*u+c*c,f=s*u+l*c,m=r*Math.sqrt(d)/h,g=r*Math.sqrt(p)/h,v=m*f/d,y=g*f/p,b=m*c+g*l,_=m*u+g*s,x=l*(g+v),w=s*(g+v),C=c*(m+y),T=u*(m+y),S=Math.atan2(w-_,x-b),k=Math.atan2(T-_,C-b);this.arc(b+t,_+e,r,S,k,l*u>c*s)}return this.dirty=!0,this},n.Graphics.prototype.arc=function(t,e,n,i,r,o){var a=t+Math.cos(i)*n,s=e+Math.sin(i)*n,l=this.currentPath.points;if((0!==l.length&&l[l.length-2]!==a||l[l.length-1]!==s)&&(this.moveTo(a,s),l=this.currentPath.points),i===r)return this;!o&&i>=r?r+=2*Math.PI:o&&r>=i&&(i+=2*Math.PI);var u=o?-1*(i-r):r-i,c=Math.abs(u)/(2*Math.PI)*40;if(0===u)return this;for(var h=u/(2*c),d=2*h,p=Math.cos(h),f=Math.sin(h),m=c-1,g=m%1/m,v=0;m>=v;v++){var y=h+i+d*(v+g*v),b=Math.cos(y),_=-Math.sin(y);l.push((p*b+f*_)*n+t,(p*-_+f*b)*n+e)}return this.dirty=!0,this},n.Graphics.prototype.drawPath=function(t){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:n.Graphics.POLY},this.graphicsData.push(this.currentPath),this.currentPath.points=this.currentPath.points.concat(t),this.dirty=!0,this},n.Graphics.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=arguments.length<2?1:e,this},n.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},n.Graphics.prototype.drawRect=function(t,e,i,r){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,e,i,r],type:n.Graphics.RECT},this.graphicsData.push(this.currentPath),this.dirty=!0,this},n.Graphics.prototype.drawRoundedRect=function(t,e,i,r,o){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,e,i,r,o],type:n.Graphics.RREC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},n.Graphics.prototype.drawCircle=function(t,e,i){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,e,i,i],type:n.Graphics.CIRC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},n.Graphics.prototype.drawEllipse=function(t,e,i,r){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,e,i,r],type:n.Graphics.ELIP},this.graphicsData.push(this.currentPath),this.dirty=!0,this},n.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this.bounds=null,this},n.Graphics.prototype.generateTexture=function(){var t=this.getBounds(),e=new n.CanvasBuffer(t.width,t.height),i=n.Texture.fromCanvas(e.canvas);return e.context.translate(-t.x,-t.y),n.CanvasGraphics.renderGraphics(this,e.context),i},n.Graphics.prototype._renderWebGL=function(t){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask){if(this._cacheAsBitmap)return this.dirty&&(this._generateCachedSprite(),n.updateWebGLTexture(this._cachedSprite.texture.baseTexture,t.gl),this.dirty=!1),this._cachedSprite.alpha=this.alpha,void n.Sprite.prototype._renderWebGL.call(this._cachedSprite,t);if(t.spriteBatch.stop(),t.blendModeManager.setBlendMode(this.blendMode),this._mask&&t.maskManager.pushMask(this._mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode){t.spriteBatch.currentBlendMode=this.blendMode;var e=n.blendModesWebGL[t.spriteBatch.currentBlendMode];t.spriteBatch.gl.blendFunc(e[0],e[1])}if(n.WebGLGraphics.renderGraphics(this,t),this.children.length){t.spriteBatch.start();for(var i=0,r=this.children.length;r>i;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop()}this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this.mask,t),t.drawCount++,t.spriteBatch.start()}},n.Graphics.prototype._renderCanvas=function(t){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask){var e=t.context,i=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t.context),e.setTransform(i.a,i.c,i.b,i.d,i.tx,i.ty),n.CanvasGraphics.renderGraphics(this,e);for(var r=0,o=this.children.length;o>r;r++)this.children[r]._renderCanvas(t);this._mask&&t.maskManager.popMask(t.context)}},n.Graphics.prototype.getBounds=function(t){this.bounds||this.updateBounds();var e=this.bounds.x,n=this.bounds.width+this.bounds.x,i=this.bounds.y,r=this.bounds.height+this.bounds.y,o=t||this.worldTransform,a=o.a,s=o.c,l=o.b,u=o.d,c=o.tx,h=o.ty,d=a*n+l*r+c,p=u*r+s*n+h,f=a*e+l*r+c,m=u*r+s*e+h,g=a*e+l*i+c,v=u*i+s*e+h,y=a*n+l*i+c,b=u*i+s*n+h,_=d,x=p,w=d,C=p;w=(w=(w=w>f?f:w)>g?g:w)>y?y:w,C=(C=(C=C>m?m:C)>v?v:C)>b?b:C,_=y>(_=g>(_=f>_?f:_)?g:_)?y:_,x=b>(x=v>(x=m>x?m:x)?v:x)?b:x;var T=this._bounds;return T.x=w,T.width=_-w,T.y=C,T.height=x-C,T},n.Graphics.prototype.updateBounds=function(){for(var t,e,i,r,o,a=1/0,s=-1/0,l=1/0,u=-1/0,c=0;c<this.graphicsData.length;c++){var h=this.graphicsData[c],d=h.type,p=h.lineWidth;if(t=h.points,d===n.Graphics.RECT)e=t[0]-p/2,i=t[1]-p/2,a=a>e?e:a,s=e+(r=t[2]+p)>s?e+r:s,l=l>i?e:l,u=i+(o=t[3]+p)>u?i+o:u;else if(d===n.Graphics.CIRC||d===n.Graphics.ELIP)e=t[0],i=t[1],a=a>e-(r=t[2]+p/2)?e-r:a,s=e+r>s?e+r:s,l=l>i-(o=t[3]+p/2)?i-o:l,u=i+o>u?i+o:u;else for(var f=0;f<t.length;f+=2)a=a>(e=t[f])-p?e-p:a,s=e+p>s?e+p:s,l=l>(i=t[f+1])-p?i-p:l,u=i+p>u?i+p:u}var m=this.boundsPadding;this.bounds=new n.Rectangle(a-m,l-m,s-a+2*m,u-l+2*m)},n.Graphics.prototype._generateCachedSprite=function(){var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(t.width,t.height);else{var e=new n.CanvasBuffer(t.width,t.height),i=n.Texture.fromCanvas(e.canvas);this._cachedSprite=new n.Sprite(i),this._cachedSprite.buffer=e,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-t.x/t.width,this._cachedSprite.anchor.y=-t.y/t.height,this._cachedSprite.buffer.context.translate(-t.x,-t.y),n.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},n.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},n.Graphics.POLY=0,n.Graphics.RECT=1,n.Graphics.CIRC=2,n.Graphics.ELIP=3,n.Graphics.RREC=4,n.Strip=function(t){n.DisplayObjectContainer.call(this),this.texture=t,this.uvs=new n.Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new n.Float32Array([0,0,100,0,100,100,0,100]),this.colors=new n.Float32Array([1,1,1,1]),this.indices=new n.Uint16Array([0,1,2,3]),this.dirty=!0},n.Strip.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Strip.prototype.constructor=n.Strip,n.Strip.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||(t.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(t),t.shaderManager.setShader(t.shaderManager.stripShader),this._renderStrip(t),t.spriteBatch.start())},n.Strip.prototype._initWebGL=function(t){var e=t.gl;this._vertexBuffer=e.createBuffer(),this._indexBuffer=e.createBuffer(),this._uvBuffer=e.createBuffer(),this._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.verticies,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvs,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colors,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)},n.Strip.prototype._renderStrip=function(t){var e=t.gl,i=t.projection,r=t.offset,o=t.shaderManager.stripShader;e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.uniformMatrix3fv(o.translationMatrix,!1,this.worldTransform.toArray(!0)),e.uniform2f(o.projectionVector,i.x,-i.y),e.uniform2f(o.offsetVector,-r.x,-r.y),e.uniform1f(o.alpha,1),this.dirty?(this.dirty=!1,e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.verticies,e.STATIC_DRAW),e.vertexAttribPointer(o.aVertexPosition,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvs,e.STATIC_DRAW),e.vertexAttribPointer(o.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture.baseTexture._glTextures[e.id]||n.createWebGLTexture(this.texture.baseTexture,e)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)):(e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this.verticies),e.vertexAttribPointer(o.aVertexPosition,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.vertexAttribPointer(o.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture.baseTexture._glTextures[e.id]||n.createWebGLTexture(this.texture.baseTexture,e)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer)),e.drawElements(e.TRIANGLE_STRIP,this.indices.length,e.UNSIGNED_SHORT,0)},n.Strip.prototype._renderCanvas=function(t){var e=t.context,n=this.worldTransform;t.roundPixels?e.setTransform(n.a,n.c,n.b,n.d,0|n.tx,0|n.ty):e.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty);var i=this,r=i.verticies,o=i.uvs,a=r.length/2;this.count++;for(var s=0;a-2>s;s++){var l=2*s,u=r[l],c=r[l+2],h=r[l+4],d=r[l+1],p=r[l+3],f=r[l+5],m=(u+c+h)/3,g=(d+p+f)/3,v=u-m,y=d-g,b=Math.sqrt(v*v+y*y);u=m+v/b*(b+3),d=g+y/b*(b+3),y=p-g,c=m+(v=c-m)/(b=Math.sqrt(v*v+y*y))*(b+3),p=g+y/b*(b+3),y=f-g,h=m+(v=h-m)/(b=Math.sqrt(v*v+y*y))*(b+3),f=g+y/b*(b+3);var _=o[l]*i.texture.width,x=o[l+2]*i.texture.width,w=o[l+4]*i.texture.width,C=o[l+1]*i.texture.height,T=o[l+3]*i.texture.height,S=o[l+5]*i.texture.height;e.save(),e.beginPath(),e.moveTo(u,d),e.lineTo(c,p),e.lineTo(h,f),e.closePath(),e.clip();var k=_*T+C*w+x*S-T*w-C*x-_*S,A=u*T+C*h+c*S-T*h-C*c-u*S,E=_*c+u*w+x*h-c*w-u*x-_*h,M=_*T*h+C*c*w+u*x*S-u*T*w-C*x*h-_*c*S,P=d*T+C*f+p*S-T*f-C*p-d*S,D=_*p+d*w+x*f-p*w-d*x-_*f,O=_*T*f+C*p*w+d*x*S-d*T*w-C*x*f-_*p*S;e.transform(A/k,P/k,E/k,D/k,M/k,O/k),e.drawImage(i.texture.baseTexture.source,0,0),e.restore()}},n.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},n.Rope=function(t,e){n.Strip.call(this,t),this.points=e,this.verticies=new n.Float32Array(4*e.length),this.uvs=new n.Float32Array(4*e.length),this.colors=new n.Float32Array(2*e.length),this.indices=new n.Uint16Array(2*e.length),this.refresh()},n.Rope.prototype=Object.create(n.Strip.prototype),n.Rope.prototype.constructor=n.Rope,n.Rope.prototype.refresh=function(){var t=this.points;if(!(t.length<1)){var e=this.uvs,n=(t[0],this.indices),i=this.colors;this.count-=.2,e[0]=0,e[1]=0,e[2]=0,e[3]=1,i[0]=1,i[1]=1,n[0]=0,n[1]=1;for(var r,o,a,s=t.length,l=1;s>l;l++)r=t[l],a=l/(s-1),e[o=4*l]=a,e[o+1]=0,e[o+2]=a,e[o+3]=1,i[o=2*l]=1,i[o+1]=1,n[o=2*l]=o,n[o+1]=o+1,r}},n.Rope.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){var e,i=t[0],r={x:0,y:0};this.count-=.2;for(var o,a,s,l,u=this.verticies,c=t.length,h=0;c>h;h++)o=t[h],a=4*h,e=h<t.length-1?t[h+1]:o,r.y=-(e.x-i.x),r.x=e.y-i.y,10*(1-h/(c-1))>1&&1,s=Math.sqrt(r.x*r.x+r.y*r.y),l=this.texture.height/2,r.x/=s,r.y/=s,r.x*=l,r.y*=l,u[a]=o.x+r.x,u[a+1]=o.y+r.y,u[a+2]=o.x-r.x,u[a+3]=o.y-r.y,i=o;n.DisplayObjectContainer.prototype.updateTransform.call(this)}},n.Rope.prototype.setTexture=function(t){this.texture=t},n.TilingSprite=function(t,e,i){n.Sprite.call(this,t),this._width=e||100,this._height=i||100,this.tileScale=new n.Point(1,1),this.tileScaleOffset=new n.Point(1,1),this.tilePosition=new n.Point(0,0),this.renderable=!0,this.tint=16777215,this.blendMode=n.blendModes.NORMAL},n.TilingSprite.prototype=Object.create(n.Sprite.prototype),n.TilingSprite.prototype.constructor=n.TilingSprite,Object.defineProperty(n.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t}}),Object.defineProperty(n.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t}}),n.TilingSprite.prototype.setTexture=function(t){this.texture!==t&&(this.texture=t,this.refreshTexture=!0,this.cachedTint=16777215)},n.TilingSprite.prototype._renderWebGL=function(t){if(!1!==this.visible&&0!==this.alpha){var e,i;for(this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(n.updateWebGLTexture(this.tilingTexture.baseTexture,t.gl),this.tilingTexture.needsUpdate=!1)):t.spriteBatch.renderTilingSprite(this),e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(t),t.spriteBatch.start()}},n.TilingSprite.prototype._renderCanvas=function(t){if(!1!==this.visible&&0!==this.alpha){var e=t.context;this._mask&&t.maskManager.pushMask(this._mask,e),e.globalAlpha=this.worldAlpha;var i,r,o=this.worldTransform;if(e.setTransform(o.a,o.c,o.b,o.d,o.tx,o.ty),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;this.__tilePattern=e.createPattern(this.tilingTexture.baseTexture.source,"repeat")}this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]);var a=this.tilePosition,s=this.tileScale;for(a.x%=this.tilingTexture.baseTexture.width,a.y%=this.tilingTexture.baseTexture.height,e.scale(s.x,s.y),e.translate(a.x,a.y),e.fillStyle=this.__tilePattern,e.fillRect(-a.x+this.anchor.x*-this._width,-a.y+this.anchor.y*-this._height,this._width/s.x,this._height/s.y),e.scale(1/s.x,1/s.y),e.translate(-a.x,-a.y),this._mask&&t.maskManager.popMask(t.context),i=0,r=this.children.length;r>i;i++)this.children[i]._renderCanvas(t)}},n.TilingSprite.prototype.getBounds=function(){var t=this._width,e=this._height,n=t*(1-this.anchor.x),i=t*-this.anchor.x,r=e*(1-this.anchor.y),o=e*-this.anchor.y,a=this.worldTransform,s=a.a,l=a.c,u=a.b,c=a.d,h=a.tx,d=a.ty,p=s*i+u*o+h,f=c*o+l*i+d,m=s*n+u*o+h,g=c*o+l*n+d,v=s*n+u*r+h,y=c*r+l*n+d,b=s*i+u*r+h,_=c*r+l*i+d,x=-1/0,w=-1/0,C=1/0,T=1/0;C=(C=(C=(C=C>p?p:C)>m?m:C)>v?v:C)>b?b:C,T=(T=(T=(T=T>f?f:T)>g?g:T)>y?y:T)>_?_:T,x=b>(x=v>(x=m>(x=p>x?p:x)?m:x)?v:x)?b:x,w=_>(w=y>(w=g>(w=f>w?f:w)?g:w)?y:w)?_:w;var S=this._bounds;return S.x=C,S.width=x-C,S.y=T,S.height=w-T,this._currentBounds=S,S},n.TilingSprite.prototype.onTextureUpdate=function(){},n.TilingSprite.prototype.generateTilingTexture=function(t){if(this.texture.baseTexture.hasLoaded){var e,i,r,o=this.texture,a=o.frame,s=a.width!==o.baseTexture.width||a.height!==o.baseTexture.height,l=!1;if(t?(e=n.getNextPowerOfTwo(a.width),i=n.getNextPowerOfTwo(a.height),(a.width!==e||a.height!==i)&&(l=!0)):s&&(e=a.width,i=a.height,l=!0),l)this.tilingTexture&&this.tilingTexture.isTiling?((r=this.tilingTexture.canvasBuffer).resize(e,i),this.tilingTexture.baseTexture.width=e,this.tilingTexture.baseTexture.height=i,this.tilingTexture.needsUpdate=!0):(r=new n.CanvasBuffer(e,i),this.tilingTexture=n.Texture.fromCanvas(r.canvas),this.tilingTexture.canvasBuffer=r,this.tilingTexture.isTiling=!0),r.context.drawImage(o.baseTexture.source,o.crop.x,o.crop.y,o.crop.width,o.crop.height,0,0,e,i),this.tileScaleOffset.x=a.width/e,this.tileScaleOffset.y=a.height/i;else this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=o;this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0}};var a={BoneData:function(t,e){this.name=t,this.parent=e}};a.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1},a.SlotData=function(t,e){this.name=t,this.boneData=e},a.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null},a.Bone=function(t,e){this.data=t,this.parent=e,this.setToSetupPose()},a.Bone.yDown=!1,a.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(t,e){var n=this.parent;null!=n?(this.worldX=this.x*n.m00+this.y*n.m01+n.worldX,this.worldY=this.x*n.m10+this.y*n.m11+n.worldY,this.worldScaleX=n.worldScaleX*this.scaleX,this.worldScaleY=n.worldScaleY*this.scaleY,this.worldRotation=n.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var i=this.worldRotation*Math.PI/180,r=Math.cos(i),o=Math.sin(i);this.m00=r*this.worldScaleX,this.m10=o*this.worldScaleX,this.m01=-o*this.worldScaleY,this.m11=r*this.worldScaleY,t&&(this.m00=-this.m00,this.m01=-this.m01),e&&(this.m10=-this.m10,this.m11=-this.m11),a.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY}},a.Slot=function(t,e,n){this.data=t,this.skeleton=e,this.bone=n,this.setToSetupPose()},a.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(t){this.attachment=t,this._attachmentTime=this.skeleton.time},setAttachmentTime:function(t){this._attachmentTime=this.skeleton.time-t},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var t=this.data;this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a;for(var e=this.skeleton.data.slots,n=0,i=e.length;i>n;n++)if(e[n]==t){this.setAttachment(t.attachmentName?this.skeleton.getAttachmentBySlotIndex(n,t.attachmentName):null);break}}},a.Skin=function(t){this.name=t,this.attachments={}},a.Skin.prototype={addAttachment:function(t,e,n){this.attachments[t+":"+e]=n},getAttachment:function(t,e){return this.attachments[t+":"+e]},_attachAll:function(t,e){for(var n in e.attachments){var i=n.indexOf(":"),r=parseInt(n.substring(0,i),10),o=n.substring(i+1),a=t.slots[r];if(a.attachment&&a.attachment.name==o){var s=this.getAttachment(r,o);s&&a.setAttachment(s)}}}},a.Animation=function(t,e,n){this.name=t,this.timelines=e,this.duration=n},a.Animation.prototype={apply:function(t,e,n){n&&this.duration&&(e%=this.duration);for(var i=this.timelines,r=0,o=i.length;o>r;r++)i[r].apply(t,e,1)},mix:function(t,e,n,i){n&&this.duration&&(e%=this.duration);for(var r=this.timelines,o=0,a=r.length;a>o;o++)r[o].apply(t,e,i)}},a.binarySearch=function(t,e,n){var i=0,r=Math.floor(t.length/n)-2;if(!r)return n;for(var o=r>>>1;;){if(t[(o+1)*n]<=e?i=o+1:r=o,i==r)return(i+1)*n;o=i+r>>>1}},a.linearSearch=function(t,e,n){for(var i=0,r=t.length-n;r>=i;i+=n)if(t[i]>e)return i;return-1},a.Curves=function(t){this.curves=[],this.curves.length=6*(t-1)},a.Curves.prototype={setLinear:function(t){this.curves[6*t]=0},setStepped:function(t){this.curves[6*t]=-1},setCurve:function(t,e,n,i,r){var o=.1*.1,a=.1*o,s=3*o,l=6*o,u=6*a,c=2*-e+i,h=2*-n+r,d=3*(e-i)+1,p=3*(n-r)+1,f=6*t,m=this.curves;m[f]=e*(3*.1)+c*s+d*a,m[f+1]=n*(3*.1)+h*s+p*a,m[f+2]=c*l+d*u,m[f+3]=h*l+p*u,m[f+4]=d*u,m[f+5]=p*u},getCurvePercent:function(t,e){e=0>e?0:e>1?1:e;var n=6*t,i=this.curves,r=i[n];if(!r)return e;if(-1==r)return 0;for(var o=i[n+1],a=i[n+2],s=i[n+3],l=i[n+4],u=i[n+5],c=r,h=o,d=8;;){if(c>=e){var p=c-r,f=h-o;return f+(h-f)*(e-p)/(c-p)}if(!d)break;d--,r+=a,o+=s,a+=l,s+=u,c+=r,h+=o}return h+(1-h)*(e-c)/(1-c)}},a.RotateTimeline=function(t){this.curves=new a.Curves(t),this.frames=[],this.frames.length=2*t},a.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,n){t*=2,this.frames[t]=e,this.frames[t+1]=n},apply:function(t,e,n){var i,r=this.frames;if(!(e<r[0])){var o=t.bones[this.boneIndex];if(e>=r[r.length-2]){for(i=o.data.rotation+r[r.length-1]-o.rotation;i>180;)i-=360;for(;-180>i;)i+=360;return void(o.rotation+=i*n)}var s=a.binarySearch(r,e,2),l=r[s-1],u=r[s],c=1-(e-u)/(r[s-2]-u);for(c=this.curves.getCurvePercent(s/2-1,c),i=r[s+1]-l;i>180;)i-=360;for(;-180>i;)i+=360;for(i=o.data.rotation+(l+i*c)-o.rotation;i>180;)i-=360;for(;-180>i;)i+=360;o.rotation+=i*n}}},a.TranslateTimeline=function(t){this.curves=new a.Curves(t),this.frames=[],this.frames.length=3*t},a.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,n,i){t*=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=i},apply:function(t,e,n){var i=this.frames;if(!(e<i[0])){var r=t.bones[this.boneIndex];if(e>=i[i.length-3])return r.x+=(r.data.x+i[i.length-2]-r.x)*n,void(r.y+=(r.data.y+i[i.length-1]-r.y)*n);var o=a.binarySearch(i,e,3),s=i[o-2],l=i[o-1],u=i[o],c=1-(e-u)/(i[o+-3]-u);c=this.curves.getCurvePercent(o/3-1,c),r.x+=(r.data.x+s+(i[o+1]-s)*c-r.x)*n,r.y+=(r.data.y+l+(i[o+2]-l)*c-r.y)*n}}},a.ScaleTimeline=function(t){this.curves=new a.Curves(t),this.frames=[],this.frames.length=3*t},a.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,n,i){t*=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=i},apply:function(t,e,n){var i=this.frames;if(!(e<i[0])){var r=t.bones[this.boneIndex];if(e>=i[i.length-3])return r.scaleX+=(r.data.scaleX-1+i[i.length-2]-r.scaleX)*n,void(r.scaleY+=(r.data.scaleY-1+i[i.length-1]-r.scaleY)*n);var o=a.binarySearch(i,e,3),s=i[o-2],l=i[o-1],u=i[o],c=1-(e-u)/(i[o+-3]-u);c=this.curves.getCurvePercent(o/3-1,c),r.scaleX+=(r.data.scaleX-1+s+(i[o+1]-s)*c-r.scaleX)*n,r.scaleY+=(r.data.scaleY-1+l+(i[o+2]-l)*c-r.scaleY)*n}}},a.ColorTimeline=function(t){this.curves=new a.Curves(t),this.frames=[],this.frames.length=5*t},a.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(t,e,n,i,r,o){t*=5,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=i,this.frames[t+3]=r,this.frames[t+4]=o},apply:function(t,e,n){var i=this.frames;if(!(e<i[0])){var r=t.slots[this.slotIndex];if(e>=i[i.length-5]){var o=i.length-1;return r.r=i[o-3],r.g=i[o-2],r.b=i[o-1],void(r.a=i[o])}var s=a.binarySearch(i,e,5),l=i[s-4],u=i[s-3],c=i[s-2],h=i[s-1],d=i[s],p=1-(e-d)/(i[s-5]-d);p=this.curves.getCurvePercent(s/5-1,p);var f=l+(i[s+1]-l)*p,m=u+(i[s+2]-u)*p,g=c+(i[s+3]-c)*p,v=h+(i[s+4]-h)*p;1>n?(r.r+=(f-r.r)*n,r.g+=(m-r.g)*n,r.b+=(g-r.b)*n,r.a+=(v-r.a)*n):(r.r=f,r.g=m,r.b=g,r.a=v)}}},a.AttachmentTimeline=function(t){this.curves=new a.Curves(t),this.frames=[],this.frames.length=t,this.attachmentNames=[],this.attachmentNames.length=t},a.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n},apply:function(t,e){var n=this.frames;if(!(e<n[0])){var i;i=e>=n[n.length-1]?n.length-1:a.binarySearch(n,e,1)-1;var r=this.attachmentNames[i];t.slots[this.slotIndex].setAttachment(r?t.getAttachmentBySlotIndex(this.slotIndex,r):null)}}},a.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.animations=[]},a.SkeletonData.prototype={defaultSkin:null,findBone:function(t){for(var e=this.bones,n=0,i=e.length;i>n;n++)if(e[n].name==t)return e[n];return null},findBoneIndex:function(t){for(var e=this.bones,n=0,i=e.length;i>n;n++)if(e[n].name==t)return n;return-1},findSlot:function(t){for(var e=this.slots,n=0,i=e.length;i>n;n++)if(e[n].name==t)return slot[n];return null},findSlotIndex:function(t){for(var e=this.slots,n=0,i=e.length;i>n;n++)if(e[n].name==t)return n;return-1},findSkin:function(t){for(var e=this.skins,n=0,i=e.length;i>n;n++)if(e[n].name==t)return e[n];return null},findAnimation:function(t){for(var e=this.animations,n=0,i=e.length;i>n;n++)if(e[n].name==t)return e[n];return null}},a.Skeleton=function(t){this.data=t,this.bones=[];for(var e=0,n=t.bones.length;n>e;e++){var i=t.bones[e],r=i.parent?this.bones[t.bones.indexOf(i.parent)]:null;this.bones.push(new a.Bone(i,r))}for(this.slots=[],this.drawOrder=[],e=0,n=t.slots.length;n>e;e++){var o=t.slots[e],s=this.bones[t.bones.indexOf(o.boneData)],l=new a.Slot(o,this,s);this.slots.push(l),this.drawOrder.push(l)}},a.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var t=this.flipX,e=this.flipY,n=this.bones,i=0,r=n.length;r>i;i++)n[i].updateWorldTransform(t,e)},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t=this.bones,e=0,n=t.length;n>e;e++)t[e].setToSetupPose()},setSlotsToSetupPose:function(){for(var t=this.slots,e=0,n=t.length;n>e;e++)t[e].setToSetupPose(e)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(t){for(var e=this.bones,n=0,i=e.length;i>n;n++)if(e[n].data.name==t)return e[n];return null},findBoneIndex:function(t){for(var e=this.bones,n=0,i=e.length;i>n;n++)if(e[n].data.name==t)return n;return-1},findSlot:function(t){for(var e=this.slots,n=0,i=e.length;i>n;n++)if(e[n].data.name==t)return e[n];return null},findSlotIndex:function(t){for(var e=this.slots,n=0,i=e.length;i>n;n++)if(e[n].data.name==t)return n;return-1},setSkinByName:function(t){var e=this.data.findSkin(t);if(!e)throw"Skin not found: "+t;this.setSkin(e)},setSkin:function(t){this.skin&&t&&t._attachAll(this,this.skin),this.skin=t},getAttachmentBySlotName:function(t,e){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(t),e)},getAttachmentBySlotIndex:function(t,e){if(this.skin){var n=this.skin.getAttachment(t,e);if(n)return n}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},setAttachment:function(t,e){for(var n=this.slots,i=0,r=n.size;r>i;i++){var o=n[i];if(o.data.name==t){var a=null;if(e&&null==(a=this.getAttachment(i,e)))throw"Attachment not found: "+e+", for slot: "+t;return void o.setAttachment(a)}}throw"Slot not found: "+t},update:function(t){time+=t}},a.AttachmentType={region:0},a.RegionAttachment=function(){this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},a.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(t,e,n,i,r){var o=this.uvs;r?(o[2]=t,o[3]=i,o[4]=t,o[5]=e,o[6]=n,o[7]=e,o[0]=n,o[1]=i):(o[0]=t,o[1]=i,o[2]=t,o[3]=e,o[4]=n,o[5]=e,o[6]=n,o[7]=i)},updateOffset:function(){var t=this.width/this.regionOriginalWidth*this.scaleX,e=this.height/this.regionOriginalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.regionOffsetX*t,i=-this.height/2*this.scaleY+this.regionOffsetY*e,r=n+this.regionWidth*t,o=i+this.regionHeight*e,a=this.rotation*Math.PI/180,s=Math.cos(a),l=Math.sin(a),u=n*s+this.x,c=n*l,h=i*s+this.y,d=i*l,p=r*s+this.x,f=r*l,m=o*s+this.y,g=o*l,v=this.offset;v[0]=u-d,v[1]=h+c,v[2]=u-g,v[3]=m+c,v[4]=p-g,v[5]=m+f,v[6]=p-d,v[7]=h+f},computeVertices:function(t,e,n,i){t+=n.worldX,e+=n.worldY;var r=n.m00,o=n.m01,a=n.m10,s=n.m11,l=this.offset;i[0]=l[0]*r+l[1]*o+t,i[1]=l[0]*a+l[1]*s+e,i[2]=l[2]*r+l[3]*o+t,i[3]=l[2]*a+l[3]*s+e,i[4]=l[4]*r+l[5]*o+t,i[5]=l[4]*a+l[5]*s+e,i[6]=l[6]*r+l[7]*o+t,i[7]=l[6]*a+l[7]*s+e}},a.AnimationStateData=function(t){this.skeletonData=t,this.animationToMixTime={}},a.AnimationStateData.prototype={defaultMix:0,setMixByName:function(t,e,n){var i=this.skeletonData.findAnimation(t);if(!i)throw"Animation not found: "+t;var r=this.skeletonData.findAnimation(e);if(!r)throw"Animation not found: "+e;this.setMix(i,r,n)},setMix:function(t,e,n){this.animationToMixTime[t.name+":"+e.name]=n},getMix:function(t,e){var n=this.animationToMixTime[t.name+":"+e.name];return n||this.defaultMix}},a.AnimationState=function(t){this.data=t,this.queue=[]},a.AnimationState.prototype={animationSpeed:1,current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(t){if(this.currentTime+=t*this.animationSpeed,this.previousTime+=t,this.mixTime+=t,this.queue.length>0){var e=this.queue[0];this.currentTime>=e.delay&&(this._setAnimation(e.animation,e.loop),this.queue.shift())}},apply:function(t){if(this.current)if(this.previous){this.previous.apply(t,this.previousTime,this.previousLoop);var e=this.mixTime/this.mixDuration;e>=1&&(e=1,this.previous=null),this.current.mix(t,this.currentTime,this.currentLoop,e)}else this.current.apply(t,this.currentTime,this.currentLoop)},clearAnimation:function(){this.previous=null,this.current=null,this.queue.length=0},_setAnimation:function(t,e){this.previous=null,t&&this.current&&(this.mixDuration=this.data.getMix(this.current,t),this.mixDuration>0&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,this.previousLoop=this.currentLoop)),this.current=t,this.currentLoop=e,this.currentTime=0},setAnimationByName:function(t,e){var n=this.data.skeletonData.findAnimation(t);if(!n)throw"Animation not found: "+t;this.setAnimation(n,e)},setAnimation:function(t,e){this.queue.length=0,this._setAnimation(t,e)},addAnimationByName:function(t,e,n){var i=this.data.skeletonData.findAnimation(t);if(!i)throw"Animation not found: "+t;this.addAnimation(i,e,n)},addAnimation:function(t,e,n){var i={};if(i.animation=t,i.loop=e,!n||0>=n){var r=this.queue.length?this.queue[this.queue.length-1].animation:this.current;n=null!=r?r.duration-this.data.getMix(r,t)+(n||0):0}i.delay=n,this.queue.push(i)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}},a.SkeletonJson=function(t){this.attachmentLoader=t},a.SkeletonJson.prototype={scale:1,readSkeletonData:function(t){for(var e,n=new a.SkeletonData,i=t.bones,r=0,o=i.length;o>r;r++){var s=i[r],l=null;if(s.parent&&!(l=n.findBone(s.parent)))throw"Parent bone not found: "+s.parent;(e=new a.BoneData(s.name,l)).length=(s.length||0)*this.scale,e.x=(s.x||0)*this.scale,e.y=(s.y||0)*this.scale,e.rotation=s.rotation||0,e.scaleX=s.scaleX||1,e.scaleY=s.scaleY||1,n.bones.push(e)}var u=t.slots;for(r=0,o=u.length;o>r;r++){var c=u[r];if(!(e=n.findBone(c.bone)))throw"Slot bone not found: "+c.bone;var h=new a.SlotData(c.name,e),d=c.color;d&&(h.r=a.SkeletonJson.toColor(d,0),h.g=a.SkeletonJson.toColor(d,1),h.b=a.SkeletonJson.toColor(d,2),h.a=a.SkeletonJson.toColor(d,3)),h.attachmentName=c.attachment,n.slots.push(h)}var p=t.skins;for(var f in p)if(p.hasOwnProperty(f)){var m=p[f],g=new a.Skin(f);for(var v in m)if(m.hasOwnProperty(v)){var y=n.findSlotIndex(v),b=m[v];for(var _ in b)if(b.hasOwnProperty(_)){var x=this.readAttachment(g,_,b[_]);null!=x&&g.addAttachment(y,_,x)}}n.skins.push(g),"default"==g.name&&(n.defaultSkin=g)}var w=t.animations;for(var C in w)w.hasOwnProperty(C)&&this.readAnimation(C,w[C],n);return n},readAttachment:function(t,e,n){e=n.name||e;var i=a.AttachmentType[n.type||"region"];if(i==a.AttachmentType.region){var r=new a.RegionAttachment;return r.x=(n.x||0)*this.scale,r.y=(n.y||0)*this.scale,r.scaleX=n.scaleX||1,r.scaleY=n.scaleY||1,r.rotation=n.rotation||0,r.width=(n.width||32)*this.scale,r.height=(n.height||32)*this.scale,r.updateOffset(),r.rendererObject={},r.rendererObject.name=e,r.rendererObject.scale={},r.rendererObject.scale.x=r.scaleX,r.rendererObject.scale.y=r.scaleY,r.rendererObject.rotation=-r.rotation*Math.PI/180,r}throw"Unknown attachment type: "+i},readAnimation:function(t,e,n){var i,r,o,s,l,u,c,h=[],d=0,p=e.bones;for(var f in p)if(p.hasOwnProperty(f)){var m=n.findBoneIndex(f);if(-1==m)throw"Bone not found: "+f;var g=p[f];for(o in g)if(g.hasOwnProperty(o))if(l=g[o],"rotate"==o){for((r=new a.RotateTimeline(l.length)).boneIndex=m,i=0,u=0,c=l.length;c>u;u++)s=l[u],r.setFrame(i,s.time,s.angle),a.SkeletonJson.readCurve(r,i,s),i++;h.push(r),d=Math.max(d,r.frames[2*r.getFrameCount()-2])}else{if("translate"!=o&&"scale"!=o)throw"Invalid timeline type for a bone: "+o+" ("+f+")";var v=1;for("scale"==o?r=new a.ScaleTimeline(l.length):(r=new a.TranslateTimeline(l.length),v=this.scale),r.boneIndex=m,i=0,u=0,c=l.length;c>u;u++){var y=((s=l[u]).x||0)*v,b=(s.y||0)*v;r.setFrame(i,s.time,y,b),a.SkeletonJson.readCurve(r,i,s),i++}h.push(r),d=Math.max(d,r.frames[3*r.getFrameCount()-3])}}var _=e.slots;for(var x in _)if(_.hasOwnProperty(x)){var w=_[x],C=n.findSlotIndex(x);for(o in w)if(w.hasOwnProperty(o))if(l=w[o],"color"==o){for((r=new a.ColorTimeline(l.length)).slotIndex=C,i=0,u=0,c=l.length;c>u;u++){var T=(s=l[u]).color,S=a.SkeletonJson.toColor(T,0),k=a.SkeletonJson.toColor(T,1),A=a.SkeletonJson.toColor(T,2),E=a.SkeletonJson.toColor(T,3);r.setFrame(i,s.time,S,k,A,E),a.SkeletonJson.readCurve(r,i,s),i++}h.push(r),d=Math.max(d,r.frames[5*r.getFrameCount()-5])}else{if("attachment"!=o)throw"Invalid timeline type for a slot: "+o+" ("+x+")";for((r=new a.AttachmentTimeline(l.length)).slotIndex=C,i=0,u=0,c=l.length;c>u;u++)s=l[u],r.setFrame(i++,s.time,s.name);h.push(r),d=Math.max(d,r.frames[r.getFrameCount()-1])}}n.animations.push(new a.Animation(t,h,d))}},a.SkeletonJson.readCurve=function(t,e,n){var i=n.curve;i&&("stepped"==i?t.curves.setStepped(e):i instanceof Array&&t.curves.setCurve(e,i[0],i[1],i[2],i[3]))},a.SkeletonJson.toColor=function(t,e){if(8!=t.length)throw"Color hexidecimal length must be 8, recieved: "+t;return parseInt(t.substr(2*e,2),16)/255},a.Atlas=function(t,e){this.textureLoader=e,this.pages=[],this.regions=[];var n=new a.AtlasReader(t),i=[];i.length=4;for(var r=null;;){var o=n.readLine();if(null==o)break;if((o=n.trim(o)).length)if(r){var s=new a.AtlasRegion;s.name=o,s.page=r,s.rotate="true"==n.readValue(),n.readTuple(i);var l=parseInt(i[0],10),u=parseInt(i[1],10);n.readTuple(i);var c=parseInt(i[0],10),h=parseInt(i[1],10);s.u=l/r.width,s.v=u/r.height,s.rotate?(s.u2=(l+h)/r.width,s.v2=(u+c)/r.height):(s.u2=(l+c)/r.width,s.v2=(u+h)/r.height),s.x=l,s.y=u,s.width=Math.abs(c),s.height=Math.abs(h),4==n.readTuple(i)&&(s.splits=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10)],4==n.readTuple(i)&&(s.pads=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10)],n.readTuple(i))),s.originalWidth=parseInt(i[0],10),s.originalHeight=parseInt(i[1],10),n.readTuple(i),s.offsetX=parseInt(i[0],10),s.offsetY=parseInt(i[1],10),s.index=parseInt(n.readValue(),10),this.regions.push(s)}else{(r=new a.AtlasPage).name=o,r.format=a.Atlas.Format[n.readValue()],n.readTuple(i),r.minFilter=a.Atlas.TextureFilter[i[0]],r.magFilter=a.Atlas.TextureFilter[i[1]];var d=n.readValue();r.uWrap=a.Atlas.TextureWrap.clampToEdge,r.vWrap=a.Atlas.TextureWrap.clampToEdge,"x"==d?r.uWrap=a.Atlas.TextureWrap.repeat:"y"==d?r.vWrap=a.Atlas.TextureWrap.repeat:"xy"==d&&(r.uWrap=r.vWrap=a.Atlas.TextureWrap.repeat),e.load(r,o),this.pages.push(r)}else r=null}},a.Atlas.prototype={findRegion:function(t){for(var e=this.regions,n=0,i=e.length;i>n;n++)if(e[n].name==t)return e[n];return null},dispose:function(){for(var t=this.pages,e=0,n=t.length;n>e;e++)this.textureLoader.unload(t[e].rendererObject)},updateUVs:function(t){for(var e=this.regions,n=0,i=e.length;i>n;n++){var r=e[n];r.page==t&&(r.u=r.x/t.width,r.v=r.y/t.height,r.rotate?(r.u2=(r.x+r.height)/t.width,r.v2=(r.y+r.width)/t.height):(r.u2=(r.x+r.width)/t.width,r.v2=(r.y+r.height)/t.height))}}},a.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},a.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},a.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},a.AtlasPage=function(){},a.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},a.AtlasRegion=function(){},a.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},a.AtlasReader=function(t){this.lines=t.split(/\r\n|\r|\n/)},a.AtlasReader.prototype={index:0,trim:function(t){return t.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw"Invalid line: "+t;return this.trim(t.substring(e+1))},readTuple:function(t){var e=this.readLine(),n=e.indexOf(":");if(-1==n)throw"Invalid line: "+e;for(var i=0,r=n+1;3>i;i++){var o=e.indexOf(",",r);if(-1==o){if(!i)throw"Invalid line: "+e;break}t[i]=this.trim(e.substr(r,o-r)),r=o+1}return t[i]=this.trim(e.substring(r)),i+1}},a.AtlasAttachmentLoader=function(t){this.atlas=t},a.AtlasAttachmentLoader.prototype={newAttachment:function(t,e,n){switch(e){case a.AttachmentType.region:var i=this.atlas.findRegion(n);if(!i)throw"Region not found in atlas: "+n+" ("+e+")";var r=new a.RegionAttachment(n);return r.rendererObject=i,r.setUVs(i.u,i.v,i.u2,i.v2,i.rotate),r.regionOffsetX=i.offsetX,r.regionOffsetY=i.offsetY,r.regionWidth=i.width,r.regionHeight=i.height,r.regionOriginalWidth=i.originalWidth,r.regionOriginalHeight=i.originalHeight,r}throw"Unknown attachment type: "+e}},a.Bone.yDown=!0,n.AnimCache={},n.Spine=function(t){if(n.DisplayObjectContainer.call(this),this.spineData=n.AnimCache[t],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+t);this.skeleton=new a.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new a.AnimationStateData(this.spineData),this.state=new a.AnimationState(this.stateData),this.slotContainers=[];for(var e=0,i=this.skeleton.drawOrder.length;i>e;e++){var r=this.skeleton.drawOrder[e],o=r.attachment,s=new n.DisplayObjectContainer;if(this.slotContainers.push(s),this.addChild(s),o instanceof a.RegionAttachment){var l=o.rendererObject.name,u=this.createSprite(r,o.rendererObject);r.currentSprite=u,r.currentSpriteName=l,s.addChild(u)}}},n.Spine.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Spine.prototype.constructor=n.Spine,n.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();var t=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.state.update(t),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var e=this.skeleton.drawOrder,i=0,r=e.length;r>i;i++){var o=e[i],s=o.attachment,l=this.slotContainers[i];if(s instanceof a.RegionAttachment){if(s.rendererObject&&(!o.currentSpriteName||o.currentSpriteName!=s.name)){var u=s.rendererObject.name;if(void 0!==o.currentSprite&&(o.currentSprite.visible=!1),o.sprites=o.sprites||{},void 0!==o.sprites[u])o.sprites[u].visible=!0;else{var c=this.createSprite(o,s.rendererObject);l.addChild(c)}o.currentSprite=o.sprites[u],o.currentSpriteName=u}l.visible=!0;var h=o.bone;l.position.x=h.worldX+s.x*h.m00+s.y*h.m01,l.position.y=h.worldY+s.x*h.m10+s.y*h.m11,l.scale.x=h.worldScaleX,l.scale.y=h.worldScaleY,l.rotation=-o.bone.worldRotation*Math.PI/180,l.alpha=o.a,o.currentSprite.tint=n.rgb2hex([o.r,o.g,o.b])}else l.visible=!1}n.DisplayObjectContainer.prototype.updateTransform.call(this)},n.Spine.prototype.createSprite=function(t,e){var i=n.TextureCache[e.name]?e.name:e.name+".png",r=new n.Sprite(n.Texture.fromFrame(i));return r.scale=e.scale,r.rotation=e.rotation,r.anchor.x=r.anchor.y=.5,t.sprites=t.sprites||{},t.sprites[e.name]=r,r},n.BaseTextureCache={},n.texturesToUpdate=[],n.texturesToDestroy=[],n.BaseTextureCacheIdGenerator=0,n.BaseTexture=function(t,e){if(n.EventTarget.call(this),this.width=100,this.height=100,this.scaleMode=e||n.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=t,this.id=n.BaseTextureCacheIdGenerator++,this.premultipliedAlpha=!0,this._glTextures=[],this._dirty=[],t){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,n.texturesToUpdate.push(this);else{var i=this;this.source.onload=function(){i.hasLoaded=!0,i.width=i.source.width,i.height=i.source.height;for(var t=0;t<i._glTextures.length;t++)i._dirty[t]=!0;i.dispatchEvent({type:"loaded",content:i})},this.source.onerror=function(){i.dispatchEvent({type:"error",content:i})}}this.imageUrl=null,this._powerOf2=!1}},n.BaseTexture.prototype.constructor=n.BaseTexture,n.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete n.BaseTextureCache[this.imageUrl],delete n.TextureCache[this.imageUrl],this.imageUrl=null,this.source.src=null):this.source&&this.source._pixiId&&delete n.BaseTextureCache[this.source._pixiId],this.source=null,n.texturesToDestroy.push(this)},n.BaseTexture.prototype.updateSourceImage=function(t){this.hasLoaded=!1,this.source.src=null,this.source.src=t},n.BaseTexture.fromImage=function(t,e,i){var r=n.BaseTextureCache[t];if(void 0===e&&-1===t.indexOf("data:")&&(e=!0),!r){var o=new Image;e&&(o.crossOrigin=""),o.src=t,(r=new n.BaseTexture(o,i)).imageUrl=t,n.BaseTextureCache[t]=r}return r},n.BaseTexture.fromCanvas=function(t,e){t._pixiId||(t._pixiId="canvas_"+n.TextureCacheIdGenerator++);var i=n.BaseTextureCache[t._pixiId];return i||(i=new n.BaseTexture(t,e),n.BaseTextureCache[t._pixiId]=i),i},n.TextureCache={},n.FrameCache={},n.TextureCacheIdGenerator=0,n.Texture=function(t,e){if(n.EventTarget.call(this),this.noFrame=!1,e||(this.noFrame=!0,e=new n.Rectangle(0,0,1,1)),t instanceof n.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=e,this.trim=null,this.valid=!1,this.scope=this,this._uvs=null,this.width=0,this.height=0,this.crop=new n.Rectangle(0,0,1,1),t.hasLoaded)this.noFrame&&(e=new n.Rectangle(0,0,t.width,t.height)),this.setFrame(e);else{var i=this;t.addEventListener("loaded",(function(){i.onBaseTextureLoaded()}))}},n.Texture.prototype.constructor=n.Texture,n.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new n.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame),this.scope.dispatchEvent({type:"update",content:this})},n.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy(),this.valid=!1},n.Texture.prototype.setFrame=function(t){if(this.noFrame=!1,this.frame=t,this.width=t.width,this.height=t.height,this.crop.x=t.x,this.crop.y=t.y,this.crop.width=t.width,this.crop.height=t.height,!this.trim&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=t&&t.width&&t.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&n.Texture.frameUpdates.push(this)},n.Texture.prototype._updateWebGLuvs=function(){this._uvs||(this._uvs=new n.TextureUvs);var t=this.crop,e=this.baseTexture.width,i=this.baseTexture.height;this._uvs.x0=t.x/e,this._uvs.y0=t.y/i,this._uvs.x1=(t.x+t.width)/e,this._uvs.y1=t.y/i,this._uvs.x2=(t.x+t.width)/e,this._uvs.y2=(t.y+t.height)/i,this._uvs.x3=t.x/e,this._uvs.y3=(t.y+t.height)/i},n.Texture.fromImage=function(t,e,i){var r=n.TextureCache[t];return r||(r=new n.Texture(n.BaseTexture.fromImage(t,e,i)),n.TextureCache[t]=r),r},n.Texture.fromFrame=function(t){var e=n.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache ');return e},n.Texture.fromCanvas=function(t,e){var i=n.BaseTexture.fromCanvas(t,e);return new n.Texture(i)},n.Texture.addTextureToCache=function(t,e){n.TextureCache[e]=t},n.Texture.removeTextureFromCache=function(t){var e=n.TextureCache[t];return delete n.TextureCache[t],delete n.BaseTextureCache[t],e},n.Texture.frameUpdates=[],n.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},n.RenderTexture=function(t,e,i,r){if(n.EventTarget.call(this),this.width=t||100,this.height=e||100,this.frame=new n.Rectangle(0,0,this.width,this.height),this.crop=new n.Rectangle(0,0,this.width,this.height),this.baseTexture=new n.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTextures=[],this.baseTexture.scaleMode=r||n.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,this.renderer=i||n.defaultRenderer,this.renderer.type===n.WEBGL_RENDERER){var o=this.renderer.gl;this.textureBuffer=new n.FilterTexture(o,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[o.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new n.Point(this.width/2,-this.height/2)}else this.render=this.renderCanvas,this.textureBuffer=new n.CanvasBuffer(this.width,this.height),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,n.Texture.frameUpdates.push(this)},n.RenderTexture.prototype=Object.create(n.Texture.prototype),n.RenderTexture.prototype.constructor=n.RenderTexture,n.RenderTexture.prototype.resize=function(t,e,i){(t!==this.width||e!==this.height)&&(this.width=this.frame.width=this.crop.width=t,this.height=this.frame.height=this.crop.height=e,i&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.renderer.type===n.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.textureBuffer.resize(this.width,this.height))},n.RenderTexture.prototype.clear=function(){this.renderer.type===n.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear()},n.RenderTexture.prototype.renderWebGL=function(t,e,i){var r=this.renderer.gl;r.colorMask(!0,!0,!0,!0),r.viewport(0,0,this.width,this.height),r.bindFramebuffer(r.FRAMEBUFFER,this.textureBuffer.frameBuffer),i&&this.textureBuffer.clear();var o=t.children,a=t.worldTransform;t.worldTransform=n.RenderTexture.tempMatrix,t.worldTransform.d=-1,t.worldTransform.ty=-2*this.projection.y,e&&(t.worldTransform.tx=e.x,t.worldTransform.ty-=e.y);for(var s=0,l=o.length;l>s;s++)o[s].updateTransform();n.WebGLRenderer.updateTextures(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(t,this.projection,this.textureBuffer.frameBuffer),t.worldTransform=a,this.renderer.spriteBatch.dirty=!0},n.RenderTexture.prototype.renderCanvas=function(t,e,i){var r=t.children,o=t.worldTransform;t.worldTransform=n.RenderTexture.tempMatrix,e?(t.worldTransform.tx=e.x,t.worldTransform.ty=e.y):(t.worldTransform.tx=0,t.worldTransform.ty=0);for(var a=0,s=r.length;s>a;a++)r[a].updateTransform();i&&this.textureBuffer.clear();var l=this.textureBuffer.context;this.renderer.renderDisplayObject(t,l),l.setTransform(1,0,0,1,0,0),t.worldTransform=o},n.RenderTexture.tempMatrix=new n.Matrix,n.AssetLoader=function(t,e){n.EventTarget.call(this),this.assetURLs=t,this.crossorigin=e,this.loadersByType={jpg:n.ImageLoader,jpeg:n.ImageLoader,png:n.ImageLoader,gif:n.ImageLoader,webp:n.ImageLoader,json:n.JsonLoader,atlas:n.AtlasLoader,anim:n.SpineLoader,xml:n.BitmapFontLoader,fnt:n.BitmapFontLoader}},n.AssetLoader.prototype.constructor=n.AssetLoader,n.AssetLoader.prototype._getDataType=function(t){var e="data:";if(t.slice(0,e.length).toLowerCase()===e){var n=t.slice(e.length),i=n.indexOf(",");if(-1===i)return null;var r=n.slice(0,i).split(";")[0];return r&&"text/plain"!==r.toLowerCase()?r.split("/").pop().toLowerCase():"txt"}return null},n.AssetLoader.prototype.load=function(){function t(t){e.onAssetLoaded(t.content)}var e=this;this.loadCount=this.assetURLs.length;for(var n=0;n<this.assetURLs.length;n++){var i=this.assetURLs[n],r=this._getDataType(i);r||(r=i.split("?").shift().split(".").pop().toLowerCase());var o=this.loadersByType[r];if(!o)throw new Error(r+" is an unsupported file type");var a=new o(i,this.crossorigin);a.addEventListener("loaded",t),a.load()}},n.AssetLoader.prototype.onAssetLoaded=function(t){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this,loader:t}),this.onProgress&&this.onProgress(t),this.loadCount||(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},n.JsonLoader=function(t,e){n.EventTarget.call(this),this.url=t,this.crossorigin=e,this.baseUrl=t.replace(/[^\/]*$/,""),this.loaded=!1},n.JsonLoader.prototype.constructor=n.JsonLoader,n.JsonLoader.prototype.load=function(){var t=this;window.XDomainRequest&&t.crossorigin?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=function(){t.onError()},this.ajaxRequest.ontimeout=function(){t.onError()},this.ajaxRequest.onprogress=function(){}):this.ajaxRequest=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),this.ajaxRequest.onload=function(){t.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.send()},n.JsonLoader.prototype.onJSONLoaded=function(){if(this.ajaxRequest.responseText)if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var t=this,e=this.baseUrl+this.json.meta.image,i=new n.ImageLoader(e,this.crossorigin),r=this.json.frames;for(var o in this.texture=i.texture.baseTexture,i.addEventListener("loaded",(function(){t.onLoaded()})),r){var s=r[o].frame;if(s&&(n.TextureCache[o]=new n.Texture(this.texture,{x:s.x,y:s.y,width:s.w,height:s.h}),n.TextureCache[o].crop=new n.Rectangle(s.x,s.y,s.w,s.h),r[o].trimmed)){var l=r[o].sourceSize,u=r[o].spriteSourceSize;n.TextureCache[o].trim=new n.Rectangle(u.x,u.y,l.w,l.h)}}i.load()}else if(this.json.bones){var c=(new a.SkeletonJson).readSkeletonData(this.json);n.AnimCache[this.url]=c,this.onLoaded()}else this.onLoaded();else this.onError()},n.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},n.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},n.AtlasLoader=function(t,e){n.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.crossorigin=e,this.loaded=!1},n.AtlasLoader.constructor=n.AtlasLoader,n.AtlasLoader.prototype.load=function(){this.ajaxRequest=new n.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},n.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};var t=this.ajaxRequest.responseText.split(/\r?\n/),e=-3,i=0,r=null,o=!1,a=0,s=0,l=this.onLoaded.bind(this);for(a=0;a<t.length;a++)if(t[a]=t[a].replace(/^\s+|\s+$/g,""),""===t[a]&&(o=a+1),t[a].length>0){if(o===a)this.atlas.meta.image.push(t[a]),i=this.atlas.meta.image.length-1,this.atlas.frames.push({}),e=-3;else if(e>0)if(e%7==1)null!=r&&(this.atlas.frames[i][r.name]=r),r={name:t[a],frame:{}};else{var u=t[a].split(" ");if(e%7==3)r.frame.x=Number(u[1].replace(",","")),r.frame.y=Number(u[2]);else if(e%7==4)r.frame.w=Number(u[1].replace(",","")),r.frame.h=Number(u[2]);else if(e%7==5){var c={x:0,y:0,w:Number(u[1].replace(",","")),h:Number(u[2])};c.w>r.frame.w||c.h>r.frame.h?(r.trimmed=!0,r.realSize=c):r.trimmed=!1}}e++}if(null!=r&&(this.atlas.frames[i][r.name]=r),this.atlas.meta.image.length>0){for(this.images=[],s=0;s<this.atlas.meta.image.length;s++){var h=this.baseUrl+this.atlas.meta.image[s],d=this.atlas.frames[s];for(a in this.images.push(new n.ImageLoader(h,this.crossorigin)),d){var p=d[a].frame;p&&(n.TextureCache[a]=new n.Texture(this.images[s].texture.baseTexture,{x:p.x,y:p.y,width:p.w,height:p.h}),d[a].trimmed&&(n.TextureCache[a].realSize=d[a].realSize,n.TextureCache[a].trim.x=0,n.TextureCache[a].trim.y=0))}}for(this.currentImageId=0,s=0;s<this.images.length;s++)this.images[s].addEventListener("loaded",l);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()},n.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.dispatchEvent({type:"loaded",content:this}))},n.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},n.SpriteSheetLoader=function(t,e){n.EventTarget.call(this),this.url=t,this.crossorigin=e,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.frames={}},n.SpriteSheetLoader.prototype.constructor=n.SpriteSheetLoader,n.SpriteSheetLoader.prototype.load=function(){var t=this,e=new n.JsonLoader(this.url,this.crossorigin);e.addEventListener("loaded",(function(e){t.json=e.content.json,t.onLoaded()})),e.load()},n.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},n.ImageLoader=function(t,e){n.EventTarget.call(this),this.texture=n.Texture.fromImage(t,e),this.frames=[]},n.ImageLoader.prototype.constructor=n.ImageLoader,n.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var t=this;this.texture.baseTexture.addEventListener("loaded",(function(){t.onLoaded()}))}},n.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},n.ImageLoader.prototype.loadFramedSpriteSheet=function(t,e,i){this.frames=[];for(var r=Math.floor(this.texture.width/t),o=Math.floor(this.texture.height/e),a=0,s=0;o>s;s++)for(var l=0;r>l;l++,a++){var u=new n.Texture(this.texture,{x:l*t,y:s*e,width:t,height:e});this.frames.push(u),i&&(n.TextureCache[i+"-"+a]=u)}if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var c=this;this.texture.baseTexture.addEventListener("loaded",(function(){c.onLoaded()}))}},n.BitmapFontLoader=function(t,e){n.EventTarget.call(this),this.url=t,this.crossorigin=e,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null},n.BitmapFontLoader.prototype.constructor=n.BitmapFontLoader,n.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new n.AjaxRequest;var t=this;this.ajaxRequest.onreadystatechange=function(){t.onXMLLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},n.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){var t=this.ajaxRequest.responseXML;if(!t||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){t=(new DOMParser).parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var e=document.createElement("div");e.innerHTML=this.ajaxRequest.responseText,t=e}var i=this.baseUrl+t.getElementsByTagName("page")[0].getAttribute("file"),r=new n.ImageLoader(i,this.crossorigin);this.texture=r.texture.baseTexture;var o={},a=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0];o.font=a.getAttribute("face"),o.size=parseInt(a.getAttribute("size"),10),o.lineHeight=parseInt(s.getAttribute("lineHeight"),10),o.chars={};for(var l=t.getElementsByTagName("char"),u=0;u<l.length;u++){var c=parseInt(l[u].getAttribute("id"),10),h=new n.Rectangle(parseInt(l[u].getAttribute("x"),10),parseInt(l[u].getAttribute("y"),10),parseInt(l[u].getAttribute("width"),10),parseInt(l[u].getAttribute("height"),10));o.chars[c]={xOffset:parseInt(l[u].getAttribute("xoffset"),10),yOffset:parseInt(l[u].getAttribute("yoffset"),10),xAdvance:parseInt(l[u].getAttribute("xadvance"),10),kerning:{},texture:n.TextureCache[c]=new n.Texture(this.texture,h)}}var d=t.getElementsByTagName("kerning");for(u=0;u<d.length;u++){var p=parseInt(d[u].getAttribute("first"),10),f=parseInt(d[u].getAttribute("second"),10),m=parseInt(d[u].getAttribute("amount"),10);o.chars[f].kerning[p]=m}n.BitmapText.fonts[o.font]=o;var g=this;r.addEventListener("loaded",(function(){g.onLoaded()})),r.load()}},n.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},n.SpineLoader=function(t,e){n.EventTarget.call(this),this.url=t,this.crossorigin=e,this.loaded=!1},n.SpineLoader.prototype.constructor=n.SpineLoader,n.SpineLoader.prototype.load=function(){var t=this,e=new n.JsonLoader(this.url,this.crossorigin);e.addEventListener("loaded",(function(e){t.json=e.content.json,t.onLoaded()})),e.load()},n.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},n.AbstractFilter=function(t,e){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=e||{},this.fragmentSrc=t||[]},n.AlphaMaskFilter=function(t){n.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={mask:{type:"sampler2D",value:t},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mask.value.x=t.width,this.uniforms.mask.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]},n.AlphaMaskFilter.prototype=Object.create(n.AbstractFilter.prototype),n.AlphaMaskFilter.prototype.constructor=n.AlphaMaskFilter,n.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height,this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(n.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value=t}}),n.ColorMatrixFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]},n.ColorMatrixFilter.prototype=Object.create(n.AbstractFilter.prototype),n.ColorMatrixFilter.prototype.constructor=n.ColorMatrixFilter,Object.defineProperty(n.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(t){this.uniforms.matrix.value=t}}),n.GrayFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={gray:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]},n.GrayFilter.prototype=Object.create(n.AbstractFilter.prototype),n.GrayFilter.prototype.constructor=n.GrayFilter,Object.defineProperty(n.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(t){this.uniforms.gray.value=t}}),n.DisplacementFilter=function(t){n.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={displacementMap:{type:"sampler2D",value:t},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=t.width,this.uniforms.mapDimensions.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]},n.DisplacementFilter.prototype=Object.create(n.AbstractFilter.prototype),n.DisplacementFilter.prototype.constructor=n.DisplacementFilter,n.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height,this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(n.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(t){this.uniforms.displacementMap.value=t}}),Object.defineProperty(n.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(t){this.uniforms.scale.value=t}}),Object.defineProperty(n.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}),n.PixelateFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]},n.PixelateFilter.prototype=Object.create(n.AbstractFilter.prototype),n.PixelateFilter.prototype.constructor=n.PixelateFilter,Object.defineProperty(n.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.dirty=!0,this.uniforms.pixelSize.value=t}}),n.BlurXFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]},n.BlurXFilter.prototype=Object.create(n.AbstractFilter.prototype),n.BlurXFilter.prototype.constructor=n.BlurXFilter,Object.defineProperty(n.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.dirty=!0,this.uniforms.blur.value=1/7e3*t}}),n.BlurYFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]},n.BlurYFilter.prototype=Object.create(n.AbstractFilter.prototype),n.BlurYFilter.prototype.constructor=n.BlurYFilter,Object.defineProperty(n.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),n.BlurFilter=function(){this.blurXFilter=new n.BlurXFilter,this.blurYFilter=new n.BlurYFilter,this.passes=[this.blurXFilter,this.blurYFilter]},Object.defineProperty(n.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t}}),Object.defineProperty(n.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}}),Object.defineProperty(n.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}),n.InvertFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]},n.InvertFilter.prototype=Object.create(n.AbstractFilter.prototype),n.InvertFilter.prototype.constructor=n.InvertFilter,Object.defineProperty(n.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(t){this.uniforms.invert.value=t}}),n.SepiaFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={sepia:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]},n.SepiaFilter.prototype=Object.create(n.AbstractFilter.prototype),n.SepiaFilter.prototype.constructor=n.SepiaFilter,Object.defineProperty(n.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(t){this.uniforms.sepia.value=t}}),n.TwistFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]},n.TwistFilter.prototype=Object.create(n.AbstractFilter.prototype),n.TwistFilter.prototype.constructor=n.TwistFilter,Object.defineProperty(n.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(t){this.dirty=!0,this.uniforms.offset.value=t}}),Object.defineProperty(n.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(t){this.dirty=!0,this.uniforms.radius.value=t}}),Object.defineProperty(n.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(t){this.dirty=!0,this.uniforms.angle.value=t}}),n.ColorStepFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={step:{type:"1f",value:5}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]},n.ColorStepFilter.prototype=Object.create(n.AbstractFilter.prototype),n.ColorStepFilter.prototype.constructor=n.ColorStepFilter,Object.defineProperty(n.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(t){this.uniforms.step.value=t}}),n.DotScreenFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]},n.DotScreenFilter.prototype=Object.create(n.AbstractFilter.prototype),n.DotScreenFilter.prototype.constructor=n.DotScreenFilter,Object.defineProperty(n.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(t){this.dirty=!0,this.uniforms.scale.value=t}}),Object.defineProperty(n.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(t){this.dirty=!0,this.uniforms.angle.value=t}}),n.CrossHatchFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]},n.CrossHatchFilter.prototype=Object.create(n.AbstractFilter.prototype),n.CrossHatchFilter.prototype.constructor=n.BlurYFilter,Object.defineProperty(n.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),n.RGBSplitFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]},n.RGBSplitFilter.prototype=Object.create(n.AbstractFilter.prototype),n.RGBSplitFilter.prototype.constructor=n.RGBSplitFilter,Object.defineProperty(n.RGBSplitFilter.prototype,"angle",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),t.exports&&(e=t.exports=n),e.PIXI=n}).call(this)},78:function(t,e,n){var i=n(195),r=n(196),o=n(197),a=n(198),s=n(199),l=n(200),u=n(201);u.alea=i,u.xor128=r,u.xorwow=o,u.xorshift7=a,u.xor4096=s,u.tychei=l,t.exports=u},79:function(t,e,n){t.exports=function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=n[a]={exports:{}};e[a][0].call(l.exports,(function(t){var n=e[a][1][t];return r(n||t)}),l,l.exports,t,e,n,i)}return n[a].exports}for(var o=!1,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){"use strict";var i=t("rsvp"),r=t("lodash"),o=t("machina"),a=new(0,t("eventemitter2").EventEmitter2)({wildcard:!0}),s=o.Fsm.extend({urlQueryParams:"",urlPrefix:"",datasets:null,_TIME_LIMIT_IN_MS:5e3,_LAUNCH_TIME_LIMIT_IN_MS:2e4,_POLLING_DELAY:500,_COLLECTING_DELAY:100,_timer:null,_hostCycler:null,_rawQueryParams:{},_statusIntervalId:0,_lastStatusTimeStamp:0,_datasetsById:{},_columnsById:{},_sessionChangedEmitted:!1,_currentSessionID:void 0,_launchFrame:null,initialize:function(){var t=this;this._timer={timerId:0,start:function(e){this._timerId=setTimeout((function(){t.handle("timeout")}),e)},reset:function(){this.stop(),this.start()},stop:function(){clearTimeout(this._timerId)}},this._hostCycler={get moreHosts(){return t._currentHostIdx+1<t._availableHosts.length},nextHost:function(){t._currentHostIdx++,t.urlPrefix=t._availableHosts[t._currentHostIdx]},reset:function(){t._currentHostIdx=0,t.urlPrefix=t._availableHosts[t._currentHostIdx]}},this._initializeSession()},initialState:"disconnected",states:{disconnected:{_onEnter:function(){this._currentSessionID=void 0,null!==this._launchFrame&&(document.body.removeChild(this._launchFrame),this._launchFrame=null)}},connecting:{_onEnter:function(){this._hostCycler.reset(),this._requestStatus(),this._timer.start(this._TIME_LIMIT_IN_MS)},statusReceived:function(){this._timer.stop(),this.transition("polling")},statusErrored:function(){this._hostCycler.moreHosts?(this._hostCycler.nextHost(),this._requestStatus()):(this._hostCycler.reset(),this._timer.stop(),this.transition("launching"))},timeout:function(){this.transition("launching")}},launching:{_onEnter:function(){this._injectCcscFrame(),this._timer.start(this._LAUNCH_TIME_LIMIT_IN_MS),this._requestStatus()},statusReceived:function(){this._timer.stop(),this.transition("polling")},statusErrored:function(){this._hostCycler.moreHosts?(this._hostCycler.nextHost(),this._requestStatus()):(this._hostCycler.reset(),setTimeout(function(){this._requestStatus()}.bind(this),this._POLLING_DELAY))},timeout:function(){this.transition("launchTimedOut")}},polling:{_onEnter:function(){this._requestStatus()},_onExit:function(){this._timer.stop()},statusReceived:function(t){this._timer.stop(),this._processStatus(t),t.collection.isCollecting?this.transition("collecting"):t.collection.canControl?void 0===t.currentInterface||null===t.currentInterface||"None Found"!==t.currentInterface?(setTimeout(function(){this._requestStatus()}.bind(this),this._POLLING_DELAY),this._timer.start(this._TIME_LIMIT_IN_MS)):this.transition("interfaceMissing"):this.transition("controlDisabled")},statusErrored:function(){this._timer.stop(),this.transition("errored")},timeout:function(){this.transition("errored")}},collecting:{_onEnter:function(){a.emit("collectionStarted"),this._requestStatus(),this._timer.start(this._TIME_LIMIT_IN_MS)},_onExit:function(){a.emit("collectionStopped")},statusReceived:function(t){this._timer.stop(),this._processStatus(t),t.collection.isCollecting?t.collection.canControl?void 0===t.currentInterface||null===t.currentInterface||"None Found"!==t.currentInterface?(setTimeout(function(){this._requestStatus()}.bind(this),this._COLLECTING_DELAY),this._timer.start(this._TIME_LIMIT_IN_MS)):this.transition("interfaceMissing"):this.transition("controlDisabled"):this.transition("polling")},columnData:function(t,e,n){var i=this._columnsById[t];n>i.receivedValuesTimeStamp&&(i.data.length=0,[].push.apply(i.data,e),i.receivedValuesTimeStamp=n,a.emit("data",t))},statusErrored:function(){this._timer.stop(),this.transition("errored")},timeout:function(){this.transition("errored")}},controlDisabled:{_onEnter:function(){a.emit("controlDisabled"),this._requestStatus(),this._timer.start(this._TIME_LIMIT_IN_MS)},_onExit:function(){a.emit("controlEnabled")},statusReceived:function(t){this._timer.stop(),this._processStatus(t),t.collection.canControl?this.transition("polling"):void 0===t.currentInterface||null===t.currentInterface||"None Found"!==t.currentInterface?(setTimeout(function(){this._requestStatus()}.bind(this),this._POLLING_DELAY),this._timer.start(this._TIME_LIMIT_IN_MS)):this.transition("interfaceMissing")},statusErrored:function(){this._timer.stop(),this.transition("errored")},timeout:function(){this.transition("errored")}},interfaceMissing:{_onEnter:function(){a.emit("interfaceRemoved"),this._requestStatus(),this._timer.start(this._TIME_LIMIT_IN_MS)},_onExit:function(){a.emit("interfaceConnected")},statusReceived:function(t){this._timer.stop(),this._processStatus(t),void 0===t.currentInterface||null===t.currentInterface||"None Found"!==t.currentInterface?t.collection.canControl?this.transition("polling"):this.transition("controlDisabled"):(setTimeout(function(){this._requestStatus()}.bind(this),this._POLLING_DELAY),this._timer.start(this._TIME_LIMIT_IN_MS))},statusErrored:function(){this._timer.stop(),this.transition("errored")},timeout:function(){this.transition("errored")}},errored:{_onEnter:function(){a.emit("statusErrored")}},launchTimedOut:{_onEnter:function(){a.emit("launchTimedOut")}},unsupported:{_onEnter:function(){a.emit("statusErrored")}}},setHosts:function(t){this._availableHosts=r.isArray(t)?t:[t],this._hostCycler.reset()},getParam:function(t){return this._rawQueryParams[t]},setParam:function(t,e){this._setRawQueryParams(t,e),this._updateQueryParams()},_setRawQueryParams:function(t,e){null==e?delete this._rawQueryParams[t]:this._rawQueryParams[t]=e},_updateQueryParams:function(){var t;Object.keys(this._rawQueryParams).forEach(function(e,n){t=this._rawQueryParams[e],0===n?this.urlQueryParams="?"+e+"="+t:this.urlQueryParams+="&"+e+"="+t}.bind(this))},_requestStatus:function(){var t=this._createCORSRequest("GET","/status"),e=this;t?(t.onerror=function(){e.handle("statusErrored")},t.onload=function(){var t=this.response||JSON.parse(this.responseText);"string"==typeof t&&(t=JSON.parse(t)),e.handle("statusReceived",t)},t.send()):this.transition("unsupported")},_initializeSession:function(){this.datasets=[],this._datasetsById=Object.create(null),this._columnsById=Object.create(null),this._sessionChangedEmitted=!1},_processStatus:function(t){if(t.requestTimeStamp<this._lastStatusTimeStamp)return!1;if(this._lastStatusTimeStamp=t.requestTimeStamp,this._currentSessionID){if(this._currentSessionID!==t.sessionID)return this._sessionChangedEmitted||(a.emit("sessionChanged"),this._sessionChangedEmitted=!0),!1}else this._currentSessionID=t.sessionID,this._initializeSession();return this._processDatasets(t.sets),this._processColumns(t.columns),this.inControl=t.collection.inControl,a.emit("statusReceived"),!0},_processDatasets:function(t){Object.keys(t).forEach(function(e){this._datasetsById[e]||(a.emit("datasetAdded",e),this._datasetsById[e]={columns:[],id:e},this.datasets.unshift(this._datasetsById[e])),this._datasetsById[e].columns.length=t[e].colIDs.length}.bind(this)),this.datasets.sort((function(t,e){return e.setId-t.setId}))},_processColumns:function(t){var e=[];Object.keys(t).forEach(function(n){var i=t[n],r=this._datasetsById[i.setID],o=this._columnsById[n];o?o!==r.columns[i.position]&&e.push(["columnMoved",n]):(e.push(["columnAdded",n]),o=this._columnsById[n]={id:null,name:null,units:null,receivedValuesTimeStamp:0,requestedValuesTimeStamp:0,liveValueTimeStamp:0,liveValue:null,data:[]}),r.columns[i.position]=o,null!==o.units&&o.units!==i.units&&e.push(["columnTypeChanged",n]),o.units=i.units,o.name=i.name,o.id=n,o.liveValue=parseFloat(i.liveValue||0),o.liveValueTimeStamp=i.liveValueTimeStamp,o.requestedValuesTimeStamp<i.valuesTimeStamp&&(this._requestData(n,i.valuesTimeStamp),o.requestedValuesTimeStamp=i.valuesTimeStamp)}.bind(this)),Object.keys(this._columnsById).forEach(function(n){t[n]||(e.push(["columnRemoved",n]),delete this._columnsById[n])}.bind(this)),e.forEach((function(t){a.emit(t[0],t[1])}))},_requestData:function(t,e){var n=this._createCORSRequest("GET","/columns/"+t),i=this;n.send(),n.onload=function(){var n=this.response||JSON.parse(this.responseText);"string"==typeof n&&(n=JSON.parse(n));var r=n.values;i.handle("columnData",t,r,e)}},_createCORSRequest:function(t,e){var n=this.urlPrefix+e+this.urlQueryParams,i=new XMLHttpRequest;if("withCredentials"in i)i.open(t,n,!0),i.responseType="json",i.setRequestHeader("Accept","application/json");else{if("undefined"==typeof XDomainRequest)return null;(i=new XDomainRequest).open(t,n)}return i},promisifyRequest:function(t){var e=this;return new i.Promise((function(n,i){var r=e._createCORSRequest("GET",t);r||i(new Error("This browser does not appear to support Cross-Origin Resource Sharing")),r.send(),r.onerror=function(){i(this)},r.onload=n}))},_injectCcscFrame:function(){null!==this._launchFrame&&document.body.removeChild(this._launchFrame);var t=document.createElement("div");t.id="sensor-connector-launch-frame-parent",t.innerHTML='<iframe id="sensor-connector-launch-frame" src="ccsc://sensorconnector.concord.org/"></iframe>',document.body.appendChild(t),this._launchFrame=document.getElementById("sensor-connector-launch-frame-parent")}});e.exports=function(){return{stateMachine:new s,startPolling:function(t,e,n){this.stateMachine.setHosts(t),this.stateMachine.setParam("client",e),this.stateMachine.setParam("clientName",n),this.stateMachine.transition("connecting")},stopPolling:function(){this.stateMachine.transition("disconnected")},requestStart:function(){return this.stateMachine.promisifyRequest("/control/start")},requestStop:function(){return this.stateMachine.promisifyRequest("/control/stop")},on:function(){a.on.apply(a,arguments)},off:function(){a.off.apply(a,arguments)},get clientId(){return this.stateMachine.getParam("client")},set clientId(t){this.stateMachine.setParam("client",t)},get clientName(){return this.stateMachine.getParam("clientName")},set clientName(t){this.stateMachine.setParam("clientName",t)},get hasAttachedInterface(){return"interfaceMissing"!==this.stateMachine.state},get datasets(){return this.stateMachine.datasets},get isConnected(){return-1!==["polling","collecting","controlDisabled","interfaceMissing"].indexOf(this.stateMachine.state)},get isCollecting(){return"collecting"===this.stateMachine.state},get inControl(){return"controlDisabled"!==this.stateMachine.state},get launchTimedOut(){return"launchTimedOut"===this.stateMachine.state},get canControl(){return"controlDisabled"!==this.stateMachine.state}}}},{eventemitter2:3,lodash:4,machina:5,rsvp:7}],2:[function(t,e,n){var i=e.exports={};i.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",(function(t){var e=t.source;e!==window&&null!==e||"process-tick"!==t.data||(t.stopPropagation(),n.length>0&&n.shift()())}),!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],3:[function(t,e,n){!function(t){var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(){this._events={},this._conf&&r.call(this,this._conf)}function r(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners&&(this._events.maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this.newListener=t.newListener),this.wildcard&&(this.listenerTree={}))}function o(t){this._events={},this.newListener=!1,r.call(this,t)}function a(t,e,n,i){if(!n)return[];var r,o,s,l,u,c,h,d=[],p=e.length,f=e[i],m=e[i+1];if(i===p&&n._listeners){if("function"==typeof n._listeners)return t&&t.push(n._listeners),[n];for(r=0,o=n._listeners.length;r<o;r++)t&&t.push(n._listeners[r]);return[n]}if("*"===f||"**"===f||n[f]){if("*"===f){for(s in n)"_listeners"!==s&&n.hasOwnProperty(s)&&(d=d.concat(a(t,e,n[s],i+1)));return d}if("**"===f){for(s in(h=i+1===p||i+2===p&&"*"===m)&&n._listeners&&(d=d.concat(a(t,e,n,p))),n)"_listeners"!==s&&n.hasOwnProperty(s)&&("*"===s||"**"===s?(n[s]._listeners&&!h&&(d=d.concat(a(t,e,n[s],p))),d=d.concat(a(t,e,n[s],i))):d=s===m?d.concat(a(t,e,n[s],i+2)):d.concat(a(t,e,n[s],i)));return d}d=d.concat(a(t,e,n[f],i+1))}if((l=n["*"])&&a(t,e,l,i+1),u=n["**"])if(i<p)for(s in u._listeners&&a(t,e,u,p),u)"_listeners"!==s&&u.hasOwnProperty(s)&&(s===m?a(t,e,u[s],i+2):s===f?a(t,e,u[s],i+1):((c={})[s]=u[s],a(t,e,{"**":c},i+1)));else u._listeners?a(t,e,u,p):u["*"]&&u["*"]._listeners&&a(t,e,u["*"],p);return d}function s(t,n){for(var i=0,r=(t="string"==typeof t?t.split(this.delimiter):t.slice()).length;i+1<r;i++)if("**"===t[i]&&"**"===t[i+1])return;for(var o=this.listenerTree,a=t.shift();a;){if(o[a]||(o[a]={}),o=o[a],0===t.length){if(o._listeners){if("function"==typeof o._listeners)o._listeners=[o._listeners,n];else if(e(o._listeners)&&(o._listeners.push(n),!o._listeners.warned)){var s=10;void 0!==this._events.maxListeners&&(s=this._events.maxListeners),s>0&&o._listeners.length>s&&(o._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",o._listeners.length),console.trace())}}else o._listeners=n;return!0}a=t.shift()}return!0}o.prototype.delimiter=".",o.prototype.setMaxListeners=function(t){this._events||i.call(this),this._events.maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t},o.prototype.event="",o.prototype.once=function(t,e){return this.many(t,1,e),this},o.prototype.many=function(t,e,n){var i=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function r(){0==--e&&i.off(t,r),n.apply(this,arguments)}return r._origin=n,this.on(t,r),i},o.prototype.emit=function(){this._events||i.call(this);var t,e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var n=arguments.length,r=new Array(n-1),o=1;o<n;o++)r[o-1]=arguments[o];for(o=0,n=this._all.length;o<n;o++)this.event=e,this._all[o].apply(this,r)}if("error"===e&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(this.wildcard){t=[];var s="string"==typeof e?e.split(this.delimiter):e.slice();a.call(this,t,s,this.listenerTree,0)}else t=this._events[e];if("function"==typeof t){if(this.event=e,1===arguments.length)t.call(this);else if(arguments.length>1)switch(arguments.length){case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,r=new Array(n-1),o=1;o<n;o++)r[o-1]=arguments[o];t.apply(this,r)}return!0}if(t){for(n=arguments.length,r=new Array(n-1),o=1;o<n;o++)r[o-1]=arguments[o];var l=t.slice();for(o=0,n=l.length;o<n;o++)this.event=e,l[o].apply(this,r);return l.length>0||!!this._all}return!!this._all},o.prototype.on=function(t,n){if("function"==typeof t)return this.onAny(t),this;if("function"!=typeof n)throw new Error("on only accepts instances of Function");if(this._events||i.call(this),this.emit("newListener",t,n),this.wildcard)return s.call(this,t,n),this;if(this._events[t]){if("function"==typeof this._events[t])this._events[t]=[this._events[t],n];else if(e(this._events[t])&&(this._events[t].push(n),!this._events[t].warned)){var r=10;void 0!==this._events.maxListeners&&(r=this._events.maxListeners),r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}}else this._events[t]=n;return this},o.prototype.onAny=function(t){if("function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(t),this},o.prototype.addListener=o.prototype.on,o.prototype.off=function(t,n){if("function"!=typeof n)throw new Error("removeListener only takes instances of Function");var i,r=[];if(this.wildcard){var o="string"==typeof t?t.split(this.delimiter):t.slice();r=a.call(this,null,o,this.listenerTree,0)}else{if(!this._events[t])return this;i=this._events[t],r.push({_listeners:i})}for(var s=0;s<r.length;s++){var l=r[s];if(i=l._listeners,e(i)){for(var u=-1,c=0,h=i.length;c<h;c++)if(i[c]===n||i[c].listener&&i[c].listener===n||i[c]._origin&&i[c]._origin===n){u=c;break}if(u<0)continue;return this.wildcard?l._listeners.splice(u,1):this._events[t].splice(u,1),0===i.length&&(this.wildcard?delete l._listeners:delete this._events[t]),this}(i===n||i.listener&&i.listener===n||i._origin&&i._origin===n)&&(this.wildcard?delete l._listeners:delete this._events[t])}return this},o.prototype.offAny=function(t){var e,n=0,i=0;if(t&&this._all&&this._all.length>0){for(n=0,i=(e=this._all).length;n<i;n++)if(t===e[n])return e.splice(n,1),this}else this._all=[];return this},o.prototype.removeListener=o.prototype.off,o.prototype.removeAllListeners=function(t){if(0===arguments.length)return!this._events||i.call(this),this;if(this.wildcard)for(var e="string"==typeof t?t.split(this.delimiter):t.slice(),n=a.call(this,null,e,this.listenerTree,0),r=0;r<n.length;r++){var o=n[r];o._listeners=null}else{if(!this._events[t])return this;this._events[t]=null}return this},o.prototype.listeners=function(t){if(this.wildcard){var n=[],r="string"==typeof t?t.split(this.delimiter):t.slice();return a.call(this,n,r,this.listenerTree,0),n}return this._events||i.call(this),this._events[t]||(this._events[t]=[]),e(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},o.prototype.listenersAny=function(){return this._all?this._all:[]},"object"==typeof n?n.EventEmitter2=o:window.EventEmitter2=o}()},{}],4:[function(t,e,n){var i="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};(function(){var t,r,o="Expected a function",a="__lodash_placeholder__",s="[object Arguments]",l="[object Array]",u="[object Boolean]",c="[object Date]",h="[object Error]",d="[object Function]",p="[object Number]",f="[object Object]",m="[object RegExp]",g="[object String]",v="[object Float32Array]",y="[object Float64Array]",b="[object Int8Array]",_="[object Int16Array]",x="[object Int32Array]",w="[object Uint8Array]",C="[object Uint16Array]",T="[object Uint32Array]",S=/\b__p \+= '';/g,k=/\b(__p \+=) '' \+/g,A=/(__e\(.*?\)|\b__t\)) \+\n'';/g,E=/&(?:amp|lt|gt|quot|#39|#96);/g,M=/[&<>"'`]/g,P=RegExp(E.source),D=RegExp(M.source),O=/<%-([\s\S]+?)%>/g,I=/<%([\s\S]+?)%>/g,L=/<%=([\s\S]+?)%>/g,R=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,N=/^\w*$/,F=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,B=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,z=RegExp(B.source),j=/[\u0300-\u036f\ufe20-\ufe23]/g,V=/\\(\\)?/g,H=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,W=/\w*$/,U=/^0[xX]/,$=/^\[object .+?Constructor\]$/,G=/^\d+$/,q=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Y=/($^)/,X=/['\n\r\u2028\u2029\\]/g,Q=(t="[A-Z\\xc0-\\xd6\\xd8-\\xde]",r="[a-z\\xdf-\\xf6\\xf8-\\xff]+",RegExp(t+"+(?="+t+r+")|"+t+"?"+r+"|"+t+"+|[0-9]+","g")),K=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],J=-1,Z={};Z[v]=Z[y]=Z[b]=Z[_]=Z[x]=Z[w]=Z["[object Uint8ClampedArray]"]=Z[C]=Z[T]=!0,Z[s]=Z[l]=Z["[object ArrayBuffer]"]=Z[u]=Z[c]=Z[h]=Z[d]=Z["[object Map]"]=Z[p]=Z[f]=Z[m]=Z["[object Set]"]=Z[g]=Z["[object WeakMap]"]=!1;var tt={};tt[s]=tt[l]=tt["[object ArrayBuffer]"]=tt[u]=tt[c]=tt[v]=tt[y]=tt[b]=tt[_]=tt[x]=tt[p]=tt[f]=tt[m]=tt[g]=tt[w]=tt["[object Uint8ClampedArray]"]=tt[C]=tt[T]=!0,tt[h]=tt[d]=tt["[object Map]"]=tt["[object Set]"]=tt["[object WeakMap]"]=!1;var et={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},nt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},it={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},rt={function:!0,object:!0},ot={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},at={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},st=rt[typeof n]&&n&&!n.nodeType&&n,lt=rt[typeof e]&&e&&!e.nodeType&&e,ut=st&&lt&&"object"==typeof i&&i&&i.Object&&i,ct=rt[typeof self]&&self&&self.Object&&self,ht=rt[typeof window]&&window&&window.Object&&window,dt=lt&&lt.exports===st&&st,pt=ut||ht!==(this&&this.window)&&ht||ct||this;function ft(t,e){if(t!==e){var n=null===t,i=void 0===t,r=t==t,o=null===e,a=void 0===e,s=e==e;if(t>e&&!o||!r||n&&!a&&s||i&&s)return 1;if(t<e&&!n||!s||o&&!i&&r||a&&r)return-1}return 0}function mt(t,e,n){for(var i=t.length,r=n?i:-1;n?r--:++r<i;)if(e(t[r],r,t))return r;return-1}function gt(t,e,n){if(e!=e)return kt(t,n);for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}function vt(t){return"function"==typeof t||!1}function yt(t){return null==t?"":t+""}function bt(t,e){for(var n=-1,i=t.length;++n<i&&e.indexOf(t.charAt(n))>-1;);return n}function _t(t,e){for(var n=t.length;n--&&e.indexOf(t.charAt(n))>-1;);return n}function xt(t,e){return ft(t.criteria,e.criteria)||t.index-e.index}function wt(t){return et[t]}function Ct(t){return nt[t]}function Tt(t,e,n){return e?t=ot[t]:n&&(t=at[t]),"\\"+t}function St(t){return"\\"+at[t]}function kt(t,e,n){for(var i=t.length,r=e+(n?0:-1);n?r--:++r<i;){var o=t[r];if(o!=o)return r}return-1}function At(t){return!!t&&"object"==typeof t}function Et(t){return t<=160&&t>=9&&t<=13||32==t||160==t||5760==t||6158==t||t>=8192&&(t<=8202||8232==t||8233==t||8239==t||8287==t||12288==t||65279==t)}function Mt(t,e){for(var n=-1,i=t.length,r=-1,o=[];++n<i;)t[n]===e&&(t[n]=a,o[++r]=n);return o}function Pt(t){for(var e=-1,n=t.length;++e<n&&Et(t.charCodeAt(e)););return e}function Dt(t){for(var e=t.length;e--&&Et(t.charCodeAt(e)););return e}function Ot(t){return it[t]}var It=function t(e){var n=(e=e?It.defaults(pt.Object(),e,It.pick(pt,K)):pt).Array,i=e.Date,r=e.Error,et=e.Function,nt=e.Math,it=e.Number,rt=e.Object,ot=e.RegExp,at=e.String,st=e.TypeError,lt=n.prototype,ut=rt.prototype,ct=at.prototype,ht=et.prototype.toString,dt=ut.hasOwnProperty,Et=0,Lt=ut.toString,Rt=pt._,Nt=ot("^"+ht.call(dt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ft=e.ArrayBuffer,Bt=e.clearTimeout,zt=e.parseFloat,jt=nt.pow,Vt=ut.propertyIsEnumerable,Ht=Jn(e,"Set"),Wt=e.setTimeout,Ut=lt.splice,$t=e.Uint8Array,Gt=Jn(e,"WeakMap"),qt=nt.ceil,Yt=Jn(rt,"create"),Xt=nt.floor,Qt=Jn(n,"isArray"),Kt=e.isFinite,Jt=Jn(rt,"keys"),Zt=nt.max,te=nt.min,ee=Jn(i,"now"),ne=e.parseInt,ie=nt.random,re=it.NEGATIVE_INFINITY,oe=it.POSITIVE_INFINITY,ae=Gt&&new Gt,se={};function le(t){if(At(t)&&!Ar(t)&&!(t instanceof he)){if(t instanceof ce)return t;if(dt.call(t,"__chain__")&&dt.call(t,"__wrapped__"))return vi(t)}return new ce(t)}function ue(){}function ce(t,e,n){this.__wrapped__=t,this.__actions__=n||[],this.__chain__=!!e}function he(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=oe,this.__views__=[]}function de(){this.__data__={}}function pe(t){var e=t?t.length:0;for(this.data={hash:Yt(null),set:new Ht};e--;)this.push(t[e])}function fe(t,e){var n=t.data;return("string"==typeof e||Dr(e)?n.set.has(e):n.hash[e])?0:-1}function me(t,e){var i=-1,r=t.length;for(e||(e=n(r));++i<r;)e[i]=t[i];return e}function ge(t,e){for(var n=-1,i=t.length;++n<i&&!1!==e(t[n],n,t););return t}function ve(t,e){for(var n=-1,i=t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function ye(t,e){for(var n=-1,i=t.length,r=-1,o=[];++n<i;){var a=t[n];e(a,n,t)&&(o[++r]=a)}return o}function be(t,e){for(var i=-1,r=t.length,o=n(r);++i<r;)o[i]=e(t[i],i,t);return o}function _e(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}function xe(t,e,n,i){var r=-1,o=t.length;for(i&&o&&(n=t[++r]);++r<o;)n=e(n,t[r],r,t);return n}function we(t,e){for(var n=-1,i=t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function Ce(t,e,n,i){return void 0!==t&&dt.call(i,n)?t:e}function Te(t,e,n){for(var i=-1,r=Jr(e),o=r.length;++i<o;){var a=r[i],s=t[a],l=n(s,e[a],a,t,e);(l==l?l===s:s!=s)&&(void 0!==s||a in t)||(t[a]=l)}return t}function Se(t,e){return null==e?t:Ae(e,Jr(e),t)}function ke(t,e){for(var i=-1,r=null==t,o=!r&&ti(t),a=o?t.length:0,s=e.length,l=n(s);++i<s;){var u=e[i];l[i]=o?ei(u,a)?t[u]:void 0:r?void 0:t[u]}return l}function Ae(t,e,n){n||(n={});for(var i=-1,r=e.length;++i<r;){var o=e[i];n[o]=t[o]}return n}function Ee(t,e,n){var i=typeof t;return"function"==i?void 0===e?t:pn(t,e,n):null==t?bo:"object"==i?Xe(t):void 0===e?So(t):Qe(t,e)}function Me(t,e,n,i,r,o,a){var l;if(n&&(l=r?n(t,i,r):n(t)),void 0!==l)return l;if(!Dr(t))return t;var h=Ar(t);if(h){if(l=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&dt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!e)return me(t,l)}else{var S=Lt.call(t),k=S==d;if(S!=f&&S!=s&&(!k||r))return tt[S]?function(t,e,n){var i=t.constructor;switch(e){case"[object ArrayBuffer]":return fn(t);case u:case c:return new i(+t);case v:case y:case b:case _:case x:case w:case"[object Uint8ClampedArray]":case C:case T:var r=t.buffer;return new i(n?fn(r):r,t.byteOffset,t.length);case p:case g:return new i(t);case m:var o=new i(t.source,W.exec(t));o.lastIndex=t.lastIndex}return o}(t,S,e):r?t:{};if(l=function(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=rt),new e}(k?{}:t),!e)return Se(l,t)}o||(o=[]),a||(a=[]);for(var A=o.length;A--;)if(o[A]==t)return a[A];return o.push(t),a.push(l),(h?ge:He)(t,(function(i,r){l[r]=Me(i,e,n,r,t,o,a)})),l}le.support={},le.templateSettings={escape:O,evaluate:I,interpolate:L,variable:"",imports:{_:le}};var Pe=function(){function t(){}return function(e){if(Dr(e)){t.prototype=e;var n=new t;t.prototype=void 0}return n||{}}}();function De(t,e,n){if("function"!=typeof t)throw new st(o);return Wt((function(){t.apply(void 0,n)}),e)}function Oe(t,e){var n=t?t.length:0,i=[];if(!n)return i;var r=-1,o=Xn(),a=o==gt,s=a&&e.length>=200?xn(e):null,l=e.length;s&&(o=fe,a=!1,e=s);t:for(;++r<n;){var u=t[r];if(a&&u==u){for(var c=l;c--;)if(e[c]===u)continue t;i.push(u)}else o(e,u,0)<0&&i.push(u)}return i}var Ie=bn(He),Le=bn(We,!0);function Re(t,e){var n=!0;return Ie(t,(function(t,i,r){return n=!!e(t,i,r)})),n}function Ne(t,e){var n=[];return Ie(t,(function(t,i,r){e(t,i,r)&&n.push(t)})),n}function Fe(t,e,n,i){var r;return n(t,(function(t,n,o){if(e(t,n,o))return r=i?n:t,!1})),r}function Be(t,e,n,i){i||(i=[]);for(var r=-1,o=t.length;++r<o;){var a=t[r];At(a)&&ti(a)&&(n||Ar(a)||kr(a))?e?Be(a,e,n,i):_e(i,a):n||(i[i.length]=a)}return i}var ze=_n(),je=_n(!0);function Ve(t,e){return ze(t,e,Zr)}function He(t,e){return ze(t,e,Jr)}function We(t,e){return je(t,e,Jr)}function Ue(t,e){for(var n=-1,i=e.length,r=-1,o=[];++n<i;){var a=e[n];Pr(t[a])&&(o[++r]=a)}return o}function $e(t,e,n){if(null!=t){void 0!==n&&n in mi(t)&&(e=[n]);for(var i=0,r=e.length;null!=t&&i<r;)t=t[e[i++]];return i&&i==r?t:void 0}}function Ge(t,e,n,i,r,o){return t===e||(null==t||null==e||!Dr(t)&&!At(e)?t!=t&&e!=e:function(t,e,n,i,r,o,a){var d=Ar(t),v=Ar(e),y=l,b=l;d||((y=Lt.call(t))==s?y=f:y!=f&&(d=Fr(t))),v||((b=Lt.call(e))==s?b=f:b!=f&&(v=Fr(e)));var _=y==f,x=b==f,w=y==b;if(w&&!d&&!_)return function(t,e,n){switch(n){case u:case c:return+t==+e;case h:return t.name==e.name&&t.message==e.message;case p:return t!=+t?e!=+e:t==+e;case m:case g:return t==e+""}return!1}(t,e,y);if(!r){var C=_&&dt.call(t,"__wrapped__"),T=x&&dt.call(e,"__wrapped__");if(C||T)return n(C?t.value():t,T?e.value():e,i,r,o,a)}if(!w)return!1;o||(o=[]),a||(a=[]);for(var S=o.length;S--;)if(o[S]==t)return a[S]==e;o.push(t),a.push(e);var k=(d?Un:$n)(t,e,n,i,r,o,a);return o.pop(),a.pop(),k}(t,e,Ge,n,i,r,o))}function qe(t,e,n){var i=e.length,r=i,o=!n;if(null==t)return!r;for(t=mi(t);i--;){var a=e[i];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<r;){var s=(a=e[i])[0],l=t[s],u=a[1];if(o&&a[2]){if(void 0===l&&!(s in t))return!1}else{var c=n?n(l,u,s):void 0;if(!(void 0===c?Ge(u,l,n,!0):c))return!1}}return!0}function Ye(t,e){var i=-1,r=ti(t)?n(t.length):[];return Ie(t,(function(t,n,o){r[++i]=e(t,n,o)})),r}function Xe(t){var e=Kn(t);if(1==e.length&&e[0][2]){var n=e[0][0],i=e[0][1];return function(t){return null!=t&&t[n]===i&&(void 0!==i||n in mi(t))}}return function(t){return qe(t,e)}}function Qe(t,e){var n=Ar(t),i=ii(t)&&ai(e),r=t+"";return t=gi(t),function(o){if(null==o)return!1;var a=r;if(o=mi(o),(n||!i)&&!(a in o)){if(null==(o=1==t.length?o:$e(o,nn(t,0,-1))))return!1;a=ki(t),o=mi(o)}return o[a]===e?void 0!==e||a in o:Ge(e,o[a],void 0,!0)}}function Ke(t){return function(e){return null==e?void 0:e[t]}}function Je(t,e){for(var n=t?e.length:0;n--;){var i=e[n];if(i!=r&&ei(i)){var r=i;Ut.call(t,i,1)}}return t}function Ze(t,e){return t+Xt(ie()*(e-t+1))}function tn(t,e,n,i,r){return r(t,(function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)})),n}var en=ae?function(t,e){return ae.set(t,e),t}:bo;function nn(t,e,i){var r=-1,o=t.length;(e=null==e?0:+e||0)<0&&(e=-e>o?0:o+e),(i=void 0===i||i>o?o:+i||0)<0&&(i+=o),o=e>i?0:i-e>>>0,e>>>=0;for(var a=n(o);++r<o;)a[r]=t[r+e];return a}function rn(t,e){var n;return Ie(t,(function(t,i,r){return!(n=e(t,i,r))})),!!n}function on(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function an(t,e,n){var i=Gn(),r=-1;return e=be(e,(function(t){return i(t)})),on(Ye(t,(function(t){return{criteria:be(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return function(t,e,n){for(var i=-1,r=t.criteria,o=e.criteria,a=r.length,s=n.length;++i<a;){var l=ft(r[i],o[i]);if(l){if(i>=s)return l;var u=n[i];return l*("asc"===u||!0===u?1:-1)}}return t.index-e.index}(t,e,n)}))}function sn(t,e){var n=-1,i=Xn(),r=t.length,o=i==gt,a=o&&r>=200,s=a?xn():null,l=[];s?(i=fe,o=!1):(a=!1,s=e?[]:l);t:for(;++n<r;){var u=t[n],c=e?e(u,n,t):u;if(o&&u==u){for(var h=s.length;h--;)if(s[h]===c)continue t;e&&s.push(c),l.push(u)}else i(s,c,0)<0&&((e||a)&&s.push(c),l.push(u))}return l}function ln(t,e){for(var i=-1,r=e.length,o=n(r);++i<r;)o[i]=t[e[i]];return o}function un(t,e,n,i){for(var r=t.length,o=i?r:-1;(i?o--:++o<r)&&e(t[o],o,t););return n?nn(t,i?0:o,i?o+1:r):nn(t,i?o+1:0,i?r:o)}function cn(t,e){var n=t;n instanceof he&&(n=n.value());for(var i=-1,r=e.length;++i<r;){var o=e[i];n=o.func.apply(o.thisArg,_e([n],o.args))}return n}function hn(t,e,n){var i=0,r=t?t.length:i;if("number"==typeof e&&e==e&&r<=2147483647){for(;i<r;){var o=i+r>>>1,a=t[o];(n?a<=e:a<e)&&null!==a?i=o+1:r=o}return r}return dn(t,e,bo,n)}function dn(t,e,n,i){e=n(e);for(var r=0,o=t?t.length:0,a=e!=e,s=null===e,l=void 0===e;r<o;){var u=Xt((r+o)/2),c=n(t[u]),h=void 0!==c,d=c==c;if(a)var p=d||i;else p=s?d&&h&&(i||null!=c):l?d&&(i||h):null!=c&&(i?c<=e:c<e);p?r=u+1:o=u}return te(o,4294967294)}function pn(t,e,n){if("function"!=typeof t)return bo;if(void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)};case 5:return function(n,i,r,o,a){return t.call(e,n,i,r,o,a)}}return function(){return t.apply(e,arguments)}}function fn(t){var e=new Ft(t.byteLength);return new $t(e).set(new $t(t)),e}function mn(t,e,i){for(var r=i.length,o=-1,a=Zt(t.length-r,0),s=-1,l=e.length,u=n(l+a);++s<l;)u[s]=e[s];for(;++o<r;)u[i[o]]=t[o];for(;a--;)u[s++]=t[o++];return u}function gn(t,e,i){for(var r=-1,o=i.length,a=-1,s=Zt(t.length-o,0),l=-1,u=e.length,c=n(s+u);++a<s;)c[a]=t[a];for(var h=a;++l<u;)c[h+l]=e[l];for(;++r<o;)c[h+i[r]]=t[a++];return c}function vn(t,e){return function(n,i,r){var o=e?e():{};if(i=Gn(i,r,3),Ar(n))for(var a=-1,s=n.length;++a<s;){var l=n[a];t(o,l,i(l,a,n),n)}else Ie(n,(function(e,n,r){t(o,e,i(e,n,r),r)}));return o}}function yn(t){return Tr((function(e,n){var i=-1,r=null==e?0:n.length,o=r>2?n[r-2]:void 0,a=r>2?n[2]:void 0,s=r>1?n[r-1]:void 0;for("function"==typeof o?(o=pn(o,s,5),r-=2):r-=(o="function"==typeof s?s:void 0)?1:0,a&&ni(n[0],n[1],a)&&(o=r<3?void 0:o,r=1);++i<r;){var l=n[i];l&&t(e,l,o)}return e}))}function bn(t,e){return function(n,i){var r=n?Qn(n):0;if(!oi(r))return t(n,i);for(var o=e?r:-1,a=mi(n);(e?o--:++o<r)&&!1!==i(a[o],o,a););return n}}function _n(t){return function(e,n,i){for(var r=mi(e),o=i(e),a=o.length,s=t?a:-1;t?s--:++s<a;){var l=o[s];if(!1===n(r[l],l,r))break}return e}}function xn(t){return Yt&&Ht?new pe(t):null}function wn(t){return function(e){for(var n=-1,i=go(so(e)),r=i.length,o="";++n<r;)o=t(o,i[n],n);return o}}function Cn(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Pe(t.prototype),i=t.apply(n,e);return Dr(i)?i:n}}function Tn(t){return function e(n,i,r){r&&ni(n,i,r)&&(i=void 0);var o=Wn(n,t,void 0,void 0,void 0,void 0,void 0,i);return o.placeholder=e.placeholder,o}}function Sn(t,e){return Tr((function(n){var i=n[0];return null==i?i:(n.push(e),t.apply(void 0,n))}))}function kn(t,e){return function(n,i,r){if(r&&ni(n,i,r)&&(i=void 0),1==(i=Gn(i,r,3)).length){var o=function(t,e,n,i){for(var r=-1,o=t.length,a=i,s=a;++r<o;){var l=t[r],u=+e(l);n(u,a)&&(a=u,s=l)}return s}(n=Ar(n)?n:fi(n),i,t,e);if(!n.length||o!==e)return o}return function(t,e,n,i){var r=i,o=r;return Ie(t,(function(t,a,s){var l=+e(t,a,s);(n(l,r)||l===i&&l===o)&&(r=l,o=t)})),o}(n,i,t,e)}}function An(t,e){return function(n,i,r){if(i=Gn(i,r,3),Ar(n)){var o=mt(n,i,e);return o>-1?n[o]:void 0}return Fe(n,i,t)}}function En(t){return function(e,n,i){return e&&e.length?mt(e,n=Gn(n,i,3),t):-1}}function Mn(t){return function(e,n,i){return Fe(e,n=Gn(n,i,3),t,!0)}}function Pn(t){return function(){for(var e,i=arguments.length,r=t?i:-1,a=0,s=n(i);t?r--:++r<i;){var l=s[a++]=arguments[r];if("function"!=typeof l)throw new st(o);!e&&ce.prototype.thru&&"wrapper"==Yn(l)&&(e=new ce([],!0))}for(r=e?-1:i;++r<i;){var u=Yn(l=s[r]),c="wrapper"==u?qn(l):void 0;e=c&&ri(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?e[Yn(c[0])].apply(e,c[3]):1==l.length&&ri(l)?e[u]():e.thru(l)}return function(){var t=arguments,n=t[0];if(e&&1==t.length&&Ar(n)&&n.length>=200)return e.plant(n).value();for(var r=0,o=i?s[r].apply(this,t):n;++r<i;)o=s[r].call(this,o);return o}}}function Dn(t,e){return function(n,i,r){return"function"==typeof i&&void 0===r&&Ar(n)?t(n,i):e(n,pn(i,r,3))}}function On(t){return function(e,n,i){return"function"==typeof n&&void 0===i||(n=pn(n,i,3)),t(e,n,Zr)}}function In(t){return function(e,n,i){return"function"==typeof n&&void 0===i||(n=pn(n,i,3)),t(e,n)}}function Ln(t){return function(e,n,i){var r={};return n=Gn(n,i,3),He(e,(function(e,i,o){var a=n(e,i,o);e=t?e:a,r[i=t?a:i]=e})),r}}function Rn(t){return function(e,n,i){return e=yt(e),(t?e:"")+zn(e,n,i)+(t?"":e)}}function Nn(t){var e=Tr((function(n,i){var r=Mt(i,e.placeholder);return Wn(n,t,void 0,i,r)}));return e}function Fn(t,e){return function(n,i,r,o){var a=arguments.length<3;return"function"==typeof i&&void 0===o&&Ar(n)?t(n,i,r,a):tn(n,Gn(i,o,4),r,a,e)}}function Bn(t,e,i,r,o,a,s,l,u,c){var h=128&e,d=1&e,p=2&e,f=8&e,m=4&e,g=16&e,v=p?void 0:Cn(t);return function y(){for(var b=arguments.length,_=b,x=n(b);_--;)x[_]=arguments[_];if(r&&(x=mn(x,r,o)),a&&(x=gn(x,a,s)),f||g){var w=y.placeholder,C=Mt(x,w);if((b-=C.length)<c){var T=l?me(l):void 0,S=Zt(c-b,0),k=f?C:void 0,A=f?void 0:C,E=f?x:void 0,M=f?void 0:x;e|=f?32:64,e&=~(f?64:32),m||(e&=-4);var P=[t,e,i,E,k,M,A,T,u,S],D=Bn.apply(void 0,P);return ri(t)&&di(D,P),D.placeholder=w,D}}var O=d?i:this,I=p?O[t]:t;return l&&(x=ui(x,l)),h&&u<x.length&&(x.length=u),this&&this!==pt&&this instanceof y&&(I=v||Cn(t)),I.apply(O,x)}}function zn(t,e,n){var i=t.length;if(i>=(e=+e)||!Kt(e))return"";var r=e-i;return ho(n=null==n?" ":n+"",qt(r/n.length)).slice(0,r)}function jn(t,e,i,r){var o=1&e,a=Cn(t);return function e(){for(var s=-1,l=arguments.length,u=-1,c=r.length,h=n(c+l);++u<c;)h[u]=r[u];for(;l--;)h[u++]=arguments[++s];var d=this&&this!==pt&&this instanceof e?a:t;return d.apply(o?i:this,h)}}function Vn(t){var e=nt[t];return function(t,n){return(n=void 0===n?0:+n||0)?(n=jt(10,n),e(t*n)/n):e(t)}}function Hn(t){return function(e,n,i,r){var o=Gn(i);return null==i&&o===Ee?hn(e,n,t):dn(e,n,o(i,r,1),t)}}function Wn(t,e,n,i,r,s,l,u){var c=2&e;if(!c&&"function"!=typeof t)throw new st(o);var h=i?i.length:0;if(h||(e&=-97,i=r=void 0),h-=r?r.length:0,64&e){var d=i,p=r;i=r=void 0}var f=c?void 0:qn(t),m=[t,e,n,i,r,d,p,s,l,u];if(f&&(function(t,e){var n=t[1],i=e[1],r=n|i,o=r<128,s=128==i&&8==n||128==i&&256==n&&t[7].length<=e[8]||384==i&&8==n;if(!o&&!s)return t;1&i&&(t[2]=e[2],r|=1&n?0:4);var l=e[3];if(l){var u=t[3];t[3]=u?mn(u,l,e[4]):me(l),t[4]=u?Mt(t[3],a):me(e[4])}(l=e[5])&&(u=t[5],t[5]=u?gn(u,l,e[6]):me(l),t[6]=u?Mt(t[5],a):me(e[6])),(l=e[7])&&(t[7]=me(l)),128&i&&(t[8]=null==t[8]?e[8]:te(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r}(m,f),e=m[1],u=m[9]),m[9]=null==u?c?0:t.length:Zt(u-h,0)||0,1==e)var g=function(t,e){var n=Cn(t);return function i(){var r=this&&this!==pt&&this instanceof i?n:t;return r.apply(e,arguments)}}(m[0],m[2]);else g=32!=e&&33!=e||m[4].length?Bn.apply(void 0,m):jn.apply(void 0,m);return(f?en:di)(g,m)}function Un(t,e,n,i,r,o,a){var s=-1,l=t.length,u=e.length;if(l!=u&&!(r&&u>l))return!1;for(;++s<l;){var c=t[s],h=e[s],d=i?i(r?h:c,r?c:h,s):void 0;if(void 0!==d){if(d)continue;return!1}if(r){if(!we(e,(function(t){return c===t||n(c,t,i,r,o,a)})))return!1}else if(c!==h&&!n(c,h,i,r,o,a))return!1}return!0}function $n(t,e,n,i,r,o,a){var s=Jr(t),l=s.length;if(l!=Jr(e).length&&!r)return!1;for(var u=l;u--;){var c=s[u];if(!(r?c in e:dt.call(e,c)))return!1}for(var h=r;++u<l;){var d=t[c=s[u]],p=e[c],f=i?i(r?p:d,r?d:p,c):void 0;if(!(void 0===f?n(d,p,i,r,o,a):f))return!1;h||(h="constructor"==c)}if(!h){var m=t.constructor,g=e.constructor;if(m!=g&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof g&&g instanceof g))return!1}return!0}function Gn(t,e,n){var i=le.callback||yo;return i=i===yo?Ee:i,n?i(t,e,n):i}var qn=ae?function(t){return ae.get(t)}:To;function Yn(t){for(var e=t.name,n=se[e],i=n?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==t)return r.name}return e}function Xn(t,e,n){var i=le.indexOf||Ti;return i=i===Ti?gt:i,t?i(t,e,n):i}var Qn=Ke("length");function Kn(t){for(var e=io(t),n=e.length;n--;)e[n][2]=ai(e[n][1]);return e}function Jn(t,e){var n=null==t?void 0:t[e];return Or(n)?n:void 0}function Zn(t,e,n){null==t||ii(e,t)||(t=1==(e=gi(e)).length?t:$e(t,nn(e,0,-1)),e=ki(e));var i=null==t?t:t[e];return null==i?void 0:i.apply(t,n)}function ti(t){return null!=t&&oi(Qn(t))}function ei(t,e){return e=null==e?9007199254740991:e,(t="number"==typeof t||G.test(t)?+t:-1)>-1&&t%1==0&&t<e}function ni(t,e,n){if(!Dr(n))return!1;var i=typeof e;if("number"==i?ti(n)&&ei(e,n.length):"string"==i&&e in n){var r=n[e];return t==t?t===r:r!=r}return!1}function ii(t,e){var n=typeof t;return!!("string"==n&&N.test(t)||"number"==n)||!Ar(t)&&(!R.test(t)||null!=e&&t in mi(e))}function ri(t){var e=Yn(t);if(!(e in he.prototype))return!1;var n=le[e];if(t===n)return!0;var i=qn(n);return!!i&&t===i[0]}function oi(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function ai(t){return t==t&&!Dr(t)}function si(t,e){t=mi(t);for(var n=-1,i=e.length,r={};++n<i;){var o=e[n];o in t&&(r[o]=t[o])}return r}function li(t,e){var n={};return Ve(t,(function(t,i,r){e(t,i,r)&&(n[i]=t)})),n}function ui(t,e){for(var n=t.length,i=te(e.length,n),r=me(t);i--;){var o=e[i];t[i]=ei(o,n)?r[o]:void 0}return t}var ci,hi,di=(ci=0,hi=0,function(t,e){var n=sr(),i=16-(n-hi);if(hi=n,i>0){if(++ci>=150)return t}else ci=0;return en(t,e)});function pi(t){for(var e=Zr(t),n=e.length,i=n&&t.length,r=!!i&&oi(i)&&(Ar(t)||kr(t)),o=-1,a=[];++o<n;){var s=e[o];(r&&ei(s,i)||dt.call(t,s))&&a.push(s)}return a}function fi(t){return null==t?[]:ti(t)?Dr(t)?t:rt(t):oo(t)}function mi(t){return Dr(t)?t:rt(t)}function gi(t){if(Ar(t))return t;var e=[];return yt(t).replace(F,(function(t,n,i,r){e.push(i?r.replace(V,"$1"):n||t)})),e}function vi(t){return t instanceof he?t.clone():new ce(t.__wrapped__,t.__chain__,me(t.__actions__))}var yi=Tr((function(t,e){return At(t)&&ti(t)?Oe(t,Be(e,!1,!0)):[]}));function bi(t,e,n){return t&&t.length?((n?ni(t,e,n):null==e)&&(e=1),nn(t,e<0?0:e)):[]}function _i(t,e,n){var i=t?t.length:0;return i?((n?ni(t,e,n):null==e)&&(e=1),nn(t,0,(e=i-(+e||0))<0?0:e)):[]}var xi=En(),wi=En(!0);function Ci(t){return t?t[0]:void 0}function Ti(t,e,n){var i=t?t.length:0;if(!i)return-1;if("number"==typeof n)n=n<0?Zt(i+n,0):n;else if(n){var r=hn(t,e);return r<i&&(e==e?e===t[r]:t[r]!=t[r])?r:-1}return gt(t,e,n||0)}var Si=Tr((function(t){for(var e=t.length,i=e,r=n(h),o=Xn(),a=o==gt,s=[];i--;){var l=t[i]=ti(l=t[i])?l:[];r[i]=a&&l.length>=120?xn(i&&l):null}var u=t[0],c=-1,h=u?u.length:0,d=r[0];t:for(;++c<h;)if(l=u[c],(d?fe(d,l):o(s,l,0))<0){for(i=e;--i;){var p=r[i];if((p?fe(p,l):o(t[i],l,0))<0)continue t}d&&d.push(l),s.push(l)}return s}));function ki(t){var e=t?t.length:0;return e?t[e-1]:void 0}var Ai=Tr((function(t,e){var n=ke(t,e=Be(e));return Je(t,e.sort(ft)),n}));function Ei(t){return bi(t,1)}var Mi=Hn(),Pi=Hn(!0),Di=Tr((function(t){return sn(Be(t,!1,!0))}));function Oi(t,e,n,i){if(!t||!t.length)return[];null!=e&&"boolean"!=typeof e&&(n=ni(t,e,i=n)?void 0:e,e=!1);var r=Gn();return null==n&&r===Ee||(n=r(n,i,3)),e&&Xn()==gt?function(t,e){for(var n,i=-1,r=t.length,o=-1,a=[];++i<r;){var s=t[i],l=e?e(s,i,t):s;i&&n===l||(n=l,a[++o]=s)}return a}(t,n):sn(t,n)}function Ii(t){if(!t||!t.length)return[];var e=-1,i=0;t=ye(t,(function(t){if(ti(t))return i=Zt(t.length,i),!0}));for(var r=n(i);++e<i;)r[e]=be(t,Ke(e));return r}function Li(t,e,n){if(!t||!t.length)return[];var i=Ii(t);return null==e?i:(e=pn(e,n,4),be(i,(function(t){return xe(t,e,void 0,!0)})))}var Ri=Tr((function(t,e){return ti(t)?Oe(t,e):[]})),Ni=Tr(Ii);function Fi(t,e){var n=-1,i=t?t.length:0,r={};for(!i||e||Ar(t[0])||(e=[]);++n<i;){var o=t[n];e?r[o]=e[n]:o&&(r[o[0]]=o[1])}return r}var Bi=Tr((function(t){var e=t.length,n=e>2?t[e-2]:void 0,i=e>1?t[e-1]:void 0;return e>2&&"function"==typeof n?e-=2:(n=e>1&&"function"==typeof i?(--e,i):void 0,i=void 0),t.length=e,Li(t,n,i)}));function zi(t){var e=le(t);return e.__chain__=!0,e}function ji(t,e,n){return e.call(n,t)}var Vi=Tr((function(t){return t=Be(t),this.thru((function(e){return function(t,e){for(var i=-1,r=t.length,o=-1,a=e.length,s=n(r+a);++i<r;)s[i]=t[i];for(;++o<a;)s[i++]=e[o];return s}(Ar(e)?e:[mi(e)],t)}))})),Hi=Tr((function(t,e){return ke(t,Be(e))})),Wi=vn((function(t,e,n){dt.call(t,n)?++t[n]:t[n]=1}));function Ui(t,e,n){var i=Ar(t)?ve:Re;return n&&ni(t,e,n)&&(e=void 0),"function"==typeof e&&void 0===n||(e=Gn(e,n,3)),i(t,e)}function $i(t,e,n){return(Ar(t)?ye:Ne)(t,e=Gn(e,n,3))}var Gi=An(Ie),qi=An(Le,!0),Yi=Dn(ge,Ie),Xi=Dn((function(t,e){for(var n=t.length;n--&&!1!==e(t[n],n,t););return t}),Le),Qi=vn((function(t,e,n){dt.call(t,n)?t[n].push(e):t[n]=[e]}));function Ki(t,e,n,i){var r=t?Qn(t):0;return oi(r)||(r=(t=oo(t)).length),n="number"!=typeof n||i&&ni(e,n,i)?0:n<0?Zt(r+n,0):n||0,"string"==typeof t||!Ar(t)&&Nr(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&Xn(t,e,n)>-1}var Ji=vn((function(t,e,n){t[n]=e})),Zi=Tr((function(t,e,i){var r=-1,o="function"==typeof e,a=ii(e),s=ti(t)?n(t.length):[];return Ie(t,(function(t){var n=o?e:a&&null!=t?t[e]:void 0;s[++r]=n?n.apply(t,i):Zn(t,e,i)})),s}));function tr(t,e,n){return(Ar(t)?be:Ye)(t,e=Gn(e,n,3))}var er=vn((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),nr=Fn(xe,Ie),ir=Fn((function(t,e,n,i){var r=t.length;for(i&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}),Le);function rr(t,e,n){if(n?ni(t,e,n):null==e)return(i=(t=fi(t)).length)>0?t[Ze(0,i-1)]:void 0;var i,r=-1,o=zr(t),a=(i=o.length)-1;for(e=te(e<0?0:+e||0,i);++r<e;){var s=Ze(r,a),l=o[s];o[s]=o[r],o[r]=l}return o.length=e,o}function or(t,e,n){var i=Ar(t)?we:rn;return n&&ni(t,e,n)&&(e=void 0),"function"==typeof e&&void 0===n||(e=Gn(e,n,3)),i(t,e)}var ar=Tr((function(t,e){if(null==t)return[];var n=e[2];return n&&ni(e[0],e[1],n)&&(e.length=1),an(t,Be(e),[])})),sr=ee||function(){return(new i).getTime()};function lr(t,e){var n;if("function"!=typeof e){if("function"!=typeof t)throw new st(o);var i=t;t=e,e=i}return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}var ur=Tr((function(t,e,n){var i=1;if(n.length){var r=Mt(n,ur.placeholder);i|=32}return Wn(t,i,e,n,r)})),cr=Tr((function(t,e){for(var n=-1,i=(e=e.length?Be(e):Kr(t)).length;++n<i;){var r=e[n];t[r]=Wn(t[r],1,t)}return t})),hr=Tr((function(t,e,n){var i=3;if(n.length){var r=Mt(n,hr.placeholder);i|=32}return Wn(e,i,t,n,r)})),dr=Tn(8),pr=Tn(16);function fr(t,e,n){var i,r,a,s,l,u,c,h=0,d=!1,p=!0;if("function"!=typeof t)throw new st(o);if(e=e<0?0:+e||0,!0===n){var f=!0;p=!1}else Dr(n)&&(f=!!n.leading,d="maxWait"in n&&Zt(+n.maxWait||0,e),p="trailing"in n?!!n.trailing:p);function m(e,n){n&&Bt(n),r=u=c=void 0,e&&(h=sr(),a=t.apply(l,i),u||r||(i=l=void 0))}function g(){var t=e-(sr()-s);t<=0||t>e?m(c,r):u=Wt(g,t)}function v(){m(p,u)}function y(){if(i=arguments,s=sr(),l=this,c=p&&(u||!f),!1===d)var n=f&&!u;else{r||f||(h=s);var o=d-(s-h),m=o<=0||o>d;m?(r&&(r=Bt(r)),h=s,a=t.apply(l,i)):r||(r=Wt(v,o))}return m&&u?u=Bt(u):u||e===d||(u=Wt(g,e)),n&&(m=!0,a=t.apply(l,i)),!m||u||r||(i=l=void 0),a}return y.cancel=function(){u&&Bt(u),r&&Bt(r),h=0,r=u=c=void 0},y}var mr=Tr((function(t,e){return De(t,1,e)})),gr=Tr((function(t,e,n){return De(t,e,n)})),vr=Pn(),yr=Pn(!0);function br(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new st(o);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var a=t.apply(this,i);return n.cache=o.set(r,a),a};return n.cache=new br.Cache,n}var _r=Tr((function(t,e){if(e=Be(e),"function"!=typeof t||!ve(e,vt))throw new st(o);var n=e.length;return Tr((function(i){for(var r=te(i.length,n);r--;)i[r]=e[r](i[r]);return t.apply(this,i)}))})),xr=Nn(32),wr=Nn(64),Cr=Tr((function(t,e){return Wn(t,256,void 0,void 0,void 0,Be(e))}));function Tr(t,e){if("function"!=typeof t)throw new st(o);return e=Zt(void 0===e?t.length-1:+e||0,0),function(){for(var i=arguments,r=-1,o=Zt(i.length-e,0),a=n(o);++r<o;)a[r]=i[e+r];switch(e){case 0:return t.call(this,a);case 1:return t.call(this,i[0],a);case 2:return t.call(this,i[0],i[1],a)}var s=n(e+1);for(r=-1;++r<e;)s[r]=i[r];return s[e]=a,t.apply(this,s)}}function Sr(t,e){return t>e}function kr(t){return At(t)&&ti(t)&&dt.call(t,"callee")&&!Vt.call(t,"callee")}var Ar=Qt||function(t){return At(t)&&oi(t.length)&&Lt.call(t)==l};function Er(t,e,n,i){var r=(n="function"==typeof n?pn(n,i,3):void 0)?n(t,e):void 0;return void 0===r?Ge(t,e,n):!!r}function Mr(t){return At(t)&&"string"==typeof t.message&&Lt.call(t)==h}function Pr(t){return Dr(t)&&Lt.call(t)==d}function Dr(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Or(t){return null!=t&&(Pr(t)?Nt.test(ht.call(t)):At(t)&&$.test(t))}function Ir(t){return"number"==typeof t||At(t)&&Lt.call(t)==p}function Lr(t){var e,n;return!(!At(t)||Lt.call(t)!=f||kr(t)||!(dt.call(t,"constructor")||"function"!=typeof(e=t.constructor)||e instanceof e))&&(Ve(t,(function(t,e){n=e})),void 0===n||dt.call(t,n))}function Rr(t){return Dr(t)&&Lt.call(t)==m}function Nr(t){return"string"==typeof t||At(t)&&Lt.call(t)==g}function Fr(t){return At(t)&&oi(t.length)&&!!Z[Lt.call(t)]}function Br(t,e){return t<e}function zr(t){var e=t?Qn(t):0;return oi(e)?e?me(t):[]:oo(t)}function jr(t){return Ae(t,Zr(t))}var Vr=yn((function t(e,n,i,r,o){if(!Dr(e))return e;var a=ti(n)&&(Ar(n)||Fr(n)),s=a?void 0:Jr(n);return ge(s||n,(function(l,u){if(s&&(l=n[u=l]),At(l))r||(r=[]),o||(o=[]),function(t,e,n,i,r,o,a){for(var s=o.length,l=e[n];s--;)if(o[s]==l)return void(t[n]=a[s]);var u=t[n],c=r?r(u,l,n,t,e):void 0,h=void 0===c;h&&(c=l,ti(l)&&(Ar(l)||Fr(l))?c=Ar(u)?u:ti(u)?me(u):[]:Lr(l)||kr(l)?c=kr(u)?jr(u):Lr(u)?u:{}:h=!1),o.push(l),a.push(c),h?t[n]=i(c,l,r,o,a):(c==c?c!==u:u==u)&&(t[n]=c)}(e,n,u,t,i,r,o);else{var c=e[u],h=i?i(c,l,u,e,n):void 0,d=void 0===h;d&&(h=l),void 0===h&&(!a||u in e)||!d&&(h==h?h===c:c!=c)||(e[u]=h)}})),e})),Hr=yn((function(t,e,n){return n?Te(t,e,n):Se(t,e)})),Wr=Sn(Hr,(function(t,e){return void 0===t?e:t})),Ur=Sn(Vr,(function t(e,n){return void 0===e?n:Vr(e,n,t)})),$r=Mn(He),Gr=Mn(We),qr=On(ze),Yr=On(je),Xr=In(He),Qr=In(We);function Kr(t){return Ue(t,Zr(t))}var Jr=Jt?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&ti(t)?pi(t):Dr(t)?Jt(t):[]}:pi;function Zr(t){if(null==t)return[];Dr(t)||(t=rt(t));var e=t.length;e=e&&oi(e)&&(Ar(t)||kr(t))&&e||0;for(var i=t.constructor,r=-1,o="function"==typeof i&&i.prototype===t,a=n(e),s=e>0;++r<e;)a[r]=r+"";for(var l in t)s&&ei(l,e)||"constructor"==l&&(o||!dt.call(t,l))||a.push(l);return a}var to=Ln(!0),eo=Ln(),no=Tr((function(t,e){if(null==t)return{};if("function"!=typeof e[0])return e=be(Be(e),at),si(t,Oe(Zr(t),e));var n=pn(e[0],e[1],3);return li(t,(function(t,e,i){return!n(t,e,i)}))}));function io(t){t=mi(t);for(var e=-1,i=Jr(t),r=i.length,o=n(r);++e<r;){var a=i[e];o[e]=[a,t[a]]}return o}var ro=Tr((function(t,e){return null==t?{}:"function"==typeof e[0]?li(t,pn(e[0],e[1],3)):si(t,Be(e))}));function oo(t){return ln(t,Jr(t))}var ao=wn((function(t,e,n){return e=e.toLowerCase(),t+(n?e.charAt(0).toUpperCase()+e.slice(1):e)}));function so(t){return(t=yt(t))&&t.replace(q,wt).replace(j,"")}var lo=wn((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),uo=Rn(),co=Rn(!0);function ho(t,e){var n="";if(t=yt(t),(e=+e)<1||!t||!Kt(e))return n;do{e%2&&(n+=t),e=Xt(e/2),t+=t}while(e);return n}var po=wn((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),fo=wn((function(t,e,n){return t+(n?" ":"")+(e.charAt(0).toUpperCase()+e.slice(1))}));function mo(t,e,n){var i=t;return(t=yt(t))?(n?ni(i,e,n):null==e)?t.slice(Pt(t),Dt(t)+1):(e+="",t.slice(bt(t,e),_t(t,e)+1)):t}function go(t,e,n){return n&&ni(t,e,n)&&(e=void 0),(t=yt(t)).match(e||Q)||[]}var vo=Tr((function(t,e){try{return t.apply(void 0,e)}catch(t){return Mr(t)?t:new r(t)}}));function yo(t,e,n){return n&&ni(t,e,n)&&(e=void 0),At(t)?_o(t):Ee(t,e)}function bo(t){return t}function _o(t){return Xe(Me(t,!0))}var xo=Tr((function(t,e){return function(n){return Zn(n,t,e)}})),wo=Tr((function(t,e){return function(n){return Zn(t,n,e)}}));function Co(t,e,n){if(null==n){var i=Dr(e),r=i?Jr(e):void 0,o=r&&r.length?Ue(e,r):void 0;(o?o.length:i)||(o=!1,n=e,e=t,t=this)}o||(o=Ue(e,Jr(e)));var a=!0,s=-1,l=Pr(t),u=o.length;!1===n?a=!1:Dr(n)&&"chain"in n&&(a=n.chain);for(;++s<u;){var c=o[s],h=e[c];t[c]=h,l&&(t.prototype[c]=function(e){return function(){var n=this.__chain__;if(a||n){var i=t(this.__wrapped__),r=i.__actions__=me(this.__actions__);return r.push({func:e,args:arguments,thisArg:t}),i.__chain__=n,i}return e.apply(t,_e([this.value()],arguments))}}(h))}return t}function To(){}function So(t){return ii(t)?Ke(t):function(t){var e=t+"";return t=gi(t),function(n){return $e(n,t,e)}}(t)}var ko,Ao=Vn("ceil"),Eo=Vn("floor"),Mo=kn(Sr,re),Po=kn(Br,oe),Do=Vn("round");return le.prototype=ue.prototype,ce.prototype=Pe(ue.prototype),ce.prototype.constructor=ce,he.prototype=Pe(ue.prototype),he.prototype.constructor=he,de.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},de.prototype.get=function(t){return"__proto__"==t?void 0:this.__data__[t]},de.prototype.has=function(t){return"__proto__"!=t&&dt.call(this.__data__,t)},de.prototype.set=function(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this},pe.prototype.push=function(t){var e=this.data;"string"==typeof t||Dr(t)?e.set.add(t):e.hash[t]=!0},br.Cache=de,le.after=function(t,e){if("function"!=typeof e){if("function"!=typeof t)throw new st(o);var n=t;t=e,e=n}return t=Kt(t=+t)?t:0,function(){if(--t<1)return e.apply(this,arguments)}},le.ary=function(t,e,n){return n&&ni(t,e,n)&&(e=void 0),Wn(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:Zt(+e||0,0))},le.assign=Hr,le.at=Hi,le.before=lr,le.bind=ur,le.bindAll=cr,le.bindKey=hr,le.callback=yo,le.chain=zi,le.chunk=function(t,e,i){e=(i?ni(t,e,i):null==e)?1:Zt(Xt(e)||1,1);for(var r=0,o=t?t.length:0,a=-1,s=n(qt(o/e));r<o;)s[++a]=nn(t,r,r+=e);return s},le.compact=function(t){for(var e=-1,n=t?t.length:0,i=-1,r=[];++e<n;){var o=t[e];o&&(r[++i]=o)}return r},le.constant=function(t){return function(){return t}},le.countBy=Wi,le.create=function(t,e,n){var i=Pe(t);return n&&ni(t,e,n)&&(e=void 0),e?Se(i,e):i},le.curry=dr,le.curryRight=pr,le.debounce=fr,le.defaults=Wr,le.defaultsDeep=Ur,le.defer=mr,le.delay=gr,le.difference=yi,le.drop=bi,le.dropRight=_i,le.dropRightWhile=function(t,e,n){return t&&t.length?un(t,Gn(e,n,3),!0,!0):[]},le.dropWhile=function(t,e,n){return t&&t.length?un(t,Gn(e,n,3),!0):[]},le.fill=function(t,e,n,i){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&ni(t,e,n)&&(n=0,i=r),function(t,e,n,i){var r=t.length;for((n=null==n?0:+n||0)<0&&(n=-n>r?0:r+n),(i=void 0===i||i>r?r:+i||0)<0&&(i+=r),r=n>i?0:i>>>0,n>>>=0;n<r;)t[n++]=e;return t}(t,e,n,i)):[]},le.filter=$i,le.flatten=function(t,e,n){var i=t?t.length:0;return n&&ni(t,e,n)&&(e=!1),i?Be(t,e):[]},le.flattenDeep=function(t){return t&&t.length?Be(t,!0):[]},le.flow=vr,le.flowRight=yr,le.forEach=Yi,le.forEachRight=Xi,le.forIn=qr,le.forInRight=Yr,le.forOwn=Xr,le.forOwnRight=Qr,le.functions=Kr,le.groupBy=Qi,le.indexBy=Ji,le.initial=function(t){return _i(t,1)},le.intersection=Si,le.invert=function(t,e,n){n&&ni(t,e,n)&&(e=void 0);for(var i=-1,r=Jr(t),o=r.length,a={};++i<o;){var s=r[i],l=t[s];e?dt.call(a,l)?a[l].push(s):a[l]=[s]:a[l]=s}return a},le.invoke=Zi,le.keys=Jr,le.keysIn=Zr,le.map=tr,le.mapKeys=to,le.mapValues=eo,le.matches=_o,le.matchesProperty=function(t,e){return Qe(t,Me(e,!0))},le.memoize=br,le.merge=Vr,le.method=xo,le.methodOf=wo,le.mixin=Co,le.modArgs=_r,le.negate=function(t){if("function"!=typeof t)throw new st(o);return function(){return!t.apply(this,arguments)}},le.omit=no,le.once=function(t){return lr(2,t)},le.pairs=io,le.partial=xr,le.partialRight=wr,le.partition=er,le.pick=ro,le.pluck=function(t,e){return tr(t,So(e))},le.property=So,le.propertyOf=function(t){return function(e){return $e(t,gi(e),e+"")}},le.pull=function(){var t=arguments,e=t[0];if(!e||!e.length)return e;for(var n=0,i=Xn(),r=t.length;++n<r;)for(var o=0,a=t[n];(o=i(e,a,o))>-1;)Ut.call(e,o,1);return e},le.pullAt=Ai,le.range=function(t,e,i){i&&ni(t,e,i)&&(e=i=void 0),t=+t||0,null==e?(e=t,t=0):e=+e||0;for(var r=-1,o=Zt(qt((e-t)/((i=null==i?1:+i||0)||1)),0),a=n(o);++r<o;)a[r]=t,t+=i;return a},le.rearg=Cr,le.reject=function(t,e,n){var i=Ar(t)?ye:Ne;return e=Gn(e,n,3),i(t,(function(t,n,i){return!e(t,n,i)}))},le.remove=function(t,e,n){var i=[];if(!t||!t.length)return i;var r=-1,o=[],a=t.length;for(e=Gn(e,n,3);++r<a;){var s=t[r];e(s,r,t)&&(i.push(s),o.push(r))}return Je(t,o),i},le.rest=Ei,le.restParam=Tr,le.set=function(t,e,n){if(null==t)return t;for(var i=e+"",r=-1,o=(e=null!=t[i]||ii(e,t)?[i]:gi(e)).length,a=o-1,s=t;null!=s&&++r<o;){var l=e[r];Dr(s)&&(r==a?s[l]=n:null==s[l]&&(s[l]=ei(e[r+1])?[]:{})),s=s[l]}return t},le.shuffle=function(t){return rr(t,oe)},le.slice=function(t,e,n){var i=t?t.length:0;return i?(n&&"number"!=typeof n&&ni(t,e,n)&&(e=0,n=i),nn(t,e,n)):[]},le.sortBy=function(t,e,n){if(null==t)return[];n&&ni(t,e,n)&&(e=void 0);var i=-1;return e=Gn(e,n,3),on(Ye(t,(function(t,n,r){return{criteria:e(t,n,r),index:++i,value:t}})),xt)},le.sortByAll=ar,le.sortByOrder=function(t,e,n,i){return null==t?[]:(i&&ni(e,n,i)&&(n=void 0),Ar(e)||(e=null==e?[]:[e]),Ar(n)||(n=null==n?[]:[n]),an(t,e,n))},le.spread=function(t){if("function"!=typeof t)throw new st(o);return function(e){return t.apply(this,e)}},le.take=function(t,e,n){return t&&t.length?((n?ni(t,e,n):null==e)&&(e=1),nn(t,0,e<0?0:e)):[]},le.takeRight=function(t,e,n){var i=t?t.length:0;return i?((n?ni(t,e,n):null==e)&&(e=1),nn(t,(e=i-(+e||0))<0?0:e)):[]},le.takeRightWhile=function(t,e,n){return t&&t.length?un(t,Gn(e,n,3),!1,!0):[]},le.takeWhile=function(t,e,n){return t&&t.length?un(t,Gn(e,n,3)):[]},le.tap=function(t,e,n){return e.call(n,t),t},le.throttle=function(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw new st(o);return!1===n?i=!1:Dr(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),fr(t,e,{leading:i,maxWait:+e,trailing:r})},le.thru=ji,le.times=function(t,e,i){if((t=Xt(t))<1||!Kt(t))return[];var r=-1,o=n(te(t,4294967295));for(e=pn(e,i,1);++r<t;)r<4294967295?o[r]=e(r):e(r);return o},le.toArray=zr,le.toPlainObject=jr,le.transform=function(t,e,n,i){var r=Ar(t)||Fr(t);if(e=Gn(e,i,4),null==n)if(r||Dr(t)){var o=t.constructor;n=r?Ar(t)?new o:[]:Pe(Pr(o)?o.prototype:void 0)}else n={};return(r?ge:He)(t,(function(t,i,r){return e(n,t,i,r)})),n},le.union=Di,le.uniq=Oi,le.unzip=Ii,le.unzipWith=Li,le.values=oo,le.valuesIn=function(t){return ln(t,Zr(t))},le.where=function(t,e){return $i(t,Xe(e))},le.without=Ri,le.wrap=function(t,e){return Wn(e=null==e?bo:e,32,void 0,[t],[])},le.xor=function(){for(var t=-1,e=arguments.length;++t<e;){var n=arguments[t];if(ti(n))var i=i?_e(Oe(i,n),Oe(n,i)):n}return i?sn(i):[]},le.zip=Ni,le.zipObject=Fi,le.zipWith=Bi,le.backflow=yr,le.collect=tr,le.compose=yr,le.each=Yi,le.eachRight=Xi,le.extend=Hr,le.iteratee=yo,le.methods=Kr,le.object=Fi,le.select=$i,le.tail=Ei,le.unique=Oi,Co(le,le),le.add=function(t,e){return(+t||0)+(+e||0)},le.attempt=vo,le.camelCase=ao,le.capitalize=function(t){return(t=yt(t))&&t.charAt(0).toUpperCase()+t.slice(1)},le.ceil=Ao,le.clone=function(t,e,n,i){return e&&"boolean"!=typeof e&&ni(t,e,n)?e=!1:"function"==typeof e&&(i=n,n=e,e=!1),"function"==typeof n?Me(t,e,pn(n,i,1)):Me(t,e)},le.cloneDeep=function(t,e,n){return"function"==typeof e?Me(t,!0,pn(e,n,1)):Me(t,!0)},le.deburr=so,le.endsWith=function(t,e,n){e+="";var i=(t=yt(t)).length;return n=void 0===n?i:te(n<0?0:+n||0,i),(n-=e.length)>=0&&t.indexOf(e,n)==n},le.escape=function(t){return(t=yt(t))&&D.test(t)?t.replace(M,Ct):t},le.escapeRegExp=function(t){return(t=yt(t))&&z.test(t)?t.replace(B,Tt):t||"(?:)"},le.every=Ui,le.find=Gi,le.findIndex=xi,le.findKey=$r,le.findLast=qi,le.findLastIndex=wi,le.findLastKey=Gr,le.findWhere=function(t,e){return Gi(t,Xe(e))},le.first=Ci,le.floor=Eo,le.get=function(t,e,n){var i=null==t?void 0:$e(t,gi(e),e+"");return void 0===i?n:i},le.gt=Sr,le.gte=function(t,e){return t>=e},le.has=function(t,e){if(null==t)return!1;var n=dt.call(t,e);if(!n&&!ii(e)){if(null==(t=1==(e=gi(e)).length?t:$e(t,nn(e,0,-1))))return!1;e=ki(e),n=dt.call(t,e)}return n||oi(t.length)&&ei(e,t.length)&&(Ar(t)||kr(t))},le.identity=bo,le.includes=Ki,le.indexOf=Ti,le.inRange=function(t,e,n){return e=+e||0,void 0===n?(n=e,e=0):n=+n||0,t>=te(e,n)&&t<Zt(e,n)},le.isArguments=kr,le.isArray=Ar,le.isBoolean=function(t){return!0===t||!1===t||At(t)&&Lt.call(t)==u},le.isDate=function(t){return At(t)&&Lt.call(t)==c},le.isElement=function(t){return!!t&&1===t.nodeType&&At(t)&&!Lr(t)},le.isEmpty=function(t){return null==t||(ti(t)&&(Ar(t)||Nr(t)||kr(t)||At(t)&&Pr(t.splice))?!t.length:!Jr(t).length)},le.isEqual=Er,le.isError=Mr,le.isFinite=function(t){return"number"==typeof t&&Kt(t)},le.isFunction=Pr,le.isMatch=function(t,e,n,i){return n="function"==typeof n?pn(n,i,3):void 0,qe(t,Kn(e),n)},le.isNaN=function(t){return Ir(t)&&t!=+t},le.isNative=Or,le.isNull=function(t){return null===t},le.isNumber=Ir,le.isObject=Dr,le.isPlainObject=Lr,le.isRegExp=Rr,le.isString=Nr,le.isTypedArray=Fr,le.isUndefined=function(t){return void 0===t},le.kebabCase=lo,le.last=ki,le.lastIndexOf=function(t,e,n){var i=t?t.length:0;if(!i)return-1;var r=i;if("number"==typeof n)r=(n<0?Zt(i+n,0):te(n||0,i-1))+1;else if(n){var o=t[r=hn(t,e,!0)-1];return(e==e?e===o:o!=o)?r:-1}if(e!=e)return kt(t,r,!0);for(;r--;)if(t[r]===e)return r;return-1},le.lt=Br,le.lte=function(t,e){return t<=e},le.max=Mo,le.min=Po,le.noConflict=function(){return pt._=Rt,this},le.noop=To,le.now=sr,le.pad=function(t,e,n){e=+e;var i=(t=yt(t)).length;if(i>=e||!Kt(e))return t;var r=(e-i)/2,o=Xt(r);return(n=zn("",qt(r),n)).slice(0,o)+t+n},le.padLeft=uo,le.padRight=co,le.parseInt=function(t,e,n){return(n?ni(t,e,n):null==e)?e=0:e&&(e=+e),t=mo(t),ne(t,e||(U.test(t)?16:10))},le.random=function(t,e,n){n&&ni(t,e,n)&&(e=n=void 0);var i=null==t,r=null==e;if(null==n&&(r&&"boolean"==typeof t?(n=t,t=1):"boolean"==typeof e&&(n=e,r=!0)),i&&r&&(e=1,r=!1),t=+t||0,r?(e=t,t=0):e=+e||0,n||t%1||e%1){var o=ie();return te(t+o*(e-t+zt("1e-"+((o+"").length-1))),e)}return Ze(t,e)},le.reduce=nr,le.reduceRight=ir,le.repeat=ho,le.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(null==t||ii(e,t)||(i=null==(t=1==(e=gi(e)).length?t:$e(t,nn(e,0,-1)))?void 0:t[ki(e)]),i=void 0===i?n:i),Pr(i)?i.call(t):i},le.round=Do,le.runInContext=t,le.size=function(t){var e=t?Qn(t):0;return oi(e)?e:Jr(t).length},le.snakeCase=po,le.some=or,le.sortedIndex=Mi,le.sortedLastIndex=Pi,le.startCase=fo,le.startsWith=function(t,e,n){return t=yt(t),n=null==n?0:te(n<0?0:+n||0,t.length),t.lastIndexOf(e,n)==n},le.sum=function(t,e,n){return n&&ni(t,e,n)&&(e=void 0),1==(e=Gn(e,n,3)).length?function(t,e){for(var n=t.length,i=0;n--;)i+=+e(t[n])||0;return i}(Ar(t)?t:fi(t),e):function(t,e){var n=0;return Ie(t,(function(t,i,r){n+=+e(t,i,r)||0})),n}(t,e)},le.template=function(t,e,n){var i=le.templateSettings;n&&ni(t,e,n)&&(e=n=void 0),t=yt(t),e=Te(Se({},n||e),i,Ce);var r,o,a=Te(Se({},e.imports),i.imports,Ce),s=Jr(a),l=ln(a,s),u=0,c=e.interpolate||Y,h="__p += '",d=ot((e.escape||Y).source+"|"+c.source+"|"+(c===L?H:Y).source+"|"+(e.evaluate||Y).source+"|$","g"),p="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++J+"]")+"\n";t.replace(d,(function(e,n,i,a,s,l){return i||(i=a),h+=t.slice(u,l).replace(X,St),n&&(r=!0,h+="' +\n__e("+n+") +\n'"),s&&(o=!0,h+="';\n"+s+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+e.length,e})),h+="';\n";var f=e.variable;f||(h="with (obj) {\n"+h+"\n}\n"),h=(o?h.replace(S,""):h).replace(k,"$1").replace(A,"$1;"),h="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=vo((function(){return et(s,p+"return "+h).apply(void 0,l)}));if(m.source=h,Mr(m))throw m;return m},le.trim=mo,le.trimLeft=function(t,e,n){var i=t;return(t=yt(t))?(n?ni(i,e,n):null==e)?t.slice(Pt(t)):t.slice(bt(t,e+"")):t},le.trimRight=function(t,e,n){var i=t;return(t=yt(t))?(n?ni(i,e,n):null==e)?t.slice(0,Dt(t)+1):t.slice(0,_t(t,e+"")+1):t},le.trunc=function(t,e,n){n&&ni(t,e,n)&&(e=void 0);var i=30,r="...";if(null!=e)if(Dr(e)){var o="separator"in e?e.separator:o;i="length"in e?+e.length||0:i,r="omission"in e?yt(e.omission):r}else i=+e||0;if(i>=(t=yt(t)).length)return t;var a=i-r.length;if(a<1)return r;var s=t.slice(0,a);if(null==o)return s+r;if(Rr(o)){if(t.slice(a).search(o)){var l,u,c=t.slice(0,a);for(o.global||(o=ot(o.source,(W.exec(o)||"")+"g")),o.lastIndex=0;l=o.exec(c);)u=l.index;s=s.slice(0,null==u?a:u)}}else if(t.indexOf(o,a)!=a){var h=s.lastIndexOf(o);h>-1&&(s=s.slice(0,h))}return s+r},le.unescape=function(t){return(t=yt(t))&&P.test(t)?t.replace(E,Ot):t},le.uniqueId=function(t){var e=++Et;return yt(t)+e},le.words=go,le.all=Ui,le.any=or,le.contains=Ki,le.eq=Er,le.detect=Gi,le.foldl=nr,le.foldr=ir,le.head=Ci,le.include=Ki,le.inject=nr,Co(le,(ko={},He(le,(function(t,e){le.prototype[e]||(ko[e]=t)})),ko),!1),le.sample=rr,le.prototype.sample=function(t){return this.__chain__||null!=t?this.thru((function(e){return rr(e,t)})):rr(this.value())},le.VERSION="3.10.0",ge(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){le[t].placeholder=le})),ge(["drop","take"],(function(t,e){he.prototype[t]=function(n){var i=this.__filtered__;if(i&&!e)return new he(this);n=null==n?1:Zt(Xt(n)||0,0);var r=this.clone();return i?r.__takeCount__=te(r.__takeCount__,n):r.__views__.push({size:n,type:t+(r.__dir__<0?"Right":"")}),r},he.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),ge(["filter","map","takeWhile"],(function(t,e){var n=e+1,i=2!=n;he.prototype[t]=function(t,e){var r=this.clone();return r.__iteratees__.push({iteratee:Gn(t,e,1),type:n}),r.__filtered__=r.__filtered__||i,r}})),ge(["first","last"],(function(t,e){var n="take"+(e?"Right":"");he.prototype[t]=function(){return this[n](1).value()[0]}})),ge(["initial","rest"],(function(t,e){var n="drop"+(e?"":"Right");he.prototype[t]=function(){return this.__filtered__?new he(this):this[n](1)}})),ge(["pluck","where"],(function(t,e){var n=e?"filter":"map",i=e?Xe:So;he.prototype[t]=function(t){return this[n](i(t))}})),he.prototype.compact=function(){return this.filter(bo)},he.prototype.reject=function(t,e){return t=Gn(t,e,1),this.filter((function(e){return!t(e)}))},he.prototype.slice=function(t,e){t=null==t?0:+t||0;var n=this;return n.__filtered__&&(t>0||e<0)?new he(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),void 0!==e&&(n=(e=+e||0)<0?n.dropRight(-e):n.take(e-t)),n)},he.prototype.takeRightWhile=function(t,e){return this.reverse().takeWhile(t,e).reverse()},he.prototype.toArray=function(){return this.take(oe)},He(he.prototype,(function(t,e){var n=/^(?:filter|map|reject)|While$/.test(e),i=/^(?:first|last)$/.test(e),r=le[i?"take"+("last"==e?"Right":""):e];r&&(le.prototype[e]=function(){var e=i?[1]:arguments,o=this.__chain__,a=this.__wrapped__,s=!!this.__actions__.length,l=a instanceof he,u=e[0],c=l||Ar(a);c&&n&&"function"==typeof u&&1!=u.length&&(l=c=!1);var h=function(t){return i&&o?r(t,1)[0]:r.apply(void 0,_e([t],e))},d={func:ji,args:[h],thisArg:void 0},p=l&&!s;if(i&&!o)return p?((a=a.clone()).__actions__.push(d),t.call(a)):r.call(void 0,this.value())[0];if(!i&&c){a=p?a:new he(this);var f=t.apply(a,e);return f.__actions__.push(d),new ce(f,o)}return this.thru(h)})})),ge(["join","pop","push","replace","shift","sort","splice","split","unshift"],(function(t){var e=(/^(?:replace|split)$/.test(t)?ct:lt)[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:join|pop|replace|shift)$/.test(t);le.prototype[t]=function(){var t=arguments;return i&&!this.__chain__?e.apply(this.value(),t):this[n]((function(n){return e.apply(n,t)}))}})),He(he.prototype,(function(t,e){var n=le[e];if(n){var i=n.name;(se[i]||(se[i]=[])).push({name:e,func:n})}})),se[Bn(void 0,2).name]=[{name:"wrapper",func:void 0}],he.prototype.clone=function(){var t=new he(this.__wrapped__);return t.__actions__=me(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=me(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=me(this.__views__),t},he.prototype.reverse=function(){if(this.__filtered__){var t=new he(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},he.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ar(t),i=e<0,r=n?t.length:0,o=function(t,e,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=te(e,t+a);break;case"takeRight":t=Zt(t,e-a)}}return{start:t,end:e}}(0,r,this.__views__),a=o.start,s=o.end,l=s-a,u=i?s:a-1,c=this.__iteratees__,h=c.length,d=0,p=te(l,this.__takeCount__);if(!n||r<200||r==l&&p==l)return cn(i&&n?t.reverse():t,this.__actions__);var f=[];t:for(;l--&&d<p;){for(var m=-1,g=t[u+=e];++m<h;){var v=c[m],y=v.iteratee,b=v.type,_=y(g);if(2==b)g=_;else if(!_){if(1==b)continue t;break t}}f[d++]=g}return f},le.prototype.chain=function(){return zi(this)},le.prototype.commit=function(){return new ce(this.value(),this.__chain__)},le.prototype.concat=Vi,le.prototype.plant=function(t){for(var e,n=this;n instanceof ue;){var i=vi(n);e?r.__wrapped__=i:e=i;var r=i;n=n.__wrapped__}return r.__wrapped__=t,e},le.prototype.reverse=function(){var t=this.__wrapped__,e=function(t){return n&&n.__dir__<0?t:t.reverse()};if(t instanceof he){var n=t;return this.__actions__.length&&(n=new he(this)),(n=n.reverse()).__actions__.push({func:ji,args:[e],thisArg:void 0}),new ce(n,this.__chain__)}return this.thru(e)},le.prototype.toString=function(){return this.value()+""},le.prototype.run=le.prototype.toJSON=le.prototype.valueOf=le.prototype.value=function(){return cn(this.__wrapped__,this.__actions__)},le.prototype.collect=le.prototype.map,le.prototype.head=le.prototype.first,le.prototype.select=le.prototype.filter,le.prototype.tail=le.prototype.rest,le}();st&&lt?dt?(lt.exports=It)._=It:st._=It:pt._=It}).call(this)},{}],5:[function(t,e,n){var i,r;i=this,r=function(t,e,n){var i=[].slice;function r(){return{initialState:"uninitialized",eventListeners:{"*":[]},states:{},namespace:u.makeFsmNamespace(),useSafeEmit:!1,hierarchy:{},pendingDelegations:{}}}function o(){return{inputQueue:[],targetReplayState:"",state:n,priorState:n,priorAction:"",currentAction:"",currentActionArgs:n,inExitHandler:!1}}function a(t,e){for(var n=[],i=e||0;i<t.length;i++)n[i]=t[i];return n}var s,l=["states","initialState"],u={makeFsmNamespace:(s=0,function(){return"fsm."+s++}),listenToChild:function(t,e){return e.on("*",(function(e,n){switch(e){case"nohandler":n.ticket||n.delegated||n.namespace===t.namespace||(n.args[1].bubbling=!0),"_reset"!==n.inputType&&t.handle.apply(t,n.args);break;case"handling":var i=n.ticket;i&&t.pendingDelegations[i]&&delete t.pendingDelegations[i],t.emit(e,n);break;default:t.emit(e,n)}}))},getLeaklessArgs:a,getDefaultOptions:r,getDefaultClientMeta:o,createUUID:function(){for(var t=[],e=0;e<36;e++)t[e]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]="0123456789abcdef".substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}},c={emit:function(e){var n=a(arguments);this.eventListeners["*"]&&t.each(this.eventListeners["*"],(function(t){if(this.useSafeEmit)try{t.apply(this,n)}catch(t){console&&void 0!==console.log&&console.log(t.stack)}else t.apply(this,n)}),this),this.eventListeners[e]&&t.each(this.eventListeners[e],(function(t){if(this.useSafeEmit)try{t.apply(this,n.slice(1))}catch(t){console&&void 0!==console.log&&console.log(t.stack)}else t.apply(this,n.slice(1))}),this)},on:function(t,e){var n=this;return n.eventListeners=n.eventListeners||{"*":[]},n.eventListeners[t]||(n.eventListeners[t]=[]),n.eventListeners[t].push(e),{eventName:t,callback:e,off:function(){n.off(t,e)}}},off:function(e,n){this.eventListeners=this.eventListeners||{"*":[]},e?this.eventListeners[e]=n?t.without(this.eventListeners[e],n):[]:this.eventListeners={}}};function h(e){t.extend(this,e),t.defaults(this,r()),this.initialize.apply(this,arguments),p.emit("newfsm",this)}t.extend(h.prototype,{initialize:function(){},initClient:function(t){var e=this.initialState;if(!e)throw new Error("You must specify an initial state for this FSM");if(!this.states[e])throw new Error("The initial state specified does not exist in the states object.");this.transition(t,e)},ensureClientMeta:function(e){if("object"!=typeof e)throw new Error("An FSM client must be an object.");return e.__machina__=e.__machina__||{},e.__machina__[this.namespace]||(e.__machina__[this.namespace]=t.cloneDeep(u.getDefaultClientMeta()),this.initClient(e)),e.__machina__[this.namespace]},buildEventPayload:function(e,n){return t.isPlainObject(n)?t.extend(n,{client:e,namespace:this.namespace}):{client:e,data:n||null,namespace:this.namespace}},getHandlerArgs:function(t,e){var n=t.slice(0),i=n[1];return"object"==typeof i&&n.splice(1,1,i.inputType),e?n:[n[0]].concat(n.slice(2))},handle:function(e,i){var r=i;if(void 0===i)throw new Error("The input argument passed to the FSM's handle method is undefined. Did you forget to pass the input name?");"string"==typeof i&&(r={inputType:i,delegated:!1,ticket:n});var o=this.ensureClientMeta(e),s=a(arguments);"object"!=typeof i&&s.splice(1,1,r),o.currentActionArgs=s.slice(1);var l,c,h,d,p,f=o.state,m=this.states[f],g=!1;if(!o.inExitHandler)if(!(h=m._child&&m._child.instance)||this.pendingDelegations[r.ticket]||r.bubbling){r.ticket&&this.pendingDelegations[r.ticket]&&delete this.pendingDelegations[r.ticket],g="*"===(l=m[r.inputType]?r.inputType:"*"),c=m[l]||this[l]||this["*"],p=o.state+"."+l,o.currentAction=p;var v=this.buildEventPayload(e,{inputType:r.inputType,delegated:r.delegated,ticket:r.ticket});c?(this.emit("handling",v),"function"==typeof c?d=c.apply(this,this.getHandlerArgs(s,g)):(d=c,this.transition(e,c)),this.emit("handled",v)):this.emit("nohandler",t.extend({args:s},v)),o.priorAction=o.currentAction,o.currentAction=""}else r.ticket=r.ticket||u.createUUID(),r.delegated=!0,this.pendingDelegations[r.ticket]={delegatedTo:h.namespace},d=h.handle.apply(h,s);return d},transition:function(t,e){var n,i=this.ensureClientMeta(t),r=i.state,o=this.states[r],a=this.states[e];if(!i.inExitHandler&&e!==r){if(a){a._child&&(a._child=function(t){if(t){var e={};return"object"==typeof t?t.factory?e=t:e.factory=function(){return t}:"function"==typeof t&&(e.factory=t),e.instance=e.factory(),e}}(a._child),n=a._child&&a._child.instance),o&&o._onExit&&(i.inExitHandler=!0,o._onExit.call(this,t),i.inExitHandler=!1),o&&o._child&&o._child.instance&&this.hierarchy[o._child.instance.namespace]&&this.hierarchy[o._child.instance.namespace].off(),i.targetReplayState=e,i.priorState=r,i.state=e,n&&(this.hierarchy[n.namespace]=u.listenToChild(this,n));var s=this.buildEventPayload(t,{fromState:i.priorState,action:i.currentAction,toState:e});return this.emit("transition",s),a._onEnter&&a._onEnter.call(this,t),n&&n.handle(t,"_reset"),void(i.targetReplayState===e&&this.processQueue(t,"transition"))}this.emit("invalidstate",this.buildEventPayload(t,{state:i.state,attemptedState:e}))}},deferUntilTransition:function(t,e){var n=this.ensureClientMeta(t);if(n.currentActionArgs){var i={type:"transition",untilState:e,args:n.currentActionArgs};n.inputQueue.push(i);var r=this.buildEventPayload(t,{state:n.state,queuedArgs:i});this.emit("deferred",r)}},deferAndTransition:function(t,e){this.deferUntilTransition(t,e),this.transition(t,e)},processQueue:function(e){var n=this.ensureClientMeta(e),i=t.filter(n.inputQueue,(function(t){return!t.untilState||t.untilState===n.state}));n.inputQueue=t.difference(n.inputQueue,i),t.each(i,(function(t){this.handle.apply(this,[e].concat(t.args))}),this)},clearQueue:function(e,n){var i=this.ensureClientMeta(e);i.inputQueue=n?t.filter(i.inputQueue,(function(t){return!n||t.untilState!==n})):[]},compositeState:function(t){var e=this.ensureClientMeta(t).state,n=this.states[e]._child&&this.states[e]._child.instance;return n&&(e+="."+n.compositeState(t)),e}},c),h.extend=function(e,n){var r,o=this,a={},s=function(){};return r=e&&e.hasOwnProperty("constructor")?e.constructor:function(){var e,n=i.call(arguments,0);n[0]=n[0]||{};var r=n[0].states||{};(e=t.merge(t.cloneDeep(a),{states:r})).initialState=n[0].initialState||this.initialState,t.extend(n[0],e),o.apply(this,n)},t.merge(r,o),s.prototype=o.prototype,r.prototype=new s,e&&(t.extend(r.prototype,e),t.merge(a,t.transform(e,(function(t,e,n){-1!==l.indexOf(n)&&(t[n]=e)})))),n&&t.merge(r,n),r.prototype.constructor=r,r.__super__=o.prototype,r};var d={constructor:function(){h.apply(this,arguments),this.ensureClientMeta()},initClient:function(){var t=this.initialState;if(!t)throw new Error("You must specify an initial state for this FSM");if(!this.states[t])throw new Error("The initial state specified does not exist in the states object.");this.transition(t)},ensureClientMeta:function(){return this._stamped||(this._stamped=!0,t.defaults(this,t.cloneDeep(o())),this.initClient()),this},ensureClientArg:function(t){var e=t;return"object"!=typeof e[0]||"inputType"in e[0]||e[0]===this?("object"!=typeof e[0]||"object"==typeof e[0]&&"inputType"in e[0])&&e.unshift(this):e.splice(0,1,this),e},getHandlerArgs:function(t,e){var n=t,i=n[1];return"object"==typeof inputType&&n.splice(1,1,i.inputType),e?n.slice(1):n.slice(2)},buildEventPayload:function(){var e=this.ensureClientArg(u.getLeaklessArgs(arguments)),n=e[1];return t.isPlainObject(n)?t.extend(n,{namespace:this.namespace}):{data:n||null,namespace:this.namespace}}};t.each(["handle","transition","deferUntilTransition","processQueue","clearQueue"],(function(t){d[t]=function(){var e=this.ensureClientArg(u.getLeaklessArgs(arguments));return h.prototype[t].apply(this,e)}})),d=h.extend(d);var p=t.merge(c,{Fsm:d,BehavioralFsm:h,utils:u,eventListeners:{newFsm:[]}});return p},"object"==typeof e&&e.exports?e.exports=r(t("lodash")):i.machina=r(i._)},{lodash:6}],6:[function(t,e,n){e.exports=t(4)},{}],7:[function(t,e,n){"use strict";var i=t("./rsvp/promise").default,r=t("./rsvp/events").default,o=t("./rsvp/node").default,a=t("./rsvp/all").default,s=t("./rsvp/all-settled").default,l=t("./rsvp/race").default,u=t("./rsvp/hash").default,c=t("./rsvp/hash-settled").default,h=t("./rsvp/rethrow").default,d=t("./rsvp/defer").default,p=t("./rsvp/config").config,f=t("./rsvp/config").configure,m=t("./rsvp/map").default,g=t("./rsvp/resolve").default,v=t("./rsvp/reject").default,y=t("./rsvp/filter").default,b=t("./rsvp/asap").default;function _(){p.on.apply(p,arguments)}if(p.async=b,"undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var x=window.__PROMISE_INSTRUMENTATION__;for(var w in f("instrument",!0),x)x.hasOwnProperty(w)&&_(w,x[w])}n.Promise=i,n.EventTarget=r,n.all=a,n.allSettled=s,n.race=l,n.hash=u,n.hashSettled=c,n.rethrow=h,n.defer=d,n.denodeify=o,n.configure=f,n.on=_,n.off=function(){p.off.apply(p,arguments)},n.resolve=g,n.reject=v,n.async=function(t,e){p.async(t,e)},n.map=m,n.filter=y},{"./rsvp/all":10,"./rsvp/all-settled":9,"./rsvp/asap":11,"./rsvp/config":12,"./rsvp/defer":13,"./rsvp/events":15,"./rsvp/filter":16,"./rsvp/hash":18,"./rsvp/hash-settled":17,"./rsvp/map":20,"./rsvp/node":21,"./rsvp/promise":23,"./rsvp/race":29,"./rsvp/reject":30,"./rsvp/resolve":31,"./rsvp/rethrow":32}],8:[function(t,e,n){"use strict";var i=t("./utils").objectOrFunction,r=t("./utils").isFunction,o=(t("./utils").now,t("./instrument").default),a=t("./config").config,s=new m;function l(t,e){if(e instanceof t.constructor)!function(t,e){t._onerror=null,1===e._state?h(t,e._result):2===t._state?d(t,e._result):p(e,void 0,(function(n){e!==n?u(t,n):h(t,n)}),(function(e){d(t,e)}))}(t,e);else{var n=function(t){try{return t.then}catch(t){return s.error=t,s}}(e);n===s?d(t,s.error):void 0===n?h(t,e):r(n)?function(t,e,n){a.async((function(t){var i=!1,r=function(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}(n,e,(function(n){i||(i=!0,e!==n?u(t,n):h(t,n))}),(function(e){i||(i=!0,d(t,e))}),t._label);!i&&r&&(i=!0,d(t,r))}),t)}(t,e,n):h(t,e)}}function u(t,e){t===e?h(t,e):i(e)?l(t,e):h(t,e)}function c(t){t._onerror&&t._onerror(t._result),f(t)}function h(t,e){void 0===t._state&&(t._result=e,t._state=1,0===t._subscribers.length?a.instrument&&o("fulfilled",t):a.async(f,t))}function d(t,e){void 0===t._state&&(t._state=2,t._result=e,a.async(c,t))}function p(t,e,n,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+1]=n,r[o+2]=i,0===o&&t._state&&a.async(f,t)}function f(t){var e=t._subscribers,n=t._state;if(a.instrument&&o(1===n?"fulfilled":"rejected",t),0!==e.length){for(var i,r,s=t._result,l=0;l<e.length;l+=3)i=e[l],r=e[l+n],i?v(n,i,r,s):r(s);t._subscribers.length=0}}function m(){this.error=null}var g=new m;function v(t,e,n,i){var o,a,s,l,c=r(n);if(c){if((o=function(t,e){try{return t(e)}catch(t){return g.error=t,g}}(n,i))===g?(l=!0,a=o.error,o=null):s=!0,e===o)return void d(e,new TypeError("A promises callback cannot return that same promise."))}else o=i,s=!0;void 0!==e._state||(c&&s?u(e,o):l?d(e,a):1===t?h(e,o):2===t&&d(e,o))}n.noop=function(){},n.resolve=u,n.reject=d,n.fulfill=h,n.subscribe=p,n.publish=f,n.publishRejection=c,n.initializePromise=function(t,e){try{e((function(e){u(t,e)}),(function(e){d(t,e)}))}catch(e){d(t,e)}},n.invokeCallback=v,n.FULFILLED=1,n.REJECTED=2},{"./config":12,"./instrument":19,"./utils":33}],9:[function(t,e,n){"use strict";var i=t("./enumerator").default,r=t("./enumerator").makeSettledResult,o=t("./promise").default,a=t("./utils").o_create;function s(t,e,n){this._superConstructor(t,e,!1,n)}s.prototype=a(i.prototype),s.prototype._superConstructor=i,s.prototype._makeResult=r,s.prototype._validationError=function(){return new Error("allSettled must be called with an array")},n.default=function(t,e){return new s(o,t,e).promise}},{"./enumerator":14,"./promise":23,"./utils":33}],10:[function(t,e,n){"use strict";var i=t("./promise").default;n.default=function(t,e){return i.all(t,e)}},{"./promise":23}],11:[function(t,e,n){var i=t("__browserify_process"),r=0;n.default=function(t,e){p[r]=t,p[r+1]=e,2===(r+=2)&&o()};var o,a,s,l,u,c="undefined"!=typeof window?window:{},h=c.MutationObserver||c.WebKitMutationObserver,d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,p=new Array(1e3);function f(){for(var t=0;t<r;t+=2)(0,p[t])(p[t+1]),p[t]=void 0,p[t+1]=void 0;r=0}void 0!==i&&"[object process]"==={}.toString.call(i)?o=function(){i.nextTick(f)}:h?(s=0,l=new h(f),u=document.createTextNode(""),l.observe(u,{characterData:!0}),o=function(){u.data=s=++s%2}):d?((a=new MessageChannel).port1.onmessage=f,o=function(){a.port2.postMessage(0)}):o=function(){setTimeout(f,1)}},{__browserify_process:2}],12:[function(t,e,n){"use strict";var i=t("./events").default,r={instrument:!1};i.mixin(r),n.config=r,n.configure=function(t,e){if("onerror"!==t)return 2!==arguments.length?r[t]:void(r[t]=e);r.on("error",e)}},{"./events":15}],13:[function(t,e,n){"use strict";var i=t("./promise").default;n.default=function(t){var e={};return e.promise=new i((function(t,n){e.resolve=t,e.reject=n}),t),e}},{"./promise":23}],14:[function(t,e,n){"use strict";var i=t("./utils").isArray,r=t("./utils").isMaybeThenable,o=t("./-internal").noop,a=t("./-internal").reject,s=t("./-internal").fulfill,l=t("./-internal").subscribe,u=t("./-internal").FULFILLED,c=t("./-internal").REJECTED,h=t("./-internal").PENDING;function d(t,e,n,i){this._instanceConstructor=t,this.promise=new t(o,i),this._abortOnReject=n,this._validateInput(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._init(),0===this.length?s(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&s(this.promise,this._result))):a(this.promise,this._validationError())}n.ABORT_ON_REJECTION=!0,n.makeSettledResult=function(t,e,n){return t===u?{state:"fulfilled",value:n}:{state:"rejected",reason:n}},d.prototype._validateInput=function(t){return i(t)},d.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},d.prototype._init=function(){this._result=new Array(this.length)},n.default=d,d.prototype._enumerate=function(){for(var t=this.length,e=this.promise,n=this._input,i=0;e._state===h&&i<t;i++)this._eachEntry(n[i],i)},d.prototype._eachEntry=function(t,e){var n=this._instanceConstructor;r(t)?t.constructor===n&&t._state!==h?(t._onerror=null,this._settledAt(t._state,e,t._result)):this._willSettleAt(n.resolve(t),e):(this._remaining--,this._result[e]=this._makeResult(u,e,t))},d.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===h&&(this._remaining--,this._abortOnReject&&t===c?a(i,n):this._result[e]=this._makeResult(t,e,n)),0===this._remaining&&s(i,this._result)},d.prototype._makeResult=function(t,e,n){return n},d.prototype._willSettleAt=function(t,e){var n=this;l(t,void 0,(function(t){n._settledAt(u,e,t)}),(function(t){n._settledAt(c,e,t)}))}},{"./-internal":8,"./utils":33}],15:[function(t,e,n){"use strict";function i(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1}function r(t){var e=t._promiseCallbacks;return e||(e=t._promiseCallbacks={}),e}n.default={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,e){var n,o=r(this);(n=o[t])||(n=o[t]=[]),-1===i(n,e)&&n.push(e)},off:function(t,e){var n,o,a=r(this);e?-1!==(o=i(n=a[t],e))&&n.splice(o,1):a[t]=[]},trigger:function(t,e){var n;if(n=r(this)[t])for(var i=0;i<n.length;i++)(0,n[i])(e)}}},{}],16:[function(t,e,n){"use strict";var i=t("./promise").default,r=t("./utils").isFunction;t("./utils").isMaybeThenable,n.default=function(t,e,n){return i.all(t,n).then((function(t){if(!r(e))throw new TypeError("You must pass a function as filter's second argument.");for(var o=t.length,a=new Array(o),s=0;s<o;s++)a[s]=e(t[s]);return i.all(a,n).then((function(e){for(var n=new Array(o),i=0,r=0;r<o;r++)e[r]&&(n[i]=t[r],i++);return n.length=i,n}))}))}},{"./promise":23,"./utils":33}],17:[function(t,e,n){"use strict";var i=t("./promise").default,r=t("./enumerator").makeSettledResult,o=t("./promise-hash").default,a=t("./enumerator").default,s=t("./utils").o_create;function l(t,e,n){this._superConstructor(t,e,!1,n)}l.prototype=s(o.prototype),l.prototype._superConstructor=a,l.prototype._makeResult=r,l.prototype._validationError=function(){return new Error("hashSettled must be called with an object")},n.default=function(t,e){return new l(i,t,e).promise}},{"./enumerator":14,"./promise":23,"./promise-hash":22,"./utils":33}],18:[function(t,e,n){"use strict";var i=t("./promise").default,r=t("./promise-hash").default;t("./enumerator").ABORT_ON_REJECTION,n.default=function(t,e){return new r(i,t,e).promise}},{"./enumerator":14,"./promise":23,"./promise-hash":22}],19:[function(t,e,n){"use strict";var i=t("./config").config,r=t("./utils").now,o=[];n.default=function(t,e,n){1===o.push({name:t,payload:{guid:e._guidKey+e._id,eventName:t,detail:e._result,childGuid:n&&e._guidKey+n._id,label:e._label,timeStamp:r(),stack:new Error(e._label).stack}})&&setTimeout((function(){for(var t,e=0;e<o.length;e++)t=o[e],i.trigger(t.name,t.payload);o.length=0}),50)}},{"./config":12,"./utils":33}],20:[function(t,e,n){"use strict";var i=t("./promise").default,r=(t("./utils").isArray,t("./utils").isFunction);n.default=function(t,e,n){return i.all(t,n).then((function(t){if(!r(e))throw new TypeError("You must pass a function as map's second argument.");for(var o=t.length,a=new Array(o),s=0;s<o;s++)a[s]=e(t[s]);return i.all(a,n)}))}},{"./promise":23,"./utils":33}],21:[function(t,e,n){"use strict";var i=t("./promise").default,r=t("./utils").isArray;n.default=function(t,e){var n=!0===e,o=r(e);function a(){for(var r,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return n||o||!e?r=this:("object"==typeof console&&console.warn('Deprecation: RSVP.denodeify() doesn\'t allow setting the "this" binding anymore. Use yourFunction.bind(yourThis) instead.'),r=e),i.all(s).then((function(a){return new i((function(i,s){a.push((function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var l=r[0],u=r[1];if(l)s(l);else if(n)i(r.slice(1));else if(o){var c,h={},d=r.slice(1);for(c=0;c<e.length;c++)h[e[c]]=d[c];i(h)}else i(u)})),t.apply(r,a)}))}))}return a.__proto__=t,a}},{"./promise":23,"./utils":33}],22:[function(t,e,n){"use strict";var i=t("./enumerator").default,r=t("./-internal").PENDING,o=(t("./-internal").FULFILLED,t("./utils").o_create);function a(t,e,n){this._superConstructor(t,e,!0,n)}n.default=a,a.prototype=o(i.prototype),a.prototype._superConstructor=i,a.prototype._init=function(){this._result={}},a.prototype._validateInput=function(t){return t&&"object"==typeof t},a.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},a.prototype._enumerate=function(){var t=this.promise,e=this._input,n=[];for(var i in e)t._state===r&&e.hasOwnProperty(i)&&n.push({position:i,entry:e[i]});var o,a=n.length;this._remaining=a;for(var s=0;t._state===r&&s<a;s++)o=n[s],this._eachEntry(o.entry,o.position)}},{"./-internal":8,"./enumerator":14,"./utils":33}],23:[function(t,e,n){"use strict";var i=t("./config").config,r=(t("./events").default,t("./instrument").default),o=(t("./utils").objectOrFunction,t("./utils").isFunction),a=t("./utils").now,s=t("./-internal").noop,l=(t("./-internal").resolve,t("./-internal").reject,t("./-internal").fulfill,t("./-internal").subscribe),u=t("./-internal").initializePromise,c=t("./-internal").invokeCallback,h=t("./-internal").FULFILLED,d=t("./-internal").REJECTED,p=t("./promise/cast").default,f=t("./promise/all").default,m=t("./promise/race").default,g=t("./promise/resolve").default,v=t("./promise/reject").default,y="rsvp_"+a()+"-",b=0;function _(t,e){this._id=b++,this._label=e,this._subscribers=[],i.instrument&&r("created",this),s!==t&&(o(t)||function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof _||function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),u(this,t))}n.default=_,_.cast=p,_.all=f,_.race=m,_.resolve=g,_.reject=v,_.prototype={constructor:_,_id:void 0,_guidKey:y,_label:void 0,_state:void 0,_result:void 0,_subscribers:void 0,_onerror:function(t){i.trigger("error",t)},then:function(t,e,n){var o=this,a=o._state;if(a===h&&!t||a===d&&!e)return i.instrument&&r("chained",this,this),this;o._onerror=null;var u=new this.constructor(s,n),p=o._result;if(i.instrument&&r("chained",o,u),a){var f=arguments[a-1];i.async((function(){c(a,u,f,p)}))}else l(o,u,t,e);return u},catch:function(t,e){return this.then(null,t,e)},finally:function(t,e){var n=this.constructor;return this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))}),e)}}},{"./-internal":8,"./config":12,"./events":15,"./instrument":19,"./promise/all":24,"./promise/cast":25,"./promise/race":26,"./promise/reject":27,"./promise/resolve":28,"./utils":33}],24:[function(t,e,n){"use strict";var i=t("../enumerator").default;n.default=function(t,e){return new i(this,t,!0,e).promise}},{"../enumerator":14}],25:[function(t,e,n){"use strict";var i=t("./resolve").default;n.default=i},{"./resolve":28}],26:[function(t,e,n){"use strict";var i=t("../utils").isArray,r=(t("../utils").isFunction,t("../utils").isMaybeThenable,t("../-internal").noop),o=t("../-internal").resolve,a=t("../-internal").reject,s=t("../-internal").subscribe,l=t("../-internal").PENDING;n.default=function(t,e){var n=new this(r,e);if(!i(t))return a(n,new TypeError("You must pass an array to race.")),n;var u=t.length;function c(t){o(n,t)}function h(t){a(n,t)}for(var d=0;n._state===l&&d<u;d++)s(this.resolve(t[d]),void 0,c,h);return n}},{"../-internal":8,"../utils":33}],27:[function(t,e,n){"use strict";var i=t("../-internal").noop,r=t("../-internal").reject;n.default=function(t,e){var n=new this(i,e);return r(n,t),n}},{"../-internal":8}],28:[function(t,e,n){"use strict";var i=t("../-internal").noop,r=t("../-internal").resolve;n.default=function(t,e){if(t&&"object"==typeof t&&t.constructor===this)return t;var n=new this(i,e);return r(n,t),n}},{"../-internal":8}],29:[function(t,e,n){"use strict";var i=t("./promise").default;n.default=function(t,e){return i.race(t,e)}},{"./promise":23}],30:[function(t,e,n){"use strict";var i=t("./promise").default;n.default=function(t,e){return i.reject(t,e)}},{"./promise":23}],31:[function(t,e,n){"use strict";var i=t("./promise").default;n.default=function(t,e){return i.resolve(t,e)}},{"./promise":23}],32:[function(t,e,n){"use strict";n.default=function(t){throw setTimeout((function(){throw t})),t}},{}],33:[function(t,e,n){"use strict";n.objectOrFunction=function(t){return"function"==typeof t||"object"==typeof t&&null!==t},n.isFunction=function(t){return"function"==typeof t},n.isMaybeThenable=function(t){return"object"==typeof t&&null!==t};var i=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};n.isArray=i;var r=Date.now||function(){return(new Date).getTime()};n.now=r;var o=Object.create||function(t){var e=function(){};return e.prototype=t,e};n.o_create=o},{}]},{},[1])(1)},8:function(t,e,n){t.exports=function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=n[a]={exports:{}};e[a][0].call(l.exports,(function(t){var n=e[a][1][t];return r(n||t)}),l,l.exports,t,e,n,i)}return n[a].exports}for(var o=!1,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){"use strict";var i,r,o,a,s,l=t("rsvp"),u=new(0,t("eventemitter2").EventEmitter2)({wildcard:!0}),c="",h=!1;function d(t,e){var n=c+e,i=new XMLHttpRequest;if("withCredentials"in i)i.open(t,n,!0),i.responseType="json",i.setRequestHeader("Accept","application/json");else{if("undefined"==typeof XDomainRequest)return null;(i=new XDomainRequest).open(t,n)}return i}var p=0,f=!1,m=!1,g=!0;function v(){u.emit("connectionTimedOut"),f=!1}var y,b={start:function(){this.timerId=setTimeout(v,1e4)},reset:function(){this.stop(),this.start()},stop:function(){clearTimeout(this.timerId)}};function _(){var t=d("GET","/status");t?(t.onerror=x,t.onload=w,t.send()):x()}function x(){u.emit("statusErrored")}function w(){var t=this.response||JSON.parse(this.responseText);if("string"==typeof t&&(t=JSON.parse(t)),h&&!(t.requestTimeStamp<p)){if(s){if(s!==t.sessionID)return void(a||(u.emit("sessionChanged"),a=!0))}else s=t.sessionID,i=[],r=Object.create(null),o=Object.create(null),a=!1;var e,n,l;p=t.requestTimeStamp,b.reset(),e=t.sets,Object.keys(e).forEach((function(t){r[t]||(u.emit("datasetAdded",t),r[t]={columns:[],id:t},i.unshift(r[t])),r[t].columns.length=e[t].colIDs.length})),i.sort((function(t,e){return e.setId-t.setId})),n=t.columns,l=[],Object.keys(n).forEach((function(t){var e=n[t],i=r[e.setID],a=o[t];a?a!==i.columns[e.position]&&l.push(["columnMoved",t]):(l.push(["columnAdded",t]),a=o[t]={id:null,units:null,receivedValuesTimeStamp:0,requestedValuesTimeStamp:0,liveValueTimeStamp:0,liveValue:null,data:[]}),i.columns[e.position]=a,null!==a.units&&a.units!==e.units&&l.push(["columnTypeChanged",t]),a.units=e.units,a.id=t,a.liveValue=parseFloat(e.liveValue||0),a.liveValueTimeStamp=e.liveValueTimeStamp,a.requestedValuesTimeStamp<e.valuesTimeStamp&&(function(t,e){var n=d("GET","/columns/"+t);n.send(),n.onload=function(){if(h){var n=this.response||JSON.parse(this.responseText);"string"==typeof n&&(n=JSON.parse(n));var i=n.values,r=o[t];e>r.receivedValuesTimeStamp&&(r.data.length=0,[].push.apply(r.data,i),r.receivedValuesTimeStamp=e,u.emit("data",t))}}}(t,e.valuesTimeStamp),a.requestedValuesTimeStamp=e.valuesTimeStamp)})),Object.keys(o).forEach((function(t){n[t]||(l.push(["columnRemoved",t]),delete o[t])})),l.forEach((function(t){u.emit(t[0],t[1])})),f=!0,u.emit("statusReceived"),m&&!t.collection.isCollecting?(m=!1,u.emit("collectionStopped")):!m&&t.collection.isCollecting&&(m=!0,u.emit("collectionStarted")),g&&!t.collection.canControl?(g=!1,u.emit("controlDisabled")):!g&&t.collection.canControl&&(g=!0,u.emit("controlEnabled"))}}function C(t){return function(){return new l.Promise((function(e,n){var i=d("GET",t);i||n(new Error("This browser does not appear to support Cross-Origin Resource Sharing")),i.send(),i.onerror=function(){n(this)},i.onload=e}))}}e.exports={startPolling:function(t){c="http://"+t,_(),h=!0,f=!1,b.start(),y=setInterval(_,500)},stopPolling:function(){b.stop(),clearInterval(y),s=void 0,h=!1},requestStart:C("/control/start"),requestStop:C("/control/stop"),on:function(){u.on.apply(u,arguments)},off:function(){u.off.apply(u,arguments)},get datasets(){return i},get isConnected(){return h&&f},get isCollecting(){return h&&f&&m},get canControl(){return g}}},{eventemitter2:3,rsvp:4}],2:[function(t,e,n){var i=e.exports={};i.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",(function(t){var e=t.source;e!==window&&null!==e||"process-tick"!==t.data||(t.stopPropagation(),n.length>0&&n.shift()())}),!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],3:[function(t,e,n){var i=t("__browserify_process");!function(t,e){var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(){this._events={},this._conf&&r.call(this,this._conf)}function r(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners&&(this._events.maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this.newListener=t.newListener),this.wildcard&&(this.listenerTree={}))}function o(t){this._events={},this.newListener=!1,r.call(this,t)}function a(t,e,n,i){if(!n)return[];var r,o,s,l,u,c,h,d=[],p=e.length,f=e[i],m=e[i+1];if(i===p&&n._listeners){if("function"==typeof n._listeners)return t&&t.push(n._listeners),[n];for(r=0,o=n._listeners.length;r<o;r++)t&&t.push(n._listeners[r]);return[n]}if("*"===f||"**"===f||n[f]){if("*"===f){for(s in n)"_listeners"!==s&&n.hasOwnProperty(s)&&(d=d.concat(a(t,e,n[s],i+1)));return d}if("**"===f){for(s in(h=i+1===p||i+2===p&&"*"===m)&&n._listeners&&(d=d.concat(a(t,e,n,p))),n)"_listeners"!==s&&n.hasOwnProperty(s)&&("*"===s||"**"===s?(n[s]._listeners&&!h&&(d=d.concat(a(t,e,n[s],p))),d=d.concat(a(t,e,n[s],i))):d=s===m?d.concat(a(t,e,n[s],i+2)):d.concat(a(t,e,n[s],i)));return d}d=d.concat(a(t,e,n[f],i+1))}if((l=n["*"])&&a(t,e,l,i+1),u=n["**"])if(i<p)for(s in u._listeners&&a(t,e,u,p),u)"_listeners"!==s&&u.hasOwnProperty(s)&&(s===m?a(t,e,u[s],i+2):s===f?a(t,e,u[s],i+1):((c={})[s]=u[s],a(t,e,{"**":c},i+1)));else u._listeners?a(t,e,u,p):u["*"]&&u["*"]._listeners&&a(t,e,u["*"],p);return d}function s(t,e){for(var i=0,r=(t="string"==typeof t?t.split(this.delimiter):t.slice()).length;i+1<r;i++)if("**"===t[i]&&"**"===t[i+1])return;for(var o=this.listenerTree,a=t.shift();a;){if(o[a]||(o[a]={}),o=o[a],0===t.length){if(o._listeners){if("function"==typeof o._listeners)o._listeners=[o._listeners,e];else if(n(o._listeners)&&(o._listeners.push(e),!o._listeners.warned)){var s=10;void 0!==this._events.maxListeners&&(s=this._events.maxListeners),s>0&&o._listeners.length>s&&(o._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",o._listeners.length),console.trace())}}else o._listeners=e;return!0}a=t.shift()}return!0}o.prototype.delimiter=".",o.prototype.setMaxListeners=function(t){this._events||i.call(this),this._events.maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t},o.prototype.event="",o.prototype.once=function(t,e){return this.many(t,1,e),this},o.prototype.many=function(t,e,n){var i=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function r(){0==--e&&i.off(t,r),n.apply(this,arguments)}return r._origin=n,this.on(t,r),i},o.prototype.emit=function(){this._events||i.call(this);var t,e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var n=arguments.length,r=new Array(n-1),o=1;o<n;o++)r[o-1]=arguments[o];for(o=0,n=this._all.length;o<n;o++)this.event=e,this._all[o].apply(this,r)}if("error"===e&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(this.wildcard){t=[];var s="string"==typeof e?e.split(this.delimiter):e.slice();a.call(this,t,s,this.listenerTree,0)}else t=this._events[e];if("function"==typeof t){if(this.event=e,1===arguments.length)t.call(this);else if(arguments.length>1)switch(arguments.length){case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,r=new Array(n-1),o=1;o<n;o++)r[o-1]=arguments[o];t.apply(this,r)}return!0}if(t){for(n=arguments.length,r=new Array(n-1),o=1;o<n;o++)r[o-1]=arguments[o];var l=t.slice();for(o=0,n=l.length;o<n;o++)this.event=e,l[o].apply(this,r);return l.length>0||this._all}return this._all},o.prototype.on=function(t,e){if("function"==typeof t)return this.onAny(t),this;if("function"!=typeof e)throw new Error("on only accepts instances of Function");if(this._events||i.call(this),this.emit("newListener",t,e),this.wildcard)return s.call(this,t,e),this;if(this._events[t]){if("function"==typeof this._events[t])this._events[t]=[this._events[t],e];else if(n(this._events[t])&&(this._events[t].push(e),!this._events[t].warned)){var r=10;void 0!==this._events.maxListeners&&(r=this._events.maxListeners),r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}}else this._events[t]=e;return this},o.prototype.onAny=function(t){if(this._all||(this._all=[]),"function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all.push(t),this},o.prototype.addListener=o.prototype.on,o.prototype.off=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");var i,r=[];if(this.wildcard){var o="string"==typeof t?t.split(this.delimiter):t.slice();r=a.call(this,null,o,this.listenerTree,0)}else{if(!this._events[t])return this;i=this._events[t],r.push({_listeners:i})}for(var s=0;s<r.length;s++){var l=r[s];if(i=l._listeners,n(i)){for(var u=-1,c=0,h=i.length;c<h;c++)if(i[c]===e||i[c].listener&&i[c].listener===e||i[c]._origin&&i[c]._origin===e){u=c;break}if(u<0)continue;return this.wildcard?l._listeners.splice(u,1):this._events[t].splice(u,1),0===i.length&&(this.wildcard?delete l._listeners:delete this._events[t]),this}(i===e||i.listener&&i.listener===e||i._origin&&i._origin===e)&&(this.wildcard?delete l._listeners:delete this._events[t])}return this},o.prototype.offAny=function(t){var e,n=0,i=0;if(t&&this._all&&this._all.length>0){for(n=0,i=(e=this._all).length;n<i;n++)if(t===e[n])return e.splice(n,1),this}else this._all=[];return this},o.prototype.removeListener=o.prototype.off,o.prototype.removeAllListeners=function(t){if(0===arguments.length)return!this._events||i.call(this),this;if(this.wildcard)for(var e="string"==typeof t?t.split(this.delimiter):t.slice(),n=a.call(this,null,e,this.listenerTree,0),r=0;r<n.length;r++){var o=n[r];o._listeners=null}else{if(!this._events[t])return this;this._events[t]=null}return this},o.prototype.listeners=function(t){if(this.wildcard){var e=[],r="string"==typeof t?t.split(this.delimiter):t.slice();return a.call(this,e,r,this.listenerTree,0),e}return this._events||i.call(this),this._events[t]||(this._events[t]=[]),n(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},o.prototype.listenersAny=function(){return this._all?this._all:[]},t.EventEmitter2=o}(void 0!==i&&void 0!==i.title&&void 0!==n?n:window)},{__browserify_process:2}],4:[function(t,e,n){"use strict";var i=t("./rsvp/promise").default,r=t("./rsvp/events").default,o=t("./rsvp/node").default,a=t("./rsvp/all").default,s=t("./rsvp/all-settled").default,l=t("./rsvp/race").default,u=t("./rsvp/hash").default,c=t("./rsvp/hash-settled").default,h=t("./rsvp/rethrow").default,d=t("./rsvp/defer").default,p=t("./rsvp/config").config,f=t("./rsvp/config").configure,m=t("./rsvp/map").default,g=t("./rsvp/resolve").default,v=t("./rsvp/reject").default,y=t("./rsvp/filter").default,b=t("./rsvp/asap").default;function _(){p.on.apply(p,arguments)}if(p.async=b,"undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var x=window.__PROMISE_INSTRUMENTATION__;for(var w in f("instrument",!0),x)x.hasOwnProperty(w)&&_(w,x[w])}n.Promise=i,n.EventTarget=r,n.all=a,n.allSettled=s,n.race=l,n.hash=u,n.hashSettled=c,n.rethrow=h,n.defer=d,n.denodeify=o,n.configure=f,n.on=_,n.off=function(){p.off.apply(p,arguments)},n.resolve=g,n.reject=v,n.async=function(t,e){p.async(t,e)},n.map=m,n.filter=y},{"./rsvp/all":6,"./rsvp/all-settled":5,"./rsvp/asap":7,"./rsvp/config":8,"./rsvp/defer":9,"./rsvp/events":10,"./rsvp/filter":11,"./rsvp/hash":13,"./rsvp/hash-settled":12,"./rsvp/map":15,"./rsvp/node":16,"./rsvp/promise":17,"./rsvp/race":23,"./rsvp/reject":24,"./rsvp/resolve":25,"./rsvp/rethrow":26}],5:[function(t,e,n){"use strict";var i=t("./promise").default,r=t("./utils").isArray,o=t("./utils").isNonThenable;function a(t){return{state:"fulfilled",value:t}}n.default=function(t,e){return new i((function(e,n){if(!r(t))throw new TypeError("You must pass an array to allSettled.");var s,l=t.length;if(0!==l)for(var u=new Array(l),c=0;c<t.length;c++)s=t[c],o(s)?p(c,a(s)):i.resolve(s).then(h(c),d(c));else e([]);function h(t){return function(e){p(t,a(e))}}function d(t){return function(e){p(t,function(t){return{state:"rejected",reason:t}}(e))}}function p(t,n){u[t]=n,0==--l&&e(u)}}),e)}},{"./promise":17,"./utils":27}],6:[function(t,e,n){"use strict";var i=t("./promise").default;n.default=function(t,e){return i.all(t,e)}},{"./promise":17}],7:[function(t,e,n){var i=t("__browserify_process");n.default=function(t,e){1===c.push([t,e])&&r()};var r,o,a,s,l="undefined"!=typeof window?window:{},u=l.MutationObserver||l.WebKitMutationObserver,c=[];function h(){for(var t=0;t<c.length;t++){var e=c[t];(0,e[0])(e[1])}c.length=0}void 0!==i&&"[object process]"==={}.toString.call(i)?r=function(){i.nextTick(h)}:u?(o=0,a=new u(h),s=document.createTextNode(""),a.observe(s,{characterData:!0}),r=function(){s.data=o=++o%2}):r=function(){setTimeout(h,1)}},{__browserify_process:2}],8:[function(t,e,n){"use strict";var i=t("./events").default,r={instrument:!1};i.mixin(r),n.config=r,n.configure=function(t,e){if("onerror"!==t)return 2!==arguments.length?r[t]:void(r[t]=e);r.on("error",e)}},{"./events":10}],9:[function(t,e,n){"use strict";var i=t("./promise").default;n.default=function(t){var e={};return e.promise=new i((function(t,n){e.resolve=t,e.reject=n}),t),e}},{"./promise":17}],10:[function(t,e,n){"use strict";function i(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1}function r(t){var e=t._promiseCallbacks;return e||(e=t._promiseCallbacks={}),e}n.default={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,e){var n,o=r(this);(n=o[t])||(n=o[t]=[]),-1===i(n,e)&&n.push(e)},off:function(t,e){var n,o,a=r(this);e?-1!==(o=i(n=a[t],e))&&n.splice(o,1):a[t]=[]},trigger:function(t,e){var n;if(n=r(this)[t])for(var i=0;i<n.length;i++)(0,n[i])(e)}}},{}],11:[function(t,e,n){"use strict";var i=t("./promise").default,r=t("./utils").isFunction;n.default=function(t,e,n){return i.all(t,n).then((function(t){if(!r(e))throw new TypeError("You must pass a function as filter's second argument.");for(var o=t.length,a=new Array(o),s=0;s<o;s++)a[s]=e(t[s]);return i.all(a,n).then((function(e){for(var n=new Array(o),i=0,r=0;r<o;r++)!0===e[r]&&(n[i]=t[r],i++);return n.length=i,n}))}))}},{"./promise":17,"./utils":27}],12:[function(t,e,n){"use strict";var i=t("./promise").default,r=t("./utils").isNonThenable,o=t("./utils").keysOf;function a(t){return{state:"fulfilled",value:t}}n.default=function(t,e){return new i((function(e,n){var s,l,u={},c=o(t),h=c.length;if(0!==h)for(var d=0;d<c.length;d++)l=c[d],s=t[l],r(s)?m(l,a(s)):i.resolve(s).then(p(l),f(l));else e(u);function p(t){return function(e){m(t,a(e))}}function f(t){return function(e){m(t,function(t){return{state:"rejected",reason:t}}(e))}}function m(t,n){u[t]=n,0==--h&&e(u)}}))}},{"./promise":17,"./utils":27}],13:[function(t,e,n){"use strict";var i=t("./promise").default,r=t("./utils").isNonThenable,o=t("./utils").keysOf;n.default=function(t,e){return new i((function(e,n){var a,s,l={},u=o(t),c=u.length;if(0!==c)for(var h=0;h<u.length;h++)s=u[h],a=t[s],r(a)?(l[s]=a,0==--c&&e(l)):i.resolve(a).then(d(s),p);else e(l);function d(t){return function(n){l[t]=n,0==--c&&e(l)}}function p(t){c=0,n(t)}}))}},{"./promise":17,"./utils":27}],14:[function(t,e,n){"use strict";var i=t("./config").config,r=t("./utils").now;n.default=function(t,e,n){try{i.trigger(t,{guid:e._guidKey+e._id,eventName:t,detail:e._detail,childGuid:n&&e._guidKey+n._id,label:e._label,timeStamp:r(),stack:new Error(e._label).stack})}catch(t){setTimeout((function(){throw t}),0)}}},{"./config":8,"./utils":27}],15:[function(t,e,n){"use strict";var i=t("./promise").default,r=(t("./utils").isArray,t("./utils").isFunction);n.default=function(t,e,n){return i.all(t,n).then((function(t){if(!r(e))throw new TypeError("You must pass a function as map's second argument.");for(var o=t.length,a=new Array(o),s=0;s<o;s++)a[s]=e(t[s]);return i.all(a,n)}))}},{"./promise":17,"./utils":27}],16:[function(t,e,n){"use strict";var i=t("./promise").default,r=t("./utils").isArray;n.default=function(t,e){var n=!0===e,o=r(e);function a(){for(var r,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return n||o||!e?r=this:(console.warn('Deprecation: RSVP.denodeify() doesn\'t allow setting the "this" binding anymore. Use yourFunction.bind(yourThis) instead.'),r=e),i.all(s).then((function(a){return new i((function(i,s){a.push((function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var l=r[0],u=r[1];if(l)s(l);else if(n)i(r.slice(1));else if(o){var c,h={},d=r.slice(1);for(c=0;c<e.length;c++)h[e[c]]=d[c];i(h)}else i(u)})),t.apply(r,a)}))}))}return a.__proto__=t,a}},{"./promise":17,"./utils":27}],17:[function(t,e,n){"use strict";var i=t("./config").config,r=(t("./events").default,t("./instrument").default),o=t("./utils").objectOrFunction,a=t("./utils").isFunction,s=t("./utils").now,l=t("./promise/cast").default,u=t("./promise/all").default,c=t("./promise/race").default,h=t("./promise/resolve").default,d=t("./promise/reject").default,p="rsvp_"+s()+"-",f=0;function m(){}function g(t,e){if(!a(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof g))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._id=f++,this._label=e,this._subscribers=[],i.instrument&&r("created",this),m!==t&&function(t,e){function n(t){C(e,t)}try{t((function(t){x(e,t)}),n)}catch(t){n(t)}}(t,this)}function v(t,e,n,i){var r=t._subscribers,o=r.length;r[o]=e,r[o+1]=n,r[o+2]=i}function y(t,e){var n=t._subscribers,o=t._detail;i.instrument&&r(1===e?"fulfilled":"rejected",t);for(var a=0;a<n.length;a+=3)b(e,n[a],n[a+e],o);t._subscribers=null}function b(t,e,n,i){var r,o,s,l,u=a(n);if(u)try{r=n(i),s=!0}catch(t){l=!0,o=t}else r=i,s=!0;_(e,r)||(u&&s?x(e,r):l?C(e,o):1===t?x(e,r):2===t&&C(e,r))}function _(t,e){var n,i=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(o(e)&&(i=e.then,a(i)))return i.call(e,(function(i){if(n)return!0;n=!0,e!==i?x(t,i):w(t,i)}),(function(e){if(n)return!0;n=!0,C(t,e)}),"Settle: "+(t._label||" unknown promise")),!0}catch(e){return!!n||(C(t,e),!0)}return!1}function x(t,e){t===e?w(t,e):_(t,e)||w(t,e)}function w(t,e){void 0===t._state&&(t._state=0,t._detail=e,i.async(T,t))}function C(t,e){void 0===t._state&&(t._state=0,t._detail=e,i.async(S,t))}function T(t){y(t,t._state=1)}function S(t){t._onerror&&t._onerror(t._detail),y(t,t._state=2)}n.default=g,g.cast=l,g.all=u,g.race=c,g.resolve=h,g.reject=d,g.prototype={constructor:g,_id:void 0,_guidKey:p,_label:void 0,_state:void 0,_detail:void 0,_subscribers:void 0,_onerror:function(t){i.trigger("error",t)},then:function(t,e,n){var o=this;this._onerror=null;var a=new this.constructor(m,n);if(this._state){var s=arguments;i.async((function(){b(o._state,a,s[o._state-1],o._detail)}))}else v(this,a,t,e);return i.instrument&&r("chained",o,a),a},catch:function(t,e){return this.then(null,t,e)},finally:function(t,e){var n=this.constructor;return this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))}),e)}}},{"./config":8,"./events":10,"./instrument":14,"./promise/all":18,"./promise/cast":19,"./promise/race":20,"./promise/reject":21,"./promise/resolve":22,"./utils":27}],18:[function(t,e,n){"use strict";var i=t("../utils").isArray,r=t("../utils").isNonThenable;n.default=function(t,e){var n=this;return new n((function(e,o){if(!i(t))throw new TypeError("You must pass an array to all.");var a,s=t.length,l=new Array(s);if(0!==s)for(var u=0;u<t.length;u++)a=t[u],r(a)?(l[u]=a,0==--s&&e(l)):n.resolve(a).then(c(u),h);else e(l);function c(t){return function(n){l[t]=n,0==--s&&e(l)}}function h(t){s=0,o(t)}}),e)}},{"../utils":27}],19:[function(t,e,n){"use strict";n.default=function(t,e){return t&&"object"==typeof t&&t.constructor===this?t:new this((function(e){e(t)}),e)}},{}],20:[function(t,e,n){"use strict";var i=t("../utils").isArray,r=(t("../utils").isFunction,t("../utils").isNonThenable);n.default=function(t,e){var n,o=this;return new o((function(e,a){if(!i(t))throw new TypeError("You must pass an array to race.");var s=!0;function l(t){s&&(s=!1,e(t))}function u(t){s&&(s=!1,a(t))}for(var c=0;c<t.length;c++){if(n=t[c],r(n))return s=!1,void e(n);o.resolve(n).then(l,u)}}),e)}},{"../utils":27}],21:[function(t,e,n){"use strict";n.default=function(t,e){return new this((function(e,n){n(t)}),e)}},{}],22:[function(t,e,n){"use strict";n.default=function(t,e){return t&&"object"==typeof t&&t.constructor===this?t:new this((function(e){e(t)}),e)}},{}],23:[function(t,e,n){"use strict";var i=t("./promise").default;n.default=function(t,e){return i.race(t,e)}},{"./promise":17}],24:[function(t,e,n){"use strict";var i=t("./promise").default;n.default=function(t,e){return i.reject(t,e)}},{"./promise":17}],25:[function(t,e,n){"use strict";var i=t("./promise").default;n.default=function(t,e){return i.resolve(t,e)}},{"./promise":17}],26:[function(t,e,n){"use strict";n.default=function(t){throw setTimeout((function(){throw t})),t}},{}],27:[function(t,e,n){"use strict";function i(t){return"function"==typeof t||"object"==typeof t&&null!==t}n.objectOrFunction=i,n.isFunction=function(t){return"function"==typeof t},n.isNonThenable=function(t){return!i(t)};var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};n.isArray=r;var o=Date.now||function(){return(new Date).getTime()};n.now=o;var a=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};n.keysOf=a},{}]},{},[1])(1)},80:function(t,e){var n=!1;!function(){var t=0;if(window.postMessage)try{window.onmessage=function(e){var i=Object.prototype.toString.call(e.data);t=-1!=i.indexOf("Null")||-1!=i.indexOf("DOMWindow")?1:0,n={structuredClones:t}},window.postMessage(document.createElement("a"),"*")}catch(e){t=e.DATA_CLONE_ERR||"Cannot post cyclic structures."==e.message?1:0,n={structuredClones:t}}}(),e.supported=function(){return n&&n.structuredClones>0}},81:function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},82:function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},83:function(t,e,n){"use strict";n.r(e);var i=n(4),r=n(34),o=n(35),a=n(22),s=n.n(a);window.Lab=window.Lab||{},window.Lab.grapher=window.Lab.grapher||{},window.Lab.grapher.BarGraphModel=r.a,window.Lab.grapher.BarGraphView=o.a,window.Lab.grapher.Graph=s.a,window.Lab.config=i.a,e.default=window.Lab.grapher},9:function(t,e,n){t.exports=function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=n[a]={exports:{}};e[a][0].call(l.exports,(function(t){var n=e[a][1][t];return r(n||t)}),l,l.exports,t,e,n,i)}return n[a].exports}for(var o=!1,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){var i=t("./mini-class"),r=t("./sensor-applet");e.exports={GoIO:i.extendClass(r,{deviceType:"golink",deviceSpecificJars:["sensor-vernier","goio-jna"]}),LabQuest:i.extendClass(r,{deviceType:"labquest",deviceSpecificJars:["sensor-vernier","labquest-jna"]})}},{"./mini-class":4,"./sensor-applet":6}],2:[function(t,e,n){"use strict";var i=t("util");function r(t){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=t}function o(){r.apply(this,arguments)}function a(){r.apply(this,arguments)}function s(){r.apply(this,arguments)}function l(){r.apply(this,arguments)}i.inherits(o,Error),i.inherits(a,Error),i.inherits(s,Error),i.inherits(l,Error),e.exports={JavaLoadError:o,AppletInitializationError:a,AlreadyReadingError:l,SensorConnectionError:s}},{util:11}],3:[function(t,e,n){e.exports="20140417.203729"},{}],4:[function(t,e,n){"use strict";function i(t,e){var n,i={}.hasOwnProperty;for(n in e)i.call(e,n)&&(t[n]=e[n])}e.exports={defineClass:function(t){function e(t){i(this,t)}return i(e.prototype,t),e},extendClass:function(t,e){function n(t){i(this,t)}return function(t,e){function n(){this.constructor=t}i(t,e),n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(n,t),i(n.prototype,e),n},mixin:i}},{}],5:[function(t,e,n){"use strict";e.exports={on:function(t,e){this._ee_listeners||(this._ee_listeners={}),this._ee_listeners[t]||(this._ee_listeners[t]=[]),this._ee_listeners[t].push(e)},emit:function(t){var e=arguments.length>1?[].slice.call(arguments,1):[];if(this._ee_listeners&&this._ee_listeners[t])for(var n=0,i=this._ee_listeners[t].length;n<i;n++)this._ee_listeners[t][n].apply(null,e)},removeListener:function(t,e){if(this._ee_listeners&&this._ee_listeners[t])for(var n=0,i=this._ee_listeners[t].length;n<i;n++)this._ee_listeners[t][n]===e&&this._ee_listeners[t].splice(n,1)},removeListeners:function(t){t?this._ee_listeners&&(this._ee_listeners[t]=[]):this._ee_listeners={}}}},{}],6:[function(t,e,n){"use strict";var i,r=t("./mini-class"),o=t("./mini-event-emitter"),a=t("./errors"),s=t("./jars-timestamp");function l(){var t=null,e=null;this.handleCallback=function(){console.log("handling callback from applet"),setTimeout((function(){null!==t?(window.clearInterval(t),t=null,e.success()):console.log("applet called callback after timer expired")}),5)},this.wait=function(n){var i=0,r=n.times;e=n,t=window.setInterval((function(){++i>r&&(window.clearInterval(t),t=null,n.fail())}),n.interval)}}i=r.defineClass({listenerPath:"",sensorDefinitions:null,codebase:"",deviceType:"",appletId:"sensor-applet",classNames:"applet sensor-applet",jars:["jna","sensor","sensor-applets"],deviceSpecificJarUrls:[],code:"org.concord.sensor.applet.SensorApplet",testAppletReadyInterval:100,getArchiveValue:function(t){for(var e=[],n=0;n<t.length;n++)e[n]=t[n]+".jar";return e.join(", ")},getHTML:function(){var t=this.jars.concat(this.deviceSpecificJars);return["<applet ",'id="',this.appletId,'" ','class="',this.classNames,'" ','archive="',this.getArchiveValue(t),'" ','code="',this.code,'" ','codebase="',this.codebase,"/",s,'" ','width="1px" ','height="1px" ','MAYSCRIPT="true" ',">",'<param name="MAYSCRIPT" value="true" />','<param name="evalOnInit" value="'+this.listenerPath+'.appletIsReadyCallback()" />','<param name="permissions" value="all-permissions" />','<param name="java_arguments" value="-Djnlp.packEnabled=true"/>',"</applet>"].join("")},getTestAppletHTML:function(){return["<applet ",'id="',this.appletId,'-test-applet" ','class="applet test-sensor-applet" ','code="org.concord.sensor.applet.DetectionApplet" ','archive="',this.getArchiveValue(["sensor-applets"]),'" ','codebase="',this.codebase,"/",s,'" ','width="150px" ','height="150px" ','style="position: absolute; ',"left: "+($("body").width()/2-75)+"px; ","top: "+($("body").height()/2-75)+'px;" ','MAYSCRIPT="true" ',">",'<param name="MAYSCRIPT" value="true" />','<param name="evalOnInit" value="'+this.listenerPath+'.testAppletIsReadyCallback()" />','<param name="permissions" value="all-permissions" />','<param name="java_arguments" value="-Djnlp.packEnabled=true"/>',"</applet>"].join("")},isSensorConnected:function(t){var e,n,i=this;setTimeout((function(){e=function(r){r?(e=function(){var e=JSON.parse(i.appletInstance.getCachedAttachedSensors());if(e)if(1===i.sensorDefinitions.length){for(var n=0;n<e.length;n++)if(i.appletInstance.getTypeConstantName(e[n].type)===i.sensorDefinitions[0].typeConstantName)return void t.call(i,!0);t.call(i,!1)}else t.call(i,!0);else t.call(i,!1)},n=i.registerCallback(e),i.appletInstance.getAttachedSensors(i.deviceType,""+n)):t.call(i,!1)},n=i.registerCallback(e),i.appletInstance.isInterfaceConnected(i.deviceType,""+n)}))},_state:"not appended",getState:function(){return this._state},append:function(t,e){if("not appended"!==this.getState())throw new Error("Can't call append() when sensor applet has left 'not appended' state");console.log("appending test applet"),this.$testAppletContainer=this._appendHTML(this.appletId+"-test-applet-container",this.getTestAppletHTML(),t),this._state="test applet appended",this._waitForTestApplet(),this._appendCallback=e},_appendHTML:function(t,e,n){var i=$("#"+t);return i.length||(i=$("<div id='"+t+"'/>").appendTo(n)),i.html(e),i},_testAppletWaiter:new l,testAppletIsReadyCallback:function(){this._testAppletWaiter.handleCallback()},_waitForTestApplet:function(){var t=this;this._testAppletWaiter.wait({times:30,interval:1e3,success:function(){t.$appletContainer=t._appendHTML(t.appletId+"-container",t.getHTML(),$("body")),t._state="appended",t._waitForApplet()},fail:function(){t._appendCallback(new a.JavaLoadError("Timed out waiting for test applet to initialize."))}})},_appletWaiter:new l,appletIsReadyCallback:function(){this._appletWaiter.handleCallback()},_waitForApplet:function(){var t=this;this._appletWaiter.wait({times:30,interval:1e3,success:function(){var e=[];t.$testAppletContainer.html(""),"appended"===t.getState()&&(t._state="applet ready"),t.appletInstance=$("#"+t.appletId)[0];for(var n=0;n<t.sensorDefinitions.length;n++)e[n]=t.appletInstance.getSensorRequest(t.sensorDefinitions[n].measurementType);t.appletInstance.initSensorInterface(t.listenerPath,t.deviceType,e)},fail:function(){t._appendCallback(new a.AppletInitializationError("Timed out waiting for sensor applet to initialize."))}})},readSensor:function(t){var e=this;if("reading sensor"===this.getState())return console.log("Already reading sensor in another thread..."),void t.call(this,new a.AlreadyReadingError("Already reading sensor in another thread"),null);"stopped"===this.getState()?(this._state="reading sensor",this.isSensorConnected((function(n){if(n){var i=e.registerCallback((function(n){e._state="stopped",n&&0!==n.length?t.call(e,null,n):t.call(e,new Error("readSensor: no sensor values to report"),null)}));e.appletInstance.getConfiguredSensorsValues(e.deviceType,""+i)}else e._state="stopped",t.call(e,new a.SensorConnectionError("readSensor: sensor is not connected"),null)}))):t.call(this,new Error("Tried to read the sensor value from non-stopped state '"+this.getState()+'"'),null)},start:function(t){var e=this;if("reading sensor"===this.getState())return console.log("start called while waiting for a sensor reading"),void setTimeout((function(){e.start(t)}),100);"stopped"===this.getState()?(this._state="starting",this.isSensorConnected((function(n){n?(e.appletInstance.startCollecting(),e._state="started",t&&t.call(e,null,!0)):(e._state="stopped",t&&t.call(e,new a.SensorConnectionError("Device reported the requested sensor type was not attached."),null))}))):t&&setTimeout((function(){t.call(this,new Error("Tried to start the applet from non-stopped state '"+this.getState()+'"'),!1)}),5)},stop:function(){"started"===this.getState()&&(this._state="stopped",this.appletInstance.stopCollecting())},remove:function(){"not appended"!==this.getState()&&(this.$appletContainer&&this.$appletContainer.html(""),this.$testAppletContainer&&this.$testAppletContainer.html(""),this._state="not appended")},initSensorInterfaceComplete:function(t){var e=this;setTimeout((function(){t?(e._state="stopped",e._appendCallback(null),e._appendCallback=null):e._appendCallback(new a.SensorConnectionError("Device reported the requested sensor type was not attached."))}),5)},dataReceived:function(t,e,n){var i=this,r=[],o=this.sensorDefinitions.length;setTimeout((function(){n=n||[];for(var t=0;t<e;t++){for(var a=0;a<o;a++)r[a]=n[t*o+a];i.emit("data",r)}}),5)},deviceUnplugged:function(){var t=this;window.setTimeout((function(){t.emit("deviceUnplugged")}),5)},sensorUnplugged:function(){console.log("received sensorUnplugged message; deviceType = "+this.deviceType)},callbackTable:[],registerCallback:function(t){return this.callbackTable.push(t),this.callbackTable.length-1},handleCallback:function(t,e){var n,i=this;"string"==typeof t&&this[t]?n=this[t]:this.callbackTable[t]&&(n=this.callbackTable[t],this.callbackTable[t]=null),n&&(e=e||[],setTimeout((function(){n.apply(i,e)}),5))}}),r.mixin(i.prototype,o),e.exports=i},{"./errors":2,"./jars-timestamp":3,"./mini-class":4,"./mini-event-emitter":5}],7:[function(t,e,n){e.exports={goMotion:{appletClass:"GoIO",measurementName:"Distance",measurementType:"distance",typeConstantName:"distance",sensorName:"GoMotion",deviceName:"GoMotion",samplesPerSecond:20,tareable:!0,minReading:-2,maxReading:2,precision:2,maxSeconds:20},goTemp:{appletClass:"GoIO",measurementName:"Temperature",measurementType:"temperature",typeConstantName:"temperature_wand",sensorName:"GoIO Temperature Sensor",deviceName:"GoIO",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:40,maxSeconds:20},goLinkTemperature:{appletClass:"GoIO",measurementName:"Temperature",measurementType:"temperature",typeConstantName:"temperature",sensorName:"GoIO Temperature Sensor",deviceName:"GoIO",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:40,maxSeconds:20},goLinkLight:{appletClass:"GoIO",measurementName:"Light Intensity",measurementType:"light",typeConstantName:"light",sensorName:"GoIO Light Sensor",deviceName:"GoIO",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:2e3,maxSeconds:20},goLinkForce:{appletClass:"GoIO",measurementName:"Force",measurementType:"force",typeConstantName:"force",sensorName:"GoIO Force Sensor",deviceName:"GoIO",samplesPerSecond:20,tareable:!0,minReading:-50,maxReading:50,precision:2,maxSeconds:10},goLinkPH:{appletClass:"GoIO",measurementName:"Acidity",measurementType:"ph",typeConstantName:"ph",sensorName:"GoIO pH Sensor",deviceName:"GoIO",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:14,maxSeconds:60},goLinkCO2:{appletClass:"GoIO",measurementName:"CO₂ Concentration",measurementType:"co2",typeConstantName:"co2_gas",sensorName:"GoIO CO₂ sensor",deviceName:"GoIO",samplesPerSecond:1,tareable:!1,minReading:0,maxReading:5e3,maxSeconds:60},goLinkO2:{appletClass:"GoIO",measurementName:"O₂ Concentration",measurementType:"o2",typeConstantName:"oxygen_gas",sensorName:"GoIO O₂ sensor",deviceName:"GoIO",samplesPerSecond:1,tareable:!1,minReading:0,maxReading:100,maxSeconds:60},labQuestMotion:{appletClass:"LabQuest",measurementName:"Distance",measurementType:"distance",typeConstantName:"distance",sensorName:"LabQuest Motion Sensor",deviceName:"LabQuest",samplesPerSecond:20,tareable:!0,minReading:-2,maxReading:2,precision:2,maxSeconds:20},labQuestTemperature:{appletClass:"LabQuest",measurementName:"Temperature",measurementType:"temperature",typeConstantName:"temperature",sensorName:"LabQuest Temperature Sensor",deviceName:"LabQuest",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:40,maxSeconds:20},labQuestLight:{appletClass:"LabQuest",measurementName:"Light Intensity",measurementType:"light",typeConstantName:"light",sensorName:"LabQuest Light Sensor",deviceName:"LabQuest",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:2e3,maxSeconds:20},labQuestForce:{appletClass:"LabQuest",measurementName:"Force",measurementType:"force",typeConstantName:"force",sensorName:"LabQuest Force Sensor",deviceName:"LabQuest",samplesPerSecond:20,tareable:!0,minReading:-50,maxReading:50,precision:2,maxSeconds:10},labQuestPH:{appletClass:"LabQuest",measurementName:"Acidity",measurementType:"ph",typeConstantName:"ph",sensorName:"LabQuest pH Sensor",deviceName:"LabQuest",samplesPerSecond:10,tareable:!1,minReading:0,maxReading:14,maxSeconds:60},labQuestCO2:{appletClass:"LabQuest",measurementName:"CO₂ Concentration",measurementType:"co2",typeConstantName:"co2_gas",sensorName:"LabQuest CO₂ sensor",deviceName:"LabQuest",samplesPerSecond:1,tareable:!1,minReading:0,maxReading:5e3,maxSeconds:60},labQuestO2:{appletClass:"LabQuest",measurementName:"O₂ Concentration",measurementType:"o2",typeConstantName:"oxygen_gas",sensorName:"LabQuest O₂ sensor",deviceName:"LabQuest",samplesPerSecond:1,tareable:!1,minReading:0,maxReading:100,maxSeconds:60}}},{}],8:[function(t,e,n){e.exports={units:{time:{name:"second",pluralName:"seconds",symbol:"s"},distance:{name:"meter",pluralName:"meters",symbol:"m"},temperature:{name:"degree Celsius",pluaralName:"degrees Celsius",symbol:"°C"},light:{name:"lux",pluralName:"lux",symbol:"lux"},force:{name:"Newton",pluralName:"Newtons",symbol:"N"},ph:{name:"pH Unit",pluralName:"pH Units",symbol:"pH"},co2:{name:"part per million",pluralName:"parts per million",symbol:"ppm"},o2:{name:"part per million",pluralName:"parts per million",symbol:"ppm"}}}},{}],9:[function(t,e,n){var i=t("./lib/applet-classes"),r=t("./lib/errors");e.exports={GoIO:i.GoIO,LabQuest:i.LabQuest,sensorDefinitions:t("./lib/sensor-definitions"),unitsDefinition:t("./lib/units-definition"),JavaLoadError:r.JavaLoadError,AppletInitializationError:r.AppletInitializationError,SensorConnectionError:r.SensorConnectionError,AlreadyReadingError:r.AlreadyReadingError}},{"./lib/applet-classes":1,"./lib/errors":2,"./lib/sensor-definitions":7,"./lib/units-definition":8}],10:[function(t,e,n){var i=Object.prototype.toString,r=Object.prototype.hasOwnProperty;function o(t){return"object"!=typeof t&&"function"!=typeof t||null===t}function a(t){if(o(t))throw new TypeError("Object.keys called on a non-object");var e=[];for(var n in t)r.call(t,n)&&e.push(n);return e}n.isArray="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===i.call(t)},n.indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1},n.filter=function(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n},n.forEach=function(t,e,n){if(t.forEach)return t.forEach(e,n);for(var i=0;i<t.length;i++)e.call(n,t[i],i,t)},n.map=function(t,e){if(t.map)return t.map(e);for(var n=new Array(t.length),i=0;i<t.length;i++)n[i]=e(t[i],i,t);return n},n.reduce=function(t,e,n){if(t.reduce)return t.reduce(e,n);var i,r=!1;2<arguments.length&&(i=n,r=!0);for(var o=0,a=t.length;a>o;++o)t.hasOwnProperty(o)&&(r?i=e(i,t[o],o,t):(i=t[o],r=!0));return i},"b"!=="ab".substr(-1)?n.substr=function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}:n.substr=function(t,e,n){return t.substr(e,n)},n.trim=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},n.bind=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();if(e.bind)return e.bind.apply(e,t);var n=t.shift();return function(){e.apply(n,t.concat([Array.prototype.slice.call(arguments)]))}},n.create="function"==typeof Object.create?Object.create:function(t,e){var n;if(null===t)n={__proto__:null};else{if("object"!=typeof t)throw new TypeError("typeof prototype["+typeof t+"] != 'object'");var i=function(){};i.prototype=t,(n=new i).__proto__=t}return void 0!==e&&Object.defineProperties&&Object.defineProperties(n,e),n};var s="function"==typeof Object.keys?Object.keys:a,l="function"==typeof Object.getOwnPropertyNames?Object.getOwnPropertyNames:function(t){if(o(t))throw new TypeError("Object.getOwnPropertyNames called on a non-object");var e=a(t);return n.isArray(t)&&-1===n.indexOf(t,"length")&&e.push("length"),e};if((new Error).hasOwnProperty("description")){var u=function(t,e){return"[object Error]"===i.call(t)&&(e=n.filter(e,(function(t){return"description"!==t&&"number"!==t&&"message"!==t}))),e};n.keys=function(t){return u(t,s(t))},n.getOwnPropertyNames=function(t){return u(t,l(t))}}else n.keys=s,n.getOwnPropertyNames=l;function c(t,e){return{value:t[e]}}if("function"==typeof Object.getOwnPropertyDescriptor)try{Object.getOwnPropertyDescriptor({a:1},"a"),n.getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor}catch(t){n.getOwnPropertyDescriptor=function(t,e){try{return Object.getOwnPropertyDescriptor(t,e)}catch(n){return c(t,e)}}}else n.getOwnPropertyDescriptor=c},{}],11:[function(t,e,n){var i=t("_shims"),r=/%[sdj%]/g;function o(t,e){var i={seen:[],stylize:s};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),d(e)?i.showHidden=e:e&&n._extend(i,e),g(i.showHidden)&&(i.showHidden=!1),g(i.depth)&&(i.depth=2),g(i.colors)&&(i.colors=!1),g(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=a),l(i,t,i.depth)}function a(t,e){var n=o.styles[e];return n?"["+o.colors[n][0]+"m"+t+"["+o.colors[n][1]+"m":t}function s(t,e){return t}function l(t,e,r){if(t.customInspect&&e&&x(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var o=e.inspect(r);return m(o)||(o=l(t,o,r)),o}var a=function(t,e){if(g(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return f(e)?t.stylize(""+e,"number"):d(e)?t.stylize(""+e,"boolean"):p(e)?t.stylize("null","null"):void 0}(t,e);if(a)return a;var s=i.keys(e),y=function(t){var e={};return i.forEach(t,(function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=i.getOwnPropertyNames(e)),0===s.length){if(x(e)){var w=e.name?": "+e.name:"";return t.stylize("[Function"+w+"]","special")}if(v(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(b(e))return t.stylize(Date.prototype.toString.call(e),"date");if(_(e))return u(e)}var C,T="",S=!1,A=["{","}"];return h(e)&&(S=!0,A=["[","]"]),x(e)&&(T=" [Function"+(e.name?": "+e.name:"")+"]"),v(e)&&(T=" "+RegExp.prototype.toString.call(e)),b(e)&&(T=" "+Date.prototype.toUTCString.call(e)),_(e)&&(T=" "+u(e)),0!==s.length||S&&0!=e.length?r<0?v(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),C=S?function(t,e,n,r,o){for(var a=[],s=0,l=e.length;s<l;++s)k(e,String(s))?a.push(c(t,e,n,r,String(s),!0)):a.push("");return i.forEach(o,(function(i){i.match(/^\d+$/)||a.push(c(t,e,n,r,i,!0))})),a}(t,e,r,y,s):s.map((function(n){return c(t,e,r,y,n,S)})),t.seen.pop(),function(t,e,n){return i.reduce(t,(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(C,T,A)):A[0]+T+A[1]}function u(t){return"["+Error.prototype.toString.call(t)+"]"}function c(t,e,n,r,o,a){var s,u,c;if((c=i.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?u=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(u=t.stylize("[Setter]","special")),k(r,o)||(s="["+o+"]"),u||(i.indexOf(t.seen,c.value)<0?(u=p(n)?l(t,c.value,null):l(t,c.value,n-1)).indexOf("\n")>-1&&(u=a?u.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+u.split("\n").map((function(t){return"   "+t})).join("\n")):u=t.stylize("[Circular]","special")),g(s)){if(a&&o.match(/^\d+$/))return u;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+u}function h(t){return i.isArray(t)}function d(t){return"boolean"==typeof t}function p(t){return null===t}function f(t){return"number"==typeof t}function m(t){return"string"==typeof t}function g(t){return void 0===t}function v(t){return y(t)&&"[object RegExp]"===w(t)}function y(t){return"object"==typeof t&&t}function b(t){return y(t)&&"[object Date]"===w(t)}function _(t){return y(t)&&"[object Error]"===w(t)}function x(t){return"function"==typeof t}function w(t){return Object.prototype.toString.call(t)}function C(t){return t<10?"0"+t.toString(10):t.toString(10)}n.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(o(arguments[n]));return e.join(" ")}n=1;for(var i=arguments,a=i.length,s=String(t).replace(r,(function(t){if("%%"===t)return"%";if(n>=a)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}})),l=i[n];n<a;l=i[++n])p(l)||!y(l)?s+=" "+l:s+=" "+o(l);return s},n.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=h,n.isBoolean=d,n.isNull=p,n.isNullOrUndefined=function(t){return null==t},n.isNumber=f,n.isString=m,n.isSymbol=function(t){return"symbol"==typeof t},n.isUndefined=g,n.isRegExp=v,n.isObject=y,n.isDate=b,n.isError=_,n.isFunction=x,n.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},n.isBuffer=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.binarySlice};var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var t=new Date,e=[C(t.getHours()),C(t.getMinutes()),C(t.getSeconds())].join(":");return[t.getDate(),T[t.getMonth()],e].join(" ")}function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}n.log=function(){console.log("%s - %s",S(),n.format.apply(n,arguments))},n.inherits=function(t,e){t.super_=e,t.prototype=i.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},n._extend=function(t,e){if(!e||!y(e))return t;for(var n=i.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}},{_shims:10}]},{},[9])(9)}});
//# sourceMappingURL=lab.min.js.map